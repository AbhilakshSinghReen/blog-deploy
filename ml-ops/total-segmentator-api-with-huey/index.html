<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      rel="preload"
      as="image"
      href="/media/images/main-contact-email-light.jpg"
    />
    <link
      rel="preload"
      as="image"
      href="/media/images/total-segmentator-api-with-huey-system-architecture-diagram.jpg"
    />
    <link
      rel="preload"
      as="image"
      href="/media/images/3d-slicer-extension-tutorials-series-thumbnails.jpg"
    />
    <link
      rel="preload"
      as="image"
      href="/media/images/3d-slicer-extension-segmentation-through-custom-api-flow.jpg"
    />
    <link
      rel="stylesheet"
      href="/_next/static/css/1d4d01086947be98.css"
      data-precedence="next"
    />
    <link
      rel="preload"
      as="script"
      fetchpriority="low"
      href="/_next/static/chunks/webpack-83486951edee0db5.js"
    />
    <script
      src="/_next/static/chunks/fd9d1056-90960e0a7e77703c.js"
      async=""
    ></script>
    <script src="/_next/static/chunks/23-365ff0b9e0ad811d.js" async=""></script>
    <script
      src="/_next/static/chunks/main-app-37d3bbd360c1bff1.js"
      async=""
    ></script>
    <script src="/_next/static/chunks/98-98337b3bb708bd24.js" async=""></script>
    <script
      src="/_next/static/chunks/748-1f14ee6eb3d7029a.js"
      async=""
    ></script>
    <script
      src="/_next/static/chunks/271-37a22bace913f735.js"
      async=""
    ></script>
    <script
      src="/_next/static/chunks/app/layout-08611f287dda1230.js"
      async=""
    ></script>
    <script
      src="/_next/static/chunks/134-4d46f2c5e7204b76.js"
      async=""
    ></script>
    <script
      src="/_next/static/chunks/830-8a0df588e7c84864.js"
      async=""
    ></script>
    <script
      src="/_next/static/chunks/411-3d27264901e39398.js"
      async=""
    ></script>
    <script
      src="/_next/static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"
      async=""
    ></script>
    <link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="16x16" />
    <script
      src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js"
      nomodule=""
    ></script>
  </head>
  <body class="__className_d65c78">
    <header style="margin-bottom: 25px">
      <style data-emotion="css 13x2oq7">
        .css-13x2oq7 {
          display: -webkit-box;
          display: -webkit-flex;
          display: -ms-flexbox;
          display: flex;
          -webkit-flex-direction: column;
          -ms-flex-direction: column;
          flex-direction: column;
          width: 100%;
          box-sizing: border-box;
          -webkit-flex-shrink: 0;
          -ms-flex-negative: 0;
          flex-shrink: 0;
          position: fixed;
          z-index: 1100;
          top: 0;
          left: auto;
          right: 0;
          background-color: #1976d2;
          color: #fff;
        }
        @media print {
          .css-13x2oq7 {
            position: absolute;
          }
        }</style
      ><style data-emotion="css 5poeop">
        .css-5poeop {
          background-color: #fff;
          color: rgba(0, 0, 0, 0.87);
          -webkit-transition: box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
          transition: box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
          box-shadow:
            0px 2px 4px -1px rgba(0, 0, 0, 0.2),
            0px 4px 5px 0px rgba(0, 0, 0, 0.14),
            0px 1px 10px 0px rgba(0, 0, 0, 0.12);
          display: -webkit-box;
          display: -webkit-flex;
          display: -ms-flexbox;
          display: flex;
          -webkit-flex-direction: column;
          -ms-flex-direction: column;
          flex-direction: column;
          width: 100%;
          box-sizing: border-box;
          -webkit-flex-shrink: 0;
          -ms-flex-negative: 0;
          flex-shrink: 0;
          position: fixed;
          z-index: 1100;
          top: 0;
          left: auto;
          right: 0;
          background-color: #1976d2;
          color: #fff;
        }
        @media print {
          .css-5poeop {
            position: absolute;
          }
        }
      </style>
      <header
        class="MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionFixed mui-fixed css-5poeop"
      >
        <style data-emotion="css 1qsxih2">
          .css-1qsxih2 {
            width: 100%;
            margin-left: auto;
            box-sizing: border-box;
            margin-right: auto;
            display: block;
            padding-left: 16px;
            padding-right: 16px;
          }
          @media (min-width: 600px) {
            .css-1qsxih2 {
              padding-left: 24px;
              padding-right: 24px;
            }
          }
          @media (min-width: 1200px) {
            .css-1qsxih2 {
              max-width: 1200px;
            }
          }
        </style>
        <div class="MuiContainer-root MuiContainer-maxWidthLg css-1qsxih2">
          <style data-emotion="css r4h1bh">
            .css-r4h1bh {
              position: relative;
              display: -webkit-box;
              display: -webkit-flex;
              display: -ms-flexbox;
              display: flex;
              -webkit-align-items: center;
              -webkit-box-align: center;
              -ms-flex-align: center;
              align-items: center;
              padding-left: 16px;
              padding-right: 16px;
              min-height: 56px;
              display: -webkit-box;
              display: -webkit-flex;
              display: -ms-flexbox;
              display: flex;
              -webkit-flex-direction: row;
              -ms-flex-direction: row;
              flex-direction: row;
              -webkit-box-pack: justify;
              -webkit-justify-content: space-between;
              justify-content: space-between;
              -webkit-align-items: center;
              -webkit-box-align: center;
              -ms-flex-align: center;
              align-items: center;
              height: 100%;
              padding: 0px;
            }
            @media (min-width: 600px) {
              .css-r4h1bh {
                padding-left: 24px;
                padding-right: 24px;
              }
            }
            @media (min-width: 0px) {
              @media (orientation: landscape) {
                .css-r4h1bh {
                  min-height: 48px;
                }
              }
            }
            @media (min-width: 600px) {
              .css-r4h1bh {
                min-height: 64px;
              }
            }
          </style>
          <div
            class="MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-r4h1bh"
          >
            <style data-emotion="css 1pna09g">
              .css-1pna09g {
                margin: 0;
                font-family: "Roboto", "Helvetica", "Arial", sans-serif;
                font-weight: 400;
                font-size: 2.125rem;
                line-height: 1.235;
                letter-spacing: 0.00735em;
                font-weight: 700;
                text-align: center;
                background: linear-gradient(45deg, #ffd700 30%, #ffa500 90%);
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
              }
              .css-1pna09g:hover {
                cursor: pointer;
              }
            </style>
            <h4 class="MuiTypography-root MuiTypography-h4 css-1pna09g">
              A.N.T
            </h4>
            <div class="MuiBox-root css-0">
              <style data-emotion="css j4ylzh">
                .css-j4ylzh {
                  text-align: center;
                  -webkit-flex: 0 0 auto;
                  -ms-flex: 0 0 auto;
                  flex: 0 0 auto;
                  font-size: 1.5rem;
                  padding: 8px;
                  border-radius: 50%;
                  overflow: visible;
                  color: rgba(0, 0, 0, 0.54);
                  -webkit-transition: background-color 150ms
                    cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                  transition: background-color 150ms
                    cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                  color: #ed6c02;
                }
                .css-j4ylzh:hover {
                  background-color: rgba(0, 0, 0, 0.04);
                }
                @media (hover: none) {
                  .css-j4ylzh:hover {
                    background-color: transparent;
                  }
                }
                .css-j4ylzh:hover {
                  background-color: rgba(237, 108, 2, 0.04);
                }
                @media (hover: none) {
                  .css-j4ylzh:hover {
                    background-color: transparent;
                  }
                }
                .css-j4ylzh.Mui-disabled {
                  background-color: transparent;
                  color: rgba(0, 0, 0, 0.26);
                }</style
              ><style data-emotion="css r4nl99">
                .css-r4nl99 {
                  display: -webkit-inline-box;
                  display: -webkit-inline-flex;
                  display: -ms-inline-flexbox;
                  display: inline-flex;
                  -webkit-align-items: center;
                  -webkit-box-align: center;
                  -ms-flex-align: center;
                  align-items: center;
                  -webkit-box-pack: center;
                  -ms-flex-pack: center;
                  -webkit-justify-content: center;
                  justify-content: center;
                  position: relative;
                  box-sizing: border-box;
                  -webkit-tap-highlight-color: transparent;
                  background-color: transparent;
                  outline: 0;
                  border: 0;
                  margin: 0;
                  border-radius: 0;
                  padding: 0;
                  cursor: pointer;
                  -webkit-user-select: none;
                  -moz-user-select: none;
                  -ms-user-select: none;
                  user-select: none;
                  vertical-align: middle;
                  -moz-appearance: none;
                  -webkit-appearance: none;
                  -webkit-text-decoration: none;
                  text-decoration: none;
                  color: inherit;
                  text-align: center;
                  -webkit-flex: 0 0 auto;
                  -ms-flex: 0 0 auto;
                  flex: 0 0 auto;
                  font-size: 1.5rem;
                  padding: 8px;
                  border-radius: 50%;
                  overflow: visible;
                  color: rgba(0, 0, 0, 0.54);
                  -webkit-transition: background-color 150ms
                    cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                  transition: background-color 150ms
                    cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                  color: #ed6c02;
                }
                .css-r4nl99::-moz-focus-inner {
                  border-style: none;
                }
                .css-r4nl99.Mui-disabled {
                  pointer-events: none;
                  cursor: default;
                }
                @media print {
                  .css-r4nl99 {
                    -webkit-print-color-adjust: exact;
                    color-adjust: exact;
                  }
                }
                .css-r4nl99:hover {
                  background-color: rgba(0, 0, 0, 0.04);
                }
                @media (hover: none) {
                  .css-r4nl99:hover {
                    background-color: transparent;
                  }
                }
                .css-r4nl99:hover {
                  background-color: rgba(237, 108, 2, 0.04);
                }
                @media (hover: none) {
                  .css-r4nl99:hover {
                    background-color: transparent;
                  }
                }
                .css-r4nl99.Mui-disabled {
                  background-color: transparent;
                  color: rgba(0, 0, 0, 0.26);
                }</style
              ><button
                class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorWarning MuiIconButton-sizeMedium css-r4nl99"
                tabindex="0"
                type="button"
              >
                <style data-emotion="css 6flbmm">
                  .css-6flbmm {
                    -webkit-user-select: none;
                    -moz-user-select: none;
                    -ms-user-select: none;
                    user-select: none;
                    width: 1em;
                    height: 1em;
                    display: inline-block;
                    fill: currentColor;
                    -webkit-flex-shrink: 0;
                    -ms-flex-negative: 0;
                    flex-shrink: 0;
                    -webkit-transition: fill 200ms cubic-bezier(0.4, 0, 0.2, 1)
                      0ms;
                    transition: fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                    font-size: 2.1875rem;
                  }</style
                ><svg
                  class="MuiSvgIcon-root MuiSvgIcon-fontSizeLarge css-6flbmm"
                  focusable="false"
                  aria-hidden="true"
                  viewBox="0 0 24 24"
                  data-testid="MenuIcon"
                >
                  <path d="M3 18h18v-2H3zm0-5h18v-2H3zm0-7v2h18V6z"></path>
                </svg>
              </button>
            </div>
          </div>
        </div>
      </header>
      <div style="padding-top: 55px"></div>
    </header>
    <style data-emotion="css 1qsxih2">
      .css-1qsxih2 {
        width: 100%;
        margin-left: auto;
        box-sizing: border-box;
        margin-right: auto;
        display: block;
        padding-left: 16px;
        padding-right: 16px;
      }
      @media (min-width: 600px) {
        .css-1qsxih2 {
          padding-left: 24px;
          padding-right: 24px;
        }
      }
      @media (min-width: 1200px) {
        .css-1qsxih2 {
          max-width: 1200px;
        }
      }
    </style>
    <div class="MuiContainer-root MuiContainer-maxWidthLg css-1qsxih2">
      <style data-emotion="css 1g0xyuw">
        .css-1g0xyuw {
          margin-bottom: 40px;
          padding-bottom: 16px;
          width: 100%;
          display: -webkit-box;
          display: -webkit-flex;
          display: -ms-flexbox;
          display: flex;
          -webkit-flex-direction: column;
          -ms-flex-direction: column;
          flex-direction: column;
          -webkit-box-pack: start;
          -ms-flex-pack: start;
          -webkit-justify-content: flex-start;
          justify-content: flex-start;
          -webkit-align-items: flex-start;
          -webkit-box-align: flex-start;
          -ms-flex-align: flex-start;
          align-items: flex-start;
        }
      </style>
      <div class="MuiBox-root css-1g0xyuw">
        <style data-emotion="css 1vl439b">
          .css-1vl439b {
            width: 100%;
            -webkit-flex-direction: row;
            -ms-flex-direction: row;
            flex-direction: row;
            -webkit-box-pack: start;
            -ms-flex-pack: start;
            -webkit-justify-content: flex-start;
            justify-content: flex-start;
            -webkit-align-items: center;
            -webkit-box-align: center;
            -ms-flex-align: center;
            align-items: center;
            margin-bottom: 24px;
          }
          @media (min-width: 0px) {
            .css-1vl439b {
              display: none;
            }
          }
          @media (min-width: 900px) {
            .css-1vl439b {
              display: -webkit-box;
              display: -webkit-flex;
              display: -ms-flexbox;
              display: flex;
            }
          }
        </style>
        <div class="MuiBox-root css-1vl439b">
          <style data-emotion="css 1yae3jf">
            .css-1yae3jf {
              display: -webkit-box;
              display: -webkit-flex;
              display: -ms-flexbox;
              display: flex;
              -webkit-flex-direction: row;
              -ms-flex-direction: row;
              flex-direction: row;
              -webkit-box-pack: start;
              -ms-flex-pack: start;
              -webkit-justify-content: flex-start;
              justify-content: flex-start;
              -webkit-align-items: center;
              -webkit-box-align: center;
              -ms-flex-align: center;
              align-items: center;
            }
          </style>
          <div class="MuiBox-root css-1yae3jf">
            <a href="/"
              ><style data-emotion="css pbbsfi">
                .css-pbbsfi {
                  font-family: "Roboto", "Helvetica", "Arial", sans-serif;
                  font-weight: 500;
                  font-size: 0.8125rem;
                  line-height: 1.75;
                  letter-spacing: 0.02857em;
                  text-transform: uppercase;
                  min-width: 64px;
                  padding: 3px 9px;
                  border-radius: 4px;
                  -webkit-transition:
                    background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
                    box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
                    border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
                    color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                  transition:
                    background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
                    box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
                    border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
                    color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                  border: 1px solid rgba(237, 108, 2, 0.5);
                  color: #ed6c02;
                }
                .css-pbbsfi:hover {
                  -webkit-text-decoration: none;
                  text-decoration: none;
                  background-color: rgba(237, 108, 2, 0.04);
                  border: 1px solid #ed6c02;
                }
                @media (hover: none) {
                  .css-pbbsfi:hover {
                    background-color: transparent;
                  }
                }
                .css-pbbsfi.Mui-disabled {
                  color: rgba(0, 0, 0, 0.26);
                  border: 1px solid rgba(0, 0, 0, 0.12);
                }</style
              ><style data-emotion="css 1184ln1">
                .css-1184ln1 {
                  display: -webkit-inline-box;
                  display: -webkit-inline-flex;
                  display: -ms-inline-flexbox;
                  display: inline-flex;
                  -webkit-align-items: center;
                  -webkit-box-align: center;
                  -ms-flex-align: center;
                  align-items: center;
                  -webkit-box-pack: center;
                  -ms-flex-pack: center;
                  -webkit-justify-content: center;
                  justify-content: center;
                  position: relative;
                  box-sizing: border-box;
                  -webkit-tap-highlight-color: transparent;
                  background-color: transparent;
                  outline: 0;
                  border: 0;
                  margin: 0;
                  border-radius: 0;
                  padding: 0;
                  cursor: pointer;
                  -webkit-user-select: none;
                  -moz-user-select: none;
                  -ms-user-select: none;
                  user-select: none;
                  vertical-align: middle;
                  -moz-appearance: none;
                  -webkit-appearance: none;
                  -webkit-text-decoration: none;
                  text-decoration: none;
                  color: inherit;
                  font-family: "Roboto", "Helvetica", "Arial", sans-serif;
                  font-weight: 500;
                  font-size: 0.8125rem;
                  line-height: 1.75;
                  letter-spacing: 0.02857em;
                  text-transform: uppercase;
                  min-width: 64px;
                  padding: 3px 9px;
                  border-radius: 4px;
                  -webkit-transition:
                    background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
                    box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
                    border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
                    color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                  transition:
                    background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
                    box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
                    border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
                    color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                  border: 1px solid rgba(237, 108, 2, 0.5);
                  color: #ed6c02;
                }
                .css-1184ln1::-moz-focus-inner {
                  border-style: none;
                }
                .css-1184ln1.Mui-disabled {
                  pointer-events: none;
                  cursor: default;
                }
                @media print {
                  .css-1184ln1 {
                    -webkit-print-color-adjust: exact;
                    color-adjust: exact;
                  }
                }
                .css-1184ln1:hover {
                  -webkit-text-decoration: none;
                  text-decoration: none;
                  background-color: rgba(237, 108, 2, 0.04);
                  border: 1px solid #ed6c02;
                }
                @media (hover: none) {
                  .css-1184ln1:hover {
                    background-color: transparent;
                  }
                }
                .css-1184ln1.Mui-disabled {
                  color: rgba(0, 0, 0, 0.26);
                  border: 1px solid rgba(0, 0, 0, 0.12);
                }</style
              ><button
                class="MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedWarning MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorWarning MuiButton-root MuiButton-outlined MuiButton-outlinedWarning MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorWarning css-1184ln1"
                tabindex="0"
                type="button"
              >
                Home
              </button></a
            >
          </div>
          <div class="MuiBox-root css-1yae3jf">
            <style data-emotion="css vubbuv">
              .css-vubbuv {
                -webkit-user-select: none;
                -moz-user-select: none;
                -ms-user-select: none;
                user-select: none;
                width: 1em;
                height: 1em;
                display: inline-block;
                fill: currentColor;
                -webkit-flex-shrink: 0;
                -ms-flex-negative: 0;
                flex-shrink: 0;
                -webkit-transition: fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                transition: fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                font-size: 1.5rem;
              }</style
            ><svg
              class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
              focusable="false"
              aria-hidden="true"
              viewBox="0 0 24 24"
              data-testid="KeyboardArrowRightIcon"
            >
              <path
                d="M8.59 16.59 13.17 12 8.59 7.41 10 6l6 6-6 6z"
              ></path></svg
            ><a href="/ml-ops/"
              ><button
                class="MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedWarning MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorWarning MuiButton-root MuiButton-outlined MuiButton-outlinedWarning MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorWarning css-1184ln1"
                tabindex="0"
                type="button"
              >
                ML Ops
              </button></a
            >
          </div>
          <div class="MuiBox-root css-1yae3jf">
            <svg
              class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
              focusable="false"
              aria-hidden="true"
              viewBox="0 0 24 24"
              data-testid="KeyboardArrowRightIcon"
            >
              <path
                d="M8.59 16.59 13.17 12 8.59 7.41 10 6l6 6-6 6z"
              ></path></svg
            ><a href="/ml-ops/total-segmentator-api-with-huey/"
              ><button
                class="MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedWarning MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorWarning MuiButton-root MuiButton-outlined MuiButton-outlinedWarning MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorWarning css-1184ln1"
                tabindex="0"
                type="button"
              >
                Running ML inference through a Huey Task Queue and FastAPI
              </button></a
            >
          </div>
        </div>
        <style data-emotion="css slaq2o">
          .css-slaq2o {
            box-sizing: border-box;
            display: -webkit-box;
            display: -webkit-flex;
            display: -ms-flexbox;
            display: flex;
            -webkit-box-flex-wrap: wrap;
            -webkit-flex-wrap: wrap;
            -ms-flex-wrap: wrap;
            flex-wrap: wrap;
            width: 100%;
            -webkit-flex-direction: row;
            -ms-flex-direction: row;
            flex-direction: row;
            margin-top: -16px;
            width: calc(100% + 16px);
            margin-left: -16px;
            margin-bottom: 0px;
          }
          .css-slaq2o > .MuiGrid-item {
            padding-top: 16px;
          }
          .css-slaq2o > .MuiGrid-item {
            padding-left: 16px;
          }
        </style>
        <div
          class="MuiGrid-root MuiGrid-container MuiGrid-spacing-xs-2 css-slaq2o"
        >
          <style data-emotion="css hr4540">
            .css-hr4540 {
              box-sizing: border-box;
              margin: 0;
              -webkit-flex-direction: row;
              -ms-flex-direction: row;
              flex-direction: row;
              -webkit-flex-basis: 100%;
              -ms-flex-preferred-size: 100%;
              flex-basis: 100%;
              -webkit-box-flex: 0;
              -webkit-flex-grow: 0;
              -ms-flex-positive: 0;
              flex-grow: 0;
              max-width: 100%;
              background: linear-gradient(to right, #eeeeee, #ffffff);
              border-radius: 20px;
            }
            @media (min-width: 600px) {
              .css-hr4540 {
                -webkit-flex-basis: 100%;
                -ms-flex-preferred-size: 100%;
                flex-basis: 100%;
                -webkit-box-flex: 0;
                -webkit-flex-grow: 0;
                -ms-flex-positive: 0;
                flex-grow: 0;
                max-width: 100%;
              }
            }
            @media (min-width: 900px) {
              .css-hr4540 {
                -webkit-flex-basis: 33.333333%;
                -ms-flex-preferred-size: 33.333333%;
                flex-basis: 33.333333%;
                -webkit-box-flex: 0;
                -webkit-flex-grow: 0;
                -ms-flex-positive: 0;
                flex-grow: 0;
                max-width: 33.333333%;
              }
            }
            @media (min-width: 1200px) {
              .css-hr4540 {
                -webkit-flex-basis: 33.333333%;
                -ms-flex-preferred-size: 33.333333%;
                flex-basis: 33.333333%;
                -webkit-box-flex: 0;
                -webkit-flex-grow: 0;
                -ms-flex-positive: 0;
                flex-grow: 0;
                max-width: 33.333333%;
              }
            }
            @media (min-width: 1536px) {
              .css-hr4540 {
                -webkit-flex-basis: 33.333333%;
                -ms-flex-preferred-size: 33.333333%;
                flex-basis: 33.333333%;
                -webkit-box-flex: 0;
                -webkit-flex-grow: 0;
                -ms-flex-positive: 0;
                flex-grow: 0;
                max-width: 33.333333%;
              }
            }
          </style>
          <div
            class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-12 MuiGrid-grid-sm-12 MuiGrid-grid-md-4 css-hr4540"
          >
            <style data-emotion="css 194lag7">
              .css-194lag7 {
                width: 100%;
                height: 100%;
                display: -webkit-box;
                display: -webkit-flex;
                display: -ms-flexbox;
                display: flex;
                -webkit-flex-direction: column;
                -ms-flex-direction: column;
                flex-direction: column;
                -webkit-box-pack: center;
                -ms-flex-pack: center;
                -webkit-justify-content: center;
                justify-content: center;
                -webkit-align-items: flex-start;
                -webkit-box-align: flex-start;
                -ms-flex-align: flex-start;
                align-items: flex-start;
                padding-bottom: 16px;
              }
            </style>
            <div class="MuiBox-root css-194lag7">
              <style data-emotion="css t1nuxs">
                .css-t1nuxs {
                  margin: 0;
                  font-family: "Roboto", "Helvetica", "Arial", sans-serif;
                  font-weight: 400;
                  font-size: 1.5rem;
                  line-height: 1.334;
                  letter-spacing: 0em;
                  margin-bottom: 0.35em;
                }
              </style>
              <h1
                class="MuiTypography-root MuiTypography-h5 MuiTypography-gutterBottom css-t1nuxs"
              >
                Running ML inference through a Huey Task Queue and FastAPI
              </h1>
              <style data-emotion="css 15wzlf5">
                .css-15wzlf5 {
                  margin: 0;
                  margin-bottom: 0.35em;
                  margin-bottom: 32px;
                }
              </style>
              <p
                class="MuiTypography-root MuiTypography-p MuiTypography-gutterBottom css-15wzlf5"
              >
                Learn how to train a simple CNN in PyTorch and how to convert it
                to ONNX for deployment.
              </p>
              <style data-emotion="css 1aiyebw">
                .css-1aiyebw {
                  width: 100%;
                  display: -webkit-box;
                  display: -webkit-flex;
                  display: -ms-flexbox;
                  display: flex;
                  -webkit-flex-direction: row;
                  -ms-flex-direction: row;
                  flex-direction: row;
                  -webkit-box-pack: justify;
                  -webkit-justify-content: space-between;
                  justify-content: space-between;
                  -webkit-align-items: center;
                  -webkit-box-align: center;
                  -ms-flex-align: center;
                  align-items: center;
                  margin-bottom: 16px;
                }
              </style>
              <div class="MuiBox-root css-1aiyebw">
                <style data-emotion="css mxjm1x">
                  .css-mxjm1x {
                    margin: 0;
                    margin-bottom: 0.35em;
                  }
                </style>
                <p
                  class="MuiTypography-root MuiTypography-p MuiTypography-gutterBottom css-mxjm1x"
                >
                  August 26, 2024
                </p>
                <p
                  class="MuiTypography-root MuiTypography-p MuiTypography-gutterBottom css-mxjm1x"
                >
                  07m<!-- -->
                  Read
                </p>
              </div>
              <style data-emotion="css 1sdy4c7">
                .css-1sdy4c7 {
                  width: 100%;
                  display: -webkit-box;
                  display: -webkit-flex;
                  display: -ms-flexbox;
                  display: flex;
                  -webkit-flex-direction: row;
                  -ms-flex-direction: row;
                  flex-direction: row;
                  -webkit-box-pack: justify;
                  -webkit-justify-content: space-between;
                  justify-content: space-between;
                  -webkit-align-items: center;
                  -webkit-box-align: center;
                  -ms-flex-align: center;
                  align-items: center;
                }
              </style>
              <div class="MuiBox-root css-1sdy4c7">
                <style data-emotion="css 19115x2">
                  .css-19115x2 {
                    margin: 0;
                    margin-right: 16px;
                  }
                </style>
                <p class="MuiTypography-root MuiTypography-p css-19115x2">
                  By: Abhilaksh Singh Reen
                </p>
                <style data-emotion="css o6eoqx">
                  .css-o6eoqx {
                    display: -webkit-box;
                    display: -webkit-flex;
                    display: -ms-flexbox;
                    display: flex;
                    -webkit-flex-direction: row;
                    -ms-flex-direction: row;
                    flex-direction: row;
                    -webkit-box-pack: space-evenly;
                    -ms-flex-pack: space-evenly;
                    -webkit-justify-content: space-evenly;
                    justify-content: space-evenly;
                    -webkit-align-items: center;
                    -webkit-box-align: center;
                    -ms-flex-align: center;
                    align-items: center;
                  }
                </style>
                <div class="MuiBox-root css-o6eoqx">
                  <style data-emotion="css 1t2xui4">
                    .css-1t2xui4 {
                      text-align: center;
                      -webkit-flex: 0 0 auto;
                      -ms-flex: 0 0 auto;
                      flex: 0 0 auto;
                      font-size: 1.5rem;
                      padding: 8px;
                      border-radius: 50%;
                      overflow: visible;
                      color: rgba(0, 0, 0, 0.54);
                      -webkit-transition: background-color 150ms
                        cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                      transition: background-color 150ms
                        cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                      color: #0077b5;
                    }
                    .css-1t2xui4:hover {
                      background-color: rgba(0, 0, 0, 0.04);
                    }
                    @media (hover: none) {
                      .css-1t2xui4:hover {
                        background-color: transparent;
                      }
                    }
                    .css-1t2xui4.Mui-disabled {
                      background-color: transparent;
                      color: rgba(0, 0, 0, 0.26);
                    }</style
                  ><style data-emotion="css 1yl6xtp">
                    .css-1yl6xtp {
                      display: -webkit-inline-box;
                      display: -webkit-inline-flex;
                      display: -ms-inline-flexbox;
                      display: inline-flex;
                      -webkit-align-items: center;
                      -webkit-box-align: center;
                      -ms-flex-align: center;
                      align-items: center;
                      -webkit-box-pack: center;
                      -ms-flex-pack: center;
                      -webkit-justify-content: center;
                      justify-content: center;
                      position: relative;
                      box-sizing: border-box;
                      -webkit-tap-highlight-color: transparent;
                      background-color: transparent;
                      outline: 0;
                      border: 0;
                      margin: 0;
                      border-radius: 0;
                      padding: 0;
                      cursor: pointer;
                      -webkit-user-select: none;
                      -moz-user-select: none;
                      -ms-user-select: none;
                      user-select: none;
                      vertical-align: middle;
                      -moz-appearance: none;
                      -webkit-appearance: none;
                      -webkit-text-decoration: none;
                      text-decoration: none;
                      color: inherit;
                      text-align: center;
                      -webkit-flex: 0 0 auto;
                      -ms-flex: 0 0 auto;
                      flex: 0 0 auto;
                      font-size: 1.5rem;
                      padding: 8px;
                      border-radius: 50%;
                      overflow: visible;
                      color: rgba(0, 0, 0, 0.54);
                      -webkit-transition: background-color 150ms
                        cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                      transition: background-color 150ms
                        cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                      color: #0077b5;
                    }
                    .css-1yl6xtp::-moz-focus-inner {
                      border-style: none;
                    }
                    .css-1yl6xtp.Mui-disabled {
                      pointer-events: none;
                      cursor: default;
                    }
                    @media print {
                      .css-1yl6xtp {
                        -webkit-print-color-adjust: exact;
                        color-adjust: exact;
                      }
                    }
                    .css-1yl6xtp:hover {
                      background-color: rgba(0, 0, 0, 0.04);
                    }
                    @media (hover: none) {
                      .css-1yl6xtp:hover {
                        background-color: transparent;
                      }
                    }
                    .css-1yl6xtp.Mui-disabled {
                      background-color: transparent;
                      color: rgba(0, 0, 0, 0.26);
                    }</style
                  ><button
                    class="MuiButtonBase-root MuiIconButton-root MuiIconButton-sizeMedium css-1yl6xtp"
                    tabindex="0"
                    type="button"
                  >
                    <svg
                      class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                      focusable="false"
                      aria-hidden="true"
                      viewBox="0 0 24 24"
                      data-testid="LinkedInIcon"
                    >
                      <path
                        d="M19 3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14m-.5 15.5v-5.3a3.26 3.26 0 0 0-3.26-3.26c-.85 0-1.84.52-2.32 1.3v-1.11h-2.79v8.37h2.79v-4.93c0-.77.62-1.4 1.39-1.4a1.4 1.4 0 0 1 1.4 1.4v4.93h2.79M6.88 8.56a1.68 1.68 0 0 0 1.68-1.68c0-.93-.75-1.69-1.68-1.69a1.69 1.69 0 0 0-1.69 1.69c0 .93.76 1.68 1.69 1.68m1.39 9.94v-8.37H5.5v8.37h2.77z"
                      ></path>
                    </svg></button
                  ><style data-emotion="css 161nngb">
                    .css-161nngb {
                      text-align: center;
                      -webkit-flex: 0 0 auto;
                      -ms-flex: 0 0 auto;
                      flex: 0 0 auto;
                      font-size: 1.5rem;
                      padding: 8px;
                      border-radius: 50%;
                      overflow: visible;
                      color: rgba(0, 0, 0, 0.54);
                      -webkit-transition: background-color 150ms
                        cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                      transition: background-color 150ms
                        cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                      color: #000000;
                    }
                    .css-161nngb:hover {
                      background-color: rgba(0, 0, 0, 0.04);
                    }
                    @media (hover: none) {
                      .css-161nngb:hover {
                        background-color: transparent;
                      }
                    }
                    .css-161nngb.Mui-disabled {
                      background-color: transparent;
                      color: rgba(0, 0, 0, 0.26);
                    }</style
                  ><style data-emotion="css tn2bks">
                    .css-tn2bks {
                      display: -webkit-inline-box;
                      display: -webkit-inline-flex;
                      display: -ms-inline-flexbox;
                      display: inline-flex;
                      -webkit-align-items: center;
                      -webkit-box-align: center;
                      -ms-flex-align: center;
                      align-items: center;
                      -webkit-box-pack: center;
                      -ms-flex-pack: center;
                      -webkit-justify-content: center;
                      justify-content: center;
                      position: relative;
                      box-sizing: border-box;
                      -webkit-tap-highlight-color: transparent;
                      background-color: transparent;
                      outline: 0;
                      border: 0;
                      margin: 0;
                      border-radius: 0;
                      padding: 0;
                      cursor: pointer;
                      -webkit-user-select: none;
                      -moz-user-select: none;
                      -ms-user-select: none;
                      user-select: none;
                      vertical-align: middle;
                      -moz-appearance: none;
                      -webkit-appearance: none;
                      -webkit-text-decoration: none;
                      text-decoration: none;
                      color: inherit;
                      text-align: center;
                      -webkit-flex: 0 0 auto;
                      -ms-flex: 0 0 auto;
                      flex: 0 0 auto;
                      font-size: 1.5rem;
                      padding: 8px;
                      border-radius: 50%;
                      overflow: visible;
                      color: rgba(0, 0, 0, 0.54);
                      -webkit-transition: background-color 150ms
                        cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                      transition: background-color 150ms
                        cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                      color: #000000;
                    }
                    .css-tn2bks::-moz-focus-inner {
                      border-style: none;
                    }
                    .css-tn2bks.Mui-disabled {
                      pointer-events: none;
                      cursor: default;
                    }
                    @media print {
                      .css-tn2bks {
                        -webkit-print-color-adjust: exact;
                        color-adjust: exact;
                      }
                    }
                    .css-tn2bks:hover {
                      background-color: rgba(0, 0, 0, 0.04);
                    }
                    @media (hover: none) {
                      .css-tn2bks:hover {
                        background-color: transparent;
                      }
                    }
                    .css-tn2bks.Mui-disabled {
                      background-color: transparent;
                      color: rgba(0, 0, 0, 0.26);
                    }</style
                  ><button
                    class="MuiButtonBase-root MuiIconButton-root MuiIconButton-sizeMedium css-tn2bks"
                    tabindex="0"
                    type="button"
                  >
                    <svg
                      class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                      focusable="false"
                      aria-hidden="true"
                      viewBox="0 0 24 24"
                      data-testid="XIcon"
                    >
                      <path
                        d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"
                      ></path>
                    </svg></button
                  ><button
                    class="MuiButtonBase-root MuiIconButton-root MuiIconButton-sizeMedium css-tn2bks"
                    tabindex="0"
                    type="button"
                  >
                    <svg
                      class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                      focusable="false"
                      aria-hidden="true"
                      viewBox="0 0 24 24"
                      data-testid="GitHubIcon"
                    >
                      <path
                        d="M12 1.27a11 11 0 00-3.48 21.46c.55.09.73-.28.73-.55v-1.84c-3.03.64-3.67-1.46-3.67-1.46-.55-1.29-1.28-1.65-1.28-1.65-.92-.65.1-.65.1-.65 1.1 0 1.73 1.1 1.73 1.1.92 1.65 2.57 1.2 3.21.92a2 2 0 01.64-1.47c-2.47-.27-5.04-1.19-5.04-5.5 0-1.1.46-2.1 1.2-2.84a3.76 3.76 0 010-2.93s.91-.28 3.11 1.1c1.8-.49 3.7-.49 5.5 0 2.1-1.38 3.02-1.1 3.02-1.1a3.76 3.76 0 010 2.93c.83.74 1.2 1.74 1.2 2.94 0 4.21-2.57 5.13-5.04 5.4.45.37.82.92.82 2.02v3.03c0 .27.1.64.73.55A11 11 0 0012 1.27"
                      ></path>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          </div>
          <style data-emotion="css efwuvd">
            .css-efwuvd {
              box-sizing: border-box;
              margin: 0;
              -webkit-flex-direction: row;
              -ms-flex-direction: row;
              flex-direction: row;
              -webkit-flex-basis: 100%;
              -ms-flex-preferred-size: 100%;
              flex-basis: 100%;
              -webkit-box-flex: 0;
              -webkit-flex-grow: 0;
              -ms-flex-positive: 0;
              flex-grow: 0;
              max-width: 100%;
            }
            @media (min-width: 600px) {
              .css-efwuvd {
                -webkit-flex-basis: 100%;
                -ms-flex-preferred-size: 100%;
                flex-basis: 100%;
                -webkit-box-flex: 0;
                -webkit-flex-grow: 0;
                -ms-flex-positive: 0;
                flex-grow: 0;
                max-width: 100%;
              }
            }
            @media (min-width: 900px) {
              .css-efwuvd {
                -webkit-flex-basis: 66.666667%;
                -ms-flex-preferred-size: 66.666667%;
                flex-basis: 66.666667%;
                -webkit-box-flex: 0;
                -webkit-flex-grow: 0;
                -ms-flex-positive: 0;
                flex-grow: 0;
                max-width: 66.666667%;
              }
            }
            @media (min-width: 1200px) {
              .css-efwuvd {
                -webkit-flex-basis: 66.666667%;
                -ms-flex-preferred-size: 66.666667%;
                flex-basis: 66.666667%;
                -webkit-box-flex: 0;
                -webkit-flex-grow: 0;
                -ms-flex-positive: 0;
                flex-grow: 0;
                max-width: 66.666667%;
              }
            }
            @media (min-width: 1536px) {
              .css-efwuvd {
                -webkit-flex-basis: 66.666667%;
                -ms-flex-preferred-size: 66.666667%;
                flex-basis: 66.666667%;
                -webkit-box-flex: 0;
                -webkit-flex-grow: 0;
                -ms-flex-positive: 0;
                flex-grow: 0;
                max-width: 66.666667%;
              }
            }
          </style>
          <div
            class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-12 MuiGrid-grid-sm-12 MuiGrid-grid-md-8 css-efwuvd"
          >
            <style data-emotion="css fbmkol">
              .css-fbmkol {
                -webkit-flex: 1;
                -ms-flex: 1;
                flex: 1;
                display: -webkit-box;
                display: -webkit-flex;
                display: -ms-flexbox;
                display: flex;
                -webkit-flex-direction: column;
                -ms-flex-direction: column;
                flex-direction: column;
                -webkit-box-pack: center;
                -ms-flex-pack: center;
                -webkit-justify-content: center;
                justify-content: center;
                -webkit-align-items: center;
                -webkit-box-align: center;
                -ms-flex-align: center;
                align-items: center;
                margin-right: 16px;
              }
            </style>
            <div class="MuiBox-root css-fbmkol">
              <img
                src="/media/images/total-segmentator-api-with-huey-system-architecture-diagram.jpg"
                style="
                  width: 100%;
                  max-width: 75vw;
                  height: auto;
                  max-height: 35vh;
                  object-fit: cover;
                "
              />
            </div>
          </div>
        </div>
        <style data-emotion="css 8atqhb">
          .css-8atqhb {
            width: 100%;
          }
        </style>
        <div class="MuiBox-root css-8atqhb">
          <style data-emotion="css iv262p">
            .css-iv262p {
              box-sizing: border-box;
              display: -webkit-box;
              display: -webkit-flex;
              display: -ms-flexbox;
              display: flex;
              -webkit-box-flex-wrap: wrap;
              -webkit-flex-wrap: wrap;
              -ms-flex-wrap: wrap;
              flex-wrap: wrap;
              width: 100%;
              -webkit-flex-direction: row;
              -ms-flex-direction: row;
              flex-direction: row;
              margin-top: -16px;
              width: calc(100% + 16px);
              margin-left: -16px;
              margin-top: 32px;
              margin-bottom: 0px;
            }
            .css-iv262p > .MuiGrid-item {
              padding-top: 16px;
            }
            .css-iv262p > .MuiGrid-item {
              padding-left: 16px;
            }
          </style>
          <div
            class="MuiGrid-root MuiGrid-container MuiGrid-spacing-xs-2 css-iv262p"
          >
            <style data-emotion="css 1hclw6t">
              .css-1hclw6t {
                box-sizing: border-box;
                margin: 0;
                -webkit-flex-direction: row;
                -ms-flex-direction: row;
                flex-direction: row;
                -webkit-flex-basis: 100%;
                -ms-flex-preferred-size: 100%;
                flex-basis: 100%;
                -webkit-box-flex: 0;
                -webkit-flex-grow: 0;
                -ms-flex-positive: 0;
                flex-grow: 0;
                max-width: 100%;
                background: linear-gradient(to right, #eeeeee, #ffffff);
                border-radius: 20px;
              }
              @media (min-width: 600px) {
                .css-1hclw6t {
                  -webkit-flex-basis: 100%;
                  -ms-flex-preferred-size: 100%;
                  flex-basis: 100%;
                  -webkit-box-flex: 0;
                  -webkit-flex-grow: 0;
                  -ms-flex-positive: 0;
                  flex-grow: 0;
                  max-width: 100%;
                }
              }
              @media (min-width: 900px) {
                .css-1hclw6t {
                  -webkit-flex-basis: 33.333333%;
                  -ms-flex-preferred-size: 33.333333%;
                  flex-basis: 33.333333%;
                  -webkit-box-flex: 0;
                  -webkit-flex-grow: 0;
                  -ms-flex-positive: 0;
                  flex-grow: 0;
                  max-width: 33.333333%;
                }
              }
              @media (min-width: 1200px) {
                .css-1hclw6t {
                  -webkit-flex-basis: 25%;
                  -ms-flex-preferred-size: 25%;
                  flex-basis: 25%;
                  -webkit-box-flex: 0;
                  -webkit-flex-grow: 0;
                  -ms-flex-positive: 0;
                  flex-grow: 0;
                  max-width: 25%;
                }
              }
              @media (min-width: 1536px) {
                .css-1hclw6t {
                  -webkit-flex-basis: 25%;
                  -ms-flex-preferred-size: 25%;
                  flex-basis: 25%;
                  -webkit-box-flex: 0;
                  -webkit-flex-grow: 0;
                  -ms-flex-positive: 0;
                  flex-grow: 0;
                  max-width: 25%;
                }
              }
            </style>
            <div
              class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-12 MuiGrid-grid-sm-12 MuiGrid-grid-md-4 MuiGrid-grid-lg-3 css-1hclw6t"
            >
              <div class="MuiBox-root css-8atqhb">
                <style data-emotion="css 1zqdou">
                  .css-1zqdou {
                    width: 100%;
                    margin-bottom: 16px;
                  }
                  @media (min-width: 0px) {
                    .css-1zqdou {
                      display: block;
                    }
                  }
                  @media (min-width: 900px) {
                    .css-1zqdou {
                      display: none;
                    }
                  }
                </style>
                <div class="MuiBox-root css-1zqdou">
                  <style data-emotion="css mgu3mc">
                    .css-mgu3mc {
                      position: relative;
                      -webkit-transition: margin 150ms
                        cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                      transition: margin 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                      overflow-anchor: none;
                      border-radius: 0;
                      width: 100%;
                      margin-bottom: 16px;
                      box-shadow:
                        0px 3px 3px -2px rgba(0, 0, 0, 0.2),
                        0px 3px 4px 0px rgba(0, 0, 0, 0.14),
                        0px 1px 8px 0px rgba(0, 0, 0, 0.12);
                      background-color: #ffffff22;
                    }
                    .css-mgu3mc::before {
                      position: absolute;
                      left: 0;
                      top: -1px;
                      right: 0;
                      height: 1px;
                      content: "";
                      opacity: 1;
                      background-color: rgba(0, 0, 0, 0.12);
                      -webkit-transition:
                        opacity 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
                        background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                      transition:
                        opacity 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
                        background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                    }
                    .css-mgu3mc:first-of-type::before {
                      display: none;
                    }
                    .css-mgu3mc.Mui-expanded::before {
                      opacity: 0;
                    }
                    .css-mgu3mc.Mui-expanded:first-of-type {
                      margin-top: 0;
                    }
                    .css-mgu3mc.Mui-expanded:last-of-type {
                      margin-bottom: 0;
                    }
                    .css-mgu3mc.Mui-expanded
                      + .css-mgu3mc.Mui-expanded::before {
                      display: none;
                    }
                    .css-mgu3mc.Mui-disabled {
                      background-color: rgba(0, 0, 0, 0.12);
                    }
                    .css-mgu3mc:first-of-type {
                      border-top-left-radius: 4px;
                      border-top-right-radius: 4px;
                    }
                    .css-mgu3mc:last-of-type {
                      border-bottom-left-radius: 4px;
                      border-bottom-right-radius: 4px;
                    }
                    @supports (-ms-ime-align: auto) {
                      .css-mgu3mc:last-of-type {
                        border-bottom-left-radius: 0;
                        border-bottom-right-radius: 0;
                      }
                    }</style
                  ><style data-emotion="css 16ex79u">
                    .css-16ex79u {
                      background-color: #fff;
                      color: rgba(0, 0, 0, 0.87);
                      -webkit-transition: box-shadow 300ms
                        cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                      transition: box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1)
                        0ms;
                      border-radius: 4px;
                      box-shadow:
                        0px 2px 1px -1px rgba(0, 0, 0, 0.2),
                        0px 1px 1px 0px rgba(0, 0, 0, 0.14),
                        0px 1px 3px 0px rgba(0, 0, 0, 0.12);
                      position: relative;
                      -webkit-transition: margin 150ms
                        cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                      transition: margin 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                      overflow-anchor: none;
                      border-radius: 0;
                      width: 100%;
                      margin-bottom: 16px;
                      box-shadow:
                        0px 3px 3px -2px rgba(0, 0, 0, 0.2),
                        0px 3px 4px 0px rgba(0, 0, 0, 0.14),
                        0px 1px 8px 0px rgba(0, 0, 0, 0.12);
                      background-color: #ffffff22;
                    }
                    .css-16ex79u::before {
                      position: absolute;
                      left: 0;
                      top: -1px;
                      right: 0;
                      height: 1px;
                      content: "";
                      opacity: 1;
                      background-color: rgba(0, 0, 0, 0.12);
                      -webkit-transition:
                        opacity 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
                        background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                      transition:
                        opacity 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
                        background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                    }
                    .css-16ex79u:first-of-type::before {
                      display: none;
                    }
                    .css-16ex79u.Mui-expanded::before {
                      opacity: 0;
                    }
                    .css-16ex79u.Mui-expanded:first-of-type {
                      margin-top: 0;
                    }
                    .css-16ex79u.Mui-expanded:last-of-type {
                      margin-bottom: 0;
                    }
                    .css-16ex79u.Mui-expanded
                      + .css-16ex79u.Mui-expanded::before {
                      display: none;
                    }
                    .css-16ex79u.Mui-disabled {
                      background-color: rgba(0, 0, 0, 0.12);
                    }
                    .css-16ex79u:first-of-type {
                      border-top-left-radius: 4px;
                      border-top-right-radius: 4px;
                    }
                    .css-16ex79u:last-of-type {
                      border-bottom-left-radius: 4px;
                      border-bottom-right-radius: 4px;
                    }
                    @supports (-ms-ime-align: auto) {
                      .css-16ex79u:last-of-type {
                        border-bottom-left-radius: 0;
                        border-bottom-right-radius: 0;
                      }
                    }
                  </style>
                  <div
                    class="MuiPaper-root MuiPaper-elevation MuiPaper-rounded MuiPaper-elevation1 MuiAccordion-root MuiAccordion-rounded css-16ex79u"
                  >
                    <style data-emotion="css 148gpqp">
                      .css-148gpqp {
                        display: -webkit-box;
                        display: -webkit-flex;
                        display: -ms-flexbox;
                        display: flex;
                        min-height: 48px;
                        padding: 0px 16px;
                        -webkit-transition:
                          min-height 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
                          background-color 150ms cubic-bezier(0.4, 0, 0.2, 1)
                            0ms;
                        transition:
                          min-height 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
                          background-color 150ms cubic-bezier(0.4, 0, 0.2, 1)
                            0ms;
                      }
                      .css-148gpqp.Mui-focusVisible {
                        background-color: rgba(0, 0, 0, 0.12);
                      }
                      .css-148gpqp.Mui-disabled {
                        opacity: 0.38;
                      }
                      .css-148gpqp:hover:not(.Mui-disabled) {
                        cursor: pointer;
                      }</style
                    ><style data-emotion="css 1uaukoe">
                      .css-1uaukoe {
                        display: -webkit-inline-box;
                        display: -webkit-inline-flex;
                        display: -ms-inline-flexbox;
                        display: inline-flex;
                        -webkit-align-items: center;
                        -webkit-box-align: center;
                        -ms-flex-align: center;
                        align-items: center;
                        -webkit-box-pack: center;
                        -ms-flex-pack: center;
                        -webkit-justify-content: center;
                        justify-content: center;
                        position: relative;
                        box-sizing: border-box;
                        -webkit-tap-highlight-color: transparent;
                        background-color: transparent;
                        outline: 0;
                        border: 0;
                        margin: 0;
                        border-radius: 0;
                        padding: 0;
                        cursor: pointer;
                        -webkit-user-select: none;
                        -moz-user-select: none;
                        -ms-user-select: none;
                        user-select: none;
                        vertical-align: middle;
                        -moz-appearance: none;
                        -webkit-appearance: none;
                        -webkit-text-decoration: none;
                        text-decoration: none;
                        color: inherit;
                        display: -webkit-box;
                        display: -webkit-flex;
                        display: -ms-flexbox;
                        display: flex;
                        min-height: 48px;
                        padding: 0px 16px;
                        -webkit-transition:
                          min-height 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
                          background-color 150ms cubic-bezier(0.4, 0, 0.2, 1)
                            0ms;
                        transition:
                          min-height 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
                          background-color 150ms cubic-bezier(0.4, 0, 0.2, 1)
                            0ms;
                      }
                      .css-1uaukoe::-moz-focus-inner {
                        border-style: none;
                      }
                      .css-1uaukoe.Mui-disabled {
                        pointer-events: none;
                        cursor: default;
                      }
                      @media print {
                        .css-1uaukoe {
                          -webkit-print-color-adjust: exact;
                          color-adjust: exact;
                        }
                      }
                      .css-1uaukoe.Mui-focusVisible {
                        background-color: rgba(0, 0, 0, 0.12);
                      }
                      .css-1uaukoe.Mui-disabled {
                        opacity: 0.38;
                      }
                      .css-1uaukoe:hover:not(.Mui-disabled) {
                        cursor: pointer;
                      }
                    </style>
                    <div
                      class="MuiButtonBase-root MuiAccordionSummary-root css-1uaukoe"
                      tabindex="0"
                      role="button"
                      aria-expanded="false"
                    >
                      <style data-emotion="css 1n11r91">
                        .css-1n11r91 {
                          display: -webkit-box;
                          display: -webkit-flex;
                          display: -ms-flexbox;
                          display: flex;
                          -webkit-box-flex: 1;
                          -webkit-flex-grow: 1;
                          -ms-flex-positive: 1;
                          flex-grow: 1;
                          margin: 12px 0;
                        }
                      </style>
                      <div class="MuiAccordionSummary-content css-1n11r91">
                        <style data-emotion="css 10n6ggx">
                          .css-10n6ggx {
                            margin: 0;
                            font-family: "Roboto", "Helvetica", "Arial",
                              sans-serif;
                            font-weight: 500;
                            font-size: 1.25rem;
                            line-height: 1.6;
                            letter-spacing: 0.0075em;
                            margin: 0px;
                            padding: 0px;
                          }
                        </style>
                        <h6
                          class="MuiTypography-root MuiTypography-h6 css-10n6ggx"
                        >
                          Table of Contents
                        </h6>
                      </div>
                      <style data-emotion="css 1fx8m19">
                        .css-1fx8m19 {
                          display: -webkit-box;
                          display: -webkit-flex;
                          display: -ms-flexbox;
                          display: flex;
                          color: rgba(0, 0, 0, 0.54);
                          -webkit-transform: rotate(0deg);
                          -moz-transform: rotate(0deg);
                          -ms-transform: rotate(0deg);
                          transform: rotate(0deg);
                          -webkit-transition: -webkit-transform 150ms
                            cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                          transition: transform 150ms
                            cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                        }
                        .css-1fx8m19.Mui-expanded {
                          -webkit-transform: rotate(180deg);
                          -moz-transform: rotate(180deg);
                          -ms-transform: rotate(180deg);
                          transform: rotate(180deg);
                        }
                      </style>
                      <div
                        class="MuiAccordionSummary-expandIconWrapper css-1fx8m19"
                      >
                        <svg
                          class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                          focusable="false"
                          aria-hidden="true"
                          viewBox="0 0 24 24"
                          data-testid="ExpandMoreIcon"
                        >
                          <path
                            d="M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"
                          ></path>
                        </svg>
                      </div>
                    </div>
                    <style data-emotion="css a0y2e3">
                      .css-a0y2e3 {
                        height: 0;
                        overflow: hidden;
                        -webkit-transition: height 300ms
                          cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                        transition: height 300ms cubic-bezier(0.4, 0, 0.2, 1)
                          0ms;
                        visibility: hidden;
                      }
                    </style>
                    <div
                      class="MuiCollapse-root MuiCollapse-vertical MuiCollapse-hidden css-a0y2e3"
                      style="min-height: 0px"
                    >
                      <style data-emotion="css hboir5">
                        .css-hboir5 {
                          display: -webkit-box;
                          display: -webkit-flex;
                          display: -ms-flexbox;
                          display: flex;
                          width: 100%;
                        }
                      </style>
                      <div
                        class="MuiCollapse-wrapper MuiCollapse-vertical css-hboir5"
                      >
                        <div
                          class="MuiCollapse-wrapperInner MuiCollapse-vertical css-8atqhb"
                        >
                          <div role="region" class="MuiAccordion-region">
                            <style data-emotion="css 2m6k8o">
                              .css-2m6k8o {
                                padding: 8px 16px 16px;
                                width: 90%;
                                display: -webkit-box;
                                display: -webkit-flex;
                                display: -ms-flexbox;
                                display: flex;
                                -webkit-flex-direction: column;
                                -ms-flex-direction: column;
                                flex-direction: column;
                                -webkit-box-pack: start;
                                -ms-flex-pack: start;
                                -webkit-justify-content: flex-start;
                                justify-content: flex-start;
                                -webkit-align-items: flex-start;
                                -webkit-box-align: flex-start;
                                -ms-flex-align: flex-start;
                                align-items: flex-start;
                                margin-bottom: 16px;
                              }
                            </style>
                            <div class="MuiAccordionDetails-root css-2m6k8o">
                              <a
                                href="#server-and-worker"
                                style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"
                                ><style data-emotion="css vmnodn">
                                  .css-vmnodn {
                                    margin: 0;
                                    margin-left: 0px;
                                    margin-bottom: 20px;
                                  }
                                  .css-vmnodn:hover {
                                    color: blue;
                                  }
                                </style>
                                <p
                                  class="MuiTypography-root MuiTypography-p css-vmnodn"
                                >
                                  Server and Worker
                                </p></a
                              ><a
                                href="#interacting-with-redis"
                                style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"
                                ><style data-emotion="css 1i0m0sm">
                                  .css-1i0m0sm {
                                    margin: 0;
                                    margin-left: 8px;
                                    margin-bottom: 16px;
                                  }
                                  .css-1i0m0sm:hover {
                                    color: blue;
                                  }
                                </style>
                                <p
                                  class="MuiTypography-root MuiTypography-p css-1i0m0sm"
                                >
                                  Interacting with Redis
                                </p></a
                              ><a
                                href="#redis-server"
                                style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"
                                ><style data-emotion="css ype23k">
                                  .css-ype23k {
                                    margin: 0;
                                    margin-left: 16px;
                                    margin-bottom: 12px;
                                  }
                                  .css-ype23k:hover {
                                    color: blue;
                                  }
                                </style>
                                <p
                                  class="MuiTypography-root MuiTypography-p css-ype23k"
                                >
                                  Redis Server
                                </p></a
                              ><a
                                href="#redis-client"
                                style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"
                                ><p
                                  class="MuiTypography-root MuiTypography-p css-ype23k"
                                >
                                  Redis Client
                                </p></a
                              ><a
                                href="#tasks"
                                style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"
                                ><p
                                  class="MuiTypography-root MuiTypography-p css-1i0m0sm"
                                >
                                  Tasks
                                </p></a
                              ><a
                                href="#fastapi-server"
                                style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"
                                ><p
                                  class="MuiTypography-root MuiTypography-p css-1i0m0sm"
                                >
                                  FastAPI Server
                                </p></a
                              ><a
                                href="#running-the-app"
                                style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"
                                ><p
                                  class="MuiTypography-root MuiTypography-p css-1i0m0sm"
                                >
                                  Running the App
                                </p></a
                              ><a
                                href="#server"
                                style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"
                                ><p
                                  class="MuiTypography-root MuiTypography-p css-ype23k"
                                >
                                  Server
                                </p></a
                              ><a
                                href="#worker"
                                style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"
                                ><p
                                  class="MuiTypography-root MuiTypography-p css-ype23k"
                                >
                                  Worker
                                </p></a
                              ><a
                                href="#tests"
                                style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"
                                ><p
                                  class="MuiTypography-root MuiTypography-p css-vmnodn"
                                >
                                  Tests
                                </p></a
                              ><a
                                href="#conclusion"
                                style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"
                                ><p
                                  class="MuiTypography-root MuiTypography-p css-vmnodn"
                                >
                                  Conclusion
                                </p></a
                              >
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <style data-emotion="css 8e7o3j">
                  .css-8e7o3j {
                    width: 100%;
                  }
                  @media (min-width: 0px) {
                    .css-8e7o3j {
                      display: none;
                    }
                  }
                  @media (min-width: 900px) {
                    .css-8e7o3j {
                      display: block;
                    }
                  }
                </style>
                <div class="MuiBox-root css-8e7o3j">
                  <style data-emotion="css 1npmiby">
                    .css-1npmiby {
                      margin: 0;
                      font-family: "Roboto", "Helvetica", "Arial", sans-serif;
                      font-weight: 400;
                      font-size: 1.5rem;
                      line-height: 1.334;
                      letter-spacing: 0em;
                      margin: 0px;
                      padding: 0px;
                    }
                  </style>
                  <h5 class="MuiTypography-root MuiTypography-h5 css-1npmiby">
                    Table of Contents
                  </h5>
                  <a
                    href="#server-and-worker"
                    style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"
                    ><p class="MuiTypography-root MuiTypography-p css-vmnodn">
                      Server and Worker
                    </p></a
                  ><a
                    href="#interacting-with-redis"
                    style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"
                    ><p class="MuiTypography-root MuiTypography-p css-1i0m0sm">
                      Interacting with Redis
                    </p></a
                  ><a
                    href="#redis-server"
                    style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"
                    ><p class="MuiTypography-root MuiTypography-p css-ype23k">
                      Redis Server
                    </p></a
                  ><a
                    href="#redis-client"
                    style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"
                    ><p class="MuiTypography-root MuiTypography-p css-ype23k">
                      Redis Client
                    </p></a
                  ><a
                    href="#tasks"
                    style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"
                    ><p class="MuiTypography-root MuiTypography-p css-1i0m0sm">
                      Tasks
                    </p></a
                  ><a
                    href="#fastapi-server"
                    style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"
                    ><p class="MuiTypography-root MuiTypography-p css-1i0m0sm">
                      FastAPI Server
                    </p></a
                  ><a
                    href="#running-the-app"
                    style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"
                    ><p class="MuiTypography-root MuiTypography-p css-1i0m0sm">
                      Running the App
                    </p></a
                  ><a
                    href="#server"
                    style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"
                    ><p class="MuiTypography-root MuiTypography-p css-ype23k">
                      Server
                    </p></a
                  ><a
                    href="#worker"
                    style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"
                    ><p class="MuiTypography-root MuiTypography-p css-ype23k">
                      Worker
                    </p></a
                  ><a
                    href="#tests"
                    style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"
                    ><p class="MuiTypography-root MuiTypography-p css-vmnodn">
                      Tests
                    </p></a
                  ><a
                    href="#conclusion"
                    style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"
                    ><p class="MuiTypography-root MuiTypography-p css-vmnodn">
                      Conclusion
                    </p></a
                  >
                </div>
              </div>
            </div>
            <style data-emotion="css 4uwbp1">
              .css-4uwbp1 {
                box-sizing: border-box;
                margin: 0;
                -webkit-flex-direction: row;
                -ms-flex-direction: row;
                flex-direction: row;
                -webkit-flex-basis: 100%;
                -ms-flex-preferred-size: 100%;
                flex-basis: 100%;
                -webkit-box-flex: 0;
                -webkit-flex-grow: 0;
                -ms-flex-positive: 0;
                flex-grow: 0;
                max-width: 100%;
                background: linear-gradient(to right, #ffffff, #eeeeee);
                border-radius: 20px;
              }
              @media (min-width: 600px) {
                .css-4uwbp1 {
                  -webkit-flex-basis: 100%;
                  -ms-flex-preferred-size: 100%;
                  flex-basis: 100%;
                  -webkit-box-flex: 0;
                  -webkit-flex-grow: 0;
                  -ms-flex-positive: 0;
                  flex-grow: 0;
                  max-width: 100%;
                }
              }
              @media (min-width: 900px) {
                .css-4uwbp1 {
                  -webkit-flex-basis: 66.666667%;
                  -ms-flex-preferred-size: 66.666667%;
                  flex-basis: 66.666667%;
                  -webkit-box-flex: 0;
                  -webkit-flex-grow: 0;
                  -ms-flex-positive: 0;
                  flex-grow: 0;
                  max-width: 66.666667%;
                }
              }
              @media (min-width: 1200px) {
                .css-4uwbp1 {
                  -webkit-flex-basis: 75%;
                  -ms-flex-preferred-size: 75%;
                  flex-basis: 75%;
                  -webkit-box-flex: 0;
                  -webkit-flex-grow: 0;
                  -ms-flex-positive: 0;
                  flex-grow: 0;
                  max-width: 75%;
                }
              }
              @media (min-width: 1536px) {
                .css-4uwbp1 {
                  -webkit-flex-basis: 75%;
                  -ms-flex-preferred-size: 75%;
                  flex-basis: 75%;
                  -webkit-box-flex: 0;
                  -webkit-flex-grow: 0;
                  -ms-flex-positive: 0;
                  flex-grow: 0;
                  max-width: 75%;
                }
              }
            </style>
            <div
              class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-12 MuiGrid-grid-sm-12 MuiGrid-grid-md-8 MuiGrid-grid-lg-9 css-4uwbp1"
            >
              <style data-emotion="css 1zo2vp">
                .css-1zo2vp {
                  -webkit-flex: 1;
                  -ms-flex: 1;
                  flex: 1;
                  margin-right: 16px;
                }
              </style>
              <div class="MuiBox-root css-1zo2vp">
                <style data-emotion="css vsuld9">
                  .css-vsuld9 {
                    margin: 0;
                    text-align: justify;
                    margin-bottom: 16px;
                  }
                </style>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  In today&#x27;s Post, we&#x27;ll build a REST API that allows
                  us to segment CT volumes using
                  <style data-emotion="css ct9vl7">
                    .css-ct9vl7 {
                      -webkit-text-decoration: none;
                      text-decoration: none;
                    }
                    .css-ct9vl7:hover {
                      -webkit-text-decoration: underline;
                      text-decoration: underline;
                    }</style
                  ><style data-emotion="css 1vxruma">
                    .css-1vxruma {
                      margin: 0;
                      font: inherit;
                      color: #1976d2;
                      -webkit-text-decoration: none;
                      text-decoration: none;
                    }
                    .css-1vxruma:hover {
                      -webkit-text-decoration: underline;
                      text-decoration: underline;
                    }</style
                  ><a
                    class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover css-1vxruma"
                    href="https://github.com/wasserth/TotalSegmentator"
                    rel="noopener noreferrer"
                    target="_blank"
                    >TotalSegmentator</a
                  >. Our system will involve two applications connected through
                  the
                  <a
                    class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover css-1vxruma"
                    href="https://huey.readthedocs.io/en/latest/"
                    rel="noopener noreferrer"
                    target="_blank"
                    >Huey</a
                  >
                  task queue: a server that a client-side application can
                  interact with to upload volumes and queue segmentation tasks
                  and a worker application that consumes these tasks to segment
                  the uploaded volumes and save the results.
                </p>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  Here&#x27;s an image describing the System Architecture:
                </p>
                <style data-emotion="css 16am2bb">
                  .css-16am2bb {
                    width: 100%;
                    display: -webkit-box;
                    display: -webkit-flex;
                    display: -ms-flexbox;
                    display: flex;
                    -webkit-flex-direction: column;
                    -ms-flex-direction: column;
                    flex-direction: column;
                    -webkit-box-pack: center;
                    -ms-flex-pack: center;
                    -webkit-justify-content: center;
                    justify-content: center;
                    -webkit-align-items: center;
                    -webkit-box-align: center;
                    -ms-flex-align: center;
                    align-items: center;
                    margin-bottom: 16px;
                  }
                </style>
                <div class="MuiBox-root css-16am2bb">
                  <img
                    src="/media/images/total-segmentator-api-with-huey-system-architecture-diagram.jpg"
                    style="
                      width: 100%;
                      max-width: 75vw;
                      height: auto;
                      max-height: 35vh;
                      object-fit: cover;
                    "
                  />
                </div>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  You can find the code for this project in
                  <a
                    class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover css-1vxruma"
                    href="https://github.com/AbhilakshSinghReen/ct-to-3d-model/tree/segmentation-only"
                    rel="noopener noreferrer"
                    target="_blank"
                    >this GitHub Repository</a
                  >.
                </p>
                <style data-emotion="css rg843f">
                  .css-rg843f {
                    margin: 0;
                    font-family: "Roboto", "Helvetica", "Arial", sans-serif;
                    font-weight: 400;
                    font-size: 2.125rem;
                    line-height: 1.235;
                    letter-spacing: 0.00735em;
                    margin-bottom: 16px;
                  }
                </style>
                <h1
                  class="MuiTypography-root MuiTypography-h4 css-rg843f"
                  id="server-and-worker"
                >
                  <strong>Server and Worker</strong>
                </h1>
                <style data-emotion="css 1oj41as">
                  .css-1oj41as {
                    margin: 0;
                    font-family: "Roboto", "Helvetica", "Arial", sans-serif;
                    font-weight: 400;
                    font-size: 1.5rem;
                    line-height: 1.334;
                    letter-spacing: 0em;
                    margin-bottom: 16px;
                  }
                </style>
                <h2
                  class="MuiTypography-root MuiTypography-h5 css-1oj41as"
                  id="interacting-with-redis"
                >
                  <strong>Interacting with Redis</strong>
                </h2>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  We&#x27;ll be using Redis for two purposes:
                </p>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  1) As the Huey task broker.
                </p>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  1) For storing the statuses of our tasks.
                </p>
                <style data-emotion="css 14mppol">
                  .css-14mppol {
                    margin: 0;
                    font-family: "Roboto", "Helvetica", "Arial", sans-serif;
                    font-weight: 500;
                    font-size: 1.25rem;
                    line-height: 1.6;
                    letter-spacing: 0.0075em;
                    margin-bottom: 16px;
                  }
                </style>
                <h3
                  class="MuiTypography-root MuiTypography-h6 css-14mppol"
                  id="redis-server"
                >
                  <strong>Redis Server</strong>
                </h3>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  We can run a lightweight Redis Docker container for
                  development purposes
                </p>
                <style data-emotion="css dzaqf9">
                  .css-dzaqf9 {
                    width: 100%;
                    margin-bottom: 16px;
                  }
                </style>
                <div class="MuiBox-root css-dzaqf9">
                  <style data-emotion="css 125pbeb">
                    .css-125pbeb {
                      background-color: rgb(227, 234, 242);
                      width: 100%;
                      display: -webkit-box;
                      display: -webkit-flex;
                      display: -ms-flexbox;
                      display: flex;
                      -webkit-flex-direction: row;
                      -ms-flex-direction: row;
                      flex-direction: row;
                      -webkit-box-pack: end;
                      -ms-flex-pack: end;
                      -webkit-justify-content: flex-end;
                      justify-content: flex-end;
                      -webkit-align-items: center;
                      -webkit-box-align: center;
                      -ms-flex-align: center;
                      align-items: center;
                    }
                  </style>
                  <div class="MuiBox-root css-125pbeb">
                    <style data-emotion="css 1xdvxj1">
                      .css-1xdvxj1 {
                        text-align: center;
                        -webkit-flex: 0 0 auto;
                        -ms-flex: 0 0 auto;
                        flex: 0 0 auto;
                        font-size: 1.5rem;
                        padding: 8px;
                        border-radius: 50%;
                        overflow: visible;
                        color: rgba(0, 0, 0, 0.54);
                        -webkit-transition: background-color 150ms
                          cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                        transition: background-color 150ms
                          cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                        color: #1976d2;
                        padding: 12px;
                        font-size: 1.75rem;
                      }
                      .css-1xdvxj1:hover {
                        background-color: rgba(0, 0, 0, 0.04);
                      }
                      @media (hover: none) {
                        .css-1xdvxj1:hover {
                          background-color: transparent;
                        }
                      }
                      .css-1xdvxj1:hover {
                        background-color: rgba(25, 118, 210, 0.04);
                      }
                      @media (hover: none) {
                        .css-1xdvxj1:hover {
                          background-color: transparent;
                        }
                      }
                      .css-1xdvxj1.Mui-disabled {
                        background-color: transparent;
                        color: rgba(0, 0, 0, 0.26);
                      }</style
                    ><style data-emotion="css h1oho">
                      .css-h1oho {
                        display: -webkit-inline-box;
                        display: -webkit-inline-flex;
                        display: -ms-inline-flexbox;
                        display: inline-flex;
                        -webkit-align-items: center;
                        -webkit-box-align: center;
                        -ms-flex-align: center;
                        align-items: center;
                        -webkit-box-pack: center;
                        -ms-flex-pack: center;
                        -webkit-justify-content: center;
                        justify-content: center;
                        position: relative;
                        box-sizing: border-box;
                        -webkit-tap-highlight-color: transparent;
                        background-color: transparent;
                        outline: 0;
                        border: 0;
                        margin: 0;
                        border-radius: 0;
                        padding: 0;
                        cursor: pointer;
                        -webkit-user-select: none;
                        -moz-user-select: none;
                        -ms-user-select: none;
                        user-select: none;
                        vertical-align: middle;
                        -moz-appearance: none;
                        -webkit-appearance: none;
                        -webkit-text-decoration: none;
                        text-decoration: none;
                        color: inherit;
                        text-align: center;
                        -webkit-flex: 0 0 auto;
                        -ms-flex: 0 0 auto;
                        flex: 0 0 auto;
                        font-size: 1.5rem;
                        padding: 8px;
                        border-radius: 50%;
                        overflow: visible;
                        color: rgba(0, 0, 0, 0.54);
                        -webkit-transition: background-color 150ms
                          cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                        transition: background-color 150ms
                          cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                        color: #1976d2;
                        padding: 12px;
                        font-size: 1.75rem;
                      }
                      .css-h1oho::-moz-focus-inner {
                        border-style: none;
                      }
                      .css-h1oho.Mui-disabled {
                        pointer-events: none;
                        cursor: default;
                      }
                      @media print {
                        .css-h1oho {
                          -webkit-print-color-adjust: exact;
                          color-adjust: exact;
                        }
                      }
                      .css-h1oho:hover {
                        background-color: rgba(0, 0, 0, 0.04);
                      }
                      @media (hover: none) {
                        .css-h1oho:hover {
                          background-color: transparent;
                        }
                      }
                      .css-h1oho:hover {
                        background-color: rgba(25, 118, 210, 0.04);
                      }
                      @media (hover: none) {
                        .css-h1oho:hover {
                          background-color: transparent;
                        }
                      }
                      .css-h1oho.Mui-disabled {
                        background-color: transparent;
                        color: rgba(0, 0, 0, 0.26);
                      }</style
                    ><button
                      class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho"
                      tabindex="0"
                      type="button"
                    >
                      <svg
                        class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                        focusable="false"
                        aria-hidden="true"
                        viewBox="0 0 24 24"
                        data-testid="ContentCopyIcon"
                      >
                        <path
                          d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"
                        ></path>
                      </svg>
                    </button>
                  </div>
                  <pre
                    style="
                      color: #111b27;
                      background: #e3eaf2;
                      font-family: Consolas, Monaco, &quot;Andale Mono&quot;,
                        &quot;Ubuntu Mono&quot;, monospace;
                      text-align: left;
                      white-space: pre;
                      word-spacing: normal;
                      word-break: normal;
                      word-wrap: normal;
                      line-height: 1.5;
                      -moz-tab-size: 4;
                      -o-tab-size: 4;
                      tab-size: 4;
                      -webkit-hyphens: none;
                      -moz-hyphens: none;
                      -ms-hyphens: none;
                      hyphens: none;
                      padding: 1em;
                      margin: 0;
                      overflow: auto;
                    "
                  ><code class="language-bash" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#7c00aa">docker</span><span> run -d --name redis-dev -p </span><span class="token" style="color:#755f00">6379</span><span>:6379 redis:7.2.4-alpine</span></code></pre>
                </div>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  A list of Redis Docker images can be found
                  <a
                    class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover css-1vxruma"
                    href="https://hub.docker.com/_/redis"
                    rel="noopener noreferrer"
                    target="_blank"
                    >here</a
                  >.
                </p>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  Then, check if the Redis container started.
                </p>
                <div class="MuiBox-root css-dzaqf9">
                  <div class="MuiBox-root css-125pbeb">
                    <button
                      class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho"
                      tabindex="0"
                      type="button"
                    >
                      <svg
                        class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                        focusable="false"
                        aria-hidden="true"
                        viewBox="0 0 24 24"
                        data-testid="ContentCopyIcon"
                      >
                        <path
                          d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"
                        ></path>
                      </svg>
                    </button>
                  </div>
                  <pre
                    style="
                      color: #111b27;
                      background: #e3eaf2;
                      font-family: Consolas, Monaco, &quot;Andale Mono&quot;,
                        &quot;Ubuntu Mono&quot;, monospace;
                      text-align: left;
                      white-space: pre;
                      word-spacing: normal;
                      word-break: normal;
                      word-wrap: normal;
                      line-height: 1.5;
                      -moz-tab-size: 4;
                      -o-tab-size: 4;
                      tab-size: 4;
                      -webkit-hyphens: none;
                      -moz-hyphens: none;
                      -ms-hyphens: none;
                      hyphens: none;
                      padding: 1em;
                      margin: 0;
                      overflow: auto;
                    "
                  ><code class="language-bash" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#7c00aa">docker</span><span> </span><span class="token" style="color:#7c00aa">ps</span></code></pre>
                </div>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  You should see a container with the name
                  <style data-emotion="css 87x4qo">
                    .css-87x4qo {
                      padding-left: 4px;
                      padding-right: 4px;
                      border-radius: 4px;
                      background-color: rgb(227, 234, 242);
                    }</style
                  ><span class="MuiBox-root css-87x4qo">redis-dev</span> up and
                  running.
                </p>
                <h3
                  class="MuiTypography-root MuiTypography-h6 css-14mppol"
                  id="redis-client"
                >
                  <strong>Redis Client</strong>
                </h3>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  Inside our project&#x27;s directory, let&#x27;s create a
                  folder called
                  <span class="MuiBox-root css-87x4qo">server-worker</span>, and
                  inside it create another folder called
                  <span class="MuiBox-root css-87x4qo">src</span>. Inside this
                  folder, we create a file called
                  <span class="MuiBox-root css-87x4qo">redis_client.py</span>.
                </p>
                <div class="MuiBox-root css-dzaqf9">
                  <div class="MuiBox-root css-125pbeb">
                    <button
                      class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho"
                      tabindex="0"
                      type="button"
                    >
                      <svg
                        class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                        focusable="false"
                        aria-hidden="true"
                        viewBox="0 0 24 24"
                        data-testid="ContentCopyIcon"
                      >
                        <path
                          d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"
                        ></path>
                      </svg>
                    </button>
                  </div>
                  <pre
                    style="
                      color: #111b27;
                      background: #e3eaf2;
                      font-family: Consolas, Monaco, &quot;Andale Mono&quot;,
                        &quot;Ubuntu Mono&quot;, monospace;
                      text-align: left;
                      white-space: pre;
                      word-spacing: normal;
                      word-break: normal;
                      word-wrap: normal;
                      line-height: 1.5;
                      -moz-tab-size: 4;
                      -o-tab-size: 4;
                      tab-size: 4;
                      -webkit-hyphens: none;
                      -moz-hyphens: none;
                      -ms-hyphens: none;
                      hyphens: none;
                      padding: 1em;
                      margin: 0;
                      overflow: auto;
                    "
                  ><code class="language-python" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#a04900">from</span><span> os </span><span class="token" style="color:#a04900">import</span><span> environ
</span>
<span></span><span class="token" style="color:#a04900">from</span><span> redis </span><span class="token" style="color:#a04900">import</span><span> Redis
</span>
<!-- -->
<span>redis_host </span><span class="token" style="color:#a04900">=</span><span> environ</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#116b00">&quot;REDIS_HOST&quot;</span><span class="token" style="color:#111b27">]</span><span>
</span><span>redis_port </span><span class="token" style="color:#a04900">=</span><span> environ</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#116b00">&quot;REDIS_PORT&quot;</span><span class="token" style="color:#111b27">]</span><span>
</span><span>redis_db </span><span class="token" style="color:#a04900">=</span><span> environ</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#116b00">&quot;REDIS_DB&quot;</span><span class="token" style="color:#111b27">]</span><span>
</span><span>redis_password </span><span class="token" style="color:#a04900">=</span><span> environ</span><span class="token" style="color:#111b27">.</span><span>get</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;REDIS_PASSWORD&quot;</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">None</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>redis_client </span><span class="token" style="color:#a04900">=</span><span> Redis</span><span class="token" style="color:#111b27">(</span><span>host</span><span class="token" style="color:#a04900">=</span><span>redis_host</span><span class="token" style="color:#111b27">,</span><span> port</span><span class="token" style="color:#a04900">=</span><span>redis_port</span><span class="token" style="color:#111b27">,</span><span> db</span><span class="token" style="color:#a04900">=</span><span>redis_db</span><span class="token" style="color:#111b27">,</span><span> password</span><span class="token" style="color:#a04900">=</span><span>redis_password</span><span class="token" style="color:#111b27">,</span><span> decode_responses</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">True</span><span class="token" style="color:#111b27">)</span></code></pre>
                </div>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  We can create an empty file
                  <span class="MuiBox-root css-87x4qo">__init__.py</span> in the
                  <span class="MuiBox-root css-87x4qo">server-worker/src</span>
                  folder to turn this into an importable package.
                </p>
                <h2
                  class="MuiTypography-root MuiTypography-h5 css-1oj41as"
                  id="tasks"
                >
                  <strong>Tasks</strong>
                </h2>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  Inside the same folder, let&#x27;s create a file called
                  <span class="MuiBox-root css-87x4qo">dirs.py</span> to store
                  some directory paths for our convenience.
                </p>
                <div class="MuiBox-root css-dzaqf9">
                  <div class="MuiBox-root css-125pbeb">
                    <button
                      class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho"
                      tabindex="0"
                      type="button"
                    >
                      <svg
                        class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                        focusable="false"
                        aria-hidden="true"
                        viewBox="0 0 24 24"
                        data-testid="ContentCopyIcon"
                      >
                        <path
                          d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"
                        ></path>
                      </svg>
                    </button>
                  </div>
                  <pre
                    style="
                      color: #111b27;
                      background: #e3eaf2;
                      font-family: Consolas, Monaco, &quot;Andale Mono&quot;,
                        &quot;Ubuntu Mono&quot;, monospace;
                      text-align: left;
                      white-space: pre;
                      word-spacing: normal;
                      word-break: normal;
                      word-wrap: normal;
                      line-height: 1.5;
                      -moz-tab-size: 4;
                      -o-tab-size: 4;
                      tab-size: 4;
                      -webkit-hyphens: none;
                      -moz-hyphens: none;
                      -ms-hyphens: none;
                      hyphens: none;
                      padding: 1em;
                      margin: 0;
                      overflow: auto;
                    "
                  ><code class="language-python" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#a04900">from</span><span> os </span><span class="token" style="color:#a04900">import</span><span> makedirs
</span><span></span><span class="token" style="color:#a04900">from</span><span> os</span><span class="token" style="color:#111b27">.</span><span>path </span><span class="token" style="color:#a04900">import</span><span> dirname</span><span class="token" style="color:#111b27">,</span><span> join </span><span class="token" style="color:#a04900">as</span><span> path_join
</span>
<!-- -->
<span>src_dir </span><span class="token" style="color:#a04900">=</span><span> dirname</span><span class="token" style="color:#111b27">(</span><span>__file__</span><span class="token" style="color:#111b27">)</span><span>
</span><span>server_worker_dir </span><span class="token" style="color:#a04900">=</span><span> dirname</span><span class="token" style="color:#111b27">(</span><span>src_dir</span><span class="token" style="color:#111b27">)</span><span>
</span><span>project_dir </span><span class="token" style="color:#a04900">=</span><span> dirname</span><span class="token" style="color:#111b27">(</span><span>server_worker_dir</span><span class="token" style="color:#111b27">)</span><span>
</span><span>data_dir </span><span class="token" style="color:#a04900">=</span><span> path_join</span><span class="token" style="color:#111b27">(</span><span>project_dir</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;data&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>makedirs</span><span class="token" style="color:#111b27">(</span><span>data_dir</span><span class="token" style="color:#111b27">,</span><span> exist_ok</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">True</span><span class="token" style="color:#111b27">)</span></code></pre>
                </div>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  Now, let&#x27;s create a file called
                  <span class="MuiBox-root css-87x4qo">tasks.py</span> in this
                  directory. This will store out Huey tasks.
                </p>
                <div class="MuiBox-root css-dzaqf9">
                  <div class="MuiBox-root css-125pbeb">
                    <button
                      class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho"
                      tabindex="0"
                      type="button"
                    >
                      <svg
                        class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                        focusable="false"
                        aria-hidden="true"
                        viewBox="0 0 24 24"
                        data-testid="ContentCopyIcon"
                      >
                        <path
                          d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"
                        ></path>
                      </svg>
                    </button>
                  </div>
                  <pre
                    style="
                      color: #111b27;
                      background: #e3eaf2;
                      font-family: Consolas, Monaco, &quot;Andale Mono&quot;,
                        &quot;Ubuntu Mono&quot;, monospace;
                      text-align: left;
                      white-space: pre;
                      word-spacing: normal;
                      word-break: normal;
                      word-wrap: normal;
                      line-height: 1.5;
                      -moz-tab-size: 4;
                      -o-tab-size: 4;
                      tab-size: 4;
                      -webkit-hyphens: none;
                      -moz-hyphens: none;
                      -ms-hyphens: none;
                      hyphens: none;
                      padding: 1em;
                      margin: 0;
                      overflow: auto;
                    "
                  ><code class="language-python" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#a04900">from</span><span> os </span><span class="token" style="color:#a04900">import</span><span> environ
</span><span></span><span class="token" style="color:#a04900">from</span><span> os</span><span class="token" style="color:#111b27">.</span><span>path </span><span class="token" style="color:#a04900">import</span><span> join </span><span class="token" style="color:#a04900">as</span><span> path_join
</span><span></span><span class="token" style="color:#a04900">from</span><span> subprocess </span><span class="token" style="color:#a04900">import</span><span> run </span><span class="token" style="color:#a04900">as</span><span> subprocess_run</span><span class="token" style="color:#111b27">,</span><span> CalledProcessError
</span><span></span><span class="token" style="color:#a04900">from</span><span> time </span><span class="token" style="color:#a04900">import</span><span> sleep
</span>
<span></span><span class="token" style="color:#a04900">from</span><span> huey </span><span class="token" style="color:#a04900">import</span><span> RedisHuey
</span>
<span></span><span class="token" style="color:#a04900">from</span><span> src</span><span class="token" style="color:#111b27">.</span><span>redis_client </span><span class="token" style="color:#a04900">import</span><span> redis_client
</span><span></span><span class="token" style="color:#a04900">from</span><span> src</span><span class="token" style="color:#111b27">.</span><span>dirs </span><span class="token" style="color:#a04900">import</span><span> data_dir
</span>
<!-- -->
<span>redis_host </span><span class="token" style="color:#a04900">=</span><span> environ</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#116b00">&quot;REDIS_HOST&quot;</span><span class="token" style="color:#111b27">]</span><span>
</span><span>task_delay </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token" style="color:#af00af">float</span><span class="token" style="color:#111b27">(</span><span>environ</span><span class="token" style="color:#111b27">.</span><span>get</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;TASK_DELAY&quot;</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">0</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>huey </span><span class="token" style="color:#a04900">=</span><span> RedisHuey</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&#x27;entrypoint&#x27;</span><span class="token" style="color:#111b27">,</span><span> host</span><span class="token" style="color:#a04900">=</span><span>redis_host</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>task_status_map_name </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token" style="color:#116b00">&quot;segmentation_task_status&quot;</span><span>
</span>
<!-- -->
<span></span><span class="token decorator annotation" style="color:#111b27">@huey</span><span class="token decorator annotation" style="color:#111b27">.</span><span class="token decorator annotation" style="color:#111b27">task</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span><span></span><span class="token" style="color:#a04900">def</span><span> </span><span class="token" style="color:#7c00aa">segment_volume</span><span class="token" style="color:#111b27">(</span><span>task_id</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>    volume_path </span><span class="token" style="color:#a04900">=</span><span> path_join</span><span class="token" style="color:#111b27">(</span><span>data_dir</span><span class="token" style="color:#111b27">,</span><span> task_id</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;volume.nii.gz&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span><span>    segmentation_path </span><span class="token" style="color:#a04900">=</span><span> path_join</span><span class="token" style="color:#111b27">(</span><span>data_dir</span><span class="token" style="color:#111b27">,</span><span> task_id</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;segmentation.nii.gz&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    redis_client</span><span class="token" style="color:#111b27">.</span><span>hset</span><span class="token" style="color:#111b27">(</span><span>task_status_map_name</span><span class="token" style="color:#111b27">,</span><span> task_id</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;processing&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    run_total_segmentator_command </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token string-interpolation" style="color:#116b00">f&quot;TotalSegmentator -i </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">volume_path</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00"> -o </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">segmentation_path</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00"> --ml&quot;</span><span>
</span>
<span>    </span><span class="token" style="color:#a04900">try</span><span class="token" style="color:#111b27">:</span><span>
</span><span>        _result </span><span class="token" style="color:#a04900">=</span><span> subprocess_run</span><span class="token" style="color:#111b27">(</span><span>run_total_segmentator_command</span><span class="token" style="color:#111b27">,</span><span> shell</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">True</span><span class="token" style="color:#111b27">,</span><span> check</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">True</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        redis_client</span><span class="token" style="color:#111b27">.</span><span>hset</span><span class="token" style="color:#111b27">(</span><span>task_status_map_name</span><span class="token" style="color:#111b27">,</span><span> task_id</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;completed&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span><span>    </span><span class="token" style="color:#a04900">except</span><span> CalledProcessError </span><span class="token" style="color:#a04900">as</span><span> _e</span><span class="token" style="color:#111b27">:</span><span>
</span><span>        </span><span class="token" style="color:#a04900">print</span><span class="token" style="color:#111b27">(</span><span class="token string-interpolation" style="color:#116b00">f&quot;Failed to segment volume for task_id </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">task_id</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">.&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        </span><span class="token" style="color:#a04900">print</span><span class="token" style="color:#111b27">(</span><span class="token string-interpolation" style="color:#116b00">f&quot;    segmentation command: </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">run_total_segmentator_command</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        redis_client</span><span class="token" style="color:#111b27">.</span><span>hset</span><span class="token" style="color:#111b27">(</span><span>task_status_map_name</span><span class="token" style="color:#111b27">,</span><span> task_id</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;failed&quot;</span><span class="token" style="color:#111b27">)</span></code></pre>
                </div>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  The Redis hashmap with the name given by
                  <span class="MuiBox-root css-87x4qo"
                    >task_status_map_name</span
                  >
                  will be used to store the statuses of our tasks. When we first
                  receive a task (inside the
                  <span class="MuiBox-root css-87x4qo">segment_volume</span>
                  function), we update its status to
                  <span class="MuiBox-root css-87x4qo">processing</span>. Then,
                  we run TotalSegmentator on the volume using
                  <span class="MuiBox-root css-87x4qo">subprocess.run</span>. If
                  the process runs successfully, we update the status of the
                  task to <span class="MuiBox-root css-87x4qo">completed</span>.
                  The segmentation will be saved at the location specified by
                  <span class="MuiBox-root css-87x4qo">segmentation_path</span>.
                  If the process fails with an error, we mark the task as
                  <span class="MuiBox-root css-87x4qo">failed</span>.
                </p>
                <h2
                  class="MuiTypography-root MuiTypography-h5 css-1oj41as"
                  id="fastapi-server"
                >
                  <strong>FastAPI Server</strong>
                </h2>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  Inside the
                  <span class="MuiBox-root css-87x4qo">server-worker/src</span>
                  directory, let&#x27;s create a file called
                  <span class="MuiBox-root css-87x4qo">app.py</span>, which will
                  contain our FastAPI application. As of now, we have three
                  needs from this application:
                </p>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  1) Serve the static files present in the
                  <span class="MuiBox-root css-87x4qo">data</span> folder (in
                  production this should be handled by your web server).
                </p>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  2) An endpoint where we can upload a Nifti file to start the
                  segmentation task.
                </p>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  3) An endpoint where we can get the status/result of a task.
                </p>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  Here is the
                  <span class="MuiBox-root css-87x4qo">app.py</span> file:
                </p>
                <div class="MuiBox-root css-dzaqf9">
                  <div class="MuiBox-root css-125pbeb">
                    <button
                      class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho"
                      tabindex="0"
                      type="button"
                    >
                      <svg
                        class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                        focusable="false"
                        aria-hidden="true"
                        viewBox="0 0 24 24"
                        data-testid="ContentCopyIcon"
                      >
                        <path
                          d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"
                        ></path>
                      </svg>
                    </button>
                  </div>
                  <pre
                    style="
                      color: #111b27;
                      background: #e3eaf2;
                      font-family: Consolas, Monaco, &quot;Andale Mono&quot;,
                        &quot;Ubuntu Mono&quot;, monospace;
                      text-align: left;
                      white-space: pre;
                      word-spacing: normal;
                      word-break: normal;
                      word-wrap: normal;
                      line-height: 1.5;
                      -moz-tab-size: 4;
                      -o-tab-size: 4;
                      tab-size: 4;
                      -webkit-hyphens: none;
                      -moz-hyphens: none;
                      -ms-hyphens: none;
                      hyphens: none;
                      padding: 1em;
                      margin: 0;
                      overflow: auto;
                    "
                  ><code class="language-python" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#a04900">from</span><span> os </span><span class="token" style="color:#a04900">import</span><span> makedirs
</span><span></span><span class="token" style="color:#a04900">from</span><span> os</span><span class="token" style="color:#111b27">.</span><span>path </span><span class="token" style="color:#a04900">import</span><span> basename </span><span class="token" style="color:#a04900">as</span><span> path_basename</span><span class="token" style="color:#111b27">,</span><span> join </span><span class="token" style="color:#a04900">as</span><span> path_join
</span><span></span><span class="token" style="color:#a04900">from</span><span> uuid </span><span class="token" style="color:#a04900">import</span><span> uuid4
</span>
<span></span><span class="token" style="color:#a04900">from</span><span> fastapi </span><span class="token" style="color:#a04900">import</span><span> FastAPI</span><span class="token" style="color:#111b27">,</span><span> UploadFile</span><span class="token" style="color:#111b27">,</span><span> File
</span><span></span><span class="token" style="color:#a04900">from</span><span> fastapi</span><span class="token" style="color:#111b27">.</span><span>responses </span><span class="token" style="color:#a04900">import</span><span> JSONResponse
</span><span></span><span class="token" style="color:#a04900">from</span><span> fastapi</span><span class="token" style="color:#111b27">.</span><span>staticfiles </span><span class="token" style="color:#a04900">import</span><span> StaticFiles
</span>
<span></span><span class="token" style="color:#a04900">from</span><span> src</span><span class="token" style="color:#111b27">.</span><span>dirs </span><span class="token" style="color:#a04900">import</span><span> data_dir
</span><span></span><span class="token" style="color:#a04900">from</span><span> src</span><span class="token" style="color:#111b27">.</span><span>redis_client </span><span class="token" style="color:#a04900">import</span><span> redis_client
</span><span></span><span class="token" style="color:#a04900">from</span><span> src</span><span class="token" style="color:#111b27">.</span><span>tasks </span><span class="token" style="color:#a04900">import</span><span> segment_volume</span><span class="token" style="color:#111b27">,</span><span> task_status_map_name
</span>
<!-- -->
<span>app </span><span class="token" style="color:#a04900">=</span><span> FastAPI</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span><span>app</span><span class="token" style="color:#111b27">.</span><span>mount</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;/data&quot;</span><span class="token" style="color:#111b27">,</span><span> StaticFiles</span><span class="token" style="color:#111b27">(</span><span>directory</span><span class="token" style="color:#a04900">=</span><span>data_dir</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span> name</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#116b00">&quot;data_dir&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<!-- -->
<span></span><span class="token decorator annotation" style="color:#111b27">@app</span><span class="token decorator annotation" style="color:#111b27">.</span><span class="token decorator annotation" style="color:#111b27">post</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;/api/add-segmentation-task&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span><span></span><span class="token" style="color:#a04900">async</span><span> </span><span class="token" style="color:#a04900">def</span><span> </span><span class="token" style="color:#7c00aa">upload_file</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#af00af">file</span><span class="token" style="color:#111b27">:</span><span> UploadFile </span><span class="token" style="color:#a04900">=</span><span> File</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">.</span><span class="token" style="color:#111b27">.</span><span class="token" style="color:#111b27">.</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>    task_id </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token" style="color:#af00af">str</span><span class="token" style="color:#111b27">(</span><span>uuid4</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">)</span><span>
</span><span>    task_dir </span><span class="token" style="color:#a04900">=</span><span> path_join</span><span class="token" style="color:#111b27">(</span><span>data_dir</span><span class="token" style="color:#111b27">,</span><span> task_id</span><span class="token" style="color:#111b27">)</span><span>
</span><span>    makedirs</span><span class="token" style="color:#111b27">(</span><span>task_dir</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    volume_save_path </span><span class="token" style="color:#a04900">=</span><span> path_join</span><span class="token" style="color:#111b27">(</span><span>task_dir</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;volume.nii.gz&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    </span><span class="token" style="color:#3c526d"># Save the file to the disk</span><span>
</span><span>    </span><span class="token" style="color:#a04900">with</span><span> </span><span class="token" style="color:#af00af">open</span><span class="token" style="color:#111b27">(</span><span>volume_save_path</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;wb&quot;</span><span class="token" style="color:#111b27">)</span><span> </span><span class="token" style="color:#a04900">as</span><span> </span><span class="token" style="color:#af00af">buffer</span><span class="token" style="color:#111b27">:</span><span>
</span><span>        </span><span class="token" style="color:#a04900">while</span><span> </span><span class="token" style="color:#755f00">True</span><span class="token" style="color:#111b27">:</span><span>
</span><span>            chunk </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token" style="color:#a04900">await</span><span> </span><span class="token" style="color:#af00af">file</span><span class="token" style="color:#111b27">.</span><span>read</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#755f00">10000</span><span class="token" style="color:#111b27">)</span><span>
</span><span>            </span><span class="token" style="color:#a04900">if</span><span> </span><span class="token" style="color:#a04900">not</span><span> chunk</span><span class="token" style="color:#111b27">:</span><span>
</span><span>                </span><span class="token" style="color:#a04900">break</span><span>
</span>
<span>            </span><span class="token" style="color:#af00af">buffer</span><span class="token" style="color:#111b27">.</span><span>write</span><span class="token" style="color:#111b27">(</span><span>chunk</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    </span><span class="token" style="color:#3c526d"># Queue the task</span><span>
</span><span>    redis_client</span><span class="token" style="color:#111b27">.</span><span>hset</span><span class="token" style="color:#111b27">(</span><span>task_status_map_name</span><span class="token" style="color:#111b27">,</span><span> task_id</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;queued&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span><span>    segment_volume</span><span class="token" style="color:#111b27">(</span><span>task_id</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    </span><span class="token" style="color:#a04900">return</span><span> JSONResponse</span><span class="token" style="color:#111b27">(</span><span>content</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#111b27">{</span><span>
</span><span>        </span><span class="token" style="color:#116b00">&#x27;success&#x27;</span><span class="token" style="color:#111b27">:</span><span> </span><span class="token" style="color:#755f00">True</span><span class="token" style="color:#111b27">,</span><span>
</span><span>        </span><span class="token" style="color:#116b00">&#x27;result&#x27;</span><span class="token" style="color:#111b27">:</span><span> </span><span class="token" style="color:#111b27">{</span><span>
</span><span>            </span><span class="token" style="color:#116b00">&#x27;taskId&#x27;</span><span class="token" style="color:#111b27">:</span><span> task_id</span><span class="token" style="color:#111b27">,</span><span>
</span><span>        </span><span class="token" style="color:#111b27">}</span><span class="token" style="color:#111b27">,</span><span>
</span><span>    </span><span class="token" style="color:#111b27">}</span><span class="token" style="color:#111b27">,</span><span> status_code</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">206</span><span class="token" style="color:#111b27">)</span><span>
</span>
<!-- -->
<span></span><span class="token decorator annotation" style="color:#111b27">@app</span><span class="token decorator annotation" style="color:#111b27">.</span><span class="token decorator annotation" style="color:#111b27">get</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;/api/get-segmentation-task-result&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span><span></span><span class="token" style="color:#a04900">async</span><span> </span><span class="token" style="color:#a04900">def</span><span> </span><span class="token" style="color:#7c00aa">get_segmentation</span><span class="token" style="color:#111b27">(</span><span>task_id</span><span class="token" style="color:#111b27">:</span><span> </span><span class="token" style="color:#af00af">str</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>    task_status </span><span class="token" style="color:#a04900">=</span><span> redis_client</span><span class="token" style="color:#111b27">.</span><span>hget</span><span class="token" style="color:#111b27">(</span><span>task_status_map_name</span><span class="token" style="color:#111b27">,</span><span> task_id</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    response_content </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token" style="color:#111b27">{</span><span>
</span><span>        </span><span class="token" style="color:#116b00">&#x27;success&#x27;</span><span class="token" style="color:#111b27">:</span><span> </span><span class="token" style="color:#755f00">True</span><span class="token" style="color:#111b27">,</span><span>
</span><span>        </span><span class="token" style="color:#116b00">&#x27;result&#x27;</span><span class="token" style="color:#111b27">:</span><span> </span><span class="token" style="color:#111b27">{</span><span>
</span><span>            </span><span class="token" style="color:#116b00">&#x27;taskId&#x27;</span><span class="token" style="color:#111b27">:</span><span> task_id</span><span class="token" style="color:#111b27">,</span><span>
</span><span>            </span><span class="token" style="color:#116b00">&#x27;status&#x27;</span><span class="token" style="color:#111b27">:</span><span> task_status</span><span class="token" style="color:#111b27">,</span><span>
</span><span>            </span><span class="token" style="color:#116b00">&#x27;volumeFileUrl&#x27;</span><span class="token" style="color:#111b27">:</span><span> path_join</span><span class="token" style="color:#111b27">(</span><span>path_basename</span><span class="token" style="color:#111b27">(</span><span>data_dir</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span> task_id</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;volume.nii.gz&quot;</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span>
</span><span>        </span><span class="token" style="color:#111b27">}</span><span class="token" style="color:#111b27">,</span><span>
</span><span>    </span><span class="token" style="color:#111b27">}</span><span>
</span>
<span>    </span><span class="token" style="color:#a04900">if</span><span> task_status </span><span class="token" style="color:#a04900">==</span><span> </span><span class="token" style="color:#116b00">&quot;completed&quot;</span><span class="token" style="color:#111b27">:</span><span>
</span><span>        response_content</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#116b00">&#x27;result&#x27;</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#116b00">&#x27;segmentationFileUrl&#x27;</span><span class="token" style="color:#111b27">]</span><span> </span><span class="token" style="color:#a04900">=</span><span> path_join</span><span class="token" style="color:#111b27">(</span><span>path_basename</span><span class="token" style="color:#111b27">(</span><span>data_dir</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span> task_id</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;segmentation.nii.gz&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    </span><span class="token" style="color:#a04900">return</span><span> JSONResponse</span><span class="token" style="color:#111b27">(</span><span>content</span><span class="token" style="color:#a04900">=</span><span>response_content</span><span class="token" style="color:#111b27">,</span><span> status_code</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">200</span><span class="token" style="color:#111b27">)</span></code></pre>
                </div>
                <h2
                  class="MuiTypography-root MuiTypography-h5 css-1oj41as"
                  id="running-the-app"
                >
                  <strong>Running the App</strong>
                </h2>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  Make sure you have a Redis server running.
                </p>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  We&#x27;ll need to create two environments: one for the server
                  and one for the worker. I&#x27;ll be using
                  <span class="MuiBox-root css-87x4qo">venv</span> for creating
                  and managing the environments.
                </p>
                <h3
                  class="MuiTypography-root MuiTypography-h6 css-14mppol"
                  id="server"
                >
                  <strong>Server</strong>
                </h3>
                <div class="MuiBox-root css-dzaqf9">
                  <div class="MuiBox-root css-125pbeb">
                    <button
                      class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho"
                      tabindex="0"
                      type="button"
                    >
                      <svg
                        class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                        focusable="false"
                        aria-hidden="true"
                        viewBox="0 0 24 24"
                        data-testid="ContentCopyIcon"
                      >
                        <path
                          d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"
                        ></path>
                      </svg>
                    </button>
                  </div>
                  <pre
                    style="
                      color: #111b27;
                      background: #e3eaf2;
                      font-family: Consolas, Monaco, &quot;Andale Mono&quot;,
                        &quot;Ubuntu Mono&quot;, monospace;
                      text-align: left;
                      white-space: pre;
                      word-spacing: normal;
                      word-break: normal;
                      word-wrap: normal;
                      line-height: 1.5;
                      -moz-tab-size: 4;
                      -o-tab-size: 4;
                      tab-size: 4;
                      -webkit-hyphens: none;
                      -moz-hyphens: none;
                      -ms-hyphens: none;
                      hyphens: none;
                      padding: 1em;
                      margin: 0;
                      overflow: auto;
                    "
                  ><code class="language-bash" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>python3 -m venv env_server
</span><span></span><span class="token" style="color:#005a8e">source</span><span> env_server/bin/activate</span></code></pre>
                </div>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  Next, we install the following packages:
                </p>
                <div class="MuiBox-root css-dzaqf9">
                  <div class="MuiBox-root css-125pbeb">
                    <button
                      class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho"
                      tabindex="0"
                      type="button"
                    >
                      <svg
                        class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                        focusable="false"
                        aria-hidden="true"
                        viewBox="0 0 24 24"
                        data-testid="ContentCopyIcon"
                      >
                        <path
                          d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"
                        ></path>
                      </svg>
                    </button>
                  </div>
                  <pre
                    style="
                      color: #111b27;
                      background: #e3eaf2;
                      font-family: Consolas, Monaco, &quot;Andale Mono&quot;,
                        &quot;Ubuntu Mono&quot;, monospace;
                      text-align: left;
                      white-space: pre;
                      word-spacing: normal;
                      word-break: normal;
                      word-wrap: normal;
                      line-height: 1.5;
                      -moz-tab-size: 4;
                      -o-tab-size: 4;
                      tab-size: 4;
                      -webkit-hyphens: none;
                      -moz-hyphens: none;
                      -ms-hyphens: none;
                      hyphens: none;
                      padding: 1em;
                      margin: 0;
                      overflow: auto;
                    "
                  ><code class="language-bash" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>pip </span><span class="token" style="color:#7c00aa">install</span><span> fastapi pydantic uvicorn python-multipart redis huey</span></code></pre>
                </div>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  We can now run the server from the
                  <span class="MuiBox-root css-87x4qo">server-worker</span>
                  directory using:
                </p>
                <div class="MuiBox-root css-dzaqf9">
                  <div class="MuiBox-root css-125pbeb">
                    <button
                      class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho"
                      tabindex="0"
                      type="button"
                    >
                      <svg
                        class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                        focusable="false"
                        aria-hidden="true"
                        viewBox="0 0 24 24"
                        data-testid="ContentCopyIcon"
                      >
                        <path
                          d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"
                        ></path>
                      </svg>
                    </button>
                  </div>
                  <pre
                    style="
                      color: #111b27;
                      background: #e3eaf2;
                      font-family: Consolas, Monaco, &quot;Andale Mono&quot;,
                        &quot;Ubuntu Mono&quot;, monospace;
                      text-align: left;
                      white-space: pre;
                      word-spacing: normal;
                      word-break: normal;
                      word-wrap: normal;
                      line-height: 1.5;
                      -moz-tab-size: 4;
                      -o-tab-size: 4;
                      tab-size: 4;
                      -webkit-hyphens: none;
                      -moz-hyphens: none;
                      -ms-hyphens: none;
                      hyphens: none;
                      padding: 1em;
                      margin: 0;
                      overflow: auto;
                    "
                  ><code class="language-bash" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token assign-left" style="color:#005a8e">REDIS_HOST</span><span class="token" style="color:#a04900">=</span><span>localhost </span><span class="token assign-left" style="color:#005a8e">REDIS_PORT</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">6379</span><span> </span><span class="token assign-left" style="color:#005a8e">REDIS_DB</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">0</span><span> uvicorn src.app:app --port</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">8000</span><span> --host</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">0.0</span><span>.0.0</span></code></pre>
                </div>
                <h3
                  class="MuiTypography-root MuiTypography-h6 css-14mppol"
                  id="worker"
                >
                  <strong>Worker</strong>
                </h3>
                <div class="MuiBox-root css-dzaqf9">
                  <div class="MuiBox-root css-125pbeb">
                    <button
                      class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho"
                      tabindex="0"
                      type="button"
                    >
                      <svg
                        class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                        focusable="false"
                        aria-hidden="true"
                        viewBox="0 0 24 24"
                        data-testid="ContentCopyIcon"
                      >
                        <path
                          d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"
                        ></path>
                      </svg>
                    </button>
                  </div>
                  <pre
                    style="
                      color: #111b27;
                      background: #e3eaf2;
                      font-family: Consolas, Monaco, &quot;Andale Mono&quot;,
                        &quot;Ubuntu Mono&quot;, monospace;
                      text-align: left;
                      white-space: pre;
                      word-spacing: normal;
                      word-break: normal;
                      word-wrap: normal;
                      line-height: 1.5;
                      -moz-tab-size: 4;
                      -o-tab-size: 4;
                      tab-size: 4;
                      -webkit-hyphens: none;
                      -moz-hyphens: none;
                      -ms-hyphens: none;
                      hyphens: none;
                      padding: 1em;
                      margin: 0;
                      overflow: auto;
                    "
                  ><code class="language-bash" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>python3 -m venv env_worker
</span><span></span><span class="token" style="color:#005a8e">source</span><span> env_worker/bin/activate</span></code></pre>
                </div>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  For the worker, we will also install the
                  <span class="MuiBox-root css-87x4qo">TotalSegmentator</span>
                  apart from the packages we installed for the server.
                </p>
                <div class="MuiBox-root css-dzaqf9">
                  <div class="MuiBox-root css-125pbeb">
                    <button
                      class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho"
                      tabindex="0"
                      type="button"
                    >
                      <svg
                        class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                        focusable="false"
                        aria-hidden="true"
                        viewBox="0 0 24 24"
                        data-testid="ContentCopyIcon"
                      >
                        <path
                          d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"
                        ></path>
                      </svg>
                    </button>
                  </div>
                  <pre
                    style="
                      color: #111b27;
                      background: #e3eaf2;
                      font-family: Consolas, Monaco, &quot;Andale Mono&quot;,
                        &quot;Ubuntu Mono&quot;, monospace;
                      text-align: left;
                      white-space: pre;
                      word-spacing: normal;
                      word-break: normal;
                      word-wrap: normal;
                      line-height: 1.5;
                      -moz-tab-size: 4;
                      -o-tab-size: 4;
                      tab-size: 4;
                      -webkit-hyphens: none;
                      -moz-hyphens: none;
                      -ms-hyphens: none;
                      hyphens: none;
                      padding: 1em;
                      margin: 0;
                      overflow: auto;
                    "
                  ><code class="language-bash" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>pip </span><span class="token" style="color:#7c00aa">install</span><span> fastapi pydantic uvicorn python-multipart redis huey TotalSegmentator</span></code></pre>
                </div>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  From the
                  <span class="MuiBox-root css-87x4qo">server-worker</span>
                  directory, run the following command to start the worker
                  process.
                </p>
                <div class="MuiBox-root css-dzaqf9">
                  <div class="MuiBox-root css-125pbeb">
                    <button
                      class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho"
                      tabindex="0"
                      type="button"
                    >
                      <svg
                        class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                        focusable="false"
                        aria-hidden="true"
                        viewBox="0 0 24 24"
                        data-testid="ContentCopyIcon"
                      >
                        <path
                          d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"
                        ></path>
                      </svg>
                    </button>
                  </div>
                  <pre
                    style="
                      color: #111b27;
                      background: #e3eaf2;
                      font-family: Consolas, Monaco, &quot;Andale Mono&quot;,
                        &quot;Ubuntu Mono&quot;, monospace;
                      text-align: left;
                      white-space: pre;
                      word-spacing: normal;
                      word-break: normal;
                      word-wrap: normal;
                      line-height: 1.5;
                      -moz-tab-size: 4;
                      -o-tab-size: 4;
                      tab-size: 4;
                      -webkit-hyphens: none;
                      -moz-hyphens: none;
                      -ms-hyphens: none;
                      hyphens: none;
                      padding: 1em;
                      margin: 0;
                      overflow: auto;
                    "
                  ><code class="language-bash" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token assign-left" style="color:#005a8e">REDIS_HOST</span><span class="token" style="color:#a04900">=</span><span>localhost </span><span class="token assign-left" style="color:#005a8e">REDIS_PORT</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">6379</span><span> </span><span class="token assign-left" style="color:#005a8e">REDIS_DB</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">0</span><span> huey_consumer.py src.tasks.huey</span></code></pre>
                </div>
                <h1
                  class="MuiTypography-root MuiTypography-h4 css-rg843f"
                  id="tests"
                >
                  <strong>Tests</strong>
                </h1>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  With both the server and worker applications running, we can
                  make a test case for our segmentation process in which we will
                  perform the following operations:
                </p>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  1) Add a segmentation task by uploading a sample volume.
                </p>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  1) Repeatedly query the status endpoint and wait for the task
                  to complete (or fail).
                </p>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  1) Download the volume and segmentation files.
                </p>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  1) Read the volume and segmentation files and verify if they
                  have the same shape.
                </p>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  Inside the project directory, create a new directory called
                  <span class="MuiBox-root css-87x4qo">tests</span>. This should
                  be on the same level as the
                  <span class="MuiBox-root css-87x4qo">server-worker</span>
                  folder. Here, we&#x27;ll have a
                  <span class="MuiBox-root css-87x4qo">dirs.py</span> file quite
                  similar to the
                  <span class="MuiBox-root css-87x4qo">dirs.py</span> in
                  <span class="MuiBox-root css-87x4qo">server-worker/src</span>.
                </p>
                <div class="MuiBox-root css-dzaqf9">
                  <div class="MuiBox-root css-125pbeb">
                    <button
                      class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho"
                      tabindex="0"
                      type="button"
                    >
                      <svg
                        class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                        focusable="false"
                        aria-hidden="true"
                        viewBox="0 0 24 24"
                        data-testid="ContentCopyIcon"
                      >
                        <path
                          d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"
                        ></path>
                      </svg>
                    </button>
                  </div>
                  <pre
                    style="
                      color: #111b27;
                      background: #e3eaf2;
                      font-family: Consolas, Monaco, &quot;Andale Mono&quot;,
                        &quot;Ubuntu Mono&quot;, monospace;
                      text-align: left;
                      white-space: pre;
                      word-spacing: normal;
                      word-break: normal;
                      word-wrap: normal;
                      line-height: 1.5;
                      -moz-tab-size: 4;
                      -o-tab-size: 4;
                      tab-size: 4;
                      -webkit-hyphens: none;
                      -moz-hyphens: none;
                      -ms-hyphens: none;
                      hyphens: none;
                      padding: 1em;
                      margin: 0;
                      overflow: auto;
                    "
                  ><code class="language-python" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#a04900">from</span><span> os </span><span class="token" style="color:#a04900">import</span><span> makedirs
</span><span></span><span class="token" style="color:#a04900">from</span><span> os</span><span class="token" style="color:#111b27">.</span><span>path </span><span class="token" style="color:#a04900">import</span><span> dirname</span><span class="token" style="color:#111b27">,</span><span> join </span><span class="token" style="color:#a04900">as</span><span> path_join
</span>
<!-- -->
<span>tests_dir </span><span class="token" style="color:#a04900">=</span><span> dirname</span><span class="token" style="color:#111b27">(</span><span>__file__</span><span class="token" style="color:#111b27">)</span><span>
</span><span>project_dir </span><span class="token" style="color:#a04900">=</span><span> dirname</span><span class="token" style="color:#111b27">(</span><span>tests_dir</span><span class="token" style="color:#111b27">)</span><span>
</span><span>data_dir </span><span class="token" style="color:#a04900">=</span><span> path_join</span><span class="token" style="color:#111b27">(</span><span>project_dir</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;data&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>makedirs</span><span class="token" style="color:#111b27">(</span><span>data_dir</span><span class="token" style="color:#111b27">,</span><span> exist_ok</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">True</span><span class="token" style="color:#111b27">)</span></code></pre>
                </div>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  Next, create a file called
                  <span class="MuiBox-root css-87x4qo">utils.py</span> to
                  contain a couple of utility functions:
                </p>
                <div class="MuiBox-root css-dzaqf9">
                  <div class="MuiBox-root css-125pbeb">
                    <button
                      class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho"
                      tabindex="0"
                      type="button"
                    >
                      <svg
                        class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                        focusable="false"
                        aria-hidden="true"
                        viewBox="0 0 24 24"
                        data-testid="ContentCopyIcon"
                      >
                        <path
                          d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"
                        ></path>
                      </svg>
                    </button>
                  </div>
                  <pre
                    style="
                      color: #111b27;
                      background: #e3eaf2;
                      font-family: Consolas, Monaco, &quot;Andale Mono&quot;,
                        &quot;Ubuntu Mono&quot;, monospace;
                      text-align: left;
                      white-space: pre;
                      word-spacing: normal;
                      word-break: normal;
                      word-wrap: normal;
                      line-height: 1.5;
                      -moz-tab-size: 4;
                      -o-tab-size: 4;
                      tab-size: 4;
                      -webkit-hyphens: none;
                      -moz-hyphens: none;
                      -ms-hyphens: none;
                      hyphens: none;
                      padding: 1em;
                      margin: 0;
                      overflow: auto;
                    "
                  ><code class="language-python" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#a04900">from</span><span> sys </span><span class="token" style="color:#a04900">import</span><span> stdout
</span>
<span></span><span class="token" style="color:#a04900">import</span><span> requests
</span>
<!-- -->
<span></span><span class="token" style="color:#a04900">def</span><span> </span><span class="token" style="color:#7c00aa">print_inline</span><span class="token" style="color:#111b27">(</span><span>string</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>    </span><span class="token" style="color:#a04900">print</span><span class="token" style="color:#111b27">(</span><span>string</span><span class="token" style="color:#111b27">,</span><span> end</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#116b00">&quot;&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span><span>    stdout</span><span class="token" style="color:#111b27">.</span><span>flush</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span>
<!-- -->
<span></span><span class="token" style="color:#a04900">def</span><span> </span><span class="token" style="color:#7c00aa">download_file</span><span class="token" style="color:#111b27">(</span><span>url</span><span class="token" style="color:#111b27">,</span><span> file_path</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>    response </span><span class="token" style="color:#a04900">=</span><span> requests</span><span class="token" style="color:#111b27">.</span><span>get</span><span class="token" style="color:#111b27">(</span><span>url</span><span class="token" style="color:#111b27">)</span><span>
</span><span>    </span><span class="token" style="color:#a04900">if</span><span> response</span><span class="token" style="color:#111b27">.</span><span>status_code </span><span class="token" style="color:#a04900">!=</span><span> </span><span class="token" style="color:#755f00">200</span><span class="token" style="color:#111b27">:</span><span>
</span><span>        </span><span class="token" style="color:#a04900">print</span><span class="token" style="color:#111b27">(</span><span class="token string-interpolation" style="color:#116b00">f&quot;Failed to download file. Response status code: </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">response</span><span class="token string-interpolation interpolation" style="color:#111b27">.</span><span class="token string-interpolation interpolation">status_code</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        </span><span class="token" style="color:#a04900">return</span><span> </span><span class="token" style="color:#755f00">False</span><span>
</span>
<span>    </span><span class="token" style="color:#a04900">with</span><span> </span><span class="token" style="color:#af00af">open</span><span class="token" style="color:#111b27">(</span><span>file_path</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;wb&quot;</span><span class="token" style="color:#111b27">)</span><span> </span><span class="token" style="color:#a04900">as</span><span> f</span><span class="token" style="color:#111b27">:</span><span>
</span><span>        f</span><span class="token" style="color:#111b27">.</span><span>write</span><span class="token" style="color:#111b27">(</span><span>response</span><span class="token" style="color:#111b27">.</span><span>content</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    </span><span class="token" style="color:#a04900">return</span><span> </span><span class="token" style="color:#755f00">True</span></code></pre>
                </div>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  Now, let&#x27;s write our core testing logic. Create a file
                  called
                  <span class="MuiBox-root css-87x4qo">test_apis.py</span> and
                  add the following lines
                </p>
                <div class="MuiBox-root css-dzaqf9">
                  <div class="MuiBox-root css-125pbeb">
                    <button
                      class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho"
                      tabindex="0"
                      type="button"
                    >
                      <svg
                        class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                        focusable="false"
                        aria-hidden="true"
                        viewBox="0 0 24 24"
                        data-testid="ContentCopyIcon"
                      >
                        <path
                          d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"
                        ></path>
                      </svg>
                    </button>
                  </div>
                  <pre
                    style="
                      color: #111b27;
                      background: #e3eaf2;
                      font-family: Consolas, Monaco, &quot;Andale Mono&quot;,
                        &quot;Ubuntu Mono&quot;, monospace;
                      text-align: left;
                      white-space: pre;
                      word-spacing: normal;
                      word-break: normal;
                      word-wrap: normal;
                      line-height: 1.5;
                      -moz-tab-size: 4;
                      -o-tab-size: 4;
                      tab-size: 4;
                      -webkit-hyphens: none;
                      -moz-hyphens: none;
                      -ms-hyphens: none;
                      hyphens: none;
                      padding: 1em;
                      margin: 0;
                      overflow: auto;
                    "
                  ><code class="language-python" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#a04900">from</span><span> os </span><span class="token" style="color:#a04900">import</span><span> makedirs
</span><span></span><span class="token" style="color:#a04900">from</span><span> os</span><span class="token" style="color:#111b27">.</span><span>path </span><span class="token" style="color:#a04900">import</span><span> basename </span><span class="token" style="color:#a04900">as</span><span> path_basename</span><span class="token" style="color:#111b27">,</span><span> join </span><span class="token" style="color:#a04900">as</span><span> path_join
</span><span></span><span class="token" style="color:#a04900">from</span><span> shutil </span><span class="token" style="color:#a04900">import</span><span> rmtree
</span><span></span><span class="token" style="color:#a04900">from</span><span> time </span><span class="token" style="color:#a04900">import</span><span> sleep</span><span class="token" style="color:#111b27">,</span><span> time
</span><span></span><span class="token" style="color:#a04900">import</span><span> unittest
</span>
<span></span><span class="token" style="color:#a04900">from</span><span> nibabel </span><span class="token" style="color:#a04900">import</span><span> load </span><span class="token" style="color:#a04900">as</span><span> nib_load
</span><span></span><span class="token" style="color:#a04900">import</span><span> requests
</span>
<span></span><span class="token" style="color:#a04900">from</span><span> dirs </span><span class="token" style="color:#a04900">import</span><span> data_dir</span><span class="token" style="color:#111b27">,</span><span> tests_dir
</span><span></span><span class="token" style="color:#a04900">from</span><span> utils </span><span class="token" style="color:#a04900">import</span><span> download_file</span><span class="token" style="color:#111b27">,</span><span> print_inline
</span>
<!-- -->
<span></span><span class="token" style="color:#a04900">class</span><span> </span><span class="token" style="color:#005a8e">TestAPIs</span><span class="token" style="color:#111b27">(</span><span>unittest</span><span class="token" style="color:#111b27">.</span><span>TestCase</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>    base_url </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token" style="color:#116b00">&quot;http://localhost:8000&quot;</span><span>
</span><span>    api_base_url </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token" style="color:#116b00">&quot;http://localhost:8000/api&quot;</span><span>
</span><span>    test_volume_path </span><span class="token" style="color:#a04900">=</span><span> path_join</span><span class="token" style="color:#111b27">(</span><span>data_dir</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;testing&quot;</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;volume.nii.gz&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<!-- -->
<span>    </span><span class="token" style="color:#a04900">def</span><span> </span><span class="token" style="color:#7c00aa">test_add_segmentation_task_and_get_result</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>        </span><span class="token" style="color:#a04900">pass</span><span>
</span>
<!-- -->
<span></span><span class="token" style="color:#a04900">if</span><span> __name__ </span><span class="token" style="color:#a04900">==</span><span> </span><span class="token" style="color:#116b00">&quot;__main__&quot;</span><span class="token" style="color:#111b27">:</span><span>
</span><span>    unittest</span><span class="token" style="color:#111b27">.</span><span>main</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span></code></pre>
                </div>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  The
                  <span class="MuiBox-root css-87x4qo"
                    >test_add_segmentation_task_and_get_result</span
                  >
                  function will contain the logic for performing the four
                  aforementioned testing operations. Inside the
                  <span class="MuiBox-root css-87x4qo">data</span> folder in the
                  project&#x27;s root directory, we&#x27;ll create another
                  folder called
                  <span class="MuiBox-root css-87x4qo">testing</span> and place
                  a CT Nifti image called
                  <span class="MuiBox-root css-87x4qo">volume.nii.gz</span> in
                  it. Let&#x27;s upload this volume for segmentation in our
                  test.
                </p>
                <div class="MuiBox-root css-dzaqf9">
                  <div class="MuiBox-root css-125pbeb">
                    <button
                      class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho"
                      tabindex="0"
                      type="button"
                    >
                      <svg
                        class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                        focusable="false"
                        aria-hidden="true"
                        viewBox="0 0 24 24"
                        data-testid="ContentCopyIcon"
                      >
                        <path
                          d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"
                        ></path>
                      </svg>
                    </button>
                  </div>
                  <pre
                    style="
                      color: #111b27;
                      background: #e3eaf2;
                      font-family: Consolas, Monaco, &quot;Andale Mono&quot;,
                        &quot;Ubuntu Mono&quot;, monospace;
                      text-align: left;
                      white-space: pre;
                      word-spacing: normal;
                      word-break: normal;
                      word-wrap: normal;
                      line-height: 1.5;
                      -moz-tab-size: 4;
                      -o-tab-size: 4;
                      tab-size: 4;
                      -webkit-hyphens: none;
                      -moz-hyphens: none;
                      -ms-hyphens: none;
                      hyphens: none;
                      padding: 1em;
                      margin: 0;
                      overflow: auto;
                    "
                  ><code class="language-python" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>add_segmentation_task_endpoint </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token string-interpolation" style="color:#116b00">f&quot;</span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">self</span><span class="token string-interpolation interpolation" style="color:#111b27">.</span><span class="token string-interpolation interpolation">api_base_url</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">/add-segmentation-task&quot;</span><span>
</span>
<span>print_inline</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;Adding task ...&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span></span><span class="token" style="color:#a04900">with</span><span> </span><span class="token" style="color:#af00af">open</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">.</span><span>test_volume_path</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;rb&quot;</span><span class="token" style="color:#111b27">)</span><span> </span><span class="token" style="color:#a04900">as</span><span> f</span><span class="token" style="color:#111b27">:</span><span>
</span><span>    files </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token" style="color:#111b27">{</span><span class="token" style="color:#116b00">&quot;file&quot;</span><span class="token" style="color:#111b27">:</span><span> f</span><span class="token" style="color:#111b27">}</span><span>
</span><span>    add_response </span><span class="token" style="color:#a04900">=</span><span> requests</span><span class="token" style="color:#111b27">.</span><span>post</span><span class="token" style="color:#111b27">(</span><span>add_segmentation_task_endpoint</span><span class="token" style="color:#111b27">,</span><span> files</span><span class="token" style="color:#a04900">=</span><span>files</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>self</span><span class="token" style="color:#111b27">.</span><span>assertEqual</span><span class="token" style="color:#111b27">(</span><span>add_response</span><span class="token" style="color:#111b27">.</span><span>status_code</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">206</span><span class="token" style="color:#111b27">)</span><span>
</span><span>self</span><span class="token" style="color:#111b27">.</span><span>assertEqual</span><span class="token" style="color:#111b27">(</span><span>add_response</span><span class="token" style="color:#111b27">.</span><span>headers</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#116b00">&#x27;content-type&#x27;</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;application/json&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>add_response_data </span><span class="token" style="color:#a04900">=</span><span> add_response</span><span class="token" style="color:#111b27">.</span><span>json</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>self</span><span class="token" style="color:#111b27">.</span><span>assertEqual</span><span class="token" style="color:#111b27">(</span><span>add_response_data</span><span class="token" style="color:#111b27">.</span><span>get</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&#x27;success&#x27;</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">None</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">True</span><span class="token" style="color:#111b27">)</span><span>
</span><span>self</span><span class="token" style="color:#111b27">.</span><span>assertNotEqual</span><span class="token" style="color:#111b27">(</span><span>add_response_data</span><span class="token" style="color:#111b27">.</span><span>get</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&#x27;result&#x27;</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#111b27">{</span><span class="token" style="color:#111b27">}</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">.</span><span>get</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&#x27;taskId&#x27;</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">None</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">None</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span></span><span class="token" style="color:#a04900">print</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;    ok.&quot;</span><span class="token" style="color:#111b27">)</span></code></pre>
                </div>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  Then, we will repeatedly fetch the status of the task until it
                  is completed or failed. If the status is
                  <span class="MuiBox-root css-87x4qo">failed</span>, we fail
                  the test. If the status is
                  <span class="MuiBox-root css-87x4qo">completed</span>, we make
                  sure that the
                  <span class="MuiBox-root css-87x4qo"
                    >segmentationFileUrl</span
                  >
                  in the response is actually what is expected for the
                  <span class="MuiBox-root css-87x4qo">task_id</span>.
                </p>
                <div class="MuiBox-root css-dzaqf9">
                  <div class="MuiBox-root css-125pbeb">
                    <button
                      class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho"
                      tabindex="0"
                      type="button"
                    >
                      <svg
                        class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                        focusable="false"
                        aria-hidden="true"
                        viewBox="0 0 24 24"
                        data-testid="ContentCopyIcon"
                      >
                        <path
                          d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"
                        ></path>
                      </svg>
                    </button>
                  </div>
                  <pre
                    style="
                      color: #111b27;
                      background: #e3eaf2;
                      font-family: Consolas, Monaco, &quot;Andale Mono&quot;,
                        &quot;Ubuntu Mono&quot;, monospace;
                      text-align: left;
                      white-space: pre;
                      word-spacing: normal;
                      word-break: normal;
                      word-wrap: normal;
                      line-height: 1.5;
                      -moz-tab-size: 4;
                      -o-tab-size: 4;
                      tab-size: 4;
                      -webkit-hyphens: none;
                      -moz-hyphens: none;
                      -ms-hyphens: none;
                      hyphens: none;
                      padding: 1em;
                      margin: 0;
                      overflow: auto;
                    "
                  ><code class="language-python" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>task_id </span><span class="token" style="color:#a04900">=</span><span> add_response_data</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#116b00">&#x27;result&#x27;</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#116b00">&#x27;taskId&#x27;</span><span class="token" style="color:#111b27">]</span><span>
</span><span>get_segmentation_task_result_endpoint </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token string-interpolation" style="color:#116b00">f&quot;</span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">self</span><span class="token string-interpolation interpolation" style="color:#111b27">.</span><span class="token string-interpolation interpolation">api_base_url</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">/get-segmentation-task-result?task_id=</span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">task_id</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">&quot;</span><span>
</span><span>expected_volume_file_url </span><span class="token" style="color:#a04900">=</span><span> path_join</span><span class="token" style="color:#111b27">(</span><span>path_basename</span><span class="token" style="color:#111b27">(</span><span>data_dir</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span> task_id</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;volume.nii.gz&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span><span>expected_segmentation_file_url </span><span class="token" style="color:#a04900">=</span><span> path_join</span><span class="token" style="color:#111b27">(</span><span>path_basename</span><span class="token" style="color:#111b27">(</span><span>data_dir</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span> task_id</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;segmentation.nii.gz&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>print_inline</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;Getting task status &quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span></span><span class="token" style="color:#a04900">while</span><span> </span><span class="token" style="color:#755f00">True</span><span class="token" style="color:#111b27">:</span><span>
</span><span>    get_result_response </span><span class="token" style="color:#a04900">=</span><span> requests</span><span class="token" style="color:#111b27">.</span><span>get</span><span class="token" style="color:#111b27">(</span><span>get_segmentation_task_result_endpoint</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    self</span><span class="token" style="color:#111b27">.</span><span>assertEqual</span><span class="token" style="color:#111b27">(</span><span>get_result_response</span><span class="token" style="color:#111b27">.</span><span>status_code</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">200</span><span class="token" style="color:#111b27">)</span><span>
</span><span>    self</span><span class="token" style="color:#111b27">.</span><span>assertEqual</span><span class="token" style="color:#111b27">(</span><span>get_result_response</span><span class="token" style="color:#111b27">.</span><span>headers</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#116b00">&#x27;content-type&#x27;</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;application/json&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    get_result_response_data </span><span class="token" style="color:#a04900">=</span><span> get_result_response</span><span class="token" style="color:#111b27">.</span><span>json</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    self</span><span class="token" style="color:#111b27">.</span><span>assertEqual</span><span class="token" style="color:#111b27">(</span><span>get_result_response_data</span><span class="token" style="color:#111b27">.</span><span>get</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&#x27;success&#x27;</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">None</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">True</span><span class="token" style="color:#111b27">)</span><span>
</span><span>    self</span><span class="token" style="color:#111b27">.</span><span>assertNotEqual</span><span class="token" style="color:#111b27">(</span><span>get_result_response_data</span><span class="token" style="color:#111b27">.</span><span>get</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&#x27;result&#x27;</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#111b27">{</span><span class="token" style="color:#111b27">}</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">.</span><span>get</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&#x27;status&#x27;</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">None</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">None</span><span class="token" style="color:#111b27">)</span><span>
</span><span>    self</span><span class="token" style="color:#111b27">.</span><span>assertEqual</span><span class="token" style="color:#111b27">(</span><span>get_result_response_data</span><span class="token" style="color:#111b27">.</span><span>get</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&#x27;result&#x27;</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#111b27">{</span><span class="token" style="color:#111b27">}</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">.</span><span>get</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&#x27;taskId&#x27;</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">None</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span> task_id</span><span class="token" style="color:#111b27">)</span><span>
</span><span>    self</span><span class="token" style="color:#111b27">.</span><span>assertEqual</span><span class="token" style="color:#111b27">(</span><span>
</span><span>        get_result_response_data</span><span class="token" style="color:#111b27">.</span><span>get</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&#x27;result&#x27;</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#111b27">{</span><span class="token" style="color:#111b27">}</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">.</span><span>get</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&#x27;volumeFileUrl&#x27;</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">None</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span>
</span>        expected_volume_file_url
<span>    </span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    print_inline</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;.&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    </span><span class="token" style="color:#a04900">if</span><span> get_result_response_data</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#116b00">&#x27;result&#x27;</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#116b00">&#x27;status&#x27;</span><span class="token" style="color:#111b27">]</span><span> </span><span class="token" style="color:#a04900">==</span><span> </span><span class="token" style="color:#116b00">&quot;failed&quot;</span><span class="token" style="color:#111b27">:</span><span>
</span><span>        self</span><span class="token" style="color:#111b27">.</span><span>fail</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;Server failed to segment the uploaded volume.&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        </span><span class="token" style="color:#a04900">break</span><span>
</span>
<span>    </span><span class="token" style="color:#a04900">if</span><span> get_result_response_data</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#116b00">&#x27;result&#x27;</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#116b00">&#x27;status&#x27;</span><span class="token" style="color:#111b27">]</span><span> </span><span class="token" style="color:#a04900">==</span><span> </span><span class="token" style="color:#116b00">&quot;completed&quot;</span><span class="token" style="color:#111b27">:</span><span>
</span><span>        self</span><span class="token" style="color:#111b27">.</span><span>assertEqual</span><span class="token" style="color:#111b27">(</span><span>
</span><span>            get_result_response_data</span><span class="token" style="color:#111b27">.</span><span>get</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&#x27;result&#x27;</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#111b27">{</span><span class="token" style="color:#111b27">}</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">.</span><span>get</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&#x27;segmentationFileUrl&#x27;</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">None</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">.</span><span>strip</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span>
</span><span>            expected_segmentation_file_url</span><span class="token" style="color:#111b27">.</span><span>strip</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        </span><span class="token" style="color:#111b27">)</span><span>
</span><span>        </span><span class="token" style="color:#a04900">break</span><span>
</span>
<span>    sleep</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#755f00">1</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span></span><span class="token" style="color:#a04900">print</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;    ok.&quot;</span><span class="token" style="color:#111b27">)</span></code></pre>
                </div>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  Next, we download the volume and segmentation files.
                </p>
                <div class="MuiBox-root css-dzaqf9">
                  <div class="MuiBox-root css-125pbeb">
                    <button
                      class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho"
                      tabindex="0"
                      type="button"
                    >
                      <svg
                        class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                        focusable="false"
                        aria-hidden="true"
                        viewBox="0 0 24 24"
                        data-testid="ContentCopyIcon"
                      >
                        <path
                          d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"
                        ></path>
                      </svg>
                    </button>
                  </div>
                  <pre
                    style="
                      color: #111b27;
                      background: #e3eaf2;
                      font-family: Consolas, Monaco, &quot;Andale Mono&quot;,
                        &quot;Ubuntu Mono&quot;, monospace;
                      text-align: left;
                      white-space: pre;
                      word-spacing: normal;
                      word-break: normal;
                      word-wrap: normal;
                      line-height: 1.5;
                      -moz-tab-size: 4;
                      -o-tab-size: 4;
                      tab-size: 4;
                      -webkit-hyphens: none;
                      -moz-hyphens: none;
                      -ms-hyphens: none;
                      hyphens: none;
                      padding: 1em;
                      margin: 0;
                      overflow: auto;
                    "
                  ><code class="language-python" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>print_inline</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;Downloading files ... &quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>volume_file_url </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token string-interpolation" style="color:#116b00">f&quot;</span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">self</span><span class="token string-interpolation interpolation" style="color:#111b27">.</span><span class="token string-interpolation interpolation">base_url</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">/</span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">expected_volume_file_url</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">&quot;</span><span>
</span><span>segmentation_file_url </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token string-interpolation" style="color:#116b00">f&quot;</span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">self</span><span class="token string-interpolation interpolation" style="color:#111b27">.</span><span class="token string-interpolation interpolation">base_url</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">/</span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">expected_segmentation_file_url</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">&quot;</span><span>
</span>
<span>temp_dir </span><span class="token" style="color:#a04900">=</span><span> path_join</span><span class="token" style="color:#111b27">(</span><span>tests_dir</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;temp&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span><span>makedirs</span><span class="token" style="color:#111b27">(</span><span>temp_dir</span><span class="token" style="color:#111b27">,</span><span> exist_ok</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">True</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>volume_file_path </span><span class="token" style="color:#a04900">=</span><span> path_join</span><span class="token" style="color:#111b27">(</span><span>temp_dir</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token string-interpolation" style="color:#116b00">f&quot;volume-</span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">time</span><span class="token string-interpolation interpolation" style="color:#111b27">(</span><span class="token string-interpolation interpolation" style="color:#111b27">)</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">.nii.gz&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span><span>segmentation_file_path </span><span class="token" style="color:#a04900">=</span><span> path_join</span><span class="token" style="color:#111b27">(</span><span>temp_dir</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token string-interpolation" style="color:#116b00">f&quot;segmentation-</span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">time</span><span class="token string-interpolation interpolation" style="color:#111b27">(</span><span class="token string-interpolation interpolation" style="color:#111b27">)</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">.nii.gz&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span></span><span class="token" style="color:#a04900">if</span><span> </span><span class="token" style="color:#a04900">not</span><span> download_file</span><span class="token" style="color:#111b27">(</span><span>volume_file_url</span><span class="token" style="color:#111b27">,</span><span> volume_file_path</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>    self</span><span class="token" style="color:#111b27">.</span><span>fail</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;Failed to download volume file from server.&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span><span>print_inline</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;    volume download ok ... &quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span></span><span class="token" style="color:#a04900">if</span><span> </span><span class="token" style="color:#a04900">not</span><span> download_file</span><span class="token" style="color:#111b27">(</span><span>segmentation_file_url</span><span class="token" style="color:#111b27">,</span><span> segmentation_file_path</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>    self</span><span class="token" style="color:#111b27">.</span><span>fail</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;Failed to download segmentation file from server.&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span><span>print_inline</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;    segmentation download ok ... &quot;</span><span class="token" style="color:#111b27">)</span></code></pre>
                </div>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  Finally, we check whether both the files have the same shape
                  and then delete the downloaded files.
                </p>
                <div class="MuiBox-root css-dzaqf9">
                  <div class="MuiBox-root css-125pbeb">
                    <button
                      class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho"
                      tabindex="0"
                      type="button"
                    >
                      <svg
                        class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                        focusable="false"
                        aria-hidden="true"
                        viewBox="0 0 24 24"
                        data-testid="ContentCopyIcon"
                      >
                        <path
                          d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"
                        ></path>
                      </svg>
                    </button>
                  </div>
                  <pre
                    style="
                      color: #111b27;
                      background: #e3eaf2;
                      font-family: Consolas, Monaco, &quot;Andale Mono&quot;,
                        &quot;Ubuntu Mono&quot;, monospace;
                      text-align: left;
                      white-space: pre;
                      word-spacing: normal;
                      word-break: normal;
                      word-wrap: normal;
                      line-height: 1.5;
                      -moz-tab-size: 4;
                      -o-tab-size: 4;
                      tab-size: 4;
                      -webkit-hyphens: none;
                      -moz-hyphens: none;
                      -ms-hyphens: none;
                      hyphens: none;
                      padding: 1em;
                      margin: 0;
                      overflow: auto;
                    "
                  ><code class="language-python" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>volume_file_data </span><span class="token" style="color:#a04900">=</span><span> nib_load</span><span class="token" style="color:#111b27">(</span><span>volume_file_path</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">.</span><span>get_fdata</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span><span>segmentation_file_data </span><span class="token" style="color:#a04900">=</span><span> nib_load</span><span class="token" style="color:#111b27">(</span><span>volume_file_path</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">.</span><span>get_fdata</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>self</span><span class="token" style="color:#111b27">.</span><span>assertTupleEqual</span><span class="token" style="color:#111b27">(</span><span>volume_file_data</span><span class="token" style="color:#111b27">.</span><span>shape</span><span class="token" style="color:#111b27">,</span><span> segmentation_file_data</span><span class="token" style="color:#111b27">.</span><span>shape</span><span class="token" style="color:#111b27">)</span><span>
</span><span></span><span class="token" style="color:#a04900">print</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;    shapes ok.&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>rmtree</span><span class="token" style="color:#111b27">(</span><span>temp_dir</span><span class="token" style="color:#111b27">)</span></code></pre>
                </div>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  Here&#x27;s the entire
                  <span class="MuiBox-root css-87x4qo">test_apis.py</span> file
                </p>
                <div class="MuiBox-root css-dzaqf9">
                  <div class="MuiBox-root css-125pbeb">
                    <button
                      class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho"
                      tabindex="0"
                      type="button"
                    >
                      <svg
                        class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                        focusable="false"
                        aria-hidden="true"
                        viewBox="0 0 24 24"
                        data-testid="ContentCopyIcon"
                      >
                        <path
                          d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"
                        ></path>
                      </svg>
                    </button>
                  </div>
                  <pre
                    style="
                      color: #111b27;
                      background: #e3eaf2;
                      font-family: Consolas, Monaco, &quot;Andale Mono&quot;,
                        &quot;Ubuntu Mono&quot;, monospace;
                      text-align: left;
                      white-space: pre;
                      word-spacing: normal;
                      word-break: normal;
                      word-wrap: normal;
                      line-height: 1.5;
                      -moz-tab-size: 4;
                      -o-tab-size: 4;
                      tab-size: 4;
                      -webkit-hyphens: none;
                      -moz-hyphens: none;
                      -ms-hyphens: none;
                      hyphens: none;
                      padding: 1em;
                      margin: 0;
                      overflow: auto;
                    "
                  ><code class="language-python" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#a04900">from</span><span> os </span><span class="token" style="color:#a04900">import</span><span> makedirs
</span><span></span><span class="token" style="color:#a04900">from</span><span> os</span><span class="token" style="color:#111b27">.</span><span>path </span><span class="token" style="color:#a04900">import</span><span> basename </span><span class="token" style="color:#a04900">as</span><span> path_basename</span><span class="token" style="color:#111b27">,</span><span> join </span><span class="token" style="color:#a04900">as</span><span> path_join
</span><span></span><span class="token" style="color:#a04900">from</span><span> shutil </span><span class="token" style="color:#a04900">import</span><span> rmtree
</span><span></span><span class="token" style="color:#a04900">from</span><span> time </span><span class="token" style="color:#a04900">import</span><span> sleep</span><span class="token" style="color:#111b27">,</span><span> time
</span><span></span><span class="token" style="color:#a04900">import</span><span> unittest
</span>
<span></span><span class="token" style="color:#a04900">from</span><span> nibabel </span><span class="token" style="color:#a04900">import</span><span> load </span><span class="token" style="color:#a04900">as</span><span> nib_load
</span><span></span><span class="token" style="color:#a04900">import</span><span> requests
</span>
<span></span><span class="token" style="color:#a04900">from</span><span> dirs </span><span class="token" style="color:#a04900">import</span><span> data_dir</span><span class="token" style="color:#111b27">,</span><span> tests_dir
</span><span></span><span class="token" style="color:#a04900">from</span><span> utils </span><span class="token" style="color:#a04900">import</span><span> download_file</span><span class="token" style="color:#111b27">,</span><span> print_inline
</span>
<!-- -->
<span></span><span class="token" style="color:#a04900">class</span><span> </span><span class="token" style="color:#005a8e">TestAPIs</span><span class="token" style="color:#111b27">(</span><span>unittest</span><span class="token" style="color:#111b27">.</span><span>TestCase</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>    base_url </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token" style="color:#116b00">&quot;http://localhost:8000&quot;</span><span>
</span><span>    api_base_url </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token" style="color:#116b00">&quot;http://localhost:8000/api&quot;</span><span>
</span><span>    test_volume_path </span><span class="token" style="color:#a04900">=</span><span> path_join</span><span class="token" style="color:#111b27">(</span><span>data_dir</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;testing&quot;</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;volume.nii.gz&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<!-- -->
<span>    </span><span class="token" style="color:#a04900">def</span><span> </span><span class="token" style="color:#7c00aa">test_add_segmentation_task_and_get_result</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>        add_segmentation_task_endpoint </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token string-interpolation" style="color:#116b00">f&quot;</span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">self</span><span class="token string-interpolation interpolation" style="color:#111b27">.</span><span class="token string-interpolation interpolation">api_base_url</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">/add-segmentation-task&quot;</span><span>
</span>
<span>        print_inline</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;Adding task ...&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        </span><span class="token" style="color:#a04900">with</span><span> </span><span class="token" style="color:#af00af">open</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">.</span><span>test_volume_path</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;rb&quot;</span><span class="token" style="color:#111b27">)</span><span> </span><span class="token" style="color:#a04900">as</span><span> f</span><span class="token" style="color:#111b27">:</span><span>
</span><span>            files </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token" style="color:#111b27">{</span><span class="token" style="color:#116b00">&quot;file&quot;</span><span class="token" style="color:#111b27">:</span><span> f</span><span class="token" style="color:#111b27">}</span><span>
</span><span>            add_response </span><span class="token" style="color:#a04900">=</span><span> requests</span><span class="token" style="color:#111b27">.</span><span>post</span><span class="token" style="color:#111b27">(</span><span>add_segmentation_task_endpoint</span><span class="token" style="color:#111b27">,</span><span> files</span><span class="token" style="color:#a04900">=</span><span>files</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        self</span><span class="token" style="color:#111b27">.</span><span>assertEqual</span><span class="token" style="color:#111b27">(</span><span>add_response</span><span class="token" style="color:#111b27">.</span><span>status_code</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">206</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        self</span><span class="token" style="color:#111b27">.</span><span>assertEqual</span><span class="token" style="color:#111b27">(</span><span>add_response</span><span class="token" style="color:#111b27">.</span><span>headers</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#116b00">&#x27;content-type&#x27;</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;application/json&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        add_response_data </span><span class="token" style="color:#a04900">=</span><span> add_response</span><span class="token" style="color:#111b27">.</span><span>json</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        self</span><span class="token" style="color:#111b27">.</span><span>assertEqual</span><span class="token" style="color:#111b27">(</span><span>add_response_data</span><span class="token" style="color:#111b27">.</span><span>get</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&#x27;success&#x27;</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">None</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">True</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        self</span><span class="token" style="color:#111b27">.</span><span>assertNotEqual</span><span class="token" style="color:#111b27">(</span><span>add_response_data</span><span class="token" style="color:#111b27">.</span><span>get</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&#x27;result&#x27;</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#111b27">{</span><span class="token" style="color:#111b27">}</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">.</span><span>get</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&#x27;taskId&#x27;</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">None</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">None</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        </span><span class="token" style="color:#a04900">print</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;    ok.&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        task_id </span><span class="token" style="color:#a04900">=</span><span> add_response_data</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#116b00">&#x27;result&#x27;</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#116b00">&#x27;taskId&#x27;</span><span class="token" style="color:#111b27">]</span><span>
</span><span>        get_segmentation_task_result_endpoint </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token string-interpolation" style="color:#116b00">f&quot;</span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">self</span><span class="token string-interpolation interpolation" style="color:#111b27">.</span><span class="token string-interpolation interpolation">api_base_url</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">/get-segmentation-task-result?task_id=</span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">task_id</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">&quot;</span><span>
</span><span>        expected_volume_file_url </span><span class="token" style="color:#a04900">=</span><span> path_join</span><span class="token" style="color:#111b27">(</span><span>path_basename</span><span class="token" style="color:#111b27">(</span><span>data_dir</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span> task_id</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;volume.nii.gz&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        expected_segmentation_file_url </span><span class="token" style="color:#a04900">=</span><span> path_join</span><span class="token" style="color:#111b27">(</span><span>path_basename</span><span class="token" style="color:#111b27">(</span><span>data_dir</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span> task_id</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;segmentation.nii.gz&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        print_inline</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;Getting task status &quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        </span><span class="token" style="color:#a04900">while</span><span> </span><span class="token" style="color:#755f00">True</span><span class="token" style="color:#111b27">:</span><span>
</span><span>            get_result_response </span><span class="token" style="color:#a04900">=</span><span> requests</span><span class="token" style="color:#111b27">.</span><span>get</span><span class="token" style="color:#111b27">(</span><span>get_segmentation_task_result_endpoint</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>            self</span><span class="token" style="color:#111b27">.</span><span>assertEqual</span><span class="token" style="color:#111b27">(</span><span>get_result_response</span><span class="token" style="color:#111b27">.</span><span>status_code</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">200</span><span class="token" style="color:#111b27">)</span><span>
</span><span>            self</span><span class="token" style="color:#111b27">.</span><span>assertEqual</span><span class="token" style="color:#111b27">(</span><span>get_result_response</span><span class="token" style="color:#111b27">.</span><span>headers</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#116b00">&#x27;content-type&#x27;</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;application/json&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>            get_result_response_data </span><span class="token" style="color:#a04900">=</span><span> get_result_response</span><span class="token" style="color:#111b27">.</span><span>json</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>            self</span><span class="token" style="color:#111b27">.</span><span>assertEqual</span><span class="token" style="color:#111b27">(</span><span>get_result_response_data</span><span class="token" style="color:#111b27">.</span><span>get</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&#x27;success&#x27;</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">None</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">True</span><span class="token" style="color:#111b27">)</span><span>
</span><span>            self</span><span class="token" style="color:#111b27">.</span><span>assertNotEqual</span><span class="token" style="color:#111b27">(</span><span>get_result_response_data</span><span class="token" style="color:#111b27">.</span><span>get</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&#x27;result&#x27;</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#111b27">{</span><span class="token" style="color:#111b27">}</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">.</span><span>get</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&#x27;status&#x27;</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">None</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">None</span><span class="token" style="color:#111b27">)</span><span>
</span><span>            self</span><span class="token" style="color:#111b27">.</span><span>assertEqual</span><span class="token" style="color:#111b27">(</span><span>get_result_response_data</span><span class="token" style="color:#111b27">.</span><span>get</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&#x27;result&#x27;</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#111b27">{</span><span class="token" style="color:#111b27">}</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">.</span><span>get</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&#x27;taskId&#x27;</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">None</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span> task_id</span><span class="token" style="color:#111b27">)</span><span>
</span><span>            self</span><span class="token" style="color:#111b27">.</span><span>assertEqual</span><span class="token" style="color:#111b27">(</span><span>
</span><span>                get_result_response_data</span><span class="token" style="color:#111b27">.</span><span>get</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&#x27;result&#x27;</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#111b27">{</span><span class="token" style="color:#111b27">}</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">.</span><span>get</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&#x27;volumeFileUrl&#x27;</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">None</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span>
</span>                expected_volume_file_url
<span>            </span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>            print_inline</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;.&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>            </span><span class="token" style="color:#a04900">if</span><span> get_result_response_data</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#116b00">&#x27;result&#x27;</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#116b00">&#x27;status&#x27;</span><span class="token" style="color:#111b27">]</span><span> </span><span class="token" style="color:#a04900">==</span><span> </span><span class="token" style="color:#116b00">&quot;failed&quot;</span><span class="token" style="color:#111b27">:</span><span>
</span><span>                self</span><span class="token" style="color:#111b27">.</span><span>fail</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;Server failed to segment the uploaded volume.&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span><span>                </span><span class="token" style="color:#a04900">break</span><span>
</span>
<span>            </span><span class="token" style="color:#a04900">if</span><span> get_result_response_data</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#116b00">&#x27;result&#x27;</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#116b00">&#x27;status&#x27;</span><span class="token" style="color:#111b27">]</span><span> </span><span class="token" style="color:#a04900">==</span><span> </span><span class="token" style="color:#116b00">&quot;completed&quot;</span><span class="token" style="color:#111b27">:</span><span>
</span><span>                self</span><span class="token" style="color:#111b27">.</span><span>assertEqual</span><span class="token" style="color:#111b27">(</span><span>
</span><span>                    get_result_response_data</span><span class="token" style="color:#111b27">.</span><span>get</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&#x27;result&#x27;</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#111b27">{</span><span class="token" style="color:#111b27">}</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">.</span><span>get</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&#x27;segmentationFileUrl&#x27;</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">None</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">.</span><span>strip</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span>
</span><span>                    expected_segmentation_file_url</span><span class="token" style="color:#111b27">.</span><span>strip</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span><span>                </span><span class="token" style="color:#111b27">)</span><span>
</span><span>                </span><span class="token" style="color:#a04900">break</span><span>
</span>
<span>            sleep</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#755f00">1</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        </span><span class="token" style="color:#a04900">print</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;    ok.&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        print_inline</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;Downloading files ... &quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        volume_file_url </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token string-interpolation" style="color:#116b00">f&quot;</span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">self</span><span class="token string-interpolation interpolation" style="color:#111b27">.</span><span class="token string-interpolation interpolation">base_url</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">/</span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">expected_volume_file_url</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">&quot;</span><span>
</span><span>        segmentation_file_url </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token string-interpolation" style="color:#116b00">f&quot;</span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">self</span><span class="token string-interpolation interpolation" style="color:#111b27">.</span><span class="token string-interpolation interpolation">base_url</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">/</span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">expected_segmentation_file_url</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">&quot;</span><span>
</span>
<span>        temp_dir </span><span class="token" style="color:#a04900">=</span><span> path_join</span><span class="token" style="color:#111b27">(</span><span>tests_dir</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;temp&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        makedirs</span><span class="token" style="color:#111b27">(</span><span>temp_dir</span><span class="token" style="color:#111b27">,</span><span> exist_ok</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">True</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        volume_file_path </span><span class="token" style="color:#a04900">=</span><span> path_join</span><span class="token" style="color:#111b27">(</span><span>temp_dir</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token string-interpolation" style="color:#116b00">f&quot;volume-</span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">time</span><span class="token string-interpolation interpolation" style="color:#111b27">(</span><span class="token string-interpolation interpolation" style="color:#111b27">)</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">.nii.gz&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        segmentation_file_path </span><span class="token" style="color:#a04900">=</span><span> path_join</span><span class="token" style="color:#111b27">(</span><span>temp_dir</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token string-interpolation" style="color:#116b00">f&quot;segmentation-</span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">time</span><span class="token string-interpolation interpolation" style="color:#111b27">(</span><span class="token string-interpolation interpolation" style="color:#111b27">)</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">.nii.gz&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        </span><span class="token" style="color:#a04900">if</span><span> </span><span class="token" style="color:#a04900">not</span><span> download_file</span><span class="token" style="color:#111b27">(</span><span>volume_file_url</span><span class="token" style="color:#111b27">,</span><span> volume_file_path</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>            self</span><span class="token" style="color:#111b27">.</span><span>fail</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;Failed to download volume file from server.&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        print_inline</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;    volume download ok ... &quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        </span><span class="token" style="color:#a04900">if</span><span> </span><span class="token" style="color:#a04900">not</span><span> download_file</span><span class="token" style="color:#111b27">(</span><span>segmentation_file_url</span><span class="token" style="color:#111b27">,</span><span> segmentation_file_path</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>            self</span><span class="token" style="color:#111b27">.</span><span>fail</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;Failed to download segmentation file from server.&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        print_inline</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;    segmentation download ok ... &quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        volume_file_data </span><span class="token" style="color:#a04900">=</span><span> nib_load</span><span class="token" style="color:#111b27">(</span><span>volume_file_path</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">.</span><span>get_fdata</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        segmentation_file_data </span><span class="token" style="color:#a04900">=</span><span> nib_load</span><span class="token" style="color:#111b27">(</span><span>volume_file_path</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">.</span><span>get_fdata</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        self</span><span class="token" style="color:#111b27">.</span><span>assertTupleEqual</span><span class="token" style="color:#111b27">(</span><span>volume_file_data</span><span class="token" style="color:#111b27">.</span><span>shape</span><span class="token" style="color:#111b27">,</span><span> segmentation_file_data</span><span class="token" style="color:#111b27">.</span><span>shape</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        </span><span class="token" style="color:#a04900">print</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;    shapes ok.&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        rmtree</span><span class="token" style="color:#111b27">(</span><span>temp_dir</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span></span><span class="token" style="color:#a04900">if</span><span> __name__ </span><span class="token" style="color:#a04900">==</span><span> </span><span class="token" style="color:#116b00">&quot;__main__&quot;</span><span class="token" style="color:#111b27">:</span><span>
</span><span>    unittest</span><span class="token" style="color:#111b27">.</span><span>main</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span></code></pre>
                </div>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  Let&#x27;s create a new environment for the tests
                </p>
                <div class="MuiBox-root css-dzaqf9">
                  <div class="MuiBox-root css-125pbeb">
                    <button
                      class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho"
                      tabindex="0"
                      type="button"
                    >
                      <svg
                        class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                        focusable="false"
                        aria-hidden="true"
                        viewBox="0 0 24 24"
                        data-testid="ContentCopyIcon"
                      >
                        <path
                          d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"
                        ></path>
                      </svg>
                    </button>
                  </div>
                  <pre
                    style="
                      color: #111b27;
                      background: #e3eaf2;
                      font-family: Consolas, Monaco, &quot;Andale Mono&quot;,
                        &quot;Ubuntu Mono&quot;, monospace;
                      text-align: left;
                      white-space: pre;
                      word-spacing: normal;
                      word-break: normal;
                      word-wrap: normal;
                      line-height: 1.5;
                      -moz-tab-size: 4;
                      -o-tab-size: 4;
                      tab-size: 4;
                      -webkit-hyphens: none;
                      -moz-hyphens: none;
                      -ms-hyphens: none;
                      hyphens: none;
                      padding: 1em;
                      margin: 0;
                      overflow: auto;
                    "
                  ><code class="language-bash" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>python3 -m venv env_test
</span><span></span><span class="token" style="color:#005a8e">source</span><span> env_test/bin/activate</span></code></pre>
                </div>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  And, install the following packages
                </p>
                <div class="MuiBox-root css-dzaqf9">
                  <div class="MuiBox-root css-125pbeb">
                    <button
                      class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho"
                      tabindex="0"
                      type="button"
                    >
                      <svg
                        class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                        focusable="false"
                        aria-hidden="true"
                        viewBox="0 0 24 24"
                        data-testid="ContentCopyIcon"
                      >
                        <path
                          d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"
                        ></path>
                      </svg>
                    </button>
                  </div>
                  <pre
                    style="
                      color: #111b27;
                      background: #e3eaf2;
                      font-family: Consolas, Monaco, &quot;Andale Mono&quot;,
                        &quot;Ubuntu Mono&quot;, monospace;
                      text-align: left;
                      white-space: pre;
                      word-spacing: normal;
                      word-break: normal;
                      word-wrap: normal;
                      line-height: 1.5;
                      -moz-tab-size: 4;
                      -o-tab-size: 4;
                      tab-size: 4;
                      -webkit-hyphens: none;
                      -moz-hyphens: none;
                      -ms-hyphens: none;
                      hyphens: none;
                      padding: 1em;
                      margin: 0;
                      overflow: auto;
                    "
                  ><code class="language-bash" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>pip </span><span class="token" style="color:#7c00aa">install</span><span> requests nibabel</span></code></pre>
                </div>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  We can run the tests by running the following command from the
                  <span class="MuiBox-root css-87x4qo">tests</span> directory:
                </p>
                <div class="MuiBox-root css-dzaqf9">
                  <div class="MuiBox-root css-125pbeb">
                    <button
                      class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho"
                      tabindex="0"
                      type="button"
                    >
                      <svg
                        class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                        focusable="false"
                        aria-hidden="true"
                        viewBox="0 0 24 24"
                        data-testid="ContentCopyIcon"
                      >
                        <path
                          d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"
                        ></path>
                      </svg>
                    </button>
                  </div>
                  <pre
                    style="
                      color: #111b27;
                      background: #e3eaf2;
                      font-family: Consolas, Monaco, &quot;Andale Mono&quot;,
                        &quot;Ubuntu Mono&quot;, monospace;
                      text-align: left;
                      white-space: pre;
                      word-spacing: normal;
                      word-break: normal;
                      word-wrap: normal;
                      line-height: 1.5;
                      -moz-tab-size: 4;
                      -o-tab-size: 4;
                      tab-size: 4;
                      -webkit-hyphens: none;
                      -moz-hyphens: none;
                      -ms-hyphens: none;
                      hyphens: none;
                      padding: 1em;
                      margin: 0;
                      overflow: auto;
                    "
                  ><code class="language-bash" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>python3 test_apis.py</span></code></pre>
                </div>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  You should see an output saying that one test ran
                  successfully.
                </p>
                <h1
                  class="MuiTypography-root MuiTypography-h4 css-rg843f"
                  id="conclusion"
                >
                  <strong>Conclusion</strong>
                </h1>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  We have successfully created and tested the APIs that allow us
                  to convert a CT scan volume into a segmentation using
                  <a
                    class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover css-1vxruma"
                    href="https://github.com/wasserth/TotalSegmentator"
                    rel="noopener noreferrer"
                    target="_blank"
                    >TotalSegmentator</a
                  >.
                </p>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  3D Slicer is a tool that can be used to visualize the
                  segmentations we generated today. If you&#x27;d like to know
                  more about 3D Slicer and how to customize it to fit some of
                  your own requirements, you can check out
                  <a
                    class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover css-1vxruma"
                    href="/full-stack/3d-slicer-extension-tutorials"
                    >this series</a
                  >
                  where I cover how to build a Slicer Extension or specifically
                  <a
                    class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover css-1vxruma"
                    href="/full-stack/3d-slicer-extension-tutorials/3"
                    >this part</a
                  >, in which, we make a Slicer Extension to work with the API
                  we created today.
                </p>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  See you next time :)
                </p>
              </div>
            </div>
          </div>
        </div>
        <style data-emotion="css sdeu8y">
          .css-sdeu8y {
            margin-top: 40px;
            margin-bottom: 40px;
            padding-bottom: 16px;
            width: 100%;
            display: -webkit-box;
            display: -webkit-flex;
            display: -ms-flexbox;
            display: flex;
            -webkit-flex-direction: column;
            -ms-flex-direction: column;
            flex-direction: column;
            -webkit-box-pack: start;
            -ms-flex-pack: start;
            -webkit-justify-content: flex-start;
            justify-content: flex-start;
            -webkit-align-items: center;
            -webkit-box-align: center;
            -ms-flex-align: center;
            align-items: center;
          }
        </style>
        <div class="MuiBox-root css-sdeu8y">
          <style data-emotion="css iyxjf1">
            .css-iyxjf1 {
              box-sizing: border-box;
              display: -webkit-box;
              display: -webkit-flex;
              display: -ms-flexbox;
              display: flex;
              -webkit-box-flex-wrap: wrap;
              -webkit-flex-wrap: wrap;
              -ms-flex-wrap: wrap;
              flex-wrap: wrap;
              width: 100%;
              -webkit-flex-direction: row;
              -ms-flex-direction: row;
              flex-direction: row;
              margin-top: -16px;
              width: calc(100% + 16px);
              margin-left: -16px;
              margin-top: 32px;
              margin-bottom: 32px;
            }
            .css-iyxjf1 > .MuiGrid-item {
              padding-top: 16px;
            }
            .css-iyxjf1 > .MuiGrid-item {
              padding-left: 16px;
            }
          </style>
          <div
            class="MuiGrid-root MuiGrid-container MuiGrid-spacing-xs-2 css-iyxjf1"
          >
            <style data-emotion="css 1etv89n">
              .css-1etv89n {
                box-sizing: border-box;
                margin: 0;
                -webkit-flex-direction: row;
                -ms-flex-direction: row;
                flex-direction: row;
                -webkit-flex-basis: 100%;
                -ms-flex-preferred-size: 100%;
                flex-basis: 100%;
                -webkit-box-flex: 0;
                -webkit-flex-grow: 0;
                -ms-flex-positive: 0;
                flex-grow: 0;
                max-width: 100%;
              }
              @media (min-width: 600px) {
                .css-1etv89n {
                  -webkit-flex-basis: 50%;
                  -ms-flex-preferred-size: 50%;
                  flex-basis: 50%;
                  -webkit-box-flex: 0;
                  -webkit-flex-grow: 0;
                  -ms-flex-positive: 0;
                  flex-grow: 0;
                  max-width: 50%;
                }
              }
              @media (min-width: 900px) {
                .css-1etv89n {
                  -webkit-flex-basis: 33.333333%;
                  -ms-flex-preferred-size: 33.333333%;
                  flex-basis: 33.333333%;
                  -webkit-box-flex: 0;
                  -webkit-flex-grow: 0;
                  -ms-flex-positive: 0;
                  flex-grow: 0;
                  max-width: 33.333333%;
                }
              }
              @media (min-width: 1200px) {
                .css-1etv89n {
                  -webkit-flex-basis: 25%;
                  -ms-flex-preferred-size: 25%;
                  flex-basis: 25%;
                  -webkit-box-flex: 0;
                  -webkit-flex-grow: 0;
                  -ms-flex-positive: 0;
                  flex-grow: 0;
                  max-width: 25%;
                }
              }
              @media (min-width: 1536px) {
                .css-1etv89n {
                  -webkit-flex-basis: 25%;
                  -ms-flex-preferred-size: 25%;
                  flex-basis: 25%;
                  -webkit-box-flex: 0;
                  -webkit-flex-grow: 0;
                  -ms-flex-positive: 0;
                  flex-grow: 0;
                  max-width: 25%;
                }
              }
            </style>
            <div
              class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-12 MuiGrid-grid-sm-6 MuiGrid-grid-md-4 MuiGrid-grid-lg-3 css-1etv89n"
            >
              <a
                style="text-decoration: none"
                href="/full-stack/3d-slicer-extension-tutorials/"
                ><style data-emotion="css 1dp4q5j">
                  .css-1dp4q5j {
                    overflow: hidden;
                    width: 100%;
                    height: 100%;
                    box-shadow: 1px 1px 1px 1px "#eeeeee";
                  }
                  .css-1dp4q5j:hover {
                    box-shadow: 3px 3px 3px 3px "#eeeeee";
                    cursor: pointer;
                  }</style
                ><style data-emotion="css ewbf0o">
                  .css-ewbf0o {
                    background-color: #fff;
                    color: rgba(0, 0, 0, 0.87);
                    -webkit-transition: box-shadow 300ms
                      cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                    transition: box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1)
                      0ms;
                    border-radius: 4px;
                    box-shadow:
                      0px 2px 1px -1px rgba(0, 0, 0, 0.2),
                      0px 1px 1px 0px rgba(0, 0, 0, 0.14),
                      0px 1px 3px 0px rgba(0, 0, 0, 0.12);
                    overflow: hidden;
                    width: 100%;
                    height: 100%;
                    box-shadow: 1px 1px 1px 1px "#eeeeee";
                  }
                  .css-ewbf0o:hover {
                    box-shadow: 3px 3px 3px 3px "#eeeeee";
                    cursor: pointer;
                  }
                </style>
                <div
                  class="MuiPaper-root MuiPaper-elevation MuiPaper-rounded MuiPaper-elevation1 MuiCard-root css-ewbf0o"
                >
                  <style data-emotion="css 146e5oc">
                    .css-146e5oc {
                      display: block;
                      -webkit-background-size: cover;
                      background-size: cover;
                      background-repeat: no-repeat;
                      -webkit-background-position: center;
                      background-position: center;
                      width: 100%;
                      object-fit: cover;
                      object-fit: cover;
                    }</style
                  ><img
                    class="MuiCardMedia-root MuiCardMedia-media MuiCardMedia-img css-146e5oc"
                    src="/media/images/3d-slicer-extension-tutorials-series-thumbnails.jpg"
                    height="150"
                    alt="3D Slicer Extension Tutorials"
                  /><style data-emotion="css 1qw96cp">
                    .css-1qw96cp {
                      padding: 16px;
                    }
                    .css-1qw96cp:last-child {
                      padding-bottom: 24px;
                    }
                  </style>
                  <div class="MuiCardContent-root css-1qw96cp">
                    <style data-emotion="css 4an0mh">
                      .css-4an0mh {
                        margin: 0;
                        font-family: "Roboto", "Helvetica", "Arial", sans-serif;
                        font-weight: 500;
                        font-size: 1.25rem;
                        line-height: 1.6;
                        letter-spacing: 0.0075em;
                        margin-bottom: 0.35em;
                      }
                    </style>
                    <h2
                      class="MuiTypography-root MuiTypography-h6 MuiTypography-gutterBottom css-4an0mh"
                    >
                      <!-- -->3D Slicer Extension Tutorials
                    </h2>
                    <style data-emotion="css r1ev5b">
                      .css-r1ev5b {
                        margin: 0;
                        margin-bottom: 0.35em;
                        overflow: hidden;
                        text-overflow: ellipsis;
                        display: -webkit-box;
                        -webkit-line-clamp: 3;
                        -webkit-box-orient: vertical;
                      }
                    </style>
                    <p
                      class="MuiTypography-root MuiTypography-p MuiTypography-gutterBottom css-r1ev5b"
                    >
                      Learn how to create an extension for 3D Slicer: extract
                      volumes and slices, run ML models, edit segmentations, and
                      much more.
                    </p>
                    <div class="MuiBox-root css-1sdy4c7">
                      <p
                        class="MuiTypography-root MuiTypography-p MuiTypography-gutterBottom css-mxjm1x"
                      >
                        3 Parts
                      </p>
                      <p
                        class="MuiTypography-root MuiTypography-p MuiTypography-gutterBottom css-mxjm1x"
                      >
                        24m Read
                      </p>
                    </div>
                  </div>
                </div></a
              >
            </div>
            <div
              class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-12 MuiGrid-grid-sm-6 MuiGrid-grid-md-4 MuiGrid-grid-lg-3 css-1etv89n"
            >
              <a
                style="text-decoration: none"
                href="/full-stack/3d-slicer-extension-tutorials/3/"
                ><div
                  class="MuiPaper-root MuiPaper-elevation MuiPaper-rounded MuiPaper-elevation1 MuiCard-root css-ewbf0o"
                >
                  <img
                    class="MuiCardMedia-root MuiCardMedia-media MuiCardMedia-img css-146e5oc"
                    src="/media/images/3d-slicer-extension-segmentation-through-custom-api-flow.jpg"
                    height="150"
                    alt="Getting a segment via an API"
                  />
                  <div class="MuiCardContent-root css-1qw96cp">
                    <h2
                      class="MuiTypography-root MuiTypography-h6 MuiTypography-gutterBottom css-4an0mh"
                    >
                      <strong>#<!-- -->3</strong>
                      <!-- -->Getting a segment via an API
                    </h2>
                    <p
                      class="MuiTypography-root MuiTypography-p MuiTypography-gutterBottom css-r1ev5b"
                    >
                      Learn how to segment the loaded volume via an API running
                      a ML model.
                    </p>
                  </div>
                </div></a
              >
            </div>
          </div>
        </div>
      </div>
      <footer style="margin-top: 25px">
        <style data-emotion="css 1uy1rgq">
          .css-1uy1rgq {
            width: 100%;
            display: -webkit-box;
            display: -webkit-flex;
            display: -ms-flexbox;
            display: flex;
            -webkit-flex-direction: column;
            -ms-flex-direction: column;
            flex-direction: column;
            -webkit-box-pack: start;
            -ms-flex-pack: start;
            -webkit-justify-content: flex-start;
            justify-content: flex-start;
            -webkit-align-items: flex-end;
            -webkit-box-align: flex-end;
            -ms-flex-align: flex-end;
            align-items: flex-end;
            padding-top: 200px;
            border-top: 1px solid black;
          }
        </style>
        <div class="MuiBox-root css-1uy1rgq">
          <img
            src="/media/images/main-contact-email-light.jpg"
            style="width: 250px; height: 27px"
          /><style data-emotion="css 1uk1gs8">
            .css-1uk1gs8 {
              margin: 0;
            }</style
          ><span class="MuiTypography-root MuiTypography-p css-1uk1gs8"
            >We typically reply within 24 hours.</span
          ><style data-emotion="css zq6grw">
            .css-zq6grw {
              margin: 0;
              font-family: "Roboto", "Helvetica", "Arial", sans-serif;
              font-weight: 400;
              font-size: 1.5rem;
              line-height: 1.334;
              letter-spacing: 0em;
            }
          </style>
          <h5 class="MuiTypography-root MuiTypography-h5 css-zq6grw">
            © 2024
            <!-- -->A Nice Teacher
          </h5>
        </div>
      </footer>
    </div>
    <script
      src="/_next/static/chunks/webpack-83486951edee0db5.js"
      async=""
    ></script>
    <script>
      (self.__next_f = self.__next_f || []).push([0]);
      self.__next_f.push([2, null]);
    </script>
    <script>
      self.__next_f.push([
        1,
        '1:HL["/_next/static/css/1d4d01086947be98.css","style"]\n',
      ]);
    </script>
    <script>
      self.__next_f.push([
        1,
        '2:I[5751,[],""]\n5:I[9275,[],""]\n8:I[1343,[],""]\n9:I[6871,["98","static/chunks/98-98337b3bb708bd24.js","748","static/chunks/748-1f14ee6eb3d7029a.js","271","static/chunks/271-37a22bace913f735.js","185","static/chunks/app/layout-08611f287dda1230.js"],"default"]\na:I[5877,["98","static/chunks/98-98337b3bb708bd24.js","748","static/chunks/748-1f14ee6eb3d7029a.js","271","static/chunks/271-37a22bace913f735.js","185","static/chunks/app/layout-08611f287dda1230.js"],"default"]\nb:I[902,["98","static/chunks/98-98337b3bb708bd24.js","748","static/chunks/748-1f14ee6eb3d7029a.js","271","static/chunks/271-37a22bace913f735.js","185","static/chunks/app/layout-08611f287dda1230.js"],""]\nc:I[5218,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],""]\nd:I[2324,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],"default"]\ne:I[2591,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],""]\nf:I[231,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],""]\n10:I[3180,["98","static/c',
      ]);
    </script>
    <script>
      self.__next_f.push([
        1,
        'hunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],""]\n11:I[3245,["98","static/chunks/98-98337b3bb708bd24.js","748","static/chunks/748-1f14ee6eb3d7029a.js","271","static/chunks/271-37a22bace913f735.js","185","static/chunks/app/layout-08611f287dda1230.js"],"default"]\n13:I[6130,[],""]\n6:["categorySlug","ml-ops","d"]\n7:["postOrSeriesSlug","total-segmentator-api-with-huey","d"]\n14:[]\n',
      ]);
    </script>
    <script>
      self.__next_f.push([
        1,
        '0:[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/1d4d01086947be98.css","precedence":"next","crossOrigin":"$undefined"}]],["$","$L2",null,{"buildId":"WaLb_sZ3RF-6dnakeG92A","assetPrefix":"","initialCanonicalUrl":"/ml-ops/total-segmentator-api-with-huey/","initialTree":["",{"children":[["categorySlug","ml-ops","d"],{"children":[["postOrSeriesSlug","total-segmentator-api-with-huey","d"],{"children":["__PAGE__?{\\"categorySlug\\":\\"ml-ops\\",\\"postOrSeriesSlug\\":\\"total-segmentator-api-with-huey\\"}",{}]}]}]},"$undefined","$undefined",true],"initialSeedData":["",{"children":[["categorySlug","ml-ops","d"],{"children":[["postOrSeriesSlug","total-segmentator-api-with-huey","d"],{"children":["__PAGE__",{},[["$L3","$L4"],null],null]},["$","$L5",null,{"parallelRouterKey":"children","segmentPath":["children","$6","children","$7","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L8",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}],null]},["$","$L5",null,{"parallelRouterKey":"children","segmentPath":["children","$6","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L8",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}],null]},[["$","html",null,{"lang":"en","suppressHydrationWarning":true,"children":["$","body",null,{"className":"__className_d65c78","children":["$","$L9",null,{"children":[["$","$La",null,{}],["$","$Lb",null,{"maxWidth":"lg","children":[["$","$L5",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L8",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":["$","$Lc",null,{"children":[["$","$Ld",null,{"render":false,"targetSiteNavigationState":[],"targetPageNavigationState":[]}],["$","$Le",null,{"variant":"h4","children":["$","strong",null,{"children":"Not Found"}]}],["$","$Le",null,{"variant":"h6","mb":3,"children":"Oops! It looks like the page you\'re looking for does not exist."}],["$","$Lf",null,{"href":"/","children":["$","$L10",null,{"variant":"contained","sx":{"marginRight":5,"marginBottom":1},"children":"Take me Home"}]}]]}],"notFoundStyles":[],"styles":null}],["$","$L11",null,{}]]}]]}]}]}],null],null],"couldBeIntercepted":false,"initialHead":[false,"$L12"],"globalErrorComponent":"$13","missingSlots":"$W14"}]]\n',
      ]);
    </script>
    <script>
      self.__next_f.push([
        1,
        '12:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","1",{"charSet":"utf-8"}],["$","link","2",{"rel":"icon","href":"/favicon.ico","type":"image/x-icon","sizes":"16x16"}]]\n3:null\n',
      ]);
    </script>
    <script>
      self.__next_f.push([
        1,
        '15:I[3507,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],""]\n17:I[4204,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],"default"]\n18:I[1847,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],"default"]\n19:I[8125,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],""]\n1a:I[3578,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],"default"]\n1b:I[7005,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],""]\n1c:I[',
      ]);
    </script>
    <script>
      self.__next_f.push([
        1,
        '6480,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],"default"]\n1d:T4b3,from os import environ\nfrom os.path import join as path_join\nfrom subprocess import run as subprocess_run, CalledProcessError\nfrom time import sleep\n\nfrom huey import RedisHuey\n\nfrom src.redis_client import redis_client\nfrom src.dirs import data_dir\n\n\nredis_host = environ["REDIS_HOST"]\ntask_delay = float(environ.get("TASK_DELAY", 0))\n\nhuey = RedisHuey(\'entrypoint\', host=redis_host)\n\ntask_status_map_name = "segmentation_task_status"\n\n\n@huey.task()\ndef segment_volume(task_id):\n    volume_path = path_join(data_dir, task_id, "volume.nii.gz")\n    segmentation_path = path_join(data_dir, task_id, "segmentation.nii.gz")\n\n    redis_client.hset(task_status_map_name, task_id, "processing")\n\n    run_total_segmentator_command = f"TotalSegmentator -i {volume_path} -o {segmentation_path} --ml"\n\n    try:\n        _result = subprocess_run(run_total_segmentator_command, shell=True, check=True)\n        redis_client.hset(task_status_map_name, task_id, "completed")\n    except CalledProcessError as _e:\n        print(f"Failed to segment volume for task_id {task_id}.")\n        print(f"    segmentation command: {run_total_segmentator_command}")\n        redis_client.hset(task_status_map_name, task_id, "failed")1e:T728,from os import makedirs\nfrom os.path import basename as path_basename, join as path_join\nfrom uuid import uuid4\n\nfrom fastapi import FastAPI, UploadFile, File\nfrom fastapi.responses import JSONResponse\nfrom fastapi.staticfiles import StaticFiles\n\nfrom src.dirs import data_dir\nfrom src.redis_client import redis_client\nfrom src.tasks import segment_volume, task_status_map_name\n\n\napp = FastAPI()\napp.mount("/data", StaticFiles(directory=data_dir), name="data_dir")\n\n\n@app.post("/api/add-seg',
      ]);
    </script>
    <script>
      self.__next_f.push([
        1,
        "mentation-task\")\nasync def upload_file(file: UploadFile = File(...)):\n    task_id = str(uuid4())\n    task_dir = path_join(data_dir, task_id)\n    makedirs(task_dir)\n\n    volume_save_path = path_join(task_dir, \"volume.nii.gz\")\n\n    # Save the file to the disk\n    with open(volume_save_path, \"wb\") as buffer:\n        while True:\n            chunk = await file.read(10000)\n            if not chunk:\n                break\n\n            buffer.write(chunk)\n\n    # Queue the task\n    redis_client.hset(task_status_map_name, task_id, \"queued\")\n    segment_volume(task_id)\n\n    return JSONResponse(content={\n        'success': True,\n        'result': {\n            'taskId': task_id,\n        },\n    }, status_code=206)\n\n\n@app.get(\"/api/get-segmentation-task-result\")\nasync def get_segmentation(task_id: str):\n    task_status = redis_client.hget(task_status_map_name, task_id)\n\n    response_content = {\n        'success': True,\n        'result': {\n            'taskId': task_id,\n            'status': task_status,\n            'volumeFileUrl': path_join(path_basename(data_dir), task_id, \"volume.nii.gz\"),\n        },\n    }\n\n    if task_status == \"completed\":\n        response_content['result']['segmentationFileUrl'] = path_join(path_basename(data_dir), task_id, \"segmentation.nii.gz\")\n\n    return JSONResponse(content=response_content, status_code=200)1f:T60f,task_id = add_response_data['result']['taskId']\nget_segmentation_task_result_endpoint = f\"{self.api_base_url}/get-segmentation-task-result?task_id={task_id}\"\nexpected_volume_file_url = path_join(path_basename(data_dir), task_id, \"volume.nii.gz\")\nexpected_segmentation_file_url = path_join(path_basename(data_dir), task_id, \"segmentation.nii.gz\")\n\nprint_inline(\"Getting task status \")\n\nwhile True:\n    get_result_response = requests.get(get_segmentation_task_result_endpoint)\n\n    self.assertEqual(get_result_response.status_code, 200)\n    self.assertEqual(get_result_response.headers['content-type'], \"application/json\")\n\n    get_result_response_data = get_result_response.json()\n\n    self.assertEq",
      ]);
    </script>
    <script>
      self.__next_f.push([
        1,
        "ual(get_result_response_data.get('success', None), True)\n    self.assertNotEqual(get_result_response_data.get('result', {}).get('status', None), None)\n    self.assertEqual(get_result_response_data.get('result', {}).get('taskId', None), task_id)\n    self.assertEqual(\n        get_result_response_data.get('result', {}).get('volumeFileUrl', None),\n        expected_volume_file_url\n    )\n\n    print_inline(\".\")\n\n    if get_result_response_data['result']['status'] == \"failed\":\n        self.fail(\"Server failed to segment the uploaded volume.\")\n        break\n\n    if get_result_response_data['result']['status'] == \"completed\":\n        self.assertEqual(\n            get_result_response_data.get('result', {}).get('segmentationFileUrl', None).strip(),\n            expected_segmentation_file_url.strip()\n        )\n        break\n\n    sleep(1)\n\nprint(\"    ok.\")20:T1065,",
      ]);
    </script>
    <script>
      self.__next_f.push([
        1,
        'from os import makedirs\nfrom os.path import basename as path_basename, join as path_join\nfrom shutil import rmtree\nfrom time import sleep, time\nimport unittest\n\nfrom nibabel import load as nib_load\nimport requests\n\nfrom dirs import data_dir, tests_dir\nfrom utils import download_file, print_inline\n\n\nclass TestAPIs(unittest.TestCase):\n    base_url = "http://localhost:8000"\n    api_base_url = "http://localhost:8000/api"\n    test_volume_path = path_join(data_dir, "testing", "volume.nii.gz")\n\n\n    def test_add_segmentation_task_and_get_result(self):\n        add_segmentation_task_endpoint = f"{self.api_base_url}/add-segmentation-task"\n\n        print_inline("Adding task ...")\n\n        with open(self.test_volume_path, "rb") as f:\n            files = {"file": f}\n            add_response = requests.post(add_segmentation_task_endpoint, files=files)\n\n        self.assertEqual(add_response.status_code, 206)\n        self.assertEqual(add_response.headers[\'content-type\'], "application/json")\n\n        add_response_data = add_response.json()\n\n        self.assertEqual(add_response_data.get(\'success\', None), True)\n        self.assertNotEqual(add_response_data.get(\'result\', {}).get(\'taskId\', None), None)\n\n        print("    ok.")\n\n        task_id = add_response_data[\'result\'][\'taskId\']\n        get_segmentation_task_result_endpoint = f"{self.api_base_url}/get-segmentation-task-result?task_id={task_id}"\n        expected_volume_file_url = path_join(path_basename(data_dir), task_id, "volume.nii.gz")\n        expected_segmentation_file_url = path_join(path_basename(data_dir), task_id, "segmentation.nii.gz")\n\n        print_inline("Getting task status ")\n\n        while True:\n            get_result_response = requests.get(get_segmentation_task_result_endpoint)\n\n            self.assertEqual(get_result_response.status_code, 200)\n            self.assertEqual(get_result_response.headers[\'content-type\'], "application/json")\n\n            get_result_response_data = get_result_response.json()\n\n            self.assertEqual(get_result_response_data.get(\'success\', None), True)\n            self.assertNotEqual(get_result_response_data.get(\'result\', {}).get(\'status\', None), None)\n            self.assertEqual(get_result_response_data.get(\'result\', {}).get(\'taskId\', None), task_id)\n            self.assertEqual(\n                get_result_response_data.get(\'result\', {}).get(\'volumeFileUrl\', None),\n                expected_volume_file_url\n            )\n\n            print_inline(".")\n\n            if get_result_response_data[\'result\'][\'status\'] == "failed":\n                self.fail("Server failed to segment the uploaded volume.")\n                break\n\n            if get_result_response_data[\'result\'][\'status\'] == "completed":\n                self.assertEqual(\n                    get_result_response_data.get(\'result\', {}).get(\'segmentationFileUrl\', None).strip(),\n                    expected_segmentation_file_url.strip()\n                )\n                break\n\n            sleep(1)\n\n        print("    ok.")\n\n        print_inline("Downloading files ... ")\n\n        volume_file_url = f"{self.base_url}/{expected_volume_file_url}"\n        segmentation_file_url = f"{self.base_url}/{expected_segmentation_file_url}"\n\n        temp_dir = path_join(tests_dir, "temp")\n        makedirs(temp_dir, exist_ok=True)\n\n        volume_file_path = path_join(temp_dir, f"volume-{time()}.nii.gz")\n        segmentation_file_path = path_join(temp_dir, f"segmentation-{time()}.nii.gz")\n\n        if not download_file(volume_file_url, volume_file_path):\n            self.fail("Failed to download volume file from server.")\n        print_inline("    volume download ok ... ")\n\n        if not download_file(segmentation_file_url, segmentation_file_path):\n            self.fail("Failed to download segmentation file from server.")\n        print_inline("    segmentation download ok ... ")\n\n        volume_file_data = nib_load(volume_file_path).get_fdata()\n        segmentation_file_data = nib_load(volume_file_path).get_fdata()\n\n        self.assertTupleEqual(volume_file_data.shape, segmentation_file_data.shape)\n        print("    shapes ok.")\n\n        rmtree(temp_dir)\n\nif __name__ == "__main__":\n    unittest.main()',
      ]);
    </script>
    <script>
      self.__next_f.push([
        1,
        '4:["$","$Lc",null,{"mb":5,"pb":2,"sx":{"width":"100%","display":"flex","flexDirection":"column","justifyContent":"flex-start","alignItems":"flex-start"},"children":[["$","$Ld",null,{"render":true,"targetSiteNavigationState":[{"absoluteSlug":"/ml-ops","title":"ML Ops"},{"absoluteSlug":"/ml-ops/total-segmentator-api-with-huey","title":"Running ML inference through a Huey Task Queue and FastAPI"}],"targetPageNavigationState":[{"title":"Server and Worker","absoluteSlug":"#server-and-worker"},{"title":"Interacting with Redis","absoluteSlug":"#interacting-with-redis"},{"title":"Redis Server","absoluteSlug":"#redis-server"},{"title":"Redis Client","absoluteSlug":"#redis-client"},{"title":"Tasks","absoluteSlug":"#tasks"},{"title":"FastAPI Server","absoluteSlug":"#fastapi-server"},{"title":"Running the App","absoluteSlug":"#running-the-app"},{"title":"Server","absoluteSlug":"#server"},{"title":"Worker","absoluteSlug":"#worker"},{"title":"Tests","absoluteSlug":"#tests"},{"title":"Conclusion","absoluteSlug":"#conclusion"}]}],["$","$L15",null,{"container":true,"spacing":2,"mb":0,"children":[["$","$L15",null,{"item":true,"xs":12,"sm":12,"md":4,"sx":{"background":"linear-gradient(to right, #eeeeee, #ffffff)","borderRadius":5},"children":["$","$Lc",null,{"sx":{"width":"100%","height":"100%","display":"flex","flexDirection":"column","justifyContent":"center","alignItems":"flex-start","paddingBottom":2},"children":[["$","$Le",null,{"gutterBottom":true,"variant":"h5","component":"h1","children":"Running ML inference through a Huey Task Queue and FastAPI"}],["$","$Le",null,{"gutterBottom":true,"variant":"p","component":"p","mb":4,"children":"Learn how to train a simple CNN in PyTorch and how to convert it to ONNX for deployment."}],["$","$Lc",null,{"sx":{"width":"100%","display":"flex","flexDirection":"row","justifyContent":"space-between","alignItems":"center","marginBottom":2},"children":[["$","$Le",null,{"gutterBottom":true,"variant":"p","component":"p","children":"August 26, 2024"}],["$","$Le",null,{"gutterBottom":true,"variant":"p","component":"p","children":["07m"," Read"]}]]}],"$L16",false]}]}],["$","$L15",null,{"item":true,"xs":12,"sm":12,"md":8,"children":["$","$Lc",null,{"sx":{"flex":1,"display":"flex","flexDirection":"column","justifyContent":"center","alignItems":"center","marginRight":2},"children":["$","img",null,{"src":"/media/images/total-segmentator-api-with-huey-system-architecture-diagram.jpg","style":{"width":"100%","maxWidth":"75vw","height":"auto","maxHeight":"35vh","objectFit":"cover"}}]}]}]]}],["$","$Lc",null,{"sx":{"width":"100%"},"children":["$","$L15",null,{"container":true,"spacing":2,"mt":4,"mb":0,"children":[["$","$L15",null,{"item":true,"xs":12,"sm":12,"md":4,"lg":3,"sx":{"background":"linear-gradient(to right, #eeeeee, #ffffff)","borderRadius":5},"children":["$","$Lc",null,{"sx":{"width":"100%"},"children":[["$","$Lc",null,{"sx":{"width":"100%","display":{"xs":"block","md":"none"},"marginBottom":2},"children":["$","$L17",null,{"sx":{"width":"100%","marginBottom":2,"boxShadow":3,"backgroundColor":"#ffffff22"},"disableGutters":true,"children":[["$","$L18",null,{"expandIcon":["$","$L19",null,{}],"children":["$","$Le",null,{"variant":"h6","component":"h6","sx":{"margin":0,"padding":0},"children":"Table of Contents"}]}],["$","$L1a",null,{"sx":{"width":"90%","display":"flex","flexDirection":"column","justifyContent":"flex-start","alignItems":"flex-start","marginBottom":2},"children":[["$","a","0",{"href":"#server-and-worker","style":{"textDecoration":"none","color":"inherit","\u0026:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Le","0",{"variant":"p","component":"p","ml":0,"mb":2.5,"sx":{"\u0026:hover":{"color":"blue"}},"children":"Server and Worker"}]}],["$","a","1",{"href":"#interacting-with-redis","style":{"textDecoration":"none","color":"inherit","\u0026:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Le","1",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"\u0026:hover":{"color":"blue"}},"children":"Interacting with Redis"}]}],["$","a","2",{"href":"#redis-server","style":{"textDecoration":"none","color":"inherit","\u0026:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Le","2",{"variant":"p","component":"p","ml":2,"mb":1.5,"sx":{"\u0026:hover":{"color":"blue"}},"children":"Redis Server"}]}],["$","a","3",{"href":"#redis-client","style":{"textDecoration":"none","color":"inherit","\u0026:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Le","3",{"variant":"p","component":"p","ml":2,"mb":1.5,"sx":{"\u0026:hover":{"color":"blue"}},"children":"Redis Client"}]}],["$","a","4",{"href":"#tasks","style":{"textDecoration":"none","color":"inherit","\u0026:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Le","4",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"\u0026:hover":{"color":"blue"}},"children":"Tasks"}]}],["$","a","5",{"href":"#fastapi-server","style":{"textDecoration":"none","color":"inherit","\u0026:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Le","5",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"\u0026:hover":{"color":"blue"}},"children":"FastAPI Server"}]}],["$","a","6",{"href":"#running-the-app","style":{"textDecoration":"none","color":"inherit","\u0026:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Le","6",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"\u0026:hover":{"color":"blue"}},"children":"Running the App"}]}],["$","a","7",{"href":"#server","style":{"textDecoration":"none","color":"inherit","\u0026:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Le","7",{"variant":"p","component":"p","ml":2,"mb":1.5,"sx":{"\u0026:hover":{"color":"blue"}},"children":"Server"}]}],["$","a","8",{"href":"#worker","style":{"textDecoration":"none","color":"inherit","\u0026:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Le","8",{"variant":"p","component":"p","ml":2,"mb":1.5,"sx":{"\u0026:hover":{"color":"blue"}},"children":"Worker"}]}],["$","a","9",{"href":"#tests","style":{"textDecoration":"none","color":"inherit","\u0026:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Le","9",{"variant":"p","component":"p","ml":0,"mb":2.5,"sx":{"\u0026:hover":{"color":"blue"}},"children":"Tests"}]}],["$","a","10",{"href":"#conclusion","style":{"textDecoration":"none","color":"inherit","\u0026:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Le","10",{"variant":"p","component":"p","ml":0,"mb":2.5,"sx":{"\u0026:hover":{"color":"blue"}},"children":"Conclusion"}]}]]}]]}]}],["$","$Lc",null,{"sx":{"width":"100%","display":{"xs":"none","md":"block"}},"children":[["$","$Le",null,{"variant":"h5","component":"h5","sx":{"margin":0,"padding":0},"children":"Table of Contents"}],[["$","a","0",{"href":"#server-and-worker","style":{"textDecoration":"none","color":"inherit","\u0026:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Le","0",{"variant":"p","component":"p","ml":0,"mb":2.5,"sx":{"\u0026:hover":{"color":"blue"}},"children":"Server and Worker"}]}],["$","a","1",{"href":"#interacting-with-redis","style":{"textDecoration":"none","color":"inherit","\u0026:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Le","1",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"\u0026:hover":{"color":"blue"}},"children":"Interacting with Redis"}]}],["$","a","2",{"href":"#redis-server","style":{"textDecoration":"none","color":"inherit","\u0026:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Le","2",{"variant":"p","component":"p","ml":2,"mb":1.5,"sx":{"\u0026:hover":{"color":"blue"}},"children":"Redis Server"}]}],["$","a","3",{"href":"#redis-client","style":{"textDecoration":"none","color":"inherit","\u0026:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Le","3",{"variant":"p","component":"p","ml":2,"mb":1.5,"sx":{"\u0026:hover":{"color":"blue"}},"children":"Redis Client"}]}],["$","a","4",{"href":"#tasks","style":{"textDecoration":"none","color":"inherit","\u0026:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Le","4",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"\u0026:hover":{"color":"blue"}},"children":"Tasks"}]}],["$","a","5",{"href":"#fastapi-server","style":{"textDecoration":"none","color":"inherit","\u0026:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Le","5",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"\u0026:hover":{"color":"blue"}},"children":"FastAPI Server"}]}],["$","a","6",{"href":"#running-the-app","style":{"textDecoration":"none","color":"inherit","\u0026:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Le","6",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"\u0026:hover":{"color":"blue"}},"children":"Running the App"}]}],["$","a","7",{"href":"#server","style":{"textDecoration":"none","color":"inherit","\u0026:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Le","7",{"variant":"p","component":"p","ml":2,"mb":1.5,"sx":{"\u0026:hover":{"color":"blue"}},"children":"Server"}]}],["$","a","8",{"href":"#worker","style":{"textDecoration":"none","color":"inherit","\u0026:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Le","8",{"variant":"p","component":"p","ml":2,"mb":1.5,"sx":{"\u0026:hover":{"color":"blue"}},"children":"Worker"}]}],["$","a","9",{"href":"#tests","style":{"textDecoration":"none","color":"inherit","\u0026:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Le","9",{"variant":"p","component":"p","ml":0,"mb":2.5,"sx":{"\u0026:hover":{"color":"blue"}},"children":"Tests"}]}],["$","a","10",{"href":"#conclusion","style":{"textDecoration":"none","color":"inherit","\u0026:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Le","10",{"variant":"p","component":"p","ml":0,"mb":2.5,"sx":{"\u0026:hover":{"color":"blue"}},"children":"Conclusion"}]}]]]}]]}]}],["$","$L15",null,{"item":true,"xs":12,"sm":12,"md":8,"lg":9,"sx":{"background":"linear-gradient(to right, #ffffff, #eeeeee)","borderRadius":5},"children":["$","$Lc",null,{"sx":{"flex":1,"marginRight":2},"children":[["$","$Le","0",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","In today\'s Post, we\'ll build a REST API that allows us to segment CT volumes using ",["$","$L1b","0-link",{"href":"https://github.com/wasserth/TotalSegmentator","rel":"noopener noreferrer","target":"_blank","color":"primary","underline":"hover","children":"TotalSegmentator"}],". Our system will involve two applications connected through the ",["$","$L1b","0-link",{"href":"https://huey.readthedocs.io/en/latest/","rel":"noopener noreferrer","target":"_blank","color":"primary","underline":"hover","children":"Huey"}]," task queue: a server that a client-side application can interact with to upload volumes and queue segmentation tasks and a worker application that consumes these tasks to segment the uploaded volumes and save the results."]}],["$","$Le","1",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Here\'s an image describing the System Architecture:"]}],["$","$Lc","2",{"sx":{"width":"100%","display":"flex","flexDirection":"column","justifyContent":"center","alignItems":"center","marginBottom":2},"children":["$","img",null,{"src":"/media/images/total-segmentator-api-with-huey-system-architecture-diagram.jpg","style":{"width":"100%","maxWidth":"75vw","height":"auto","maxHeight":"35vh","objectFit":"cover"}}]}],["$","$Le","3",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","You can find the code for this project in ",["$","$L1b","3-link",{"href":"https://github.com/AbhilakshSinghReen/ct-to-3d-model/tree/segmentation-only","rel":"noopener noreferrer","target":"_blank","color":"primary","underline":"hover","children":"this GitHub Repository"}],"."]}],["$","$Le","4",{"id":"server-and-worker","variant":"h4","component":"h1","mb":2,"children":["$","strong",null,{"children":"Server and Worker"}]}],["$","$Le","5",{"id":"interacting-with-redis","variant":"h5","component":"h2","mb":2,"children":["$","strong",null,{"children":"Interacting with Redis"}]}],["$","$Le","6",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","We\'ll be using Redis for two purposes:"]}],["$","$Le","7",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","1) As the Huey task broker."]}],["$","$Le","8",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","1) For storing the statuses of our tasks."]}],["$","$Le","9",{"id":"redis-server","variant":"h6","component":"h3","mb":2,"children":["$","strong",null,{"children":"Redis Server"}]}],["$","$Le","10",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","We can run a lightweight Redis Docker container for development purposes"]}],["$","$Lc",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L1c",null,{"contentToCopy":"docker run -d --name redis-dev -p 6379:6379 redis:7.2.4-alpine"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-bash","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#7c00aa"},"children":["docker"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" run -d --name redis-dev -p "]}],["$","span","code-segement2",{"className":"token","style":{"color":"#755f00"},"children":["6379"]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":[":6379 redis:7.2.4-alpine"]}]]]}]}]]}],["$","$Le","12",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","A list of Redis Docker images can be found ",["$","$L1b","12-link",{"href":"https://hub.docker.com/_/redis","rel":"noopener noreferrer","target":"_blank","color":"primary","underline":"hover","children":"here"}],"."]}],["$","$Le","13",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Then, check if the Redis container started."]}],["$","$Lc",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L1c",null,{"contentToCopy":"docker ps"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-bash","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#7c00aa"},"children":["docker"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement2",{"className":"token","style":{"color":"#7c00aa"},"children":["ps"]}]]]}]}]]}],["$","$Le","15",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","You should see a container with the name ",["$","$Lc","15-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"redis-dev"}]," up and running."]}],["$","$Le","16",{"id":"redis-client","variant":"h6","component":"h3","mb":2,"children":["$","strong",null,{"children":"Redis Client"}]}],["$","$Le","17",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Inside our project\'s directory, let\'s create a folder called ",["$","$Lc","17-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"server-worker"}],", and inside it create another folder called ",["$","$Lc","17-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"src"}],". Inside this folder, we create a file called ",["$","$Lc","17-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"redis_client.py"}],"."]}],["$","$Lc",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L1c",null,{"contentToCopy":"from os import environ\\n\\nfrom redis import Redis\\n\\n\\nredis_host = environ[\\"REDIS_HOST\\"]\\nredis_port = environ[\\"REDIS_PORT\\"]\\nredis_db = environ[\\"REDIS_DB\\"]\\nredis_password = environ.get(\\"REDIS_PASSWORD\\", None)\\n\\nredis_client = Redis(host=redis_host, port=redis_port, db=redis_db, password=redis_password, decode_responses=True)"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" os "]}],["$","span","code-segement2",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":[" environ\\n"]}],"\\n",["$","span","code-segement5",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement6",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement7",{"className":"$undefined","style":{},"children":[" redis "]}],["$","span","code-segement8",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement9",{"className":"$undefined","style":{},"children":[" Redis\\n"]}],"\\n","\\n",["$","span","code-segement12",{"className":"$undefined","style":{},"children":["redis_host "]}],["$","span","code-segement13",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement14",{"className":"$undefined","style":{},"children":[" environ"]}],["$","span","code-segement15",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement16",{"className":"token","style":{"color":"#116b00"},"children":["\\"REDIS_HOST\\""]}],["$","span","code-segement17",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement18",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement19",{"className":"$undefined","style":{},"children":["redis_port "]}],["$","span","code-segement20",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement21",{"className":"$undefined","style":{},"children":[" environ"]}],["$","span","code-segement22",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement23",{"className":"token","style":{"color":"#116b00"},"children":["\\"REDIS_PORT\\""]}],["$","span","code-segement24",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement25",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":["redis_db "]}],["$","span","code-segement27",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement28",{"className":"$undefined","style":{},"children":[" environ"]}],["$","span","code-segement29",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement30",{"className":"token","style":{"color":"#116b00"},"children":["\\"REDIS_DB\\""]}],["$","span","code-segement31",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement32",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement33",{"className":"$undefined","style":{},"children":["redis_password "]}],["$","span","code-segement34",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement35",{"className":"$undefined","style":{},"children":[" environ"]}],["$","span","code-segement36",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement37",{"className":"$undefined","style":{},"children":["get"]}],["$","span","code-segement38",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement39",{"className":"token","style":{"color":"#116b00"},"children":["\\"REDIS_PASSWORD\\""]}],["$","span","code-segement40",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement41",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement42",{"className":"token","style":{"color":"#755f00"},"children":["None"]}],["$","span","code-segement43",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement44",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement46",{"className":"$undefined","style":{},"children":["redis_client "]}],["$","span","code-segement47",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement48",{"className":"$undefined","style":{},"children":[" Redis"]}],["$","span","code-segement49",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement50",{"className":"$undefined","style":{},"children":["host"]}],["$","span","code-segement51",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement52",{"className":"$undefined","style":{},"children":["redis_host"]}],["$","span","code-segement53",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement54",{"className":"$undefined","style":{},"children":[" port"]}],["$","span","code-segement55",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement56",{"className":"$undefined","style":{},"children":["redis_port"]}],["$","span","code-segement57",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement58",{"className":"$undefined","style":{},"children":[" db"]}],["$","span","code-segement59",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement60",{"className":"$undefined","style":{},"children":["redis_db"]}],["$","span","code-segement61",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement62",{"className":"$undefined","style":{},"children":[" password"]}],["$","span","code-segement63",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement64",{"className":"$undefined","style":{},"children":["redis_password"]}],["$","span","code-segement65",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement66",{"className":"$undefined","style":{},"children":[" decode_responses"]}],["$","span","code-segement67",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement68",{"className":"token","style":{"color":"#755f00"},"children":["True"]}],["$","span","code-segement69",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Le","19",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","We can create an empty file ",["$","$Lc","19-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"__init__.py"}]," in the ",["$","$Lc","19-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"server-worker/src"}]," folder to turn this into an importable package."]}],["$","$Le","20",{"id":"tasks","variant":"h5","component":"h2","mb":2,"children":["$","strong",null,{"children":"Tasks"}]}],["$","$Le","21",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Inside the same folder, let\'s create a file called ",["$","$Lc","21-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"dirs.py"}]," to store some directory paths for our convenience."]}],["$","$Lc",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L1c",null,{"contentToCopy":"from os import makedirs\\nfrom os.path import dirname, join as path_join\\n\\n\\nsrc_dir = dirname(__file__)\\nserver_worker_dir = dirname(src_dir)\\nproject_dir = dirname(server_worker_dir)\\ndata_dir = path_join(project_dir, \\"data\\")\\n\\nmakedirs(data_dir, exist_ok=True)"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" os "]}],["$","span","code-segement2",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":[" makedirs\\n"]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement5",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement6",{"className":"$undefined","style":{},"children":[" os"]}],["$","span","code-segement7",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":["path "]}],["$","span","code-segement9",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":[" dirname"]}],["$","span","code-segement11",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement12",{"className":"$undefined","style":{},"children":[" join "]}],["$","span","code-segement13",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement14",{"className":"$undefined","style":{},"children":[" path_join\\n"]}],"\\n","\\n",["$","span","code-segement17",{"className":"$undefined","style":{},"children":["src_dir "]}],["$","span","code-segement18",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement19",{"className":"$undefined","style":{},"children":[" dirname"]}],["$","span","code-segement20",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement21",{"className":"$undefined","style":{},"children":["__file__"]}],["$","span","code-segement22",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement23",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement24",{"className":"$undefined","style":{},"children":["server_worker_dir "]}],["$","span","code-segement25",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":[" dirname"]}],["$","span","code-segement27",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement28",{"className":"$undefined","style":{},"children":["src_dir"]}],["$","span","code-segement29",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement30",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement31",{"className":"$undefined","style":{},"children":["project_dir "]}],["$","span","code-segement32",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement33",{"className":"$undefined","style":{},"children":[" dirname"]}],["$","span","code-segement34",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement35",{"className":"$undefined","style":{},"children":["server_worker_dir"]}],["$","span","code-segement36",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement37",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement38",{"className":"$undefined","style":{},"children":["data_dir "]}],["$","span","code-segement39",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement40",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement41",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement42",{"className":"$undefined","style":{},"children":["project_dir"]}],["$","span","code-segement43",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement44",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement45",{"className":"token","style":{"color":"#116b00"},"children":["\\"data\\""]}],["$","span","code-segement46",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement47",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement49",{"className":"$undefined","style":{},"children":["makedirs"]}],["$","span","code-segement50",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement51",{"className":"$undefined","style":{},"children":["data_dir"]}],["$","span","code-segement52",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement53",{"className":"$undefined","style":{},"children":[" exist_ok"]}],["$","span","code-segement54",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement55",{"className":"token","style":{"color":"#755f00"},"children":["True"]}],["$","span","code-segement56",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Le","23",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Now, let\'s create a file called ",["$","$Lc","23-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"tasks.py"}]," in this directory. This will store out Huey tasks."]}],["$","$Lc",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L1c",null,{"contentToCopy":"$1d"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" os "]}],["$","span","code-segement2",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":[" environ\\n"]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement5",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement6",{"className":"$undefined","style":{},"children":[" os"]}],["$","span","code-segement7",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":["path "]}],["$","span","code-segement9",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":[" join "]}],["$","span","code-segement11",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement12",{"className":"$undefined","style":{},"children":[" path_join\\n"]}],["$","span","code-segement13",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement14",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":[" subprocess "]}],["$","span","code-segement16",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement17",{"className":"$undefined","style":{},"children":[" run "]}],["$","span","code-segement18",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement19",{"className":"$undefined","style":{},"children":[" subprocess_run"]}],["$","span","code-segement20",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement21",{"className":"$undefined","style":{},"children":[" CalledProcessError\\n"]}],["$","span","code-segement22",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement23",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement24",{"className":"$undefined","style":{},"children":[" time "]}],["$","span","code-segement25",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":[" sleep\\n"]}],"\\n",["$","span","code-segement28",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement29",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement30",{"className":"$undefined","style":{},"children":[" huey "]}],["$","span","code-segement31",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement32",{"className":"$undefined","style":{},"children":[" RedisHuey\\n"]}],"\\n",["$","span","code-segement34",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement35",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement36",{"className":"$undefined","style":{},"children":[" src"]}],["$","span","code-segement37",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement38",{"className":"$undefined","style":{},"children":["redis_client "]}],["$","span","code-segement39",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement40",{"className":"$undefined","style":{},"children":[" redis_client\\n"]}],["$","span","code-segement41",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement42",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement43",{"className":"$undefined","style":{},"children":[" src"]}],["$","span","code-segement44",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement45",{"className":"$undefined","style":{},"children":["dirs "]}],["$","span","code-segement46",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement47",{"className":"$undefined","style":{},"children":[" data_dir\\n"]}],"\\n","\\n",["$","span","code-segement50",{"className":"$undefined","style":{},"children":["redis_host "]}],["$","span","code-segement51",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement52",{"className":"$undefined","style":{},"children":[" environ"]}],["$","span","code-segement53",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement54",{"className":"token","style":{"color":"#116b00"},"children":["\\"REDIS_HOST\\""]}],["$","span","code-segement55",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement56",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement57",{"className":"$undefined","style":{},"children":["task_delay "]}],["$","span","code-segement58",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement59",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement60",{"className":"token","style":{"color":"#af00af"},"children":["float"]}],["$","span","code-segement61",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement62",{"className":"$undefined","style":{},"children":["environ"]}],["$","span","code-segement63",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement64",{"className":"$undefined","style":{},"children":["get"]}],["$","span","code-segement65",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement66",{"className":"token","style":{"color":"#116b00"},"children":["\\"TASK_DELAY\\""]}],["$","span","code-segement67",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement68",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement69",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement70",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement71",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement72",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement74",{"className":"$undefined","style":{},"children":["huey "]}],["$","span","code-segement75",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement76",{"className":"$undefined","style":{},"children":[" RedisHuey"]}],["$","span","code-segement77",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement78",{"className":"token","style":{"color":"#116b00"},"children":["\'entrypoint\'"]}],["$","span","code-segement79",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement80",{"className":"$undefined","style":{},"children":[" host"]}],["$","span","code-segement81",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement82",{"className":"$undefined","style":{},"children":["redis_host"]}],["$","span","code-segement83",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement84",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement86",{"className":"$undefined","style":{},"children":["task_status_map_name "]}],["$","span","code-segement87",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement88",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement89",{"className":"token","style":{"color":"#116b00"},"children":["\\"segmentation_task_status\\""]}],["$","span","code-segement90",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n","\\n",["$","span","code-segement93",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement94",{"className":"token decorator annotation","style":{"color":"#111b27"},"children":["@huey"]}],["$","span","code-segement95",{"className":"token decorator annotation","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement96",{"className":"token decorator annotation","style":{"color":"#111b27"},"children":["task"]}],["$","span","code-segement97",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement98",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement99",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement100",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement101",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement102",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement103",{"className":"token","style":{"color":"#7c00aa"},"children":["segment_volume"]}],["$","span","code-segement104",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement105",{"className":"$undefined","style":{},"children":["task_id"]}],["$","span","code-segement106",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement107",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement108",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement109",{"className":"$undefined","style":{},"children":["    volume_path "]}],["$","span","code-segement110",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement111",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement112",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement113",{"className":"$undefined","style":{},"children":["data_dir"]}],["$","span","code-segement114",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement115",{"className":"$undefined","style":{},"children":[" task_id"]}],["$","span","code-segement116",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement117",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement118",{"className":"token","style":{"color":"#116b00"},"children":["\\"volume.nii.gz\\""]}],["$","span","code-segement119",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement120",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement121",{"className":"$undefined","style":{},"children":["    segmentation_path "]}],["$","span","code-segement122",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement123",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement124",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement125",{"className":"$undefined","style":{},"children":["data_dir"]}],["$","span","code-segement126",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement127",{"className":"$undefined","style":{},"children":[" task_id"]}],["$","span","code-segement128",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement129",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement130",{"className":"token","style":{"color":"#116b00"},"children":["\\"segmentation.nii.gz\\""]}],["$","span","code-segement131",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement132",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement134",{"className":"$undefined","style":{},"children":["    redis_client"]}],["$","span","code-segement135",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement136",{"className":"$undefined","style":{},"children":["hset"]}],["$","span","code-segement137",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement138",{"className":"$undefined","style":{},"children":["task_status_map_name"]}],["$","span","code-segement139",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement140",{"className":"$undefined","style":{},"children":[" task_id"]}],["$","span","code-segement141",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement142",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement143",{"className":"token","style":{"color":"#116b00"},"children":["\\"processing\\""]}],["$","span","code-segement144",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement145",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement147",{"className":"$undefined","style":{},"children":["    run_total_segmentator_command "]}],["$","span","code-segement148",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement149",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement150",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\\"TotalSegmentator -i "]}],["$","span","code-segement151",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement152",{"className":"token string-interpolation interpolation","style":{},"children":["volume_path"]}],["$","span","code-segement153",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement154",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[" -o "]}],["$","span","code-segement155",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement156",{"className":"token string-interpolation interpolation","style":{},"children":["segmentation_path"]}],["$","span","code-segement157",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement158",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[" --ml\\""]}],["$","span","code-segement159",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement161",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement162",{"className":"token","style":{"color":"#a04900"},"children":["try"]}],["$","span","code-segement163",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement164",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement165",{"className":"$undefined","style":{},"children":["        _result "]}],["$","span","code-segement166",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement167",{"className":"$undefined","style":{},"children":[" subprocess_run"]}],["$","span","code-segement168",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement169",{"className":"$undefined","style":{},"children":["run_total_segmentator_command"]}],["$","span","code-segement170",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement171",{"className":"$undefined","style":{},"children":[" shell"]}],["$","span","code-segement172",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement173",{"className":"token","style":{"color":"#755f00"},"children":["True"]}],["$","span","code-segement174",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement175",{"className":"$undefined","style":{},"children":[" check"]}],["$","span","code-segement176",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement177",{"className":"token","style":{"color":"#755f00"},"children":["True"]}],["$","span","code-segement178",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement179",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement180",{"className":"$undefined","style":{},"children":["        redis_client"]}],["$","span","code-segement181",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement182",{"className":"$undefined","style":{},"children":["hset"]}],["$","span","code-segement183",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement184",{"className":"$undefined","style":{},"children":["task_status_map_name"]}],["$","span","code-segement185",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement186",{"className":"$undefined","style":{},"children":[" task_id"]}],["$","span","code-segement187",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement188",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement189",{"className":"token","style":{"color":"#116b00"},"children":["\\"completed\\""]}],["$","span","code-segement190",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement191",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement192",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement193",{"className":"token","style":{"color":"#a04900"},"children":["except"]}],["$","span","code-segement194",{"className":"$undefined","style":{},"children":[" CalledProcessError "]}],["$","span","code-segement195",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement196",{"className":"$undefined","style":{},"children":[" _e"]}],["$","span","code-segement197",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement198",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement199",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement200",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement201",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement202",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\\"Failed to segment volume for task_id "]}],["$","span","code-segement203",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement204",{"className":"token string-interpolation interpolation","style":{},"children":["task_id"]}],["$","span","code-segement205",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement206",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[".\\""]}],["$","span","code-segement207",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement208",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement209",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement210",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement211",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement212",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\\"    segmentation command: "]}],["$","span","code-segement213",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement214",{"className":"token string-interpolation interpolation","style":{},"children":["run_total_segmentator_command"]}],["$","span","code-segement215",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement216",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["\\""]}],["$","span","code-segement217",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement218",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement219",{"className":"$undefined","style":{},"children":["        redis_client"]}],["$","span","code-segement220",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement221",{"className":"$undefined","style":{},"children":["hset"]}],["$","span","code-segement222",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement223",{"className":"$undefined","style":{},"children":["task_status_map_name"]}],["$","span","code-segement224",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement225",{"className":"$undefined","style":{},"children":[" task_id"]}],["$","span","code-segement226",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement227",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement228",{"className":"token","style":{"color":"#116b00"},"children":["\\"failed\\""]}],["$","span","code-segement229",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Le","25",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","The Redis hashmap with the name given by ",["$","$Lc","25-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"task_status_map_name"}]," will be used to store the statuses of our tasks. When we first receive a task (inside the ",["$","$Lc","25-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"segment_volume"}]," function), we update its status to ",["$","$Lc","25-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"processing"}],". Then, we run TotalSegmentator on the volume using ",["$","$Lc","25-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"subprocess.run"}],". If the process runs successfully, we update the status of the task to ",["$","$Lc","25-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"completed"}],". The segmentation will be saved at the location specified by ",["$","$Lc","25-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"segmentation_path"}],". If the process fails with an error, we mark the task as ",["$","$Lc","25-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"failed"}],"."]}],["$","$Le","26",{"id":"fastapi-server","variant":"h5","component":"h2","mb":2,"children":["$","strong",null,{"children":"FastAPI Server"}]}],["$","$Le","27",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Inside the ",["$","$Lc","27-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"server-worker/src"}]," directory, let\'s create a file called ",["$","$Lc","27-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"app.py"}],", which will contain our FastAPI application. As of now, we have three needs from this application:"]}],["$","$Le","28",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","1) Serve the static files present in the ",["$","$Lc","28-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"data"}]," folder (in production this should be handled by your web server)."]}],["$","$Le","29",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","2) An endpoint where we can upload a Nifti file to start the segmentation task."]}],["$","$Le","30",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","3) An endpoint where we can get the status/result of a task."]}],["$","$Le","31",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Here is the ",["$","$Lc","31-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"app.py"}]," file:"]}],["$","$Lc",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L1c",null,{"contentToCopy":"$1e"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" os "]}],["$","span","code-segement2",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":[" makedirs\\n"]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement5",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement6",{"className":"$undefined","style":{},"children":[" os"]}],["$","span","code-segement7",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":["path "]}],["$","span","code-segement9",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":[" basename "]}],["$","span","code-segement11",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement12",{"className":"$undefined","style":{},"children":[" path_basename"]}],["$","span","code-segement13",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement14",{"className":"$undefined","style":{},"children":[" join "]}],["$","span","code-segement15",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement16",{"className":"$undefined","style":{},"children":[" path_join\\n"]}],["$","span","code-segement17",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement18",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement19",{"className":"$undefined","style":{},"children":[" uuid "]}],["$","span","code-segement20",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement21",{"className":"$undefined","style":{},"children":[" uuid4\\n"]}],"\\n",["$","span","code-segement23",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement24",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement25",{"className":"$undefined","style":{},"children":[" fastapi "]}],["$","span","code-segement26",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement27",{"className":"$undefined","style":{},"children":[" FastAPI"]}],["$","span","code-segement28",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement29",{"className":"$undefined","style":{},"children":[" UploadFile"]}],["$","span","code-segement30",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement31",{"className":"$undefined","style":{},"children":[" File\\n"]}],["$","span","code-segement32",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement33",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement34",{"className":"$undefined","style":{},"children":[" fastapi"]}],["$","span","code-segement35",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement36",{"className":"$undefined","style":{},"children":["responses "]}],["$","span","code-segement37",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement38",{"className":"$undefined","style":{},"children":[" JSONResponse\\n"]}],["$","span","code-segement39",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement40",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement41",{"className":"$undefined","style":{},"children":[" fastapi"]}],["$","span","code-segement42",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement43",{"className":"$undefined","style":{},"children":["staticfiles "]}],["$","span","code-segement44",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement45",{"className":"$undefined","style":{},"children":[" StaticFiles\\n"]}],"\\n",["$","span","code-segement47",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement48",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement49",{"className":"$undefined","style":{},"children":[" src"]}],["$","span","code-segement50",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement51",{"className":"$undefined","style":{},"children":["dirs "]}],["$","span","code-segement52",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement53",{"className":"$undefined","style":{},"children":[" data_dir\\n"]}],["$","span","code-segement54",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement55",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement56",{"className":"$undefined","style":{},"children":[" src"]}],["$","span","code-segement57",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement58",{"className":"$undefined","style":{},"children":["redis_client "]}],["$","span","code-segement59",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement60",{"className":"$undefined","style":{},"children":[" redis_client\\n"]}],["$","span","code-segement61",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement62",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement63",{"className":"$undefined","style":{},"children":[" src"]}],["$","span","code-segement64",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement65",{"className":"$undefined","style":{},"children":["tasks "]}],["$","span","code-segement66",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement67",{"className":"$undefined","style":{},"children":[" segment_volume"]}],["$","span","code-segement68",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement69",{"className":"$undefined","style":{},"children":[" task_status_map_name\\n"]}],"\\n","\\n",["$","span","code-segement72",{"className":"$undefined","style":{},"children":["app "]}],["$","span","code-segement73",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement74",{"className":"$undefined","style":{},"children":[" FastAPI"]}],["$","span","code-segement75",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement76",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement77",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement78",{"className":"$undefined","style":{},"children":["app"]}],["$","span","code-segement79",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement80",{"className":"$undefined","style":{},"children":["mount"]}],["$","span","code-segement81",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement82",{"className":"token","style":{"color":"#116b00"},"children":["\\"/data\\""]}],["$","span","code-segement83",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement84",{"className":"$undefined","style":{},"children":[" StaticFiles"]}],["$","span","code-segement85",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement86",{"className":"$undefined","style":{},"children":["directory"]}],["$","span","code-segement87",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement88",{"className":"$undefined","style":{},"children":["data_dir"]}],["$","span","code-segement89",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement90",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement91",{"className":"$undefined","style":{},"children":[" name"]}],["$","span","code-segement92",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement93",{"className":"token","style":{"color":"#116b00"},"children":["\\"data_dir\\""]}],["$","span","code-segement94",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement95",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n","\\n",["$","span","code-segement98",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement99",{"className":"token decorator annotation","style":{"color":"#111b27"},"children":["@app"]}],["$","span","code-segement100",{"className":"token decorator annotation","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement101",{"className":"token decorator annotation","style":{"color":"#111b27"},"children":["post"]}],["$","span","code-segement102",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement103",{"className":"token","style":{"color":"#116b00"},"children":["\\"/api/add-segmentation-task\\""]}],["$","span","code-segement104",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement105",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement106",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement107",{"className":"token","style":{"color":"#a04900"},"children":["async"]}],["$","span","code-segement108",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement109",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement110",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement111",{"className":"token","style":{"color":"#7c00aa"},"children":["upload_file"]}],["$","span","code-segement112",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement113",{"className":"token","style":{"color":"#af00af"},"children":["file"]}],["$","span","code-segement114",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement115",{"className":"$undefined","style":{},"children":[" UploadFile "]}],["$","span","code-segement116",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement117",{"className":"$undefined","style":{},"children":[" File"]}],["$","span","code-segement118",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement119",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement120",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement121",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement122",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement123",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement124",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement125",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement126",{"className":"$undefined","style":{},"children":["    task_id "]}],["$","span","code-segement127",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement128",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement129",{"className":"token","style":{"color":"#af00af"},"children":["str"]}],["$","span","code-segement130",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement131",{"className":"$undefined","style":{},"children":["uuid4"]}],["$","span","code-segement132",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement133",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement134",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement135",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement136",{"className":"$undefined","style":{},"children":["    task_dir "]}],["$","span","code-segement137",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement138",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement139",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement140",{"className":"$undefined","style":{},"children":["data_dir"]}],["$","span","code-segement141",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement142",{"className":"$undefined","style":{},"children":[" task_id"]}],["$","span","code-segement143",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement144",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement145",{"className":"$undefined","style":{},"children":["    makedirs"]}],["$","span","code-segement146",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement147",{"className":"$undefined","style":{},"children":["task_dir"]}],["$","span","code-segement148",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement149",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement151",{"className":"$undefined","style":{},"children":["    volume_save_path "]}],["$","span","code-segement152",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement153",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement154",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement155",{"className":"$undefined","style":{},"children":["task_dir"]}],["$","span","code-segement156",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement157",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement158",{"className":"token","style":{"color":"#116b00"},"children":["\\"volume.nii.gz\\""]}],["$","span","code-segement159",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement160",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement162",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement163",{"className":"token","style":{"color":"#3c526d"},"children":["# Save the file to the disk"]}],["$","span","code-segement164",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement165",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement166",{"className":"token","style":{"color":"#a04900"},"children":["with"]}],["$","span","code-segement167",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement168",{"className":"token","style":{"color":"#af00af"},"children":["open"]}],["$","span","code-segement169",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement170",{"className":"$undefined","style":{},"children":["volume_save_path"]}],["$","span","code-segement171",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement172",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement173",{"className":"token","style":{"color":"#116b00"},"children":["\\"wb\\""]}],["$","span","code-segement174",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement175",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement176",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement177",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement178",{"className":"token","style":{"color":"#af00af"},"children":["buffer"]}],["$","span","code-segement179",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement180",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement181",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement182",{"className":"token","style":{"color":"#a04900"},"children":["while"]}],["$","span","code-segement183",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement184",{"className":"token","style":{"color":"#755f00"},"children":["True"]}],["$","span","code-segement185",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement186",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement187",{"className":"$undefined","style":{},"children":["            chunk "]}],["$","span","code-segement188",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement189",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement190",{"className":"token","style":{"color":"#a04900"},"children":["await"]}],["$","span","code-segement191",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement192",{"className":"token","style":{"color":"#af00af"},"children":["file"]}],["$","span","code-segement193",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement194",{"className":"$undefined","style":{},"children":["read"]}],["$","span","code-segement195",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement196",{"className":"token","style":{"color":"#755f00"},"children":["10000"]}],["$","span","code-segement197",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement198",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement199",{"className":"$undefined","style":{},"children":["            "]}],["$","span","code-segement200",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement201",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement202",{"className":"token","style":{"color":"#a04900"},"children":["not"]}],["$","span","code-segement203",{"className":"$undefined","style":{},"children":[" chunk"]}],["$","span","code-segement204",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement205",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement206",{"className":"$undefined","style":{},"children":["                "]}],["$","span","code-segement207",{"className":"token","style":{"color":"#a04900"},"children":["break"]}],["$","span","code-segement208",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement210",{"className":"$undefined","style":{},"children":["            "]}],["$","span","code-segement211",{"className":"token","style":{"color":"#af00af"},"children":["buffer"]}],["$","span","code-segement212",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement213",{"className":"$undefined","style":{},"children":["write"]}],["$","span","code-segement214",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement215",{"className":"$undefined","style":{},"children":["chunk"]}],["$","span","code-segement216",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement217",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement219",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement220",{"className":"token","style":{"color":"#3c526d"},"children":["# Queue the task"]}],["$","span","code-segement221",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement222",{"className":"$undefined","style":{},"children":["    redis_client"]}],["$","span","code-segement223",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement224",{"className":"$undefined","style":{},"children":["hset"]}],["$","span","code-segement225",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement226",{"className":"$undefined","style":{},"children":["task_status_map_name"]}],["$","span","code-segement227",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement228",{"className":"$undefined","style":{},"children":[" task_id"]}],["$","span","code-segement229",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement230",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement231",{"className":"token","style":{"color":"#116b00"},"children":["\\"queued\\""]}],["$","span","code-segement232",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement233",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement234",{"className":"$undefined","style":{},"children":["    segment_volume"]}],["$","span","code-segement235",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement236",{"className":"$undefined","style":{},"children":["task_id"]}],["$","span","code-segement237",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement238",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement240",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement241",{"className":"token","style":{"color":"#a04900"},"children":["return"]}],["$","span","code-segement242",{"className":"$undefined","style":{},"children":[" JSONResponse"]}],["$","span","code-segement243",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement244",{"className":"$undefined","style":{},"children":["content"]}],["$","span","code-segement245",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement246",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement247",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement248",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement249",{"className":"token","style":{"color":"#116b00"},"children":["\'success\'"]}],["$","span","code-segement250",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement251",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement252",{"className":"token","style":{"color":"#755f00"},"children":["True"]}],["$","span","code-segement253",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement254",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement255",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement256",{"className":"token","style":{"color":"#116b00"},"children":["\'result\'"]}],["$","span","code-segement257",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement258",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement259",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement260",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement261",{"className":"$undefined","style":{},"children":["            "]}],["$","span","code-segement262",{"className":"token","style":{"color":"#116b00"},"children":["\'taskId\'"]}],["$","span","code-segement263",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement264",{"className":"$undefined","style":{},"children":[" task_id"]}],["$","span","code-segement265",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement266",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement267",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement268",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement269",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement270",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement271",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement272",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement273",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement274",{"className":"$undefined","style":{},"children":[" status_code"]}],["$","span","code-segement275",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement276",{"className":"token","style":{"color":"#755f00"},"children":["206"]}],["$","span","code-segement277",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement278",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n","\\n",["$","span","code-segement281",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement282",{"className":"token decorator annotation","style":{"color":"#111b27"},"children":["@app"]}],["$","span","code-segement283",{"className":"token decorator annotation","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement284",{"className":"token decorator annotation","style":{"color":"#111b27"},"children":["get"]}],["$","span","code-segement285",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement286",{"className":"token","style":{"color":"#116b00"},"children":["\\"/api/get-segmentation-task-result\\""]}],["$","span","code-segement287",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement288",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement289",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement290",{"className":"token","style":{"color":"#a04900"},"children":["async"]}],["$","span","code-segement291",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement292",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement293",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement294",{"className":"token","style":{"color":"#7c00aa"},"children":["get_segmentation"]}],["$","span","code-segement295",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement296",{"className":"$undefined","style":{},"children":["task_id"]}],["$","span","code-segement297",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement298",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement299",{"className":"token","style":{"color":"#af00af"},"children":["str"]}],["$","span","code-segement300",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement301",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement302",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement303",{"className":"$undefined","style":{},"children":["    task_status "]}],["$","span","code-segement304",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement305",{"className":"$undefined","style":{},"children":[" redis_client"]}],["$","span","code-segement306",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement307",{"className":"$undefined","style":{},"children":["hget"]}],["$","span","code-segement308",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement309",{"className":"$undefined","style":{},"children":["task_status_map_name"]}],["$","span","code-segement310",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement311",{"className":"$undefined","style":{},"children":[" task_id"]}],["$","span","code-segement312",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement313",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement315",{"className":"$undefined","style":{},"children":["    response_content "]}],["$","span","code-segement316",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement317",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement318",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement319",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement320",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement321",{"className":"token","style":{"color":"#116b00"},"children":["\'success\'"]}],["$","span","code-segement322",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement323",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement324",{"className":"token","style":{"color":"#755f00"},"children":["True"]}],["$","span","code-segement325",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement326",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement327",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement328",{"className":"token","style":{"color":"#116b00"},"children":["\'result\'"]}],["$","span","code-segement329",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement330",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement331",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement332",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement333",{"className":"$undefined","style":{},"children":["            "]}],["$","span","code-segement334",{"className":"token","style":{"color":"#116b00"},"children":["\'taskId\'"]}],["$","span","code-segement335",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement336",{"className":"$undefined","style":{},"children":[" task_id"]}],["$","span","code-segement337",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement338",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement339",{"className":"$undefined","style":{},"children":["            "]}],["$","span","code-segement340",{"className":"token","style":{"color":"#116b00"},"children":["\'status\'"]}],["$","span","code-segement341",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement342",{"className":"$undefined","style":{},"children":[" task_status"]}],["$","span","code-segement343",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement344",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement345",{"className":"$undefined","style":{},"children":["            "]}],["$","span","code-segement346",{"className":"token","style":{"color":"#116b00"},"children":["\'volumeFileUrl\'"]}],["$","span","code-segement347",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement348",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement349",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement350",{"className":"$undefined","style":{},"children":["path_basename"]}],["$","span","code-segement351",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement352",{"className":"$undefined","style":{},"children":["data_dir"]}],["$","span","code-segement353",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement354",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement355",{"className":"$undefined","style":{},"children":[" task_id"]}],["$","span","code-segement356",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement357",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement358",{"className":"token","style":{"color":"#116b00"},"children":["\\"volume.nii.gz\\""]}],["$","span","code-segement359",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement360",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement361",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement362",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement363",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement364",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement365",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement366",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement367",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement368",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement370",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement371",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement372",{"className":"$undefined","style":{},"children":[" task_status "]}],["$","span","code-segement373",{"className":"token","style":{"color":"#a04900"},"children":["=="]}],["$","span","code-segement374",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement375",{"className":"token","style":{"color":"#116b00"},"children":["\\"completed\\""]}],["$","span","code-segement376",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement377",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement378",{"className":"$undefined","style":{},"children":["        response_content"]}],["$","span","code-segement379",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement380",{"className":"token","style":{"color":"#116b00"},"children":["\'result\'"]}],["$","span","code-segement381",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement382",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement383",{"className":"token","style":{"color":"#116b00"},"children":["\'segmentationFileUrl\'"]}],["$","span","code-segement384",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement385",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement386",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement387",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement388",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement389",{"className":"$undefined","style":{},"children":["path_basename"]}],["$","span","code-segement390",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement391",{"className":"$undefined","style":{},"children":["data_dir"]}],["$","span","code-segement392",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement393",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement394",{"className":"$undefined","style":{},"children":[" task_id"]}],["$","span","code-segement395",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement396",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement397",{"className":"token","style":{"color":"#116b00"},"children":["\\"segmentation.nii.gz\\""]}],["$","span","code-segement398",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement399",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement401",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement402",{"className":"token","style":{"color":"#a04900"},"children":["return"]}],["$","span","code-segement403",{"className":"$undefined","style":{},"children":[" JSONResponse"]}],["$","span","code-segement404",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement405",{"className":"$undefined","style":{},"children":["content"]}],["$","span","code-segement406",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement407",{"className":"$undefined","style":{},"children":["response_content"]}],["$","span","code-segement408",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement409",{"className":"$undefined","style":{},"children":[" status_code"]}],["$","span","code-segement410",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement411",{"className":"token","style":{"color":"#755f00"},"children":["200"]}],["$","span","code-segement412",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Le","33",{"id":"running-the-app","variant":"h5","component":"h2","mb":2,"children":["$","strong",null,{"children":"Running the App"}]}],["$","$Le","34",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Make sure you have a Redis server running."]}],["$","$Le","35",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","We\'ll need to create two environments: one for the server and one for the worker. I\'ll be using ",["$","$Lc","35-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"venv"}]," for creating and managing the environments."]}],["$","$Le","36",{"id":"server","variant":"h6","component":"h3","mb":2,"children":["$","strong",null,{"children":"Server"}]}],["$","$Lc",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L1c",null,{"contentToCopy":"python3 -m venv env_server\\nsource env_server/bin/activate"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-bash","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"$undefined","style":{},"children":["python3 -m venv env_server\\n"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement2",{"className":"token","style":{"color":"#005a8e"},"children":["source"]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":[" env_server/bin/activate"]}]]]}]}]]}],["$","$Le","38",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Next, we install the following packages:"]}],["$","$Lc",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L1c",null,{"contentToCopy":"pip install fastapi pydantic uvicorn python-multipart redis huey"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-bash","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"$undefined","style":{},"children":["pip "]}],["$","span","code-segement1",{"className":"token","style":{"color":"#7c00aa"},"children":["install"]}],["$","span","code-segement2",{"className":"$undefined","style":{},"children":[" fastapi pydantic uvicorn python-multipart redis huey"]}]]]}]}]]}],["$","$Le","40",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","We can now run the server from the ",["$","$Lc","40-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"server-worker"}]," directory using:"]}],["$","$Lc",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L1c",null,{"contentToCopy":"REDIS_HOST=localhost REDIS_PORT=6379 REDIS_DB=0 uvicorn src.app:app --port=8000 --host=0.0.0.0"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-bash","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token assign-left","style":{"color":"#005a8e"},"children":["REDIS_HOST"]}],["$","span","code-segement1",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement2",{"className":"$undefined","style":{},"children":["localhost "]}],["$","span","code-segement3",{"className":"token assign-left","style":{"color":"#005a8e"},"children":["REDIS_PORT"]}],["$","span","code-segement4",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement5",{"className":"token","style":{"color":"#755f00"},"children":["6379"]}],["$","span","code-segement6",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement7",{"className":"token assign-left","style":{"color":"#005a8e"},"children":["REDIS_DB"]}],["$","span","code-segement8",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement9",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":[" uvicorn src.app:app --port"]}],["$","span","code-segement11",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement12",{"className":"token","style":{"color":"#755f00"},"children":["8000"]}],["$","span","code-segement13",{"className":"$undefined","style":{},"children":[" --host"]}],["$","span","code-segement14",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement15",{"className":"token","style":{"color":"#755f00"},"children":["0.0"]}],["$","span","code-segement16",{"className":"$undefined","style":{},"children":[".0.0"]}]]]}]}]]}],["$","$Le","42",{"id":"worker","variant":"h6","component":"h3","mb":2,"children":["$","strong",null,{"children":"Worker"}]}],["$","$Lc",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L1c",null,{"contentToCopy":"python3 -m venv env_worker\\nsource env_worker/bin/activate"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-bash","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"$undefined","style":{},"children":["python3 -m venv env_worker\\n"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement2",{"className":"token","style":{"color":"#005a8e"},"children":["source"]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":[" env_worker/bin/activate"]}]]]}]}]]}],["$","$Le","44",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","For the worker, we will also install the ",["$","$Lc","44-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"TotalSegmentator"}]," apart from the packages we installed for the server."]}],["$","$Lc",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L1c",null,{"contentToCopy":"pip install fastapi pydantic uvicorn python-multipart redis huey TotalSegmentator"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-bash","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"$undefined","style":{},"children":["pip "]}],["$","span","code-segement1",{"className":"token","style":{"color":"#7c00aa"},"children":["install"]}],["$","span","code-segement2",{"className":"$undefined","style":{},"children":[" fastapi pydantic uvicorn python-multipart redis huey TotalSegmentator"]}]]]}]}]]}],["$","$Le","46",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","From the ",["$","$Lc","46-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"server-worker"}]," directory, run the following command to start the worker process."]}],["$","$Lc",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L1c",null,{"contentToCopy":"REDIS_HOST=localhost REDIS_PORT=6379 REDIS_DB=0 huey_consumer.py src.tasks.huey"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-bash","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token assign-left","style":{"color":"#005a8e"},"children":["REDIS_HOST"]}],["$","span","code-segement1",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement2",{"className":"$undefined","style":{},"children":["localhost "]}],["$","span","code-segement3",{"className":"token assign-left","style":{"color":"#005a8e"},"children":["REDIS_PORT"]}],["$","span","code-segement4",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement5",{"className":"token","style":{"color":"#755f00"},"children":["6379"]}],["$","span","code-segement6",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement7",{"className":"token assign-left","style":{"color":"#005a8e"},"children":["REDIS_DB"]}],["$","span","code-segement8",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement9",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":[" huey_consumer.py src.tasks.huey"]}]]]}]}]]}],["$","$Le","48",{"id":"tests","variant":"h4","component":"h1","mb":2,"children":["$","strong",null,{"children":"Tests"}]}],["$","$Le","49",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","With both the server and worker applications running, we can make a test case for our segmentation process in which we will perform the following operations:"]}],["$","$Le","50",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","1) Add a segmentation task by uploading a sample volume."]}],["$","$Le","51",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","1) Repeatedly query the status endpoint and wait for the task to complete (or fail)."]}],["$","$Le","52",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","1) Download the volume and segmentation files."]}],["$","$Le","53",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","1) Read the volume and segmentation files and verify if they have the same shape."]}],["$","$Le","54",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Inside the project directory, create a new directory called ",["$","$Lc","54-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"tests"}],". This should be on the same level as the ",["$","$Lc","54-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"server-worker"}]," folder. Here, we\'ll have a ",["$","$Lc","54-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"dirs.py"}]," file quite similar to the ",["$","$Lc","54-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"dirs.py"}]," in ",["$","$Lc","54-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"server-worker/src"}],"."]}],["$","$Lc",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L1c",null,{"contentToCopy":"from os import makedirs\\nfrom os.path import dirname, join as path_join\\n\\n\\ntests_dir = dirname(__file__)\\nproject_dir = dirname(tests_dir)\\ndata_dir = path_join(project_dir, \\"data\\")\\n\\nmakedirs(data_dir, exist_ok=True)"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" os "]}],["$","span","code-segement2",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":[" makedirs\\n"]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement5",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement6",{"className":"$undefined","style":{},"children":[" os"]}],["$","span","code-segement7",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":["path "]}],["$","span","code-segement9",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":[" dirname"]}],["$","span","code-segement11",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement12",{"className":"$undefined","style":{},"children":[" join "]}],["$","span","code-segement13",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement14",{"className":"$undefined","style":{},"children":[" path_join\\n"]}],"\\n","\\n",["$","span","code-segement17",{"className":"$undefined","style":{},"children":["tests_dir "]}],["$","span","code-segement18",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement19",{"className":"$undefined","style":{},"children":[" dirname"]}],["$","span","code-segement20",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement21",{"className":"$undefined","style":{},"children":["__file__"]}],["$","span","code-segement22",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement23",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement24",{"className":"$undefined","style":{},"children":["project_dir "]}],["$","span","code-segement25",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":[" dirname"]}],["$","span","code-segement27",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement28",{"className":"$undefined","style":{},"children":["tests_dir"]}],["$","span","code-segement29",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement30",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement31",{"className":"$undefined","style":{},"children":["data_dir "]}],["$","span","code-segement32",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement33",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement34",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement35",{"className":"$undefined","style":{},"children":["project_dir"]}],["$","span","code-segement36",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement37",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement38",{"className":"token","style":{"color":"#116b00"},"children":["\\"data\\""]}],["$","span","code-segement39",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement40",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement42",{"className":"$undefined","style":{},"children":["makedirs"]}],["$","span","code-segement43",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement44",{"className":"$undefined","style":{},"children":["data_dir"]}],["$","span","code-segement45",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement46",{"className":"$undefined","style":{},"children":[" exist_ok"]}],["$","span","code-segement47",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement48",{"className":"token","style":{"color":"#755f00"},"children":["True"]}],["$","span","code-segement49",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Le","56",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Next, create a file called ",["$","$Lc","56-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"utils.py"}]," to contain a couple of utility functions:"]}],["$","$Lc",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L1c",null,{"contentToCopy":"from sys import stdout\\n\\nimport requests\\n\\n\\ndef print_inline(string):\\n    print(string, end=\\"\\")\\n    stdout.flush()\\n\\n\\ndef download_file(url, file_path):\\n    response = requests.get(url)\\n    if response.status_code != 200:\\n        print(f\\"Failed to download file. Response status code: {response.status_code}\\")\\n        return False\\n\\n    with open(file_path, \\"wb\\") as f:\\n        f.write(response.content)\\n\\n    return True"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" sys "]}],["$","span","code-segement2",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":[" stdout\\n"]}],"\\n",["$","span","code-segement5",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement6",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement7",{"className":"$undefined","style":{},"children":[" requests\\n"]}],"\\n","\\n",["$","span","code-segement10",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement11",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement12",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement13",{"className":"token","style":{"color":"#7c00aa"},"children":["print_inline"]}],["$","span","code-segement14",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":["string"]}],["$","span","code-segement16",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement17",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement18",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement19",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement20",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement21",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement22",{"className":"$undefined","style":{},"children":["string"]}],["$","span","code-segement23",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement24",{"className":"$undefined","style":{},"children":[" end"]}],["$","span","code-segement25",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement26",{"className":"token","style":{"color":"#116b00"},"children":["\\"\\""]}],["$","span","code-segement27",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement28",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement29",{"className":"$undefined","style":{},"children":["    stdout"]}],["$","span","code-segement30",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement31",{"className":"$undefined","style":{},"children":["flush"]}],["$","span","code-segement32",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement33",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement34",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n","\\n",["$","span","code-segement37",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement38",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement39",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement40",{"className":"token","style":{"color":"#7c00aa"},"children":["download_file"]}],["$","span","code-segement41",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement42",{"className":"$undefined","style":{},"children":["url"]}],["$","span","code-segement43",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement44",{"className":"$undefined","style":{},"children":[" file_path"]}],["$","span","code-segement45",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement46",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement47",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement48",{"className":"$undefined","style":{},"children":["    response "]}],["$","span","code-segement49",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement50",{"className":"$undefined","style":{},"children":[" requests"]}],["$","span","code-segement51",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement52",{"className":"$undefined","style":{},"children":["get"]}],["$","span","code-segement53",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement54",{"className":"$undefined","style":{},"children":["url"]}],["$","span","code-segement55",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement56",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement57",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement58",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement59",{"className":"$undefined","style":{},"children":[" response"]}],["$","span","code-segement60",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement61",{"className":"$undefined","style":{},"children":["status_code "]}],["$","span","code-segement62",{"className":"token","style":{"color":"#a04900"},"children":["!="]}],["$","span","code-segement63",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement64",{"className":"token","style":{"color":"#755f00"},"children":["200"]}],["$","span","code-segement65",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement66",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement67",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement68",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement69",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement70",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\\"Failed to download file. Response status code: "]}],["$","span","code-segement71",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement72",{"className":"token string-interpolation interpolation","style":{},"children":["response"]}],["$","span","code-segement73",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement74",{"className":"token string-interpolation interpolation","style":{},"children":["status_code"]}],["$","span","code-segement75",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement76",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["\\""]}],["$","span","code-segement77",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement78",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement79",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement80",{"className":"token","style":{"color":"#a04900"},"children":["return"]}],["$","span","code-segement81",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement82",{"className":"token","style":{"color":"#755f00"},"children":["False"]}],["$","span","code-segement83",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement85",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement86",{"className":"token","style":{"color":"#a04900"},"children":["with"]}],["$","span","code-segement87",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement88",{"className":"token","style":{"color":"#af00af"},"children":["open"]}],["$","span","code-segement89",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement90",{"className":"$undefined","style":{},"children":["file_path"]}],["$","span","code-segement91",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement92",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement93",{"className":"token","style":{"color":"#116b00"},"children":["\\"wb\\""]}],["$","span","code-segement94",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement95",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement96",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement97",{"className":"$undefined","style":{},"children":[" f"]}],["$","span","code-segement98",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement99",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement100",{"className":"$undefined","style":{},"children":["        f"]}],["$","span","code-segement101",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement102",{"className":"$undefined","style":{},"children":["write"]}],["$","span","code-segement103",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement104",{"className":"$undefined","style":{},"children":["response"]}],["$","span","code-segement105",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement106",{"className":"$undefined","style":{},"children":["content"]}],["$","span","code-segement107",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement108",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement110",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement111",{"className":"token","style":{"color":"#a04900"},"children":["return"]}],["$","span","code-segement112",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement113",{"className":"token","style":{"color":"#755f00"},"children":["True"]}]]]}]}]]}],["$","$Le","58",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Now, let\'s write our core testing logic. Create a file called ",["$","$Lc","58-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"test_apis.py"}]," and add the following lines"]}],["$","$Lc",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L1c",null,{"contentToCopy":"from os import makedirs\\nfrom os.path import basename as path_basename, join as path_join\\nfrom shutil import rmtree\\nfrom time import sleep, time\\nimport unittest\\n\\nfrom nibabel import load as nib_load\\nimport requests\\n\\nfrom dirs import data_dir, tests_dir\\nfrom utils import download_file, print_inline\\n\\n\\nclass TestAPIs(unittest.TestCase):\\n    base_url = \\"http://localhost:8000\\"\\n    api_base_url = \\"http://localhost:8000/api\\"\\n    test_volume_path = path_join(data_dir, \\"testing\\", \\"volume.nii.gz\\")\\n\\n\\n    def test_add_segmentation_task_and_get_result(self):\\n        pass\\n\\n\\nif __name__ == \\"__main__\\":\\n    unittest.main()"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" os "]}],["$","span","code-segement2",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":[" makedirs\\n"]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement5",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement6",{"className":"$undefined","style":{},"children":[" os"]}],["$","span","code-segement7",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":["path "]}],["$","span","code-segement9",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":[" basename "]}],["$","span","code-segement11",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement12",{"className":"$undefined","style":{},"children":[" path_basename"]}],["$","span","code-segement13",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement14",{"className":"$undefined","style":{},"children":[" join "]}],["$","span","code-segement15",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement16",{"className":"$undefined","style":{},"children":[" path_join\\n"]}],["$","span","code-segement17",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement18",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement19",{"className":"$undefined","style":{},"children":[" shutil "]}],["$","span","code-segement20",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement21",{"className":"$undefined","style":{},"children":[" rmtree\\n"]}],["$","span","code-segement22",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement23",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement24",{"className":"$undefined","style":{},"children":[" time "]}],["$","span","code-segement25",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":[" sleep"]}],["$","span","code-segement27",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement28",{"className":"$undefined","style":{},"children":[" time\\n"]}],["$","span","code-segement29",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement30",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement31",{"className":"$undefined","style":{},"children":[" unittest\\n"]}],"\\n",["$","span","code-segement33",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement34",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement35",{"className":"$undefined","style":{},"children":[" nibabel "]}],["$","span","code-segement36",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement37",{"className":"$undefined","style":{},"children":[" load "]}],["$","span","code-segement38",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement39",{"className":"$undefined","style":{},"children":[" nib_load\\n"]}],["$","span","code-segement40",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement41",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement42",{"className":"$undefined","style":{},"children":[" requests\\n"]}],"\\n",["$","span","code-segement44",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement45",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement46",{"className":"$undefined","style":{},"children":[" dirs "]}],["$","span","code-segement47",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement48",{"className":"$undefined","style":{},"children":[" data_dir"]}],["$","span","code-segement49",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement50",{"className":"$undefined","style":{},"children":[" tests_dir\\n"]}],["$","span","code-segement51",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement52",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement53",{"className":"$undefined","style":{},"children":[" utils "]}],["$","span","code-segement54",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement55",{"className":"$undefined","style":{},"children":[" download_file"]}],["$","span","code-segement56",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement57",{"className":"$undefined","style":{},"children":[" print_inline\\n"]}],"\\n","\\n",["$","span","code-segement60",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement61",{"className":"token","style":{"color":"#a04900"},"children":["class"]}],["$","span","code-segement62",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement63",{"className":"token","style":{"color":"#005a8e"},"children":["TestAPIs"]}],["$","span","code-segement64",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement65",{"className":"$undefined","style":{},"children":["unittest"]}],["$","span","code-segement66",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement67",{"className":"$undefined","style":{},"children":["TestCase"]}],["$","span","code-segement68",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement69",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement70",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement71",{"className":"$undefined","style":{},"children":["    base_url "]}],["$","span","code-segement72",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement73",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement74",{"className":"token","style":{"color":"#116b00"},"children":["\\"http://localhost:8000\\""]}],["$","span","code-segement75",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement76",{"className":"$undefined","style":{},"children":["    api_base_url "]}],["$","span","code-segement77",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement78",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement79",{"className":"token","style":{"color":"#116b00"},"children":["\\"http://localhost:8000/api\\""]}],["$","span","code-segement80",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement81",{"className":"$undefined","style":{},"children":["    test_volume_path "]}],["$","span","code-segement82",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement83",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement84",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement85",{"className":"$undefined","style":{},"children":["data_dir"]}],["$","span","code-segement86",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement87",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement88",{"className":"token","style":{"color":"#116b00"},"children":["\\"testing\\""]}],["$","span","code-segement89",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement90",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement91",{"className":"token","style":{"color":"#116b00"},"children":["\\"volume.nii.gz\\""]}],["$","span","code-segement92",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement93",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n","\\n",["$","span","code-segement96",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement97",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement98",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement99",{"className":"token","style":{"color":"#7c00aa"},"children":["test_add_segmentation_task_and_get_result"]}],["$","span","code-segement100",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement101",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement102",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement103",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement104",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement105",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement106",{"className":"token","style":{"color":"#a04900"},"children":["pass"]}],["$","span","code-segement107",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n","\\n",["$","span","code-segement110",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement111",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement112",{"className":"$undefined","style":{},"children":[" __name__ "]}],["$","span","code-segement113",{"className":"token","style":{"color":"#a04900"},"children":["=="]}],["$","span","code-segement114",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement115",{"className":"token","style":{"color":"#116b00"},"children":["\\"__main__\\""]}],["$","span","code-segement116",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement117",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement118",{"className":"$undefined","style":{},"children":["    unittest"]}],["$","span","code-segement119",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement120",{"className":"$undefined","style":{},"children":["main"]}],["$","span","code-segement121",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement122",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Le","60",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","The ",["$","$Lc","60-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"test_add_segmentation_task_and_get_result"}]," function will contain the logic for performing the four aforementioned testing operations. Inside the ",["$","$Lc","60-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"data"}]," folder in the project\'s root directory, we\'ll create another folder called ",["$","$Lc","60-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"testing"}]," and place a CT Nifti image called ",["$","$Lc","60-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"volume.nii.gz"}]," in it. Let\'s upload this volume for segmentation in our test."]}],["$","$Lc",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L1c",null,{"contentToCopy":"add_segmentation_task_endpoint = f\\"{self.api_base_url}/add-segmentation-task\\"\\n\\nprint_inline(\\"Adding task ...\\")\\n\\nwith open(self.test_volume_path, \\"rb\\") as f:\\n    files = {\\"file\\": f}\\n    add_response = requests.post(add_segmentation_task_endpoint, files=files)\\n\\nself.assertEqual(add_response.status_code, 206)\\nself.assertEqual(add_response.headers[\'content-type\'], \\"application/json\\")\\n\\nadd_response_data = add_response.json()\\n\\nself.assertEqual(add_response_data.get(\'success\', None), True)\\nself.assertNotEqual(add_response_data.get(\'result\', {}).get(\'taskId\', None), None)\\n\\nprint(\\"    ok.\\")"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"$undefined","style":{},"children":["add_segmentation_task_endpoint "]}],["$","span","code-segement1",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement2",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement3",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\\""]}],["$","span","code-segement4",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement5",{"className":"token string-interpolation interpolation","style":{},"children":["self"]}],["$","span","code-segement6",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement7",{"className":"token string-interpolation interpolation","style":{},"children":["api_base_url"]}],["$","span","code-segement8",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement9",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["/add-segmentation-task\\""]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement12",{"className":"$undefined","style":{},"children":["print_inline"]}],["$","span","code-segement13",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement14",{"className":"token","style":{"color":"#116b00"},"children":["\\"Adding task ...\\""]}],["$","span","code-segement15",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement16",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement18",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement19",{"className":"token","style":{"color":"#a04900"},"children":["with"]}],["$","span","code-segement20",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement21",{"className":"token","style":{"color":"#af00af"},"children":["open"]}],["$","span","code-segement22",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement23",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement24",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement25",{"className":"$undefined","style":{},"children":["test_volume_path"]}],["$","span","code-segement26",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement27",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement28",{"className":"token","style":{"color":"#116b00"},"children":["\\"rb\\""]}],["$","span","code-segement29",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement30",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement31",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement32",{"className":"$undefined","style":{},"children":[" f"]}],["$","span","code-segement33",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement34",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement35",{"className":"$undefined","style":{},"children":["    files "]}],["$","span","code-segement36",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement37",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement38",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement39",{"className":"token","style":{"color":"#116b00"},"children":["\\"file\\""]}],["$","span","code-segement40",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement41",{"className":"$undefined","style":{},"children":[" f"]}],["$","span","code-segement42",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement43",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement44",{"className":"$undefined","style":{},"children":["    add_response "]}],["$","span","code-segement45",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement46",{"className":"$undefined","style":{},"children":[" requests"]}],["$","span","code-segement47",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement48",{"className":"$undefined","style":{},"children":["post"]}],["$","span","code-segement49",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement50",{"className":"$undefined","style":{},"children":["add_segmentation_task_endpoint"]}],["$","span","code-segement51",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement52",{"className":"$undefined","style":{},"children":[" files"]}],["$","span","code-segement53",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement54",{"className":"$undefined","style":{},"children":["files"]}],["$","span","code-segement55",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement56",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement58",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement59",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement60",{"className":"$undefined","style":{},"children":["assertEqual"]}],["$","span","code-segement61",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement62",{"className":"$undefined","style":{},"children":["add_response"]}],["$","span","code-segement63",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement64",{"className":"$undefined","style":{},"children":["status_code"]}],["$","span","code-segement65",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement66",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement67",{"className":"token","style":{"color":"#755f00"},"children":["206"]}],["$","span","code-segement68",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement69",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement70",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement71",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement72",{"className":"$undefined","style":{},"children":["assertEqual"]}],["$","span","code-segement73",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement74",{"className":"$undefined","style":{},"children":["add_response"]}],["$","span","code-segement75",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement76",{"className":"$undefined","style":{},"children":["headers"]}],["$","span","code-segement77",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement78",{"className":"token","style":{"color":"#116b00"},"children":["\'content-type\'"]}],["$","span","code-segement79",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement80",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement81",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement82",{"className":"token","style":{"color":"#116b00"},"children":["\\"application/json\\""]}],["$","span","code-segement83",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement84",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement86",{"className":"$undefined","style":{},"children":["add_response_data "]}],["$","span","code-segement87",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement88",{"className":"$undefined","style":{},"children":[" add_response"]}],["$","span","code-segement89",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement90",{"className":"$undefined","style":{},"children":["json"]}],["$","span","code-segement91",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement92",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement93",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement95",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement96",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement97",{"className":"$undefined","style":{},"children":["assertEqual"]}],["$","span","code-segement98",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement99",{"className":"$undefined","style":{},"children":["add_response_data"]}],["$","span","code-segement100",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement101",{"className":"$undefined","style":{},"children":["get"]}],["$","span","code-segement102",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement103",{"className":"token","style":{"color":"#116b00"},"children":["\'success\'"]}],["$","span","code-segement104",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement105",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement106",{"className":"token","style":{"color":"#755f00"},"children":["None"]}],["$","span","code-segement107",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement108",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement109",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement110",{"className":"token","style":{"color":"#755f00"},"children":["True"]}],["$","span","code-segement111",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement112",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement113",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement114",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement115",{"className":"$undefined","style":{},"children":["assertNotEqual"]}],["$","span","code-segement116",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement117",{"className":"$undefined","style":{},"children":["add_response_data"]}],["$","span","code-segement118",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement119",{"className":"$undefined","style":{},"children":["get"]}],["$","span","code-segement120",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement121",{"className":"token","style":{"color":"#116b00"},"children":["\'result\'"]}],["$","span","code-segement122",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement123",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement124",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement125",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement126",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement127",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement128",{"className":"$undefined","style":{},"children":["get"]}],["$","span","code-segement129",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement130",{"className":"token","style":{"color":"#116b00"},"children":["\'taskId\'"]}],["$","span","code-segement131",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement132",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement133",{"className":"token","style":{"color":"#755f00"},"children":["None"]}],["$","span","code-segement134",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement135",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement136",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement137",{"className":"token","style":{"color":"#755f00"},"children":["None"]}],["$","span","code-segement138",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement139",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement141",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement142",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement143",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement144",{"className":"token","style":{"color":"#116b00"},"children":["\\"    ok.\\""]}],["$","span","code-segement145",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Le","62",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Then, we will repeatedly fetch the status of the task until it is completed or failed. If the status is ",["$","$Lc","62-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"failed"}],", we fail the test. If the status is ",["$","$Lc","62-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"completed"}],", we make sure that the ",["$","$Lc","62-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"segmentationFileUrl"}]," in the response is actually what is expected for the ",["$","$Lc","62-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"task_id"}],"."]}],["$","$Lc",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L1c",null,{"contentToCopy":"$1f"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"$undefined","style":{},"children":["task_id "]}],["$","span","code-segement1",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement2",{"className":"$undefined","style":{},"children":[" add_response_data"]}],["$","span","code-segement3",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement4",{"className":"token","style":{"color":"#116b00"},"children":["\'result\'"]}],["$","span","code-segement5",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement6",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement7",{"className":"token","style":{"color":"#116b00"},"children":["\'taskId\'"]}],["$","span","code-segement8",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement9",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":["get_segmentation_task_result_endpoint "]}],["$","span","code-segement11",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement12",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement13",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\\""]}],["$","span","code-segement14",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement15",{"className":"token string-interpolation interpolation","style":{},"children":["self"]}],["$","span","code-segement16",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement17",{"className":"token string-interpolation interpolation","style":{},"children":["api_base_url"]}],["$","span","code-segement18",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement19",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["/get-segmentation-task-result?task_id="]}],["$","span","code-segement20",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement21",{"className":"token string-interpolation interpolation","style":{},"children":["task_id"]}],["$","span","code-segement22",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement23",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["\\""]}],["$","span","code-segement24",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement25",{"className":"$undefined","style":{},"children":["expected_volume_file_url "]}],["$","span","code-segement26",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement27",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement28",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement29",{"className":"$undefined","style":{},"children":["path_basename"]}],["$","span","code-segement30",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement31",{"className":"$undefined","style":{},"children":["data_dir"]}],["$","span","code-segement32",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement33",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement34",{"className":"$undefined","style":{},"children":[" task_id"]}],["$","span","code-segement35",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement36",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement37",{"className":"token","style":{"color":"#116b00"},"children":["\\"volume.nii.gz\\""]}],["$","span","code-segement38",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement39",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement40",{"className":"$undefined","style":{},"children":["expected_segmentation_file_url "]}],["$","span","code-segement41",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement42",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement43",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement44",{"className":"$undefined","style":{},"children":["path_basename"]}],["$","span","code-segement45",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement46",{"className":"$undefined","style":{},"children":["data_dir"]}],["$","span","code-segement47",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement48",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement49",{"className":"$undefined","style":{},"children":[" task_id"]}],["$","span","code-segement50",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement51",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement52",{"className":"token","style":{"color":"#116b00"},"children":["\\"segmentation.nii.gz\\""]}],["$","span","code-segement53",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement54",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement56",{"className":"$undefined","style":{},"children":["print_inline"]}],["$","span","code-segement57",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement58",{"className":"token","style":{"color":"#116b00"},"children":["\\"Getting task status \\""]}],["$","span","code-segement59",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement60",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement62",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement63",{"className":"token","style":{"color":"#a04900"},"children":["while"]}],["$","span","code-segement64",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement65",{"className":"token","style":{"color":"#755f00"},"children":["True"]}],["$","span","code-segement66",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement67",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement68",{"className":"$undefined","style":{},"children":["    get_result_response "]}],["$","span","code-segement69",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement70",{"className":"$undefined","style":{},"children":[" requests"]}],["$","span","code-segement71",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement72",{"className":"$undefined","style":{},"children":["get"]}],["$","span","code-segement73",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement74",{"className":"$undefined","style":{},"children":["get_segmentation_task_result_endpoint"]}],["$","span","code-segement75",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement76",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement78",{"className":"$undefined","style":{},"children":["    self"]}],["$","span","code-segement79",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement80",{"className":"$undefined","style":{},"children":["assertEqual"]}],["$","span","code-segement81",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement82",{"className":"$undefined","style":{},"children":["get_result_response"]}],["$","span","code-segement83",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement84",{"className":"$undefined","style":{},"children":["status_code"]}],["$","span","code-segement85",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement86",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement87",{"className":"token","style":{"color":"#755f00"},"children":["200"]}],["$","span","code-segement88",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement89",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement90",{"className":"$undefined","style":{},"children":["    self"]}],["$","span","code-segement91",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement92",{"className":"$undefined","style":{},"children":["assertEqual"]}],["$","span","code-segement93",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement94",{"className":"$undefined","style":{},"children":["get_result_response"]}],["$","span","code-segement95",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement96",{"className":"$undefined","style":{},"children":["headers"]}],["$","span","code-segement97",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement98",{"className":"token","style":{"color":"#116b00"},"children":["\'content-type\'"]}],["$","span","code-segement99",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement100",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement101",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement102",{"className":"token","style":{"color":"#116b00"},"children":["\\"application/json\\""]}],["$","span","code-segement103",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement104",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement106",{"className":"$undefined","style":{},"children":["    get_result_response_data "]}],["$","span","code-segement107",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement108",{"className":"$undefined","style":{},"children":[" get_result_response"]}],["$","span","code-segement109",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement110",{"className":"$undefined","style":{},"children":["json"]}],["$","span","code-segement111",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement112",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement113",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement115",{"className":"$undefined","style":{},"children":["    self"]}],["$","span","code-segement116",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement117",{"className":"$undefined","style":{},"children":["assertEqual"]}],["$","span","code-segement118",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement119",{"className":"$undefined","style":{},"children":["get_result_response_data"]}],["$","span","code-segement120",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement121",{"className":"$undefined","style":{},"children":["get"]}],["$","span","code-segement122",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement123",{"className":"token","style":{"color":"#116b00"},"children":["\'success\'"]}],["$","span","code-segement124",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement125",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement126",{"className":"token","style":{"color":"#755f00"},"children":["None"]}],["$","span","code-segement127",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement128",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement129",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement130",{"className":"token","style":{"color":"#755f00"},"children":["True"]}],["$","span","code-segement131",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement132",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement133",{"className":"$undefined","style":{},"children":["    self"]}],["$","span","code-segement134",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement135",{"className":"$undefined","style":{},"children":["assertNotEqual"]}],["$","span","code-segement136",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement137",{"className":"$undefined","style":{},"children":["get_result_response_data"]}],["$","span","code-segement138",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement139",{"className":"$undefined","style":{},"children":["get"]}],["$","span","code-segement140",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement141",{"className":"token","style":{"color":"#116b00"},"children":["\'result\'"]}],["$","span","code-segement142",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement143",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement144",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement145",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement146",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement147",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement148",{"className":"$undefined","style":{},"children":["get"]}],["$","span","code-segement149",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement150",{"className":"token","style":{"color":"#116b00"},"children":["\'status\'"]}],["$","span","code-segement151",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement152",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement153",{"className":"token","style":{"color":"#755f00"},"children":["None"]}],["$","span","code-segement154",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement155",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement156",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement157",{"className":"token","style":{"color":"#755f00"},"children":["None"]}],["$","span","code-segement158",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement159",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement160",{"className":"$undefined","style":{},"children":["    self"]}],["$","span","code-segement161",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement162",{"className":"$undefined","style":{},"children":["assertEqual"]}],["$","span","code-segement163",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement164",{"className":"$undefined","style":{},"children":["get_result_response_data"]}],["$","span","code-segement165",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement166",{"className":"$undefined","style":{},"children":["get"]}],["$","span","code-segement167",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement168",{"className":"token","style":{"color":"#116b00"},"children":["\'result\'"]}],["$","span","code-segement169",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement170",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement171",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement172",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement173",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement174",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement175",{"className":"$undefined","style":{},"children":["get"]}],["$","span","code-segement176",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement177",{"className":"token","style":{"color":"#116b00"},"children":["\'taskId\'"]}],["$","span","code-segement178",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement179",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement180",{"className":"token","style":{"color":"#755f00"},"children":["None"]}],["$","span","code-segement181",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement182",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement183",{"className":"$undefined","style":{},"children":[" task_id"]}],["$","span","code-segement184",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement185",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement186",{"className":"$undefined","style":{},"children":["    self"]}],["$","span","code-segement187",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement188",{"className":"$undefined","style":{},"children":["assertEqual"]}],["$","span","code-segement189",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement190",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement191",{"className":"$undefined","style":{},"children":["        get_result_response_data"]}],["$","span","code-segement192",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement193",{"className":"$undefined","style":{},"children":["get"]}],["$","span","code-segement194",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement195",{"className":"token","style":{"color":"#116b00"},"children":["\'result\'"]}],["$","span","code-segement196",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement197",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement198",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement199",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement200",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement201",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement202",{"className":"$undefined","style":{},"children":["get"]}],["$","span","code-segement203",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement204",{"className":"token","style":{"color":"#116b00"},"children":["\'volumeFileUrl\'"]}],["$","span","code-segement205",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement206",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement207",{"className":"token","style":{"color":"#755f00"},"children":["None"]}],["$","span","code-segement208",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement209",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement210",{"className":"$undefined","style":{},"children":["\\n"]}],"        expected_volume_file_url\\n",["$","span","code-segement212",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement213",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement214",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement216",{"className":"$undefined","style":{},"children":["    print_inline"]}],["$","span","code-segement217",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement218",{"className":"token","style":{"color":"#116b00"},"children":["\\".\\""]}],["$","span","code-segement219",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement220",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement222",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement223",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement224",{"className":"$undefined","style":{},"children":[" get_result_response_data"]}],["$","span","code-segement225",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement226",{"className":"token","style":{"color":"#116b00"},"children":["\'result\'"]}],["$","span","code-segement227",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement228",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement229",{"className":"token","style":{"color":"#116b00"},"children":["\'status\'"]}],["$","span","code-segement230",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement231",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement232",{"className":"token","style":{"color":"#a04900"},"children":["=="]}],["$","span","code-segement233",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement234",{"className":"token","style":{"color":"#116b00"},"children":["\\"failed\\""]}],["$","span","code-segement235",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement236",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement237",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement238",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement239",{"className":"$undefined","style":{},"children":["fail"]}],["$","span","code-segement240",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement241",{"className":"token","style":{"color":"#116b00"},"children":["\\"Server failed to segment the uploaded volume.\\""]}],["$","span","code-segement242",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement243",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement244",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement245",{"className":"token","style":{"color":"#a04900"},"children":["break"]}],["$","span","code-segement246",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement248",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement249",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement250",{"className":"$undefined","style":{},"children":[" get_result_response_data"]}],["$","span","code-segement251",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement252",{"className":"token","style":{"color":"#116b00"},"children":["\'result\'"]}],["$","span","code-segement253",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement254",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement255",{"className":"token","style":{"color":"#116b00"},"children":["\'status\'"]}],["$","span","code-segement256",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement257",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement258",{"className":"token","style":{"color":"#a04900"},"children":["=="]}],["$","span","code-segement259",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement260",{"className":"token","style":{"color":"#116b00"},"children":["\\"completed\\""]}],["$","span","code-segement261",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement262",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement263",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement264",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement265",{"className":"$undefined","style":{},"children":["assertEqual"]}],["$","span","code-segement266",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement267",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement268",{"className":"$undefined","style":{},"children":["            get_result_response_data"]}],["$","span","code-segement269",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement270",{"className":"$undefined","style":{},"children":["get"]}],["$","span","code-segement271",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement272",{"className":"token","style":{"color":"#116b00"},"children":["\'result\'"]}],["$","span","code-segement273",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement274",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement275",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement276",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement277",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement278",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement279",{"className":"$undefined","style":{},"children":["get"]}],["$","span","code-segement280",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement281",{"className":"token","style":{"color":"#116b00"},"children":["\'segmentationFileUrl\'"]}],["$","span","code-segement282",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement283",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement284",{"className":"token","style":{"color":"#755f00"},"children":["None"]}],["$","span","code-segement285",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement286",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement287",{"className":"$undefined","style":{},"children":["strip"]}],["$","span","code-segement288",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement289",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement290",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement291",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement292",{"className":"$undefined","style":{},"children":["            expected_segmentation_file_url"]}],["$","span","code-segement293",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement294",{"className":"$undefined","style":{},"children":["strip"]}],["$","span","code-segement295",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement296",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement297",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement298",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement299",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement300",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement301",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement302",{"className":"token","style":{"color":"#a04900"},"children":["break"]}],["$","span","code-segement303",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement305",{"className":"$undefined","style":{},"children":["    sleep"]}],["$","span","code-segement306",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement307",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement308",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement309",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement311",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement312",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement313",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement314",{"className":"token","style":{"color":"#116b00"},"children":["\\"    ok.\\""]}],["$","span","code-segement315",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Le","64",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Next, we download the volume and segmentation files."]}],["$","$Lc",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L1c",null,{"contentToCopy":"print_inline(\\"Downloading files ... \\")\\n\\nvolume_file_url = f\\"{self.base_url}/{expected_volume_file_url}\\"\\nsegmentation_file_url = f\\"{self.base_url}/{expected_segmentation_file_url}\\"\\n\\ntemp_dir = path_join(tests_dir, \\"temp\\")\\nmakedirs(temp_dir, exist_ok=True)\\n\\nvolume_file_path = path_join(temp_dir, f\\"volume-{time()}.nii.gz\\")\\nsegmentation_file_path = path_join(temp_dir, f\\"segmentation-{time()}.nii.gz\\")\\n\\nif not download_file(volume_file_url, volume_file_path):\\n    self.fail(\\"Failed to download volume file from server.\\")\\nprint_inline(\\"    volume download ok ... \\")\\n\\nif not download_file(segmentation_file_url, segmentation_file_path):\\n    self.fail(\\"Failed to download segmentation file from server.\\")\\nprint_inline(\\"    segmentation download ok ... \\")"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"$undefined","style":{},"children":["print_inline"]}],["$","span","code-segement1",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement2",{"className":"token","style":{"color":"#116b00"},"children":["\\"Downloading files ... \\""]}],["$","span","code-segement3",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement6",{"className":"$undefined","style":{},"children":["volume_file_url "]}],["$","span","code-segement7",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement9",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\\""]}],["$","span","code-segement10",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement11",{"className":"token string-interpolation interpolation","style":{},"children":["self"]}],["$","span","code-segement12",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement13",{"className":"token string-interpolation interpolation","style":{},"children":["base_url"]}],["$","span","code-segement14",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement15",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["/"]}],["$","span","code-segement16",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement17",{"className":"token string-interpolation interpolation","style":{},"children":["expected_volume_file_url"]}],["$","span","code-segement18",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement19",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["\\""]}],["$","span","code-segement20",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement21",{"className":"$undefined","style":{},"children":["segmentation_file_url "]}],["$","span","code-segement22",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement23",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement24",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\\""]}],["$","span","code-segement25",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement26",{"className":"token string-interpolation interpolation","style":{},"children":["self"]}],["$","span","code-segement27",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement28",{"className":"token string-interpolation interpolation","style":{},"children":["base_url"]}],["$","span","code-segement29",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement30",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["/"]}],["$","span","code-segement31",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement32",{"className":"token string-interpolation interpolation","style":{},"children":["expected_segmentation_file_url"]}],["$","span","code-segement33",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement34",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["\\""]}],["$","span","code-segement35",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement37",{"className":"$undefined","style":{},"children":["temp_dir "]}],["$","span","code-segement38",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement39",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement40",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement41",{"className":"$undefined","style":{},"children":["tests_dir"]}],["$","span","code-segement42",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement43",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement44",{"className":"token","style":{"color":"#116b00"},"children":["\\"temp\\""]}],["$","span","code-segement45",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement46",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement47",{"className":"$undefined","style":{},"children":["makedirs"]}],["$","span","code-segement48",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement49",{"className":"$undefined","style":{},"children":["temp_dir"]}],["$","span","code-segement50",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement51",{"className":"$undefined","style":{},"children":[" exist_ok"]}],["$","span","code-segement52",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement53",{"className":"token","style":{"color":"#755f00"},"children":["True"]}],["$","span","code-segement54",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement55",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement57",{"className":"$undefined","style":{},"children":["volume_file_path "]}],["$","span","code-segement58",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement59",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement60",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement61",{"className":"$undefined","style":{},"children":["temp_dir"]}],["$","span","code-segement62",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement63",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement64",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\\"volume-"]}],["$","span","code-segement65",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement66",{"className":"token string-interpolation interpolation","style":{},"children":["time"]}],["$","span","code-segement67",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement68",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement69",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement70",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[".nii.gz\\""]}],["$","span","code-segement71",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement72",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement73",{"className":"$undefined","style":{},"children":["segmentation_file_path "]}],["$","span","code-segement74",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement75",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement76",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement77",{"className":"$undefined","style":{},"children":["temp_dir"]}],["$","span","code-segement78",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement79",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement80",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\\"segmentation-"]}],["$","span","code-segement81",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement82",{"className":"token string-interpolation interpolation","style":{},"children":["time"]}],["$","span","code-segement83",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement84",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement85",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement86",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[".nii.gz\\""]}],["$","span","code-segement87",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement88",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement90",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement91",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement92",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement93",{"className":"token","style":{"color":"#a04900"},"children":["not"]}],["$","span","code-segement94",{"className":"$undefined","style":{},"children":[" download_file"]}],["$","span","code-segement95",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement96",{"className":"$undefined","style":{},"children":["volume_file_url"]}],["$","span","code-segement97",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement98",{"className":"$undefined","style":{},"children":[" volume_file_path"]}],["$","span","code-segement99",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement100",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement101",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement102",{"className":"$undefined","style":{},"children":["    self"]}],["$","span","code-segement103",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement104",{"className":"$undefined","style":{},"children":["fail"]}],["$","span","code-segement105",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement106",{"className":"token","style":{"color":"#116b00"},"children":["\\"Failed to download volume file from server.\\""]}],["$","span","code-segement107",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement108",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement109",{"className":"$undefined","style":{},"children":["print_inline"]}],["$","span","code-segement110",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement111",{"className":"token","style":{"color":"#116b00"},"children":["\\"    volume download ok ... \\""]}],["$","span","code-segement112",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement113",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement115",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement116",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement117",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement118",{"className":"token","style":{"color":"#a04900"},"children":["not"]}],["$","span","code-segement119",{"className":"$undefined","style":{},"children":[" download_file"]}],["$","span","code-segement120",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement121",{"className":"$undefined","style":{},"children":["segmentation_file_url"]}],["$","span","code-segement122",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement123",{"className":"$undefined","style":{},"children":[" segmentation_file_path"]}],["$","span","code-segement124",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement125",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement126",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement127",{"className":"$undefined","style":{},"children":["    self"]}],["$","span","code-segement128",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement129",{"className":"$undefined","style":{},"children":["fail"]}],["$","span","code-segement130",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement131",{"className":"token","style":{"color":"#116b00"},"children":["\\"Failed to download segmentation file from server.\\""]}],["$","span","code-segement132",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement133",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement134",{"className":"$undefined","style":{},"children":["print_inline"]}],["$","span","code-segement135",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement136",{"className":"token","style":{"color":"#116b00"},"children":["\\"    segmentation download ok ... \\""]}],["$","span","code-segement137",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Le","66",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Finally, we check whether both the files have the same shape and then delete the downloaded files."]}],["$","$Lc",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L1c",null,{"contentToCopy":"volume_file_data = nib_load(volume_file_path).get_fdata()\\nsegmentation_file_data = nib_load(volume_file_path).get_fdata()\\n\\nself.assertTupleEqual(volume_file_data.shape, segmentation_file_data.shape)\\nprint(\\"    shapes ok.\\")\\n\\nrmtree(temp_dir)"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"$undefined","style":{},"children":["volume_file_data "]}],["$","span","code-segement1",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement2",{"className":"$undefined","style":{},"children":[" nib_load"]}],["$","span","code-segement3",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":["volume_file_path"]}],["$","span","code-segement5",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement6",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement7",{"className":"$undefined","style":{},"children":["get_fdata"]}],["$","span","code-segement8",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement9",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement11",{"className":"$undefined","style":{},"children":["segmentation_file_data "]}],["$","span","code-segement12",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement13",{"className":"$undefined","style":{},"children":[" nib_load"]}],["$","span","code-segement14",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":["volume_file_path"]}],["$","span","code-segement16",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement17",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement18",{"className":"$undefined","style":{},"children":["get_fdata"]}],["$","span","code-segement19",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement20",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement21",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement23",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement24",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement25",{"className":"$undefined","style":{},"children":["assertTupleEqual"]}],["$","span","code-segement26",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement27",{"className":"$undefined","style":{},"children":["volume_file_data"]}],["$","span","code-segement28",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement29",{"className":"$undefined","style":{},"children":["shape"]}],["$","span","code-segement30",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement31",{"className":"$undefined","style":{},"children":[" segmentation_file_data"]}],["$","span","code-segement32",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement33",{"className":"$undefined","style":{},"children":["shape"]}],["$","span","code-segement34",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement35",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement36",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement37",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement38",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement39",{"className":"token","style":{"color":"#116b00"},"children":["\\"    shapes ok.\\""]}],["$","span","code-segement40",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement41",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement43",{"className":"$undefined","style":{},"children":["rmtree"]}],["$","span","code-segement44",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement45",{"className":"$undefined","style":{},"children":["temp_dir"]}],["$","span","code-segement46",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Le","68",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Here\'s the entire ",["$","$Lc","68-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"test_apis.py"}]," file"]}],["$","$Lc",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L1c",null,{"contentToCopy":"$20"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" os "]}],["$","span","code-segement2",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":[" makedirs\\n"]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement5",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement6",{"className":"$undefined","style":{},"children":[" os"]}],["$","span","code-segement7",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":["path "]}],["$","span","code-segement9",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":[" basename "]}],["$","span","code-segement11",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement12",{"className":"$undefined","style":{},"children":[" path_basename"]}],["$","span","code-segement13",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement14",{"className":"$undefined","style":{},"children":[" join "]}],["$","span","code-segement15",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement16",{"className":"$undefined","style":{},"children":[" path_join\\n"]}],["$","span","code-segement17",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement18",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement19",{"className":"$undefined","style":{},"children":[" shutil "]}],["$","span","code-segement20",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement21",{"className":"$undefined","style":{},"children":[" rmtree\\n"]}],["$","span","code-segement22",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement23",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement24",{"className":"$undefined","style":{},"children":[" time "]}],["$","span","code-segement25",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":[" sleep"]}],["$","span","code-segement27",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement28",{"className":"$undefined","style":{},"children":[" time\\n"]}],["$","span","code-segement29",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement30",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement31",{"className":"$undefined","style":{},"children":[" unittest\\n"]}],"\\n",["$","span","code-segement33",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement34",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement35",{"className":"$undefined","style":{},"children":[" nibabel "]}],["$","span","code-segement36",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement37",{"className":"$undefined","style":{},"children":[" load "]}],["$","span","code-segement38",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement39",{"className":"$undefined","style":{},"children":[" nib_load\\n"]}],["$","span","code-segement40",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement41",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement42",{"className":"$undefined","style":{},"children":[" requests\\n"]}],"\\n",["$","span","code-segement44",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement45",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement46",{"className":"$undefined","style":{},"children":[" dirs "]}],["$","span","code-segement47",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement48",{"className":"$undefined","style":{},"children":[" data_dir"]}],["$","span","code-segement49",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement50",{"className":"$undefined","style":{},"children":[" tests_dir\\n"]}],["$","span","code-segement51",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement52",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement53",{"className":"$undefined","style":{},"children":[" utils "]}],["$","span","code-segement54",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement55",{"className":"$undefined","style":{},"children":[" download_file"]}],["$","span","code-segement56",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement57",{"className":"$undefined","style":{},"children":[" print_inline\\n"]}],"\\n","\\n",["$","span","code-segement60",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement61",{"className":"token","style":{"color":"#a04900"},"children":["class"]}],["$","span","code-segement62",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement63",{"className":"token","style":{"color":"#005a8e"},"children":["TestAPIs"]}],["$","span","code-segement64",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement65",{"className":"$undefined","style":{},"children":["unittest"]}],["$","span","code-segement66",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement67",{"className":"$undefined","style":{},"children":["TestCase"]}],["$","span","code-segement68",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement69",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement70",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement71",{"className":"$undefined","style":{},"children":["    base_url "]}],["$","span","code-segement72",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement73",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement74",{"className":"token","style":{"color":"#116b00"},"children":["\\"http://localhost:8000\\""]}],["$","span","code-segement75",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement76",{"className":"$undefined","style":{},"children":["    api_base_url "]}],["$","span","code-segement77",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement78",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement79",{"className":"token","style":{"color":"#116b00"},"children":["\\"http://localhost:8000/api\\""]}],["$","span","code-segement80",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement81",{"className":"$undefined","style":{},"children":["    test_volume_path "]}],["$","span","code-segement82",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement83",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement84",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement85",{"className":"$undefined","style":{},"children":["data_dir"]}],["$","span","code-segement86",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement87",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement88",{"className":"token","style":{"color":"#116b00"},"children":["\\"testing\\""]}],["$","span","code-segement89",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement90",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement91",{"className":"token","style":{"color":"#116b00"},"children":["\\"volume.nii.gz\\""]}],["$","span","code-segement92",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement93",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n","\\n",["$","span","code-segement96",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement97",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement98",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement99",{"className":"token","style":{"color":"#7c00aa"},"children":["test_add_segmentation_task_and_get_result"]}],["$","span","code-segement100",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement101",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement102",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement103",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement104",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement105",{"className":"$undefined","style":{},"children":["        add_segmentation_task_endpoint "]}],["$","span","code-segement106",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement107",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement108",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\\""]}],["$","span","code-segement109",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement110",{"className":"token string-interpolation interpolation","style":{},"children":["self"]}],["$","span","code-segement111",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement112",{"className":"token string-interpolation interpolation","style":{},"children":["api_base_url"]}],["$","span","code-segement113",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement114",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["/add-segmentation-task\\""]}],["$","span","code-segement115",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement117",{"className":"$undefined","style":{},"children":["        print_inline"]}],["$","span","code-segement118",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement119",{"className":"token","style":{"color":"#116b00"},"children":["\\"Adding task ...\\""]}],["$","span","code-segement120",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement121",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement123",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement124",{"className":"token","style":{"color":"#a04900"},"children":["with"]}],["$","span","code-segement125",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement126",{"className":"token","style":{"color":"#af00af"},"children":["open"]}],["$","span","code-segement127",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement128",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement129",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement130",{"className":"$undefined","style":{},"children":["test_volume_path"]}],["$","span","code-segement131",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement132",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement133",{"className":"token","style":{"color":"#116b00"},"children":["\\"rb\\""]}],["$","span","code-segement134",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement135",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement136",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement137",{"className":"$undefined","style":{},"children":[" f"]}],["$","span","code-segement138",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement139",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement140",{"className":"$undefined","style":{},"children":["            files "]}],["$","span","code-segement141",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement142",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement143",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement144",{"className":"token","style":{"color":"#116b00"},"children":["\\"file\\""]}],["$","span","code-segement145",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement146",{"className":"$undefined","style":{},"children":[" f"]}],["$","span","code-segement147",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement148",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement149",{"className":"$undefined","style":{},"children":["            add_response "]}],["$","span","code-segement150",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement151",{"className":"$undefined","style":{},"children":[" requests"]}],["$","span","code-segement152",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement153",{"className":"$undefined","style":{},"children":["post"]}],["$","span","code-segement154",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement155",{"className":"$undefined","style":{},"children":["add_segmentation_task_endpoint"]}],["$","span","code-segement156",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement157",{"className":"$undefined","style":{},"children":[" files"]}],["$","span","code-segement158",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement159",{"className":"$undefined","style":{},"children":["files"]}],["$","span","code-segement160",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement161",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement163",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement164",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement165",{"className":"$undefined","style":{},"children":["assertEqual"]}],["$","span","code-segement166",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement167",{"className":"$undefined","style":{},"children":["add_response"]}],["$","span","code-segement168",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement169",{"className":"$undefined","style":{},"children":["status_code"]}],["$","span","code-segement170",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement171",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement172",{"className":"token","style":{"color":"#755f00"},"children":["206"]}],["$","span","code-segement173",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement174",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement175",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement176",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement177",{"className":"$undefined","style":{},"children":["assertEqual"]}],["$","span","code-segement178",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement179",{"className":"$undefined","style":{},"children":["add_response"]}],["$","span","code-segement180",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement181",{"className":"$undefined","style":{},"children":["headers"]}],["$","span","code-segement182",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement183",{"className":"token","style":{"color":"#116b00"},"children":["\'content-type\'"]}],["$","span","code-segement184",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement185",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement186",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement187",{"className":"token","style":{"color":"#116b00"},"children":["\\"application/json\\""]}],["$","span","code-segement188",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement189",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement191",{"className":"$undefined","style":{},"children":["        add_response_data "]}],["$","span","code-segement192",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement193",{"className":"$undefined","style":{},"children":[" add_response"]}],["$","span","code-segement194",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement195",{"className":"$undefined","style":{},"children":["json"]}],["$","span","code-segement196",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement197",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement198",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement200",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement201",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement202",{"className":"$undefined","style":{},"children":["assertEqual"]}],["$","span","code-segement203",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement204",{"className":"$undefined","style":{},"children":["add_response_data"]}],["$","span","code-segement205",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement206",{"className":"$undefined","style":{},"children":["get"]}],["$","span","code-segement207",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement208",{"className":"token","style":{"color":"#116b00"},"children":["\'success\'"]}],["$","span","code-segement209",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement210",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement211",{"className":"token","style":{"color":"#755f00"},"children":["None"]}],["$","span","code-segement212",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement213",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement214",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement215",{"className":"token","style":{"color":"#755f00"},"children":["True"]}],["$","span","code-segement216",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement217",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement218",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement219",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement220",{"className":"$undefined","style":{},"children":["assertNotEqual"]}],["$","span","code-segement221",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement222",{"className":"$undefined","style":{},"children":["add_response_data"]}],["$","span","code-segement223",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement224",{"className":"$undefined","style":{},"children":["get"]}],["$","span","code-segement225",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement226",{"className":"token","style":{"color":"#116b00"},"children":["\'result\'"]}],["$","span","code-segement227",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement228",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement229",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement230",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement231",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement232",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement233",{"className":"$undefined","style":{},"children":["get"]}],["$","span","code-segement234",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement235",{"className":"token","style":{"color":"#116b00"},"children":["\'taskId\'"]}],["$","span","code-segement236",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement237",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement238",{"className":"token","style":{"color":"#755f00"},"children":["None"]}],["$","span","code-segement239",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement240",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement241",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement242",{"className":"token","style":{"color":"#755f00"},"children":["None"]}],["$","span","code-segement243",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement244",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement246",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement247",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement248",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement249",{"className":"token","style":{"color":"#116b00"},"children":["\\"    ok.\\""]}],["$","span","code-segement250",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement251",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement253",{"className":"$undefined","style":{},"children":["        task_id "]}],["$","span","code-segement254",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement255",{"className":"$undefined","style":{},"children":[" add_response_data"]}],["$","span","code-segement256",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement257",{"className":"token","style":{"color":"#116b00"},"children":["\'result\'"]}],["$","span","code-segement258",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement259",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement260",{"className":"token","style":{"color":"#116b00"},"children":["\'taskId\'"]}],["$","span","code-segement261",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement262",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement263",{"className":"$undefined","style":{},"children":["        get_segmentation_task_result_endpoint "]}],["$","span","code-segement264",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement265",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement266",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\\""]}],["$","span","code-segement267",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement268",{"className":"token string-interpolation interpolation","style":{},"children":["self"]}],["$","span","code-segement269",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement270",{"className":"token string-interpolation interpolation","style":{},"children":["api_base_url"]}],["$","span","code-segement271",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement272",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["/get-segmentation-task-result?task_id="]}],["$","span","code-segement273",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement274",{"className":"token string-interpolation interpolation","style":{},"children":["task_id"]}],["$","span","code-segement275",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement276",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["\\""]}],["$","span","code-segement277",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement278",{"className":"$undefined","style":{},"children":["        expected_volume_file_url "]}],["$","span","code-segement279",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement280",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement281",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement282",{"className":"$undefined","style":{},"children":["path_basename"]}],["$","span","code-segement283",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement284",{"className":"$undefined","style":{},"children":["data_dir"]}],["$","span","code-segement285",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement286",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement287",{"className":"$undefined","style":{},"children":[" task_id"]}],["$","span","code-segement288",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement289",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement290",{"className":"token","style":{"color":"#116b00"},"children":["\\"volume.nii.gz\\""]}],["$","span","code-segement291",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement292",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement293",{"className":"$undefined","style":{},"children":["        expected_segmentation_file_url "]}],["$","span","code-segement294",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement295",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement296",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement297",{"className":"$undefined","style":{},"children":["path_basename"]}],["$","span","code-segement298",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement299",{"className":"$undefined","style":{},"children":["data_dir"]}],["$","span","code-segement300",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement301",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement302",{"className":"$undefined","style":{},"children":[" task_id"]}],["$","span","code-segement303",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement304",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement305",{"className":"token","style":{"color":"#116b00"},"children":["\\"segmentation.nii.gz\\""]}],["$","span","code-segement306",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement307",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement309",{"className":"$undefined","style":{},"children":["        print_inline"]}],["$","span","code-segement310",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement311",{"className":"token","style":{"color":"#116b00"},"children":["\\"Getting task status \\""]}],["$","span","code-segement312",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement313",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement315",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement316",{"className":"token","style":{"color":"#a04900"},"children":["while"]}],["$","span","code-segement317",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement318",{"className":"token","style":{"color":"#755f00"},"children":["True"]}],["$","span","code-segement319",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement320",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement321",{"className":"$undefined","style":{},"children":["            get_result_response "]}],["$","span","code-segement322",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement323",{"className":"$undefined","style":{},"children":[" requests"]}],["$","span","code-segement324",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement325",{"className":"$undefined","style":{},"children":["get"]}],["$","span","code-segement326",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement327",{"className":"$undefined","style":{},"children":["get_segmentation_task_result_endpoint"]}],["$","span","code-segement328",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement329",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement331",{"className":"$undefined","style":{},"children":["            self"]}],["$","span","code-segement332",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement333",{"className":"$undefined","style":{},"children":["assertEqual"]}],["$","span","code-segement334",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement335",{"className":"$undefined","style":{},"children":["get_result_response"]}],["$","span","code-segement336",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement337",{"className":"$undefined","style":{},"children":["status_code"]}],["$","span","code-segement338",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement339",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement340",{"className":"token","style":{"color":"#755f00"},"children":["200"]}],["$","span","code-segement341",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement342",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement343",{"className":"$undefined","style":{},"children":["            self"]}],["$","span","code-segement344",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement345",{"className":"$undefined","style":{},"children":["assertEqual"]}],["$","span","code-segement346",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement347",{"className":"$undefined","style":{},"children":["get_result_response"]}],["$","span","code-segement348",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement349",{"className":"$undefined","style":{},"children":["headers"]}],["$","span","code-segement350",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement351",{"className":"token","style":{"color":"#116b00"},"children":["\'content-type\'"]}],["$","span","code-segement352",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement353",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement354",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement355",{"className":"token","style":{"color":"#116b00"},"children":["\\"application/json\\""]}],["$","span","code-segement356",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement357",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement359",{"className":"$undefined","style":{},"children":["            get_result_response_data "]}],["$","span","code-segement360",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement361",{"className":"$undefined","style":{},"children":[" get_result_response"]}],["$","span","code-segement362",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement363",{"className":"$undefined","style":{},"children":["json"]}],["$","span","code-segement364",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement365",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement366",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement368",{"className":"$undefined","style":{},"children":["            self"]}],["$","span","code-segement369",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement370",{"className":"$undefined","style":{},"children":["assertEqual"]}],["$","span","code-segement371",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement372",{"className":"$undefined","style":{},"children":["get_result_response_data"]}],["$","span","code-segement373",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement374",{"className":"$undefined","style":{},"children":["get"]}],["$","span","code-segement375",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement376",{"className":"token","style":{"color":"#116b00"},"children":["\'success\'"]}],["$","span","code-segement377",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement378",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement379",{"className":"token","style":{"color":"#755f00"},"children":["None"]}],["$","span","code-segement380",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement381",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement382",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement383",{"className":"token","style":{"color":"#755f00"},"children":["True"]}],["$","span","code-segement384",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement385",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement386",{"className":"$undefined","style":{},"children":["            self"]}],["$","span","code-segement387",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement388",{"className":"$undefined","style":{},"children":["assertNotEqual"]}],["$","span","code-segement389",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement390",{"className":"$undefined","style":{},"children":["get_result_response_data"]}],["$","span","code-segement391",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement392",{"className":"$undefined","style":{},"children":["get"]}],["$","span","code-segement393",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement394",{"className":"token","style":{"color":"#116b00"},"children":["\'result\'"]}],["$","span","code-segement395",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement396",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement397",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement398",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement399",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement400",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement401",{"className":"$undefined","style":{},"children":["get"]}],["$","span","code-segement402",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement403",{"className":"token","style":{"color":"#116b00"},"children":["\'status\'"]}],["$","span","code-segement404",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement405",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement406",{"className":"token","style":{"color":"#755f00"},"children":["None"]}],["$","span","code-segement407",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement408",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement409",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement410",{"className":"token","style":{"color":"#755f00"},"children":["None"]}],["$","span","code-segement411",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement412",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement413",{"className":"$undefined","style":{},"children":["            self"]}],["$","span","code-segement414",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement415",{"className":"$undefined","style":{},"children":["assertEqual"]}],["$","span","code-segement416",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement417",{"className":"$undefined","style":{},"children":["get_result_response_data"]}],["$","span","code-segement418",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement419",{"className":"$undefined","style":{},"children":["get"]}],["$","span","code-segement420",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement421",{"className":"token","style":{"color":"#116b00"},"children":["\'result\'"]}],["$","span","code-segement422",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement423",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement424",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement425",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement426",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement427",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement428",{"className":"$undefined","style":{},"children":["get"]}],["$","span","code-segement429",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement430",{"className":"token","style":{"color":"#116b00"},"children":["\'taskId\'"]}],["$","span","code-segement431",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement432",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement433",{"className":"token","style":{"color":"#755f00"},"children":["None"]}],["$","span","code-segement434",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement435",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement436",{"className":"$undefined","style":{},"children":[" task_id"]}],["$","span","code-segement437",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement438",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement439",{"className":"$undefined","style":{},"children":["            self"]}],["$","span","code-segement440",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement441",{"className":"$undefined","style":{},"children":["assertEqual"]}],["$","span","code-segement442",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement443",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement444",{"className":"$undefined","style":{},"children":["                get_result_response_data"]}],["$","span","code-segement445",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement446",{"className":"$undefined","style":{},"children":["get"]}],["$","span","code-segement447",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement448",{"className":"token","style":{"color":"#116b00"},"children":["\'result\'"]}],["$","span","code-segement449",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement450",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement451",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement452",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement453",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement454",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement455",{"className":"$undefined","style":{},"children":["get"]}],["$","span","code-segement456",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement457",{"className":"token","style":{"color":"#116b00"},"children":["\'volumeFileUrl\'"]}],["$","span","code-segement458",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement459",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement460",{"className":"token","style":{"color":"#755f00"},"children":["None"]}],["$","span","code-segement461",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement462",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement463",{"className":"$undefined","style":{},"children":["\\n"]}],"                expected_volume_file_url\\n",["$","span","code-segement465",{"className":"$undefined","style":{},"children":["            "]}],["$","span","code-segement466",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement467",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement469",{"className":"$undefined","style":{},"children":["            print_inline"]}],["$","span","code-segement470",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement471",{"className":"token","style":{"color":"#116b00"},"children":["\\".\\""]}],["$","span","code-segement472",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement473",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement475",{"className":"$undefined","style":{},"children":["            "]}],["$","span","code-segement476",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement477",{"className":"$undefined","style":{},"children":[" get_result_response_data"]}],["$","span","code-segement478",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement479",{"className":"token","style":{"color":"#116b00"},"children":["\'result\'"]}],["$","span","code-segement480",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement481",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement482",{"className":"token","style":{"color":"#116b00"},"children":["\'status\'"]}],["$","span","code-segement483",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement484",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement485",{"className":"token","style":{"color":"#a04900"},"children":["=="]}],["$","span","code-segement486",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement487",{"className":"token","style":{"color":"#116b00"},"children":["\\"failed\\""]}],["$","span","code-segement488",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement489",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement490",{"className":"$undefined","style":{},"children":["                self"]}],["$","span","code-segement491",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement492",{"className":"$undefined","style":{},"children":["fail"]}],["$","span","code-segement493",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement494",{"className":"token","style":{"color":"#116b00"},"children":["\\"Server failed to segment the uploaded volume.\\""]}],["$","span","code-segement495",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement496",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement497",{"className":"$undefined","style":{},"children":["                "]}],["$","span","code-segement498",{"className":"token","style":{"color":"#a04900"},"children":["break"]}],["$","span","code-segement499",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement501",{"className":"$undefined","style":{},"children":["            "]}],["$","span","code-segement502",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement503",{"className":"$undefined","style":{},"children":[" get_result_response_data"]}],["$","span","code-segement504",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement505",{"className":"token","style":{"color":"#116b00"},"children":["\'result\'"]}],["$","span","code-segement506",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement507",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement508",{"className":"token","style":{"color":"#116b00"},"children":["\'status\'"]}],["$","span","code-segement509",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement510",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement511",{"className":"token","style":{"color":"#a04900"},"children":["=="]}],["$","span","code-segement512",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement513",{"className":"token","style":{"color":"#116b00"},"children":["\\"completed\\""]}],["$","span","code-segement514",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement515",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement516",{"className":"$undefined","style":{},"children":["                self"]}],["$","span","code-segement517",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement518",{"className":"$undefined","style":{},"children":["assertEqual"]}],["$","span","code-segement519",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement520",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement521",{"className":"$undefined","style":{},"children":["                    get_result_response_data"]}],["$","span","code-segement522",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement523",{"className":"$undefined","style":{},"children":["get"]}],["$","span","code-segement524",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement525",{"className":"token","style":{"color":"#116b00"},"children":["\'result\'"]}],["$","span","code-segement526",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement527",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement528",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement529",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement530",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement531",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement532",{"className":"$undefined","style":{},"children":["get"]}],["$","span","code-segement533",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement534",{"className":"token","style":{"color":"#116b00"},"children":["\'segmentationFileUrl\'"]}],["$","span","code-segement535",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement536",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement537",{"className":"token","style":{"color":"#755f00"},"children":["None"]}],["$","span","code-segement538",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement539",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement540",{"className":"$undefined","style":{},"children":["strip"]}],["$","span","code-segement541",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement542",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement543",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement544",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement545",{"className":"$undefined","style":{},"children":["                    expected_segmentation_file_url"]}],["$","span","code-segement546",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement547",{"className":"$undefined","style":{},"children":["strip"]}],["$","span","code-segement548",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement549",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement550",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement551",{"className":"$undefined","style":{},"children":["                "]}],["$","span","code-segement552",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement553",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement554",{"className":"$undefined","style":{},"children":["                "]}],["$","span","code-segement555",{"className":"token","style":{"color":"#a04900"},"children":["break"]}],["$","span","code-segement556",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement558",{"className":"$undefined","style":{},"children":["            sleep"]}],["$","span","code-segement559",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement560",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement561",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement562",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement564",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement565",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement566",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement567",{"className":"token","style":{"color":"#116b00"},"children":["\\"    ok.\\""]}],["$","span","code-segement568",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement569",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement571",{"className":"$undefined","style":{},"children":["        print_inline"]}],["$","span","code-segement572",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement573",{"className":"token","style":{"color":"#116b00"},"children":["\\"Downloading files ... \\""]}],["$","span","code-segement574",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement575",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement577",{"className":"$undefined","style":{},"children":["        volume_file_url "]}],["$","span","code-segement578",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement579",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement580",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\\""]}],["$","span","code-segement581",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement582",{"className":"token string-interpolation interpolation","style":{},"children":["self"]}],["$","span","code-segement583",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement584",{"className":"token string-interpolation interpolation","style":{},"children":["base_url"]}],["$","span","code-segement585",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement586",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["/"]}],["$","span","code-segement587",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement588",{"className":"token string-interpolation interpolation","style":{},"children":["expected_volume_file_url"]}],["$","span","code-segement589",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement590",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["\\""]}],["$","span","code-segement591",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement592",{"className":"$undefined","style":{},"children":["        segmentation_file_url "]}],["$","span","code-segement593",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement594",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement595",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\\""]}],["$","span","code-segement596",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement597",{"className":"token string-interpolation interpolation","style":{},"children":["self"]}],["$","span","code-segement598",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement599",{"className":"token string-interpolation interpolation","style":{},"children":["base_url"]}],["$","span","code-segement600",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement601",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["/"]}],["$","span","code-segement602",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement603",{"className":"token string-interpolation interpolation","style":{},"children":["expected_segmentation_file_url"]}],["$","span","code-segement604",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement605",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["\\""]}],["$","span","code-segement606",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement608",{"className":"$undefined","style":{},"children":["        temp_dir "]}],["$","span","code-segement609",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement610",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement611",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement612",{"className":"$undefined","style":{},"children":["tests_dir"]}],["$","span","code-segement613",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement614",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement615",{"className":"token","style":{"color":"#116b00"},"children":["\\"temp\\""]}],["$","span","code-segement616",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement617",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement618",{"className":"$undefined","style":{},"children":["        makedirs"]}],["$","span","code-segement619",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement620",{"className":"$undefined","style":{},"children":["temp_dir"]}],["$","span","code-segement621",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement622",{"className":"$undefined","style":{},"children":[" exist_ok"]}],["$","span","code-segement623",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement624",{"className":"token","style":{"color":"#755f00"},"children":["True"]}],["$","span","code-segement625",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement626",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement628",{"className":"$undefined","style":{},"children":["        volume_file_path "]}],["$","span","code-segement629",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement630",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement631",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement632",{"className":"$undefined","style":{},"children":["temp_dir"]}],["$","span","code-segement633",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement634",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement635",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\\"volume-"]}],["$","span","code-segement636",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement637",{"className":"token string-interpolation interpolation","style":{},"children":["time"]}],["$","span","code-segement638",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement639",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement640",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement641",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[".nii.gz\\""]}],["$","span","code-segement642",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement643",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement644",{"className":"$undefined","style":{},"children":["        segmentation_file_path "]}],["$","span","code-segement645",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement646",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement647",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement648",{"className":"$undefined","style":{},"children":["temp_dir"]}],["$","span","code-segement649",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement650",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement651",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\\"segmentation-"]}],["$","span","code-segement652",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement653",{"className":"token string-interpolation interpolation","style":{},"children":["time"]}],["$","span","code-segement654",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement655",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement656",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement657",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[".nii.gz\\""]}],["$","span","code-segement658",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement659",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement661",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement662",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement663",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement664",{"className":"token","style":{"color":"#a04900"},"children":["not"]}],["$","span","code-segement665",{"className":"$undefined","style":{},"children":[" download_file"]}],["$","span","code-segement666",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement667",{"className":"$undefined","style":{},"children":["volume_file_url"]}],["$","span","code-segement668",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement669",{"className":"$undefined","style":{},"children":[" volume_file_path"]}],["$","span","code-segement670",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement671",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement672",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement673",{"className":"$undefined","style":{},"children":["            self"]}],["$","span","code-segement674",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement675",{"className":"$undefined","style":{},"children":["fail"]}],["$","span","code-segement676",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement677",{"className":"token","style":{"color":"#116b00"},"children":["\\"Failed to download volume file from server.\\""]}],["$","span","code-segement678",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement679",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement680",{"className":"$undefined","style":{},"children":["        print_inline"]}],["$","span","code-segement681",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement682",{"className":"token","style":{"color":"#116b00"},"children":["\\"    volume download ok ... \\""]}],["$","span","code-segement683",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement684",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement686",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement687",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement688",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement689",{"className":"token","style":{"color":"#a04900"},"children":["not"]}],["$","span","code-segement690",{"className":"$undefined","style":{},"children":[" download_file"]}],["$","span","code-segement691",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement692",{"className":"$undefined","style":{},"children":["segmentation_file_url"]}],["$","span","code-segement693",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement694",{"className":"$undefined","style":{},"children":[" segmentation_file_path"]}],["$","span","code-segement695",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement696",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement697",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement698",{"className":"$undefined","style":{},"children":["            self"]}],["$","span","code-segement699",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement700",{"className":"$undefined","style":{},"children":["fail"]}],["$","span","code-segement701",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement702",{"className":"token","style":{"color":"#116b00"},"children":["\\"Failed to download segmentation file from server.\\""]}],["$","span","code-segement703",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement704",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement705",{"className":"$undefined","style":{},"children":["        print_inline"]}],["$","span","code-segement706",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement707",{"className":"token","style":{"color":"#116b00"},"children":["\\"    segmentation download ok ... \\""]}],["$","span","code-segement708",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement709",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement711",{"className":"$undefined","style":{},"children":["        volume_file_data "]}],["$","span","code-segement712",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement713",{"className":"$undefined","style":{},"children":[" nib_load"]}],["$","span","code-segement714",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement715",{"className":"$undefined","style":{},"children":["volume_file_path"]}],["$","span","code-segement716",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement717",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement718",{"className":"$undefined","style":{},"children":["get_fdata"]}],["$","span","code-segement719",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement720",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement721",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement722",{"className":"$undefined","style":{},"children":["        segmentation_file_data "]}],["$","span","code-segement723",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement724",{"className":"$undefined","style":{},"children":[" nib_load"]}],["$","span","code-segement725",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement726",{"className":"$undefined","style":{},"children":["volume_file_path"]}],["$","span","code-segement727",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement728",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement729",{"className":"$undefined","style":{},"children":["get_fdata"]}],["$","span","code-segement730",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement731",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement732",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement734",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement735",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement736",{"className":"$undefined","style":{},"children":["assertTupleEqual"]}],["$","span","code-segement737",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement738",{"className":"$undefined","style":{},"children":["volume_file_data"]}],["$","span","code-segement739",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement740",{"className":"$undefined","style":{},"children":["shape"]}],["$","span","code-segement741",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement742",{"className":"$undefined","style":{},"children":[" segmentation_file_data"]}],["$","span","code-segement743",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement744",{"className":"$undefined","style":{},"children":["shape"]}],["$","span","code-segement745",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement746",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement747",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement748",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement749",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement750",{"className":"token","style":{"color":"#116b00"},"children":["\\"    shapes ok.\\""]}],["$","span","code-segement751",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement752",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement754",{"className":"$undefined","style":{},"children":["        rmtree"]}],["$","span","code-segement755",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement756",{"className":"$undefined","style":{},"children":["temp_dir"]}],["$","span","code-segement757",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement758",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement760",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement761",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement762",{"className":"$undefined","style":{},"children":[" __name__ "]}],["$","span","code-segement763",{"className":"token","style":{"color":"#a04900"},"children":["=="]}],["$","span","code-segement764",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement765",{"className":"token","style":{"color":"#116b00"},"children":["\\"__main__\\""]}],["$","span","code-segement766",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement767",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement768",{"className":"$undefined","style":{},"children":["    unittest"]}],["$","span","code-segement769",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement770",{"className":"$undefined","style":{},"children":["main"]}],["$","span","code-segement771",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement772",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Le","70",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Let\'s create a new environment for the tests"]}],["$","$Lc",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L1c",null,{"contentToCopy":"python3 -m venv env_test\\nsource env_test/bin/activate"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-bash","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"$undefined","style":{},"children":["python3 -m venv env_test\\n"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement2",{"className":"token","style":{"color":"#005a8e"},"children":["source"]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":[" env_test/bin/activate"]}]]]}]}]]}],["$","$Le","72",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","And, install the following packages"]}],["$","$Lc",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L1c",null,{"contentToCopy":"pip install requests nibabel"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-bash","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"$undefined","style":{},"children":["pip "]}],["$","span","code-segement1",{"className":"token","style":{"color":"#7c00aa"},"children":["install"]}],["$","span","code-segement2",{"className":"$undefined","style":{},"children":[" requests nibabel"]}]]]}]}]]}],["$","$Le","74",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","We can run the tests by running the following command from the ",["$","$Lc","74-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"tests"}]," directory:"]}],["$","$Lc",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L1c",null,{"contentToCopy":"python3 test_apis.py"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-bash","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"$undefined","style":{},"children":["python3 test_apis.py"]}]]]}]}]]}],["$","$Le","76",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","You should see an output saying that one test ran successfully."]}],["$","$Le","77",{"id":"conclusion","variant":"h4","component":"h1","mb":2,"children":["$","strong",null,{"children":"Conclusion"}]}],["$","$Le","78",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","We have successfully created and tested the APIs that allow us to convert a CT scan volume into a segmentation using ",["$","$L1b","78-link",{"href":"https://github.com/wasserth/TotalSegmentator","rel":"noopener noreferrer","target":"_blank","color":"primary","underline":"hover","children":"TotalSegmentator"}],"."]}],["$","$Le","79",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","3D Slicer is a tool that can be used to visualize the segmentations we generated today. If you\'d like to know more about 3D Slicer and how to customize it to fit some of your own requirements, you can check out ",["$","$L1b","79-link",{"href":"/full-stack/3d-slicer-extension-tutorials","color":"primary","underline":"hover","children":"this series"}]," where I cover how to build a Slicer Extension or specifically ",["$","$L1b","79-link",{"href":"/full-stack/3d-slicer-extension-tutorials/3","color":"primary","underline":"hover","children":"this part"}],", in which, we make a Slicer Extension to work with the API we created today."]}],["$","$Le","80",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","See you next time :)"]}]]}]}]]}]}],"$L21"]}]\n',
      ]);
    </script>
    <script>
      self.__next_f.push([
        1,
        '22:I[3713,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],"default"]\n16:["$","$Lc",null,{"sx":{"width":"100%","display":"flex","flexDirection":"row","justifyContent":"space-between","alignItems":"center"},"children":[["$","$Le",null,{"variant":"p","component":"p","mr":2,"children":"By: Abhilaksh Singh Reen"}],["$","$L22",null,{"socialMediaProfiles":[{"network_name":"LinkedIn","profile_url":"https://www.linkedin.com/in/abhilaksh-singh-837901210/","profile_display_name":"Abhilaksh Singh Reen"},{"network_name":"Twitter","profile_url":"https://x.com/TheVeteran06","profile_display_name":"The Veteran 06"},{"network_name":"GitHub","profile_url":"https://github.com/AbhilakshSinghReen","profile_display_name":"Abhilaksh Singh Reen"}]}]]}]\n',
      ]);
    </script>
    <script>
      self.__next_f.push([
        1,
        '23:I[6652,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],""]\n24:I[6981,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],""]\n25:I[2818,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],""]\n',
      ]);
    </script>
    <script>
      self.__next_f.push([
        1,
        '21:["$","$Lc",null,{"mt":5,"mb":5,"pb":2,"sx":{"width":"100%","display":"flex","flexDirection":"column","justifyContent":"flex-start","alignItems":"center"},"children":["$","$L15",null,{"container":true,"spacing":2,"mt":4,"mb":4,"children":[["$","$L15","/full-stack/3d-slicer-extension-tutorials",{"item":true,"xs":12,"sm":6,"md":4,"lg":3,"children":["$","$Lf",null,{"href":"/full-stack/3d-slicer-extension-tutorials","passHref":true,"style":{"textDecoration":"none"},"children":["$","$L23",null,{"sx":{"width":"100%","height":"100%","boxShadow":"1px 1px 1px 1px \\"#eeeeee\\"","\u0026:hover":{"boxShadow":"3px 3px 3px 3px \\"#eeeeee\\"","cursor":"pointer"}},"children":[["$","$L24",null,{"component":"img","height":"150","image":"/media/images/3d-slicer-extension-tutorials-series-thumbnails.jpg","alt":"3D Slicer Extension Tutorials","sx":{"objectFit":"cover"}}],["$","$L25",null,{"children":[["$","$Le",null,{"gutterBottom":true,"variant":"h6","component":"h2","children":[""," ","3D Slicer Extension Tutorials"]}],["$","$Le",null,{"gutterBottom":true,"variant":"p","component":"p","sx":{"overflow":"hidden","textOverflow":"ellipsis","display":"-webkit-box","WebkitLineClamp":"3","WebkitBoxOrient":"vertical"},"children":"Learn how to create an extension for 3D Slicer: extract volumes and slices, run ML models, edit segmentations, and much more."}],false,["$","$Lc",null,{"sx":{"width":"100%","display":"flex","flexDirection":"row","justifyContent":"space-between","alignItems":"center"},"children":[["$","$Le",null,{"gutterBottom":true,"variant":"p","component":"p","children":"3 Parts"}],["$","$Le",null,{"gutterBottom":true,"variant":"p","component":"p","children":"24m Read"}]]}]]}]]}]}]}],["$","$L15","/full-stack/undefined",{"item":true,"xs":12,"sm":6,"md":4,"lg":3,"children":["$","$Lf",null,{"href":"/full-stack/3d-slicer-extension-tutorials/3","passHref":true,"style":{"textDecoration":"none"},"children":["$","$L23",null,{"sx":{"width":"100%","height":"100%","boxShadow":"1px 1px 1px 1px \\"#eeeeee\\"","\u0026:hover":{"boxShadow":"3px 3px 3px 3px \\"#eeeeee\\"","cursor":"pointer"}},"children":[["$","$L24",null,{"component":"img","height":"150","image":"/media/images/3d-slicer-extension-segmentation-through-custom-api-flow.jpg","alt":"Getting a segment via an API","sx":{"objectFit":"cover"}}],["$","$L25",null,{"children":[["$","$Le",null,{"gutterBottom":true,"variant":"h6","component":"h2","children":[["$","strong",null,{"children":["#","3"]}]," ","Getting a segment via an API"]}],["$","$Le",null,{"gutterBottom":true,"variant":"p","component":"p","sx":{"overflow":"hidden","textOverflow":"ellipsis","display":"-webkit-box","WebkitLineClamp":"3","WebkitBoxOrient":"vertical"},"children":"Learn how to segment the loaded volume via an API running a ML model."}],false,false]}]]}]}]}]]}]}]\n',
      ]);
    </script>
  </body>
</html>
