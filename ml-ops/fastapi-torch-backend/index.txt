3:I[9275,[],""]
6:I[1343,[],""]
7:I[6871,["98","static/chunks/98-7f6363f9ac68c942.js","748","static/chunks/748-1f14ee6eb3d7029a.js","271","static/chunks/271-37a22bace913f735.js","185","static/chunks/app/layout-08611f287dda1230.js"],"default"]
8:I[5877,["98","static/chunks/98-7f6363f9ac68c942.js","748","static/chunks/748-1f14ee6eb3d7029a.js","271","static/chunks/271-37a22bace913f735.js","185","static/chunks/app/layout-08611f287dda1230.js"],"default"]
9:I[902,["98","static/chunks/98-7f6363f9ac68c942.js","748","static/chunks/748-1f14ee6eb3d7029a.js","271","static/chunks/271-37a22bace913f735.js","185","static/chunks/app/layout-08611f287dda1230.js"],""]
a:I[5218,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],""]
b:I[2324,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],"default"]
c:I[2591,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],""]
d:I[231,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],""]
e:I[3180,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],""]
f:I[3245,["98","static/chunks/98-7f6363f9ac68c942.js","748","static/chunks/748-1f14ee6eb3d7029a.js","271","static/chunks/271-37a22bace913f735.js","185","static/chunks/app/layout-08611f287dda1230.js"],"default"]
4:["categorySlug","ml-ops","d"]
5:["postOrSeriesSlug","fastapi-torch-backend","d"]
0:["WOpoYNfSyePVsNQIvcvfm",[[["",{"children":[["categorySlug","ml-ops","d"],{"children":[["postOrSeriesSlug","fastapi-torch-backend","d"],{"children":["__PAGE__?{\"categorySlug\":\"ml-ops\",\"postOrSeriesSlug\":\"fastapi-torch-backend\"}",{}]}]}]},"$undefined","$undefined",true],["",{"children":[["categorySlug","ml-ops","d"],{"children":[["postOrSeriesSlug","fastapi-torch-backend","d"],{"children":["__PAGE__",{},[["$L1","$L2"],null],null]},["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","$4","children","$5","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}],null]},["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","$4","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}],null]},[["$","html",null,{"lang":"en","suppressHydrationWarning":true,"children":["$","body",null,{"className":"__className_d65c78","children":["$","$L7",null,{"children":[["$","$L8",null,{}],["$","$L9",null,{"maxWidth":"lg","children":[["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":["$","$La",null,{"children":[["$","$Lb",null,{"render":false,"targetSiteNavigationState":[],"targetPageNavigationState":[]}],["$","$Lc",null,{"variant":"h4","children":["$","strong",null,{"children":"Not Found"}]}],["$","$Lc",null,{"variant":"h6","mb":3,"children":"Oops! It looks like the page you're looking for does not exist."}],["$","$Ld",null,{"href":"/","children":["$","$Le",null,{"variant":"contained","sx":{"marginRight":5,"marginBottom":1},"children":"Take me Home"}]}]]}],"notFoundStyles":[],"styles":null}],["$","$Lf",null,{}]]}]]}]}]}],null],null],[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/1d4d01086947be98.css","precedence":"next","crossOrigin":"$undefined"}]],"$L10"]]]]
10:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","1",{"charSet":"utf-8"}],["$","link","2",{"rel":"icon","href":"/favicon.ico","type":"image/x-icon","sizes":"16x16"}]]
1:null
11:I[3507,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],""]
13:I[4204,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],"default"]
14:I[1847,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],"default"]
15:I[8125,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],""]
16:I[3578,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],"default"]
17:I[7005,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],""]
18:I[6480,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],"default"]
19:T738,from json import load as json_load
from os import listdir
from os.path import join as path_join
import unittest

import requests

from config import data_dir


class TestAPIInference(unittest.TestCase):
    def setUp(self):
        self.url = "http://localhost:8000/api/run-inference"
        self.images_dir = path_join(data_dir, "test_images")
        self.labels_json_file_path = path_join(data_dir, "test_images_labels.json")

        with open(self.labels_json_file_path, 'r') as labels_json_file:
            self.labels = json_load(labels_json_file)

    def test_inference(self):
        num_correct_predictions = 0
        num_bad_responses = 0
        all_image_names = listdir(self.images_dir)

        for image_name in all_image_names:
            image_file_path = path_join(self.images_dir, image_name)

            with open(image_file_path, "rb") as file:
                response = requests.post(self.url, files={"file": file})

            if response.status_code != 200:
                num_bad_responses += 1

            self.assertEqual(response.status_code, 200)

            response_data = response.json()

            if response_data['predicted_label'] == self.labels[image_name]:
                num_correct_predictions += 1

            print(
                f"Image: {image_name}, "
                f"Predicted Label: {response_data['predicted_label']}, "
                f"Correct: {response_data['predicted_label'] == self.labels[image_name]}"
            )

        num_inferred = len(all_image_names) - num_bad_responses
        accuracy = num_correct_predictions / num_inferred

        print(f"Failed to infer: {num_bad_responses} / {len(all_image_names)}")
        print(f"Correct Predictions: {num_correct_predictions} / {num_inferred}, Accuracy: {accuracy}")


if __name__ == '__main__':
    unittest.main()1a:T410,Image: 1.png, Predicted Label: 2, Correct: False
Image: 10.png, Predicted Label: 7, Correct: True
Image: 11.png, Predicted Label: 7, Correct: True
Image: 12.png, Predicted Label: 0, Correct: True
Image: 13.png, Predicted Label: 5, Correct: True
Image: 14.png, Predicted Label: 3, Correct: True
Image: 15.png, Predicted Label: 2, Correct: True
Image: 16.png, Predicted Label: 1, Correct: True
Image: 17.png, Predicted Label: 0, Correct: True
Image: 18.png, Predicted Label: 8, Correct: True
Image: 19.png, Predicted Label: 7, Correct: True
Image: 2.png, Predicted Label: 7, Correct: True
Image: 20.png, Predicted Label: 4, Correct: True
Image: 3.png, Predicted Label: 2, Correct: True
Image: 4.png, Predicted Label: 9, Correct: True
Image: 5.png, Predicted Label: 8, Correct: True
Image: 6.png, Predicted Label: 5, Correct: True
Image: 7.png, Predicted Label: 1, Correct: True
Image: 8.png, Predicted Label: 7, Correct: True
Image: 9.png, Predicted Label: 1, Correct: True
Failed to infer: 0 / 20
Correct Predictions: 19 / 20, Accuracy: 0.952:["$","$La",null,{"mb":5,"pb":2,"sx":{"width":"100%","display":"flex","flexDirection":"column","justifyContent":"flex-start","alignItems":"flex-start"},"children":[["$","$Lb",null,{"render":true,"targetSiteNavigationState":[{"absoluteSlug":"/ml-ops","title":"ML Ops"},{"absoluteSlug":"/ml-ops/fastapi-torch-backend","title":"Serving a PyTorch Model using FastAPI"}],"targetPageNavigationState":[{"title":"Server Setup","absoluteSlug":"#server-setup"},{"title":"Requirements","absoluteSlug":"#requirements"},{"title":"Configuration","absoluteSlug":"#configuration"},{"title":"The Model","absoluteSlug":"#the-model"},{"title":"FastAPI Server and Torch Inference","absoluteSlug":"#fastapi-server-and-torch-inference"},{"title":"Testing","absoluteSlug":"#testing"},{"title":"Testing Data","absoluteSlug":"#testing-data"},{"title":"The Test Case","absoluteSlug":"#the-test-case"},{"title":"Conclusion","absoluteSlug":"#conclusion"}]}],["$","$L11",null,{"container":true,"spacing":2,"mb":0,"children":[["$","$L11",null,{"item":true,"xs":12,"sm":12,"md":4,"sx":{"background":"linear-gradient(to right, #eeeeee, #ffffff)","borderRadius":5},"children":["$","$La",null,{"sx":{"width":"100%","height":"100%","display":"flex","flexDirection":"column","justifyContent":"center","alignItems":"flex-start","paddingBottom":2},"children":[["$","$Lc",null,{"gutterBottom":true,"variant":"h5","component":"h1","children":"Serving a PyTorch Model using FastAPI"}],["$","$Lc",null,{"gutterBottom":true,"variant":"p","component":"p","mb":4,"children":"Learn how to serve a PyTorch model with FastAPI."}],["$","$La",null,{"sx":{"width":"100%","display":"flex","flexDirection":"row","justifyContent":"space-between","alignItems":"center","marginBottom":2},"children":[["$","$Lc",null,{"gutterBottom":true,"variant":"p","component":"p","children":"August 26, 2024"}],["$","$Lc",null,{"gutterBottom":true,"variant":"p","component":"p","children":["06m"," Read"]}]]}],"$L12",false]}]}],["$","$L11",null,{"item":true,"xs":12,"sm":12,"md":8,"children":["$","$La",null,{"sx":{"flex":1,"display":"flex","flexDirection":"column","justifyContent":"center","alignItems":"center","marginRight":2},"children":["$","img",null,{"src":"/media/images/fastapi-torch-backend-thumbnail.jpg","style":{"width":"100%","maxWidth":"75vw","height":"auto","maxHeight":"35vh","objectFit":"cover"}}]}]}]]}],["$","$La",null,{"sx":{"width":"100%"},"children":["$","$L11",null,{"container":true,"spacing":2,"mt":4,"mb":0,"children":[["$","$L11",null,{"item":true,"xs":12,"sm":12,"md":4,"lg":3,"sx":{"background":"linear-gradient(to right, #eeeeee, #ffffff)","borderRadius":5},"children":["$","$La",null,{"sx":{"width":"100%"},"children":[["$","$La",null,{"sx":{"width":"100%","display":{"xs":"block","md":"none"},"marginBottom":2},"children":["$","$L13",null,{"sx":{"width":"100%","marginBottom":2,"boxShadow":3,"backgroundColor":"#ffffff22"},"disableGutters":true,"children":[["$","$L14",null,{"expandIcon":["$","$L15",null,{}],"children":["$","$Lc",null,{"variant":"h6","component":"h6","sx":{"margin":0,"padding":0},"children":"Table of Contents"}]}],["$","$L16",null,{"sx":{"width":"90%","display":"flex","flexDirection":"column","justifyContent":"flex-start","alignItems":"flex-start","marginBottom":2},"children":[["$","a","0",{"href":"#server-setup","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","0",{"variant":"p","component":"p","ml":0,"mb":2.5,"sx":{"&:hover":{"color":"blue"}},"children":"Server Setup"}]}],["$","a","1",{"href":"#requirements","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","1",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"Requirements"}]}],["$","a","2",{"href":"#configuration","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","2",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"Configuration"}]}],["$","a","3",{"href":"#the-model","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","3",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"The Model"}]}],["$","a","4",{"href":"#fastapi-server-and-torch-inference","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","4",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"FastAPI Server and Torch Inference"}]}],["$","a","5",{"href":"#testing","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","5",{"variant":"p","component":"p","ml":0,"mb":2.5,"sx":{"&:hover":{"color":"blue"}},"children":"Testing"}]}],["$","a","6",{"href":"#testing-data","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","6",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"Testing Data"}]}],["$","a","7",{"href":"#the-test-case","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","7",{"variant":"p","component":"p","ml":0,"mb":2.5,"sx":{"&:hover":{"color":"blue"}},"children":"The Test Case"}]}],["$","a","8",{"href":"#conclusion","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","8",{"variant":"p","component":"p","ml":0,"mb":2.5,"sx":{"&:hover":{"color":"blue"}},"children":"Conclusion"}]}]]}]]}]}],["$","$La",null,{"sx":{"width":"100%","display":{"xs":"none","md":"block"}},"children":[["$","$Lc",null,{"variant":"h5","component":"h5","sx":{"margin":0,"padding":0},"children":"Table of Contents"}],[["$","a","0",{"href":"#server-setup","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","0",{"variant":"p","component":"p","ml":0,"mb":2.5,"sx":{"&:hover":{"color":"blue"}},"children":"Server Setup"}]}],["$","a","1",{"href":"#requirements","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","1",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"Requirements"}]}],["$","a","2",{"href":"#configuration","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","2",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"Configuration"}]}],["$","a","3",{"href":"#the-model","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","3",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"The Model"}]}],["$","a","4",{"href":"#fastapi-server-and-torch-inference","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","4",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"FastAPI Server and Torch Inference"}]}],["$","a","5",{"href":"#testing","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","5",{"variant":"p","component":"p","ml":0,"mb":2.5,"sx":{"&:hover":{"color":"blue"}},"children":"Testing"}]}],["$","a","6",{"href":"#testing-data","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","6",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"Testing Data"}]}],["$","a","7",{"href":"#the-test-case","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","7",{"variant":"p","component":"p","ml":0,"mb":2.5,"sx":{"&:hover":{"color":"blue"}},"children":"The Test Case"}]}],["$","a","8",{"href":"#conclusion","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","8",{"variant":"p","component":"p","ml":0,"mb":2.5,"sx":{"&:hover":{"color":"blue"}},"children":"Conclusion"}]}]]]}]]}]}],["$","$L11",null,{"item":true,"xs":12,"sm":12,"md":8,"lg":9,"sx":{"background":"linear-gradient(to right, #ffffff, #eeeeee)","borderRadius":5},"children":["$","$La",null,{"sx":{"flex":1,"marginRight":2},"children":[["$","$Lc","0",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","In ",["$","$L17","0-link",{"href":"/ml-ops/torch-training-and-conversion-to-onnx","color":"primary","underline":"hover","children":"this Post"}],", we trained a CNN in PyTorch to recognize handwritten digits. Today, we'll put it on a REST server using FastAPI, so that other applications can make use of our model without having it locally. This is actually surprisingly simple - just a little over a hundred lines of code."]}],["$","$Lc","1",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","The code for this Article can be found ",["$","$L17","1-link",{"href":"https://github.com/AbhilakshSinghReen/drawn-digit-recognition/tree/main/backends/fastapi-torch","rel":"noopener noreferrer","target":"_blank","color":"primary","underline":"hover","children":"right here"}],"."]}],["$","$Lc","2",{"id":"server-setup","variant":"h4","component":"h1","mb":2,"children":["$","strong",null,{"children":"Server Setup"}]}],["$","$Lc","3",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Once completed, our codebase would look something like the following:"]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"│   requirements.txt\n│\n├───models\n├───src\n│       app.py\n│       config.py\n│       model.py\n│       __init__.py\n│\n└───tests\n        config.py\n        requirements.txt\n        test_apis.py"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-bash","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"$undefined","style":{},"children":["│   requirements.txt\n"]}],"│\n","├───models\n","├───src\n","│       app.py\n","│       config.py\n","│       model.py\n","│       __init__.py\n","│\n","└───tests\n","        config.py\n","        requirements.txt\n","        test_apis.py"]]}]}]]}],["$","$Lc","5",{"id":"requirements","variant":"h5","component":"h2","mb":2,"children":["$","strong",null,{"children":"Requirements"}]}],["$","$Lc","6",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","It is recommended to do this in a virtual environment. Install the required packages by running:"]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"pip install fastapi numpy torch torchvision opencv-python pydantic python-multipart uvicorn"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-bash","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"$undefined","style":{},"children":["pip "]}],["$","span","code-segement1",{"className":"token","style":{"color":"#7c00aa"},"children":["install"]}],["$","span","code-segement2",{"className":"$undefined","style":{},"children":[" fastapi numpy torch torchvision opencv-python pydantic python-multipart uvicorn"]}]]]}]}]]}],["$","$Lc","8",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Unfortunately, since we are using PyTorch for inference, we need to have ",["$","$La","8-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"torch"}]," and ",["$","$La","8-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"torchvision"}]," installed. These are large packages and their installation is time-consuming. If you're interested in a more lightweight deployment, you can do it with ONNX Runtime, as we have done ",["$","$L17","8-link",{"href":"/ml-ops/fastapi-onnx-backend","color":"primary","underline":"hover","children":"here"}],". For now, let's continue with torch."]}],["$","$Lc","9",{"id":"configuration","variant":"h5","component":"h2","mb":2,"children":["$","strong",null,{"children":"Configuration"}]}],["$","$Lc","10",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Inside the project directory, we make another folder called ",["$","$La","10-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"src"}],", and in this folder, we create a file called ",["$","$La","10-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"config.py"}],"."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"from os.path import dirname, join as path_join\n\n\nmodels_dir = path_join(dirname(dirname(__file__)), \"models\")"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" os"]}],["$","span","code-segement2",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":["path "]}],["$","span","code-segement4",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement5",{"className":"$undefined","style":{},"children":[" dirname"]}],["$","span","code-segement6",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement7",{"className":"$undefined","style":{},"children":[" join "]}],["$","span","code-segement8",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement9",{"className":"$undefined","style":{},"children":[" path_join\n"]}],"\n","\n",["$","span","code-segement12",{"className":"$undefined","style":{},"children":["models_dir "]}],["$","span","code-segement13",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement14",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement15",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement16",{"className":"$undefined","style":{},"children":["dirname"]}],["$","span","code-segement17",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement18",{"className":"$undefined","style":{},"children":["dirname"]}],["$","span","code-segement19",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement20",{"className":"$undefined","style":{},"children":["__file__"]}],["$","span","code-segement21",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement22",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement23",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement24",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement25",{"className":"token","style":{"color":"#116b00"},"children":["\"models\""]}],["$","span","code-segement26",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Lc","12",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Right now, we only have the path to our models directory in this file. Feel free to add more configuration as needed."]}],["$","$Lc","13",{"id":"the-model","variant":"h5","component":"h2","mb":2,"children":["$","strong",null,{"children":"The Model"}]}],["$","$Lc","14",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Let's work on ",["$","$La","14-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"src/model.py"}]," next."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"import torch\nimport torch.nn as nn\nimport torch.optim as optim\n\n\nclass CNN(nn.Module):\n    def __init__(self):\n        super(CNN, self).__init__()\n\n        self.conv1 = nn.Conv2d(in_channels=1, out_channels=10, kernel_size=5)\n        self.pool = nn.MaxPool2d(kernel_size=2, stride=2)\n        self.conv2 = nn.Conv2d(in_channels=10, out_channels=20, kernel_size=5)\n        self.dropout = nn.Dropout(p=0.5)\n        self.fc1 = nn.Linear(20 * 4 * 4, 50)\n        self.fc2 = nn.Linear(50, 10)\n\n    def forward(self, x):\n        x = self.pool(torch.relu(self.conv1(x)))\n        x = self.pool(torch.relu(self.conv2(x)))\n        x = self.dropout(x)\n        x = x.view(-1, 20 * 4 * 4)  # Flatten the tensor\n        x = torch.relu(self.fc1(x))\n        x = self.dropout(x)\n        x = self.fc2(x)\n        return torch.softmax(x, dim=1)\n\n# Create an instance of the CNN model\nmodel = CNN()\n\n# Define loss function and optimizer\n# criterion = nn.CrossEntropyLoss()\n# optimizer = optim.Adam(model.parameters(), lr=0.001)"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" torch\n"]}],["$","span","code-segement2",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement3",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement5",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement6",{"className":"$undefined","style":{},"children":["nn "]}],["$","span","code-segement7",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":[" nn\n"]}],["$","span","code-segement9",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement10",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement11",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement12",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement13",{"className":"$undefined","style":{},"children":["optim "]}],["$","span","code-segement14",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":[" optim\n"]}],"\n","\n",["$","span","code-segement18",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement19",{"className":"token","style":{"color":"#a04900"},"children":["class"]}],["$","span","code-segement20",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement21",{"className":"token","style":{"color":"#005a8e"},"children":["CNN"]}],["$","span","code-segement22",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement23",{"className":"$undefined","style":{},"children":["nn"]}],["$","span","code-segement24",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement25",{"className":"$undefined","style":{},"children":["Module"]}],["$","span","code-segement26",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement27",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement28",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement29",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement30",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement31",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement32",{"className":"token","style":{"color":"#7c00aa"},"children":["__init__"]}],["$","span","code-segement33",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement34",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement35",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement36",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement37",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement38",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement39",{"className":"token","style":{"color":"#af00af"},"children":["super"]}],["$","span","code-segement40",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement41",{"className":"$undefined","style":{},"children":["CNN"]}],["$","span","code-segement42",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement43",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement44",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement45",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement46",{"className":"$undefined","style":{},"children":["__init__"]}],["$","span","code-segement47",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement48",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement49",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement51",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement52",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement53",{"className":"$undefined","style":{},"children":["conv1 "]}],["$","span","code-segement54",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement55",{"className":"$undefined","style":{},"children":[" nn"]}],["$","span","code-segement56",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement57",{"className":"$undefined","style":{},"children":["Conv2d"]}],["$","span","code-segement58",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement59",{"className":"$undefined","style":{},"children":["in_channels"]}],["$","span","code-segement60",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement61",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement62",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement63",{"className":"$undefined","style":{},"children":[" out_channels"]}],["$","span","code-segement64",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement65",{"className":"token","style":{"color":"#755f00"},"children":["10"]}],["$","span","code-segement66",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement67",{"className":"$undefined","style":{},"children":[" kernel_size"]}],["$","span","code-segement68",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement69",{"className":"token","style":{"color":"#755f00"},"children":["5"]}],["$","span","code-segement70",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement71",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement72",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement73",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement74",{"className":"$undefined","style":{},"children":["pool "]}],["$","span","code-segement75",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement76",{"className":"$undefined","style":{},"children":[" nn"]}],["$","span","code-segement77",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement78",{"className":"$undefined","style":{},"children":["MaxPool2d"]}],["$","span","code-segement79",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement80",{"className":"$undefined","style":{},"children":["kernel_size"]}],["$","span","code-segement81",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement82",{"className":"token","style":{"color":"#755f00"},"children":["2"]}],["$","span","code-segement83",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement84",{"className":"$undefined","style":{},"children":[" stride"]}],["$","span","code-segement85",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement86",{"className":"token","style":{"color":"#755f00"},"children":["2"]}],["$","span","code-segement87",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement88",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement89",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement90",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement91",{"className":"$undefined","style":{},"children":["conv2 "]}],["$","span","code-segement92",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement93",{"className":"$undefined","style":{},"children":[" nn"]}],["$","span","code-segement94",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement95",{"className":"$undefined","style":{},"children":["Conv2d"]}],["$","span","code-segement96",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement97",{"className":"$undefined","style":{},"children":["in_channels"]}],["$","span","code-segement98",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement99",{"className":"token","style":{"color":"#755f00"},"children":["10"]}],["$","span","code-segement100",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement101",{"className":"$undefined","style":{},"children":[" out_channels"]}],["$","span","code-segement102",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement103",{"className":"token","style":{"color":"#755f00"},"children":["20"]}],["$","span","code-segement104",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement105",{"className":"$undefined","style":{},"children":[" kernel_size"]}],["$","span","code-segement106",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement107",{"className":"token","style":{"color":"#755f00"},"children":["5"]}],["$","span","code-segement108",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement109",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement110",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement111",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement112",{"className":"$undefined","style":{},"children":["dropout "]}],["$","span","code-segement113",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement114",{"className":"$undefined","style":{},"children":[" nn"]}],["$","span","code-segement115",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement116",{"className":"$undefined","style":{},"children":["Dropout"]}],["$","span","code-segement117",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement118",{"className":"$undefined","style":{},"children":["p"]}],["$","span","code-segement119",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement120",{"className":"token","style":{"color":"#755f00"},"children":["0.5"]}],["$","span","code-segement121",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement122",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement123",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement124",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement125",{"className":"$undefined","style":{},"children":["fc1 "]}],["$","span","code-segement126",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement127",{"className":"$undefined","style":{},"children":[" nn"]}],["$","span","code-segement128",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement129",{"className":"$undefined","style":{},"children":["Linear"]}],["$","span","code-segement130",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement131",{"className":"token","style":{"color":"#755f00"},"children":["20"]}],["$","span","code-segement132",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement133",{"className":"token","style":{"color":"#a04900"},"children":["*"]}],["$","span","code-segement134",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement135",{"className":"token","style":{"color":"#755f00"},"children":["4"]}],["$","span","code-segement136",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement137",{"className":"token","style":{"color":"#a04900"},"children":["*"]}],["$","span","code-segement138",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement139",{"className":"token","style":{"color":"#755f00"},"children":["4"]}],["$","span","code-segement140",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement141",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement142",{"className":"token","style":{"color":"#755f00"},"children":["50"]}],["$","span","code-segement143",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement144",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement145",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement146",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement147",{"className":"$undefined","style":{},"children":["fc2 "]}],["$","span","code-segement148",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement149",{"className":"$undefined","style":{},"children":[" nn"]}],["$","span","code-segement150",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement151",{"className":"$undefined","style":{},"children":["Linear"]}],["$","span","code-segement152",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement153",{"className":"token","style":{"color":"#755f00"},"children":["50"]}],["$","span","code-segement154",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement155",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement156",{"className":"token","style":{"color":"#755f00"},"children":["10"]}],["$","span","code-segement157",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement158",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement160",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement161",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement162",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement163",{"className":"token","style":{"color":"#7c00aa"},"children":["forward"]}],["$","span","code-segement164",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement165",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement166",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement167",{"className":"$undefined","style":{},"children":[" x"]}],["$","span","code-segement168",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement169",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement170",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement171",{"className":"$undefined","style":{},"children":["        x "]}],["$","span","code-segement172",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement173",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement174",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement175",{"className":"$undefined","style":{},"children":["pool"]}],["$","span","code-segement176",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement177",{"className":"$undefined","style":{},"children":["torch"]}],["$","span","code-segement178",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement179",{"className":"$undefined","style":{},"children":["relu"]}],["$","span","code-segement180",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement181",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement182",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement183",{"className":"$undefined","style":{},"children":["conv1"]}],["$","span","code-segement184",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement185",{"className":"$undefined","style":{},"children":["x"]}],["$","span","code-segement186",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement187",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement188",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement189",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement190",{"className":"$undefined","style":{},"children":["        x "]}],["$","span","code-segement191",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement192",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement193",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement194",{"className":"$undefined","style":{},"children":["pool"]}],["$","span","code-segement195",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement196",{"className":"$undefined","style":{},"children":["torch"]}],["$","span","code-segement197",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement198",{"className":"$undefined","style":{},"children":["relu"]}],["$","span","code-segement199",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement200",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement201",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement202",{"className":"$undefined","style":{},"children":["conv2"]}],["$","span","code-segement203",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement204",{"className":"$undefined","style":{},"children":["x"]}],["$","span","code-segement205",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement206",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement207",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement208",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement209",{"className":"$undefined","style":{},"children":["        x "]}],["$","span","code-segement210",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement211",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement212",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement213",{"className":"$undefined","style":{},"children":["dropout"]}],["$","span","code-segement214",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement215",{"className":"$undefined","style":{},"children":["x"]}],["$","span","code-segement216",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement217",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement218",{"className":"$undefined","style":{},"children":["        x "]}],["$","span","code-segement219",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement220",{"className":"$undefined","style":{},"children":[" x"]}],["$","span","code-segement221",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement222",{"className":"$undefined","style":{},"children":["view"]}],["$","span","code-segement223",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement224",{"className":"token","style":{"color":"#a04900"},"children":["-"]}],["$","span","code-segement225",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement226",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement227",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement228",{"className":"token","style":{"color":"#755f00"},"children":["20"]}],["$","span","code-segement229",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement230",{"className":"token","style":{"color":"#a04900"},"children":["*"]}],["$","span","code-segement231",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement232",{"className":"token","style":{"color":"#755f00"},"children":["4"]}],["$","span","code-segement233",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement234",{"className":"token","style":{"color":"#a04900"},"children":["*"]}],["$","span","code-segement235",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement236",{"className":"token","style":{"color":"#755f00"},"children":["4"]}],["$","span","code-segement237",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement238",{"className":"$undefined","style":{},"children":["  "]}],["$","span","code-segement239",{"className":"token","style":{"color":"#3c526d"},"children":["# Flatten the tensor"]}],["$","span","code-segement240",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement241",{"className":"$undefined","style":{},"children":["        x "]}],["$","span","code-segement242",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement243",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement244",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement245",{"className":"$undefined","style":{},"children":["relu"]}],["$","span","code-segement246",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement247",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement248",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement249",{"className":"$undefined","style":{},"children":["fc1"]}],["$","span","code-segement250",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement251",{"className":"$undefined","style":{},"children":["x"]}],["$","span","code-segement252",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement253",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement254",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement255",{"className":"$undefined","style":{},"children":["        x "]}],["$","span","code-segement256",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement257",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement258",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement259",{"className":"$undefined","style":{},"children":["dropout"]}],["$","span","code-segement260",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement261",{"className":"$undefined","style":{},"children":["x"]}],["$","span","code-segement262",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement263",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement264",{"className":"$undefined","style":{},"children":["        x "]}],["$","span","code-segement265",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement266",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement267",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement268",{"className":"$undefined","style":{},"children":["fc2"]}],["$","span","code-segement269",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement270",{"className":"$undefined","style":{},"children":["x"]}],["$","span","code-segement271",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement272",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement273",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement274",{"className":"token","style":{"color":"#a04900"},"children":["return"]}],["$","span","code-segement275",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement276",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement277",{"className":"$undefined","style":{},"children":["softmax"]}],["$","span","code-segement278",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement279",{"className":"$undefined","style":{},"children":["x"]}],["$","span","code-segement280",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement281",{"className":"$undefined","style":{},"children":[" dim"]}],["$","span","code-segement282",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement283",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement284",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement285",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement287",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement288",{"className":"token","style":{"color":"#3c526d"},"children":["# Create an instance of the CNN model"]}],["$","span","code-segement289",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement290",{"className":"$undefined","style":{},"children":["model "]}],["$","span","code-segement291",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement292",{"className":"$undefined","style":{},"children":[" CNN"]}],["$","span","code-segement293",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement294",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement295",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement297",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement298",{"className":"token","style":{"color":"#3c526d"},"children":["# Define loss function and optimizer"]}],["$","span","code-segement299",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement300",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement301",{"className":"token","style":{"color":"#3c526d"},"children":["# criterion = nn.CrossEntropyLoss()"]}],["$","span","code-segement302",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement303",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement304",{"className":"token","style":{"color":"#3c526d"},"children":["# optimizer = optim.Adam(model.parameters(), lr=0.001)"]}]]]}]}]]}],["$","$Lc","16",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","I've copied this file from our ",["$","$L17","16-link",{"href":"/ml-ops/torch-training-and-conversion-to-onnx","color":"primary","underline":"hover","children":"training project"}]," and commented out the unnecessary bit. In summary, the model is a Convolutional Neural Network with two convolution, one max pooling, one dropout, and two fully-connected layers."]}],["$","$Lc","17",{"id":"fastapi-server-and-torch-inference","variant":"h5","component":"h2","mb":2,"children":["$","strong",null,{"children":"FastAPI Server and Torch Inference"}]}],["$","$Lc","18",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Next up, we have ",["$","$La","18-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"src/app.py"}]," that contains our FastAPI server and the Inference code for our model. We import the required packages, initialize the server, load the model, and define our preprocessing transforms."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"from os.path import join as path_join\n\nimport cv2\nfrom fastapi import FastAPI, File, UploadFile, Query\nfrom fastapi.responses import JSONResponse\nfrom fastapi.middleware.cors import CORSMiddleware\nimport numpy as np\nimport torch\nfrom torchvision import transforms\n\nfrom .config import models_dir\nfrom .model import CNN\n\n\n# MODEL_WEIGHTS_FILE_PATH = path_join(models_dir, \"training_id\", \"epoch-epoch_numbe\")\nMODEL_WEIGHTS_FILE_PATH = path_join(models_dir, \"torch---2024-04-23-08-25-15\", \"epoch-9.pt\")\ndevice = torch.device(\"cuda\" if torch.cuda.is_available() else \"cpu\")\n\n\napp = FastAPI()\n# app.add_middleware(\n#     CORSMiddleware,\n#     allow_origins=[\"*\"],\n#     allow_credentials=True,\n#     allow_methods=[\"*\"],\n#     allow_headers=[\"*\"],\n# )\n\nmodel = CNN()\nmodel = model.to(device)\nmodel.load_state_dict(torch.load(MODEL_WEIGHTS_FILE_PATH, map_location=device))\nmodel.eval()\n\npreprocessing_transforms = transforms.Compose([\n    transforms.ToTensor(),\n])"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" os"]}],["$","span","code-segement2",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":["path "]}],["$","span","code-segement4",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement5",{"className":"$undefined","style":{},"children":[" join "]}],["$","span","code-segement6",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement7",{"className":"$undefined","style":{},"children":[" path_join\n"]}],"\n",["$","span","code-segement9",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement10",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement11",{"className":"$undefined","style":{},"children":[" cv2\n"]}],["$","span","code-segement12",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement13",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement14",{"className":"$undefined","style":{},"children":[" fastapi "]}],["$","span","code-segement15",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement16",{"className":"$undefined","style":{},"children":[" FastAPI"]}],["$","span","code-segement17",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement18",{"className":"$undefined","style":{},"children":[" File"]}],["$","span","code-segement19",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement20",{"className":"$undefined","style":{},"children":[" UploadFile"]}],["$","span","code-segement21",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement22",{"className":"$undefined","style":{},"children":[" Query\n"]}],["$","span","code-segement23",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement24",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement25",{"className":"$undefined","style":{},"children":[" fastapi"]}],["$","span","code-segement26",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement27",{"className":"$undefined","style":{},"children":["responses "]}],["$","span","code-segement28",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement29",{"className":"$undefined","style":{},"children":[" JSONResponse\n"]}],["$","span","code-segement30",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement31",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement32",{"className":"$undefined","style":{},"children":[" fastapi"]}],["$","span","code-segement33",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement34",{"className":"$undefined","style":{},"children":["middleware"]}],["$","span","code-segement35",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement36",{"className":"$undefined","style":{},"children":["cors "]}],["$","span","code-segement37",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement38",{"className":"$undefined","style":{},"children":[" CORSMiddleware\n"]}],["$","span","code-segement39",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement40",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement41",{"className":"$undefined","style":{},"children":[" numpy "]}],["$","span","code-segement42",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement43",{"className":"$undefined","style":{},"children":[" np\n"]}],["$","span","code-segement44",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement45",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement46",{"className":"$undefined","style":{},"children":[" torch\n"]}],["$","span","code-segement47",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement48",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement49",{"className":"$undefined","style":{},"children":[" torchvision "]}],["$","span","code-segement50",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement51",{"className":"$undefined","style":{},"children":[" transforms\n"]}],"\n",["$","span","code-segement53",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement54",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement55",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement56",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement57",{"className":"$undefined","style":{},"children":["config "]}],["$","span","code-segement58",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement59",{"className":"$undefined","style":{},"children":[" models_dir\n"]}],["$","span","code-segement60",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement61",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement62",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement63",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement64",{"className":"$undefined","style":{},"children":["model "]}],["$","span","code-segement65",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement66",{"className":"$undefined","style":{},"children":[" CNN\n"]}],"\n","\n",["$","span","code-segement69",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement70",{"className":"token","style":{"color":"#3c526d"},"children":["# MODEL_WEIGHTS_FILE_PATH = path_join(models_dir, \"training_id\", \"epoch-epoch_numbe\")"]}],["$","span","code-segement71",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement72",{"className":"$undefined","style":{},"children":["MODEL_WEIGHTS_FILE_PATH "]}],["$","span","code-segement73",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement74",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement75",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement76",{"className":"$undefined","style":{},"children":["models_dir"]}],["$","span","code-segement77",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement78",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement79",{"className":"token","style":{"color":"#116b00"},"children":["\"torch---2024-04-23-08-25-15\""]}],["$","span","code-segement80",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement81",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement82",{"className":"token","style":{"color":"#116b00"},"children":["\"epoch-9.pt\""]}],["$","span","code-segement83",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement84",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement85",{"className":"$undefined","style":{},"children":["device "]}],["$","span","code-segement86",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement87",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement88",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement89",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement90",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement91",{"className":"token","style":{"color":"#116b00"},"children":["\"cuda\""]}],["$","span","code-segement92",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement93",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement94",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement95",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement96",{"className":"$undefined","style":{},"children":["cuda"]}],["$","span","code-segement97",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement98",{"className":"$undefined","style":{},"children":["is_available"]}],["$","span","code-segement99",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement100",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement101",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement102",{"className":"token","style":{"color":"#a04900"},"children":["else"]}],["$","span","code-segement103",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement104",{"className":"token","style":{"color":"#116b00"},"children":["\"cpu\""]}],["$","span","code-segement105",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement106",{"className":"$undefined","style":{},"children":["\n"]}],"\n","\n",["$","span","code-segement109",{"className":"$undefined","style":{},"children":["app "]}],["$","span","code-segement110",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement111",{"className":"$undefined","style":{},"children":[" FastAPI"]}],["$","span","code-segement112",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement113",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement114",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement115",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement116",{"className":"token","style":{"color":"#3c526d"},"children":["# app.add_middleware("]}],["$","span","code-segement117",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement118",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement119",{"className":"token","style":{"color":"#3c526d"},"children":["#     CORSMiddleware,"]}],["$","span","code-segement120",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement121",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement122",{"className":"token","style":{"color":"#3c526d"},"children":["#     allow_origins=[\"*\"],"]}],["$","span","code-segement123",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement124",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement125",{"className":"token","style":{"color":"#3c526d"},"children":["#     allow_credentials=True,"]}],["$","span","code-segement126",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement127",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement128",{"className":"token","style":{"color":"#3c526d"},"children":["#     allow_methods=[\"*\"],"]}],["$","span","code-segement129",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement130",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement131",{"className":"token","style":{"color":"#3c526d"},"children":["#     allow_headers=[\"*\"],"]}],["$","span","code-segement132",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement133",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement134",{"className":"token","style":{"color":"#3c526d"},"children":["# )"]}],["$","span","code-segement135",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement137",{"className":"$undefined","style":{},"children":["model "]}],["$","span","code-segement138",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement139",{"className":"$undefined","style":{},"children":[" CNN"]}],["$","span","code-segement140",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement141",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement142",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement143",{"className":"$undefined","style":{},"children":["model "]}],["$","span","code-segement144",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement145",{"className":"$undefined","style":{},"children":[" model"]}],["$","span","code-segement146",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement147",{"className":"$undefined","style":{},"children":["to"]}],["$","span","code-segement148",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement149",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement150",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement151",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement152",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement153",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement154",{"className":"$undefined","style":{},"children":["load_state_dict"]}],["$","span","code-segement155",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement156",{"className":"$undefined","style":{},"children":["torch"]}],["$","span","code-segement157",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement158",{"className":"$undefined","style":{},"children":["load"]}],["$","span","code-segement159",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement160",{"className":"$undefined","style":{},"children":["MODEL_WEIGHTS_FILE_PATH"]}],["$","span","code-segement161",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement162",{"className":"$undefined","style":{},"children":[" map_location"]}],["$","span","code-segement163",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement164",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement165",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement166",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement167",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement168",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement169",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement170",{"className":"token","style":{"color":"#af00af"},"children":["eval"]}],["$","span","code-segement171",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement172",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement173",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement175",{"className":"$undefined","style":{},"children":["preprocessing_transforms "]}],["$","span","code-segement176",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement177",{"className":"$undefined","style":{},"children":[" transforms"]}],["$","span","code-segement178",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement179",{"className":"$undefined","style":{},"children":["Compose"]}],["$","span","code-segement180",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement181",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement182",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement183",{"className":"$undefined","style":{},"children":["    transforms"]}],["$","span","code-segement184",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement185",{"className":"$undefined","style":{},"children":["ToTensor"]}],["$","span","code-segement186",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement187",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement188",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement189",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement190",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement191",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement192",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Lc","20",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","We can now define our inference endpoint."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"@app.post(\"/api/run-inference\")\nasync def run_inference(file: UploadFile = File(...), image_provider: str = Query(None)):\n    file_contents = await file.read()\n    np_arr = np.frombuffer(file_contents, np.uint8)\n    image = cv2.imdecode(np_arr,  cv2.IMREAD_UNCHANGED)\n\n    # Remove the alpha channel and make the digit black on white\n    if image_provider == \"konva\":\n        image = image[:, :, 3]\n\n    # cv2.imwrite(\"original.png\", image)\n\n    image = cv2.resize(image, (28, 28))\n    # cv2.imwrite(\"resized.png\", image)\n\n    if len(image.shape) > 2 and image.shape[-1] > 1:\n        image = image[:, :, 0]\n\n    preprocessed_image = preprocessing_transforms(image)\n    preprocessed_image = preprocessed_image.unsqueeze(0)\n\n    output = model(preprocessed_image)\n    prediction = output.argmax(dim=1, keepdim=True)\n    prediction = int(prediction)\n\n    return JSONResponse(\n        content={\n            \"predicted_label\": prediction,\n        },\n        status_code=200\n    )"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token decorator annotation","style":{"color":"#111b27"},"children":["@app"]}],["$","span","code-segement1",{"className":"token decorator annotation","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement2",{"className":"token decorator annotation","style":{"color":"#111b27"},"children":["post"]}],["$","span","code-segement3",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement4",{"className":"token","style":{"color":"#116b00"},"children":["\"/api/run-inference\""]}],["$","span","code-segement5",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement6",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement7",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement8",{"className":"token","style":{"color":"#a04900"},"children":["async"]}],["$","span","code-segement9",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement10",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement11",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement12",{"className":"token","style":{"color":"#7c00aa"},"children":["run_inference"]}],["$","span","code-segement13",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement14",{"className":"token","style":{"color":"#af00af"},"children":["file"]}],["$","span","code-segement15",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement16",{"className":"$undefined","style":{},"children":[" UploadFile "]}],["$","span","code-segement17",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement18",{"className":"$undefined","style":{},"children":[" File"]}],["$","span","code-segement19",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement20",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement21",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement22",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement23",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement24",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement25",{"className":"$undefined","style":{},"children":[" image_provider"]}],["$","span","code-segement26",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement27",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement28",{"className":"token","style":{"color":"#af00af"},"children":["str"]}],["$","span","code-segement29",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement30",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement31",{"className":"$undefined","style":{},"children":[" Query"]}],["$","span","code-segement32",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement33",{"className":"token","style":{"color":"#755f00"},"children":["None"]}],["$","span","code-segement34",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement35",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement36",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement37",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement38",{"className":"$undefined","style":{},"children":["    file_contents "]}],["$","span","code-segement39",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement40",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement41",{"className":"token","style":{"color":"#a04900"},"children":["await"]}],["$","span","code-segement42",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement43",{"className":"token","style":{"color":"#af00af"},"children":["file"]}],["$","span","code-segement44",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement45",{"className":"$undefined","style":{},"children":["read"]}],["$","span","code-segement46",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement47",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement48",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement49",{"className":"$undefined","style":{},"children":["    np_arr "]}],["$","span","code-segement50",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement51",{"className":"$undefined","style":{},"children":[" np"]}],["$","span","code-segement52",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement53",{"className":"$undefined","style":{},"children":["frombuffer"]}],["$","span","code-segement54",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement55",{"className":"$undefined","style":{},"children":["file_contents"]}],["$","span","code-segement56",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement57",{"className":"$undefined","style":{},"children":[" np"]}],["$","span","code-segement58",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement59",{"className":"$undefined","style":{},"children":["uint8"]}],["$","span","code-segement60",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement61",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement62",{"className":"$undefined","style":{},"children":["    image "]}],["$","span","code-segement63",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement64",{"className":"$undefined","style":{},"children":[" cv2"]}],["$","span","code-segement65",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement66",{"className":"$undefined","style":{},"children":["imdecode"]}],["$","span","code-segement67",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement68",{"className":"$undefined","style":{},"children":["np_arr"]}],["$","span","code-segement69",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement70",{"className":"$undefined","style":{},"children":["  cv2"]}],["$","span","code-segement71",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement72",{"className":"$undefined","style":{},"children":["IMREAD_UNCHANGED"]}],["$","span","code-segement73",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement74",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement76",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement77",{"className":"token","style":{"color":"#3c526d"},"children":["# Remove the alpha channel and make the digit black on white"]}],["$","span","code-segement78",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement79",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement80",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement81",{"className":"$undefined","style":{},"children":[" image_provider "]}],["$","span","code-segement82",{"className":"token","style":{"color":"#a04900"},"children":["=="]}],["$","span","code-segement83",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement84",{"className":"token","style":{"color":"#116b00"},"children":["\"konva\""]}],["$","span","code-segement85",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement86",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement87",{"className":"$undefined","style":{},"children":["        image "]}],["$","span","code-segement88",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement89",{"className":"$undefined","style":{},"children":[" image"]}],["$","span","code-segement90",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement91",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement92",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement93",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement94",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement95",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement96",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement97",{"className":"token","style":{"color":"#755f00"},"children":["3"]}],["$","span","code-segement98",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement99",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement101",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement102",{"className":"token","style":{"color":"#3c526d"},"children":["# cv2.imwrite(\"original.png\", image)"]}],["$","span","code-segement103",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement105",{"className":"$undefined","style":{},"children":["    image "]}],["$","span","code-segement106",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement107",{"className":"$undefined","style":{},"children":[" cv2"]}],["$","span","code-segement108",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement109",{"className":"$undefined","style":{},"children":["resize"]}],["$","span","code-segement110",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement111",{"className":"$undefined","style":{},"children":["image"]}],["$","span","code-segement112",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement113",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement114",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement115",{"className":"token","style":{"color":"#755f00"},"children":["28"]}],["$","span","code-segement116",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement117",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement118",{"className":"token","style":{"color":"#755f00"},"children":["28"]}],["$","span","code-segement119",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement120",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement121",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement122",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement123",{"className":"token","style":{"color":"#3c526d"},"children":["# cv2.imwrite(\"resized.png\", image)"]}],["$","span","code-segement124",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement126",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement127",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement128",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement129",{"className":"token","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement130",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement131",{"className":"$undefined","style":{},"children":["image"]}],["$","span","code-segement132",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement133",{"className":"$undefined","style":{},"children":["shape"]}],["$","span","code-segement134",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement135",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement136",{"className":"token","style":{"color":"#a04900"},"children":[">"]}],["$","span","code-segement137",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement138",{"className":"token","style":{"color":"#755f00"},"children":["2"]}],["$","span","code-segement139",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement140",{"className":"token","style":{"color":"#a04900"},"children":["and"]}],["$","span","code-segement141",{"className":"$undefined","style":{},"children":[" image"]}],["$","span","code-segement142",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement143",{"className":"$undefined","style":{},"children":["shape"]}],["$","span","code-segement144",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement145",{"className":"token","style":{"color":"#a04900"},"children":["-"]}],["$","span","code-segement146",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement147",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement148",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement149",{"className":"token","style":{"color":"#a04900"},"children":[">"]}],["$","span","code-segement150",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement151",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement152",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement153",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement154",{"className":"$undefined","style":{},"children":["        image "]}],["$","span","code-segement155",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement156",{"className":"$undefined","style":{},"children":[" image"]}],["$","span","code-segement157",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement158",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement159",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement160",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement161",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement162",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement163",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement164",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement165",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement166",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement168",{"className":"$undefined","style":{},"children":["    preprocessed_image "]}],["$","span","code-segement169",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement170",{"className":"$undefined","style":{},"children":[" preprocessing_transforms"]}],["$","span","code-segement171",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement172",{"className":"$undefined","style":{},"children":["image"]}],["$","span","code-segement173",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement174",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement175",{"className":"$undefined","style":{},"children":["    preprocessed_image "]}],["$","span","code-segement176",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement177",{"className":"$undefined","style":{},"children":[" preprocessed_image"]}],["$","span","code-segement178",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement179",{"className":"$undefined","style":{},"children":["unsqueeze"]}],["$","span","code-segement180",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement181",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement182",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement183",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement185",{"className":"$undefined","style":{},"children":["    output "]}],["$","span","code-segement186",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement187",{"className":"$undefined","style":{},"children":[" model"]}],["$","span","code-segement188",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement189",{"className":"$undefined","style":{},"children":["preprocessed_image"]}],["$","span","code-segement190",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement191",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement192",{"className":"$undefined","style":{},"children":["    prediction "]}],["$","span","code-segement193",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement194",{"className":"$undefined","style":{},"children":[" output"]}],["$","span","code-segement195",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement196",{"className":"$undefined","style":{},"children":["argmax"]}],["$","span","code-segement197",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement198",{"className":"$undefined","style":{},"children":["dim"]}],["$","span","code-segement199",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement200",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement201",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement202",{"className":"$undefined","style":{},"children":[" keepdim"]}],["$","span","code-segement203",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement204",{"className":"token","style":{"color":"#755f00"},"children":["True"]}],["$","span","code-segement205",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement206",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement207",{"className":"$undefined","style":{},"children":["    prediction "]}],["$","span","code-segement208",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement209",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement210",{"className":"token","style":{"color":"#af00af"},"children":["int"]}],["$","span","code-segement211",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement212",{"className":"$undefined","style":{},"children":["prediction"]}],["$","span","code-segement213",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement214",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement216",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement217",{"className":"token","style":{"color":"#a04900"},"children":["return"]}],["$","span","code-segement218",{"className":"$undefined","style":{},"children":[" JSONResponse"]}],["$","span","code-segement219",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement220",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement221",{"className":"$undefined","style":{},"children":["        content"]}],["$","span","code-segement222",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement223",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement224",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement225",{"className":"$undefined","style":{},"children":["            "]}],["$","span","code-segement226",{"className":"token","style":{"color":"#116b00"},"children":["\"predicted_label\""]}],["$","span","code-segement227",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement228",{"className":"$undefined","style":{},"children":[" prediction"]}],["$","span","code-segement229",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement230",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement231",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement232",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement233",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement234",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement235",{"className":"$undefined","style":{},"children":["        status_code"]}],["$","span","code-segement236",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement237",{"className":"token","style":{"color":"#755f00"},"children":["200"]}],["$","span","code-segement238",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement239",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement240",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Lc","22",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","We receive the image as multipart/form-data and load its contents into a numpy array and then decode them to a cv2 image. The endpoint has an optional query parameter called ",["$","$La","22-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"image_provider"}]," that allows the client side to request a certain preprocessing method. In ",["$","$L17","22-link",{"href":"/full-stack/react-konva-draw-image-and-predict-via-api","color":"primary","underline":"hover","children":"this Post"}],", we build a Frontend in React with Konva where the user can draw an image with their mouse and get a prediction from the API. Hence, I have a case configured for the ",["$","$La","22-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"konva"}]," image provider. We resize the image to 28x28 and make it single-channel. Then, we pass it through our preprocessing transforms and add a batch dimension. Next, we pass it to our model and get the output. The output is an array of probabilities for the 10 classes, and the prediction is the class with the highest probability. ",["$","$La","22-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"numpy.argmax"}]," gives the index of this class, since the classes are from 0 to 9, this index itself is the prediction, we just have to convert it to an ",["$","$La","22-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"int"}],"."]}],["$","$Lc","23",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","That's it for our application, we can serve it with ",["$","$La","23-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"uvicorn"}]," (from the project's root directory) using :"]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"uvicorn src.app:app --port=8000 --host=0.0.0.0"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-bash","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"$undefined","style":{},"children":["uvicorn src.app:app --port"]}],["$","span","code-segement1",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement2",{"className":"token","style":{"color":"#755f00"},"children":["8000"]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":[" --host"]}],["$","span","code-segement4",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement5",{"className":"token","style":{"color":"#755f00"},"children":["0.0"]}],["$","span","code-segement6",{"className":"$undefined","style":{},"children":[".0.0"]}]]]}]}]]}],["$","$Lc","25",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","You should see an output stating that ",["$","$La","25-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"uvicorn"}]," is listening on ",["$","$La","25-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"0.0.0.0:8000"}],"."]}],["$","$Lc","26",{"id":"testing","variant":"h4","component":"h1","mb":2,"children":["$","strong",null,{"children":"Testing"}]}],["$","$Lc","27",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","With the application completed, let's work on writing the tests. At the same level as the ",["$","$La","27-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"src"}]," folder, create a new folder called ",["$","$La","27-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"tests"}]," and inside it create a file called ",["$","$La","27-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"config.py"}],"."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"from os.path import dirname, join as path_join\n\n\ndata_dir = path_join(dirname(dirname(__file__)), \"data\")"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" os"]}],["$","span","code-segement2",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":["path "]}],["$","span","code-segement4",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement5",{"className":"$undefined","style":{},"children":[" dirname"]}],["$","span","code-segement6",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement7",{"className":"$undefined","style":{},"children":[" join "]}],["$","span","code-segement8",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement9",{"className":"$undefined","style":{},"children":[" path_join\n"]}],"\n","\n",["$","span","code-segement12",{"className":"$undefined","style":{},"children":["data_dir "]}],["$","span","code-segement13",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement14",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement15",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement16",{"className":"$undefined","style":{},"children":["dirname"]}],["$","span","code-segement17",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement18",{"className":"$undefined","style":{},"children":["dirname"]}],["$","span","code-segement19",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement20",{"className":"$undefined","style":{},"children":["__file__"]}],["$","span","code-segement21",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement22",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement23",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement24",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement25",{"className":"token","style":{"color":"#116b00"},"children":["\"data\""]}],["$","span","code-segement26",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Lc","29",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","In this file, we simply define a path to our data directory, that lives at the same level as the ",["$","$La","29-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"tests"}]," and ",["$","$La","29-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"src"}]," directories."]}],["$","$Lc","30",{"id":"testing-data","variant":"h5","component":"h2","mb":2,"children":["$","strong",null,{"children":"Testing Data"}]}],["$","$Lc","31",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Inside the ",["$","$La","31-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"data"}]," directory, create a folder called ",["$","$La","31-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"test_images"}],". You can draw some digits in MS Paint (white foreground on a black background) and place them in this folder. Inside the ",["$","$La","31-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"data"}]," dir, next to the ",["$","$La","31-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"test_images"}]," dir, create a file called ",["$","$La","31-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"test_images_labels.json"}],", in which we will store the labels corresponding to our test images. Here's an example labels file"]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"{\n    \"1.png\": 1,\n    \"2.png\": 7,\n    \"3.png\": 2,\n    \"4.png\": 9,\n    \"5.png\": 8,\n    \"6.png\": 5,\n    \"7.png\": 1,\n    \"8.png\": 7,\n    \"9.png\": 1,\n    \"10.png\": 7,\n    \"11.png\": 7,\n    \"12.png\": 0,\n    \"13.png\": 5,\n    \"14.png\": 3,\n    \"15.png\": 2,\n    \"16.png\": 1,\n    \"17.png\": 0,\n    \"18.png\": 8,\n    \"19.png\": 7,\n    \"20.png\": 4\n}"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-json","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement2",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement3",{"className":"token","style":{"color":"#005a8e"},"children":["\"1.png\""]}],["$","span","code-segement4",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement5",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement6",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement7",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement9",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement10",{"className":"token","style":{"color":"#005a8e"},"children":["\"2.png\""]}],["$","span","code-segement11",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement12",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement13",{"className":"token","style":{"color":"#755f00"},"children":["7"]}],["$","span","code-segement14",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement16",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement17",{"className":"token","style":{"color":"#005a8e"},"children":["\"3.png\""]}],["$","span","code-segement18",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement19",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement20",{"className":"token","style":{"color":"#755f00"},"children":["2"]}],["$","span","code-segement21",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement22",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement23",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement24",{"className":"token","style":{"color":"#005a8e"},"children":["\"4.png\""]}],["$","span","code-segement25",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement27",{"className":"token","style":{"color":"#755f00"},"children":["9"]}],["$","span","code-segement28",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement29",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement30",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement31",{"className":"token","style":{"color":"#005a8e"},"children":["\"5.png\""]}],["$","span","code-segement32",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement33",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement34",{"className":"token","style":{"color":"#755f00"},"children":["8"]}],["$","span","code-segement35",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement36",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement37",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement38",{"className":"token","style":{"color":"#005a8e"},"children":["\"6.png\""]}],["$","span","code-segement39",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement40",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement41",{"className":"token","style":{"color":"#755f00"},"children":["5"]}],["$","span","code-segement42",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement43",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement44",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement45",{"className":"token","style":{"color":"#005a8e"},"children":["\"7.png\""]}],["$","span","code-segement46",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement47",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement48",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement49",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement50",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement51",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement52",{"className":"token","style":{"color":"#005a8e"},"children":["\"8.png\""]}],["$","span","code-segement53",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement54",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement55",{"className":"token","style":{"color":"#755f00"},"children":["7"]}],["$","span","code-segement56",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement57",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement58",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement59",{"className":"token","style":{"color":"#005a8e"},"children":["\"9.png\""]}],["$","span","code-segement60",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement61",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement62",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement63",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement64",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement65",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement66",{"className":"token","style":{"color":"#005a8e"},"children":["\"10.png\""]}],["$","span","code-segement67",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement68",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement69",{"className":"token","style":{"color":"#755f00"},"children":["7"]}],["$","span","code-segement70",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement71",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement72",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement73",{"className":"token","style":{"color":"#005a8e"},"children":["\"11.png\""]}],["$","span","code-segement74",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement75",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement76",{"className":"token","style":{"color":"#755f00"},"children":["7"]}],["$","span","code-segement77",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement78",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement79",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement80",{"className":"token","style":{"color":"#005a8e"},"children":["\"12.png\""]}],["$","span","code-segement81",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement82",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement83",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement84",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement85",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement86",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement87",{"className":"token","style":{"color":"#005a8e"},"children":["\"13.png\""]}],["$","span","code-segement88",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement89",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement90",{"className":"token","style":{"color":"#755f00"},"children":["5"]}],["$","span","code-segement91",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement92",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement93",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement94",{"className":"token","style":{"color":"#005a8e"},"children":["\"14.png\""]}],["$","span","code-segement95",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement96",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement97",{"className":"token","style":{"color":"#755f00"},"children":["3"]}],["$","span","code-segement98",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement99",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement100",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement101",{"className":"token","style":{"color":"#005a8e"},"children":["\"15.png\""]}],["$","span","code-segement102",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement103",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement104",{"className":"token","style":{"color":"#755f00"},"children":["2"]}],["$","span","code-segement105",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement106",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement107",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement108",{"className":"token","style":{"color":"#005a8e"},"children":["\"16.png\""]}],["$","span","code-segement109",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement110",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement111",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement112",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement113",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement114",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement115",{"className":"token","style":{"color":"#005a8e"},"children":["\"17.png\""]}],["$","span","code-segement116",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement117",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement118",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement119",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement120",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement121",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement122",{"className":"token","style":{"color":"#005a8e"},"children":["\"18.png\""]}],["$","span","code-segement123",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement124",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement125",{"className":"token","style":{"color":"#755f00"},"children":["8"]}],["$","span","code-segement126",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement127",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement128",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement129",{"className":"token","style":{"color":"#005a8e"},"children":["\"19.png\""]}],["$","span","code-segement130",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement131",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement132",{"className":"token","style":{"color":"#755f00"},"children":["7"]}],["$","span","code-segement133",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement134",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement135",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement136",{"className":"token","style":{"color":"#005a8e"},"children":["\"20.png\""]}],["$","span","code-segement137",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement138",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement139",{"className":"token","style":{"color":"#755f00"},"children":["4"]}],["$","span","code-segement140",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement141",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement142",{"className":"token","style":{"color":"#111b27"},"children":["}"]}]]]}]}]]}],["$","$Lc","33",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","With that done, we can move on to our testing code. Create the ",["$","$La","33-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"tests/test_apis.py"}]," file."]}],["$","$Lc","34",{"id":"the-test-case","variant":"h4","component":"h1","mb":2,"children":["$","strong",null,{"children":"The Test Case"}]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"$19"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" json "]}],["$","span","code-segement2",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":[" load "]}],["$","span","code-segement4",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement5",{"className":"$undefined","style":{},"children":[" json_load\n"]}],["$","span","code-segement6",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement7",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":[" os "]}],["$","span","code-segement9",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":[" listdir\n"]}],["$","span","code-segement11",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement12",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement13",{"className":"$undefined","style":{},"children":[" os"]}],["$","span","code-segement14",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":["path "]}],["$","span","code-segement16",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement17",{"className":"$undefined","style":{},"children":[" join "]}],["$","span","code-segement18",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement19",{"className":"$undefined","style":{},"children":[" path_join\n"]}],["$","span","code-segement20",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement21",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement22",{"className":"$undefined","style":{},"children":[" unittest\n"]}],"\n",["$","span","code-segement24",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement25",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":[" requests\n"]}],"\n",["$","span","code-segement28",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement29",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement30",{"className":"$undefined","style":{},"children":[" config "]}],["$","span","code-segement31",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement32",{"className":"$undefined","style":{},"children":[" data_dir\n"]}],"\n","\n",["$","span","code-segement35",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement36",{"className":"token","style":{"color":"#a04900"},"children":["class"]}],["$","span","code-segement37",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement38",{"className":"token","style":{"color":"#005a8e"},"children":["TestAPIInference"]}],["$","span","code-segement39",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement40",{"className":"$undefined","style":{},"children":["unittest"]}],["$","span","code-segement41",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement42",{"className":"$undefined","style":{},"children":["TestCase"]}],["$","span","code-segement43",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement44",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement45",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement46",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement47",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement48",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement49",{"className":"token","style":{"color":"#7c00aa"},"children":["setUp"]}],["$","span","code-segement50",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement51",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement52",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement53",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement54",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement55",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement56",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement57",{"className":"$undefined","style":{},"children":["url "]}],["$","span","code-segement58",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement59",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement60",{"className":"token","style":{"color":"#116b00"},"children":["\"http://localhost:8000/api/run-inference\""]}],["$","span","code-segement61",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement62",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement63",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement64",{"className":"$undefined","style":{},"children":["images_dir "]}],["$","span","code-segement65",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement66",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement67",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement68",{"className":"$undefined","style":{},"children":["data_dir"]}],["$","span","code-segement69",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement70",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement71",{"className":"token","style":{"color":"#116b00"},"children":["\"test_images\""]}],["$","span","code-segement72",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement73",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement74",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement75",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement76",{"className":"$undefined","style":{},"children":["labels_json_file_path "]}],["$","span","code-segement77",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement78",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement79",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement80",{"className":"$undefined","style":{},"children":["data_dir"]}],["$","span","code-segement81",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement82",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement83",{"className":"token","style":{"color":"#116b00"},"children":["\"test_images_labels.json\""]}],["$","span","code-segement84",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement85",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement87",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement88",{"className":"token","style":{"color":"#a04900"},"children":["with"]}],["$","span","code-segement89",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement90",{"className":"token","style":{"color":"#af00af"},"children":["open"]}],["$","span","code-segement91",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement92",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement93",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement94",{"className":"$undefined","style":{},"children":["labels_json_file_path"]}],["$","span","code-segement95",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement96",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement97",{"className":"token","style":{"color":"#116b00"},"children":["'r'"]}],["$","span","code-segement98",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement99",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement100",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement101",{"className":"$undefined","style":{},"children":[" labels_json_file"]}],["$","span","code-segement102",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement103",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement104",{"className":"$undefined","style":{},"children":["            self"]}],["$","span","code-segement105",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement106",{"className":"$undefined","style":{},"children":["labels "]}],["$","span","code-segement107",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement108",{"className":"$undefined","style":{},"children":[" json_load"]}],["$","span","code-segement109",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement110",{"className":"$undefined","style":{},"children":["labels_json_file"]}],["$","span","code-segement111",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement112",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement114",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement115",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement116",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement117",{"className":"token","style":{"color":"#7c00aa"},"children":["test_inference"]}],["$","span","code-segement118",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement119",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement120",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement121",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement122",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement123",{"className":"$undefined","style":{},"children":["        num_correct_predictions "]}],["$","span","code-segement124",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement125",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement126",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement127",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement128",{"className":"$undefined","style":{},"children":["        num_bad_responses "]}],["$","span","code-segement129",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement130",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement131",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement132",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement133",{"className":"$undefined","style":{},"children":["        all_image_names "]}],["$","span","code-segement134",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement135",{"className":"$undefined","style":{},"children":[" listdir"]}],["$","span","code-segement136",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement137",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement138",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement139",{"className":"$undefined","style":{},"children":["images_dir"]}],["$","span","code-segement140",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement141",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement143",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement144",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement145",{"className":"$undefined","style":{},"children":[" image_name "]}],["$","span","code-segement146",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement147",{"className":"$undefined","style":{},"children":[" all_image_names"]}],["$","span","code-segement148",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement149",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement150",{"className":"$undefined","style":{},"children":["            image_file_path "]}],["$","span","code-segement151",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement152",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement153",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement154",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement155",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement156",{"className":"$undefined","style":{},"children":["images_dir"]}],["$","span","code-segement157",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement158",{"className":"$undefined","style":{},"children":[" image_name"]}],["$","span","code-segement159",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement160",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement162",{"className":"$undefined","style":{},"children":["            "]}],["$","span","code-segement163",{"className":"token","style":{"color":"#a04900"},"children":["with"]}],["$","span","code-segement164",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement165",{"className":"token","style":{"color":"#af00af"},"children":["open"]}],["$","span","code-segement166",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement167",{"className":"$undefined","style":{},"children":["image_file_path"]}],["$","span","code-segement168",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement169",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement170",{"className":"token","style":{"color":"#116b00"},"children":["\"rb\""]}],["$","span","code-segement171",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement172",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement173",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement174",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement175",{"className":"token","style":{"color":"#af00af"},"children":["file"]}],["$","span","code-segement176",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement177",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement178",{"className":"$undefined","style":{},"children":["                response "]}],["$","span","code-segement179",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement180",{"className":"$undefined","style":{},"children":[" requests"]}],["$","span","code-segement181",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement182",{"className":"$undefined","style":{},"children":["post"]}],["$","span","code-segement183",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement184",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement185",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement186",{"className":"$undefined","style":{},"children":["url"]}],["$","span","code-segement187",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement188",{"className":"$undefined","style":{},"children":[" files"]}],["$","span","code-segement189",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement190",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement191",{"className":"token","style":{"color":"#116b00"},"children":["\"file\""]}],["$","span","code-segement192",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement193",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement194",{"className":"token","style":{"color":"#af00af"},"children":["file"]}],["$","span","code-segement195",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement196",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement197",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement199",{"className":"$undefined","style":{},"children":["            "]}],["$","span","code-segement200",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement201",{"className":"$undefined","style":{},"children":[" response"]}],["$","span","code-segement202",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement203",{"className":"$undefined","style":{},"children":["status_code "]}],["$","span","code-segement204",{"className":"token","style":{"color":"#a04900"},"children":["!="]}],["$","span","code-segement205",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement206",{"className":"token","style":{"color":"#755f00"},"children":["200"]}],["$","span","code-segement207",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement208",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement209",{"className":"$undefined","style":{},"children":["                num_bad_responses "]}],["$","span","code-segement210",{"className":"token","style":{"color":"#a04900"},"children":["+="]}],["$","span","code-segement211",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement212",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement213",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement215",{"className":"$undefined","style":{},"children":["            self"]}],["$","span","code-segement216",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement217",{"className":"$undefined","style":{},"children":["assertEqual"]}],["$","span","code-segement218",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement219",{"className":"$undefined","style":{},"children":["response"]}],["$","span","code-segement220",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement221",{"className":"$undefined","style":{},"children":["status_code"]}],["$","span","code-segement222",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement223",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement224",{"className":"token","style":{"color":"#755f00"},"children":["200"]}],["$","span","code-segement225",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement226",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement228",{"className":"$undefined","style":{},"children":["            response_data "]}],["$","span","code-segement229",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement230",{"className":"$undefined","style":{},"children":[" response"]}],["$","span","code-segement231",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement232",{"className":"$undefined","style":{},"children":["json"]}],["$","span","code-segement233",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement234",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement235",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement237",{"className":"$undefined","style":{},"children":["            "]}],["$","span","code-segement238",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement239",{"className":"$undefined","style":{},"children":[" response_data"]}],["$","span","code-segement240",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement241",{"className":"token","style":{"color":"#116b00"},"children":["'predicted_label'"]}],["$","span","code-segement242",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement243",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement244",{"className":"token","style":{"color":"#a04900"},"children":["=="]}],["$","span","code-segement245",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement246",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement247",{"className":"$undefined","style":{},"children":["labels"]}],["$","span","code-segement248",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement249",{"className":"$undefined","style":{},"children":["image_name"]}],["$","span","code-segement250",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement251",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement252",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement253",{"className":"$undefined","style":{},"children":["                num_correct_predictions "]}],["$","span","code-segement254",{"className":"token","style":{"color":"#a04900"},"children":["+="]}],["$","span","code-segement255",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement256",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement257",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement259",{"className":"$undefined","style":{},"children":["            "]}],["$","span","code-segement260",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement261",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement262",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement263",{"className":"$undefined","style":{},"children":["                "]}],["$","span","code-segement264",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\"Image: "]}],["$","span","code-segement265",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement266",{"className":"token string-interpolation interpolation","style":{},"children":["image_name"]}],["$","span","code-segement267",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement268",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[", \""]}],["$","span","code-segement269",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement270",{"className":"$undefined","style":{},"children":["                "]}],["$","span","code-segement271",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\"Predicted Label: "]}],["$","span","code-segement272",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement273",{"className":"token string-interpolation interpolation","style":{},"children":["response_data"]}],["$","span","code-segement274",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement275",{"className":"token string-interpolation interpolation","style":{"color":"#116b00"},"children":["'predicted_label'"]}],["$","span","code-segement276",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement277",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement278",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[", \""]}],["$","span","code-segement279",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement280",{"className":"$undefined","style":{},"children":["                "]}],["$","span","code-segement281",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\"Correct: "]}],["$","span","code-segement282",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement283",{"className":"token string-interpolation interpolation","style":{},"children":["response_data"]}],["$","span","code-segement284",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement285",{"className":"token string-interpolation interpolation","style":{"color":"#116b00"},"children":["'predicted_label'"]}],["$","span","code-segement286",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement287",{"className":"token string-interpolation interpolation","style":{},"children":[" "]}],["$","span","code-segement288",{"className":"token string-interpolation interpolation","style":{"color":"#a04900"},"children":["=="]}],["$","span","code-segement289",{"className":"token string-interpolation interpolation","style":{},"children":[" self"]}],["$","span","code-segement290",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement291",{"className":"token string-interpolation interpolation","style":{},"children":["labels"]}],["$","span","code-segement292",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement293",{"className":"token string-interpolation interpolation","style":{},"children":["image_name"]}],["$","span","code-segement294",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement295",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement296",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["\""]}],["$","span","code-segement297",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement298",{"className":"$undefined","style":{},"children":["            "]}],["$","span","code-segement299",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement300",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement302",{"className":"$undefined","style":{},"children":["        num_inferred "]}],["$","span","code-segement303",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement304",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement305",{"className":"token","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement306",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement307",{"className":"$undefined","style":{},"children":["all_image_names"]}],["$","span","code-segement308",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement309",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement310",{"className":"token","style":{"color":"#a04900"},"children":["-"]}],["$","span","code-segement311",{"className":"$undefined","style":{},"children":[" num_bad_responses\n"]}],["$","span","code-segement312",{"className":"$undefined","style":{},"children":["        accuracy "]}],["$","span","code-segement313",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement314",{"className":"$undefined","style":{},"children":[" num_correct_predictions "]}],["$","span","code-segement315",{"className":"token","style":{"color":"#a04900"},"children":["/"]}],["$","span","code-segement316",{"className":"$undefined","style":{},"children":[" num_inferred\n"]}],"\n",["$","span","code-segement318",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement319",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement320",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement321",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\"Failed to infer: "]}],["$","span","code-segement322",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement323",{"className":"token string-interpolation interpolation","style":{},"children":["num_bad_responses"]}],["$","span","code-segement324",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement325",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[" / "]}],["$","span","code-segement326",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement327",{"className":"token string-interpolation interpolation","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement328",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement329",{"className":"token string-interpolation interpolation","style":{},"children":["all_image_names"]}],["$","span","code-segement330",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement331",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement332",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["\""]}],["$","span","code-segement333",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement334",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement335",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement336",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement337",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement338",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\"Correct Predictions: "]}],["$","span","code-segement339",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement340",{"className":"token string-interpolation interpolation","style":{},"children":["num_correct_predictions"]}],["$","span","code-segement341",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement342",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[" / "]}],["$","span","code-segement343",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement344",{"className":"token string-interpolation interpolation","style":{},"children":["num_inferred"]}],["$","span","code-segement345",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement346",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[", Accuracy: "]}],["$","span","code-segement347",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement348",{"className":"token string-interpolation interpolation","style":{},"children":["accuracy"]}],["$","span","code-segement349",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement350",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["\""]}],["$","span","code-segement351",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement352",{"className":"$undefined","style":{},"children":["\n"]}],"\n","\n",["$","span","code-segement355",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement356",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement357",{"className":"$undefined","style":{},"children":[" __name__ "]}],["$","span","code-segement358",{"className":"token","style":{"color":"#a04900"},"children":["=="]}],["$","span","code-segement359",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement360",{"className":"token","style":{"color":"#116b00"},"children":["'__main__'"]}],["$","span","code-segement361",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement362",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement363",{"className":"$undefined","style":{},"children":["    unittest"]}],["$","span","code-segement364",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement365",{"className":"$undefined","style":{},"children":["main"]}],["$","span","code-segement366",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement367",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Lc","36",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","The test case loads the labels and then loads the images one by one and passes them to the API for inference. Then, it checks if there is actually a prediction. Note that the test does not fail in case of an incorrect prediction, the purpose of the test is to check if the API works correctly, not if the model reaches an accuracy threshold. We do print the accuracy, just as a good measure."]}],["$","$Lc","37",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","With the server running, we can run our test script in another terminal."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"python test_apis.py"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-bash","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"$undefined","style":{},"children":["python test_apis.py"]}]]]}]}]]}],["$","$Lc","39",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","You should see an output like the following:"]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"$1a"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-bash","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"$undefined","style":{},"children":["Image: "]}],["$","span","code-segement1",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement2",{"className":"$undefined","style":{},"children":[".png, Predicted Label: "]}],["$","span","code-segement3",{"className":"token","style":{"color":"#755f00"},"children":["2"]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":[", Correct: False\n"]}],["$","span","code-segement5",{"className":"$undefined","style":{},"children":["Image: "]}],["$","span","code-segement6",{"className":"token","style":{"color":"#755f00"},"children":["10"]}],["$","span","code-segement7",{"className":"$undefined","style":{},"children":[".png, Predicted Label: "]}],["$","span","code-segement8",{"className":"token","style":{"color":"#755f00"},"children":["7"]}],["$","span","code-segement9",{"className":"$undefined","style":{},"children":[", Correct: True\n"]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":["Image: "]}],["$","span","code-segement11",{"className":"token","style":{"color":"#755f00"},"children":["11"]}],["$","span","code-segement12",{"className":"$undefined","style":{},"children":[".png, Predicted Label: "]}],["$","span","code-segement13",{"className":"token","style":{"color":"#755f00"},"children":["7"]}],["$","span","code-segement14",{"className":"$undefined","style":{},"children":[", Correct: True\n"]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":["Image: "]}],["$","span","code-segement16",{"className":"token","style":{"color":"#755f00"},"children":["12"]}],["$","span","code-segement17",{"className":"$undefined","style":{},"children":[".png, Predicted Label: "]}],["$","span","code-segement18",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement19",{"className":"$undefined","style":{},"children":[", Correct: True\n"]}],["$","span","code-segement20",{"className":"$undefined","style":{},"children":["Image: "]}],["$","span","code-segement21",{"className":"token","style":{"color":"#755f00"},"children":["13"]}],["$","span","code-segement22",{"className":"$undefined","style":{},"children":[".png, Predicted Label: "]}],["$","span","code-segement23",{"className":"token","style":{"color":"#755f00"},"children":["5"]}],["$","span","code-segement24",{"className":"$undefined","style":{},"children":[", Correct: True\n"]}],["$","span","code-segement25",{"className":"$undefined","style":{},"children":["Image: "]}],["$","span","code-segement26",{"className":"token","style":{"color":"#755f00"},"children":["14"]}],["$","span","code-segement27",{"className":"$undefined","style":{},"children":[".png, Predicted Label: "]}],["$","span","code-segement28",{"className":"token","style":{"color":"#755f00"},"children":["3"]}],["$","span","code-segement29",{"className":"$undefined","style":{},"children":[", Correct: True\n"]}],["$","span","code-segement30",{"className":"$undefined","style":{},"children":["Image: "]}],["$","span","code-segement31",{"className":"token","style":{"color":"#755f00"},"children":["15"]}],["$","span","code-segement32",{"className":"$undefined","style":{},"children":[".png, Predicted Label: "]}],["$","span","code-segement33",{"className":"token","style":{"color":"#755f00"},"children":["2"]}],["$","span","code-segement34",{"className":"$undefined","style":{},"children":[", Correct: True\n"]}],["$","span","code-segement35",{"className":"$undefined","style":{},"children":["Image: "]}],["$","span","code-segement36",{"className":"token","style":{"color":"#755f00"},"children":["16"]}],["$","span","code-segement37",{"className":"$undefined","style":{},"children":[".png, Predicted Label: "]}],["$","span","code-segement38",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement39",{"className":"$undefined","style":{},"children":[", Correct: True\n"]}],["$","span","code-segement40",{"className":"$undefined","style":{},"children":["Image: "]}],["$","span","code-segement41",{"className":"token","style":{"color":"#755f00"},"children":["17"]}],["$","span","code-segement42",{"className":"$undefined","style":{},"children":[".png, Predicted Label: "]}],["$","span","code-segement43",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement44",{"className":"$undefined","style":{},"children":[", Correct: True\n"]}],["$","span","code-segement45",{"className":"$undefined","style":{},"children":["Image: "]}],["$","span","code-segement46",{"className":"token","style":{"color":"#755f00"},"children":["18"]}],["$","span","code-segement47",{"className":"$undefined","style":{},"children":[".png, Predicted Label: "]}],["$","span","code-segement48",{"className":"token","style":{"color":"#755f00"},"children":["8"]}],["$","span","code-segement49",{"className":"$undefined","style":{},"children":[", Correct: True\n"]}],["$","span","code-segement50",{"className":"$undefined","style":{},"children":["Image: "]}],["$","span","code-segement51",{"className":"token","style":{"color":"#755f00"},"children":["19"]}],["$","span","code-segement52",{"className":"$undefined","style":{},"children":[".png, Predicted Label: "]}],["$","span","code-segement53",{"className":"token","style":{"color":"#755f00"},"children":["7"]}],["$","span","code-segement54",{"className":"$undefined","style":{},"children":[", Correct: True\n"]}],["$","span","code-segement55",{"className":"$undefined","style":{},"children":["Image: "]}],["$","span","code-segement56",{"className":"token","style":{"color":"#755f00"},"children":["2"]}],["$","span","code-segement57",{"className":"$undefined","style":{},"children":[".png, Predicted Label: "]}],["$","span","code-segement58",{"className":"token","style":{"color":"#755f00"},"children":["7"]}],["$","span","code-segement59",{"className":"$undefined","style":{},"children":[", Correct: True\n"]}],["$","span","code-segement60",{"className":"$undefined","style":{},"children":["Image: "]}],["$","span","code-segement61",{"className":"token","style":{"color":"#755f00"},"children":["20"]}],["$","span","code-segement62",{"className":"$undefined","style":{},"children":[".png, Predicted Label: "]}],["$","span","code-segement63",{"className":"token","style":{"color":"#755f00"},"children":["4"]}],["$","span","code-segement64",{"className":"$undefined","style":{},"children":[", Correct: True\n"]}],["$","span","code-segement65",{"className":"$undefined","style":{},"children":["Image: "]}],["$","span","code-segement66",{"className":"token","style":{"color":"#755f00"},"children":["3"]}],["$","span","code-segement67",{"className":"$undefined","style":{},"children":[".png, Predicted Label: "]}],["$","span","code-segement68",{"className":"token","style":{"color":"#755f00"},"children":["2"]}],["$","span","code-segement69",{"className":"$undefined","style":{},"children":[", Correct: True\n"]}],["$","span","code-segement70",{"className":"$undefined","style":{},"children":["Image: "]}],["$","span","code-segement71",{"className":"token","style":{"color":"#755f00"},"children":["4"]}],["$","span","code-segement72",{"className":"$undefined","style":{},"children":[".png, Predicted Label: "]}],["$","span","code-segement73",{"className":"token","style":{"color":"#755f00"},"children":["9"]}],["$","span","code-segement74",{"className":"$undefined","style":{},"children":[", Correct: True\n"]}],["$","span","code-segement75",{"className":"$undefined","style":{},"children":["Image: "]}],["$","span","code-segement76",{"className":"token","style":{"color":"#755f00"},"children":["5"]}],["$","span","code-segement77",{"className":"$undefined","style":{},"children":[".png, Predicted Label: "]}],["$","span","code-segement78",{"className":"token","style":{"color":"#755f00"},"children":["8"]}],["$","span","code-segement79",{"className":"$undefined","style":{},"children":[", Correct: True\n"]}],["$","span","code-segement80",{"className":"$undefined","style":{},"children":["Image: "]}],["$","span","code-segement81",{"className":"token","style":{"color":"#755f00"},"children":["6"]}],["$","span","code-segement82",{"className":"$undefined","style":{},"children":[".png, Predicted Label: "]}],["$","span","code-segement83",{"className":"token","style":{"color":"#755f00"},"children":["5"]}],["$","span","code-segement84",{"className":"$undefined","style":{},"children":[", Correct: True\n"]}],["$","span","code-segement85",{"className":"$undefined","style":{},"children":["Image: "]}],["$","span","code-segement86",{"className":"token","style":{"color":"#755f00"},"children":["7"]}],["$","span","code-segement87",{"className":"$undefined","style":{},"children":[".png, Predicted Label: "]}],["$","span","code-segement88",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement89",{"className":"$undefined","style":{},"children":[", Correct: True\n"]}],["$","span","code-segement90",{"className":"$undefined","style":{},"children":["Image: "]}],["$","span","code-segement91",{"className":"token","style":{"color":"#755f00"},"children":["8"]}],["$","span","code-segement92",{"className":"$undefined","style":{},"children":[".png, Predicted Label: "]}],["$","span","code-segement93",{"className":"token","style":{"color":"#755f00"},"children":["7"]}],["$","span","code-segement94",{"className":"$undefined","style":{},"children":[", Correct: True\n"]}],["$","span","code-segement95",{"className":"$undefined","style":{},"children":["Image: "]}],["$","span","code-segement96",{"className":"token","style":{"color":"#755f00"},"children":["9"]}],["$","span","code-segement97",{"className":"$undefined","style":{},"children":[".png, Predicted Label: "]}],["$","span","code-segement98",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement99",{"className":"$undefined","style":{},"children":[", Correct: True\n"]}],["$","span","code-segement100",{"className":"$undefined","style":{},"children":["Failed to infer: "]}],["$","span","code-segement101",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement102",{"className":"$undefined","style":{},"children":[" / "]}],["$","span","code-segement103",{"className":"token","style":{"color":"#755f00"},"children":["20"]}],["$","span","code-segement104",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement105",{"className":"$undefined","style":{},"children":["Correct Predictions: "]}],["$","span","code-segement106",{"className":"token","style":{"color":"#755f00"},"children":["19"]}],["$","span","code-segement107",{"className":"$undefined","style":{},"children":[" / "]}],["$","span","code-segement108",{"className":"token","style":{"color":"#755f00"},"children":["20"]}],["$","span","code-segement109",{"className":"$undefined","style":{},"children":[", Accuracy: "]}],["$","span","code-segement110",{"className":"token","style":{"color":"#755f00"},"children":["0.95"]}]]]}]}]]}],["$","$Lc","41",{"id":"conclusion","variant":"h4","component":"h1","mb":2,"children":["$","strong",null,{"children":"Conclusion"}]}],["$","$Lc","42",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Today, we've learned how we can wrap our PyTorch model in a FastAPI application and serve it to the web. But, as we discussed above, the ",["$","$La","42-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"torch"}]," and ",["$","$La","42-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"torchvision"}]," packages are heavy and we would not want to have them as a dependency on our server. If you are looking for a lighter way of deployment, it can be achieved through ",["$","$L17","42-link",{"href":"https://onnx.ai/","rel":"noopener noreferrer","target":"_blank","color":"primary","underline":"hover","children":"ONNX"}]," and ",["$","$L17","42-link",{"href":"https://onnxruntime.ai/","rel":"noopener noreferrer","target":"_blank","color":"primary","underline":"hover","children":"ONNX Runtime"}]," as we discuss in ",["$","$L17","42-link",{"href":"/ml-ops/fastapi-onnx-backend","color":"primary","underline":"hover","children":"this Post"}],"."]}],["$","$Lc","43",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","If you're looking for a similar deployment but with TensorFlow, you can check out ",["$","$L17","43-link",{"href":"/ml-ops/fastapi-tensorflow-backend","color":"primary","underline":"hover","children":"this Article"}],"."]}],["$","$Lc","44",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","See you next time :)"]}]]}]}]]}]}],"$L1b"]}]
1c:I[3713,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],"default"]
12:["$","$La",null,{"sx":{"width":"100%","display":"flex","flexDirection":"row","justifyContent":"space-between","alignItems":"center"},"children":[["$","$Lc",null,{"variant":"p","component":"p","mr":2,"children":"By: Abhilaksh Singh Reen"}],["$","$L1c",null,{"socialMediaProfiles":[{"network_name":"LinkedIn","profile_url":"https://www.linkedin.com/in/abhilaksh-singh-837901210/","profile_display_name":"Abhilaksh Singh Reen"},{"network_name":"Twitter","profile_url":"https://x.com/TheVeteran06","profile_display_name":"The Veteran 06"},{"network_name":"GitHub","profile_url":"https://github.com/AbhilakshSinghReen","profile_display_name":"Abhilaksh Singh Reen"}]}]]}]
1d:I[6652,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],""]
1e:I[6981,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],""]
1f:I[2818,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],""]
1b:["$","$La",null,{"mt":5,"mb":5,"pb":2,"sx":{"width":"100%","display":"flex","flexDirection":"column","justifyContent":"flex-start","alignItems":"center"},"children":["$","$L11",null,{"container":true,"spacing":2,"mt":4,"mb":4,"children":[["$","$L11","/ml-ops/fastapi-onnx-backend",{"item":true,"xs":12,"sm":6,"md":4,"lg":3,"children":["$","$Ld",null,{"href":"/ml-ops/fastapi-onnx-backend","passHref":true,"style":{"textDecoration":"none"},"children":["$","$L1d",null,{"sx":{"width":"100%","height":"100%","boxShadow":"1px 1px 1px 1px \"#eeeeee\"","&:hover":{"boxShadow":"3px 3px 3px 3px \"#eeeeee\"","cursor":"pointer"}},"children":[["$","$L1e",null,{"component":"img","height":"150","image":"/media/images/fastapi-onnx-backend-thumbnail.jpg","alt":"Serving an ONNX Model using FastAPI","sx":{"objectFit":"cover"}}],["$","$L1f",null,{"children":[["$","$Lc",null,{"gutterBottom":true,"variant":"h6","component":"h2","children":[""," ","Serving an ONNX Model using FastAPI"]}],["$","$Lc",null,{"gutterBottom":true,"variant":"p","component":"p","sx":{"overflow":"hidden","textOverflow":"ellipsis","display":"-webkit-box","WebkitLineClamp":"3","WebkitBoxOrient":"vertical"},"children":"Learn how to serve an ONNX model with FastAPI."}],["$","$La",null,{"sx":{"width":"100%","display":"flex","flexDirection":"row","justifyContent":"flex-end","alignItems":"center"},"children":["$","$Lc",null,{"gutterBottom":true,"variant":"p","component":"p","children":"06m Read"}]}],false]}]]}]}]}],["$","$L11","/ml-ops/fastapi-tensorflow-backend",{"item":true,"xs":12,"sm":6,"md":4,"lg":3,"children":["$","$Ld",null,{"href":"/ml-ops/fastapi-tensorflow-backend","passHref":true,"style":{"textDecoration":"none"},"children":["$","$L1d",null,{"sx":{"width":"100%","height":"100%","boxShadow":"1px 1px 1px 1px \"#eeeeee\"","&:hover":{"boxShadow":"3px 3px 3px 3px \"#eeeeee\"","cursor":"pointer"}},"children":[["$","$L1e",null,{"component":"img","height":"150","image":"/media/images/fastapi-tensorflow-backend-thumbnail.jpg","alt":"Serving a TensorFlow Model using FastAPI","sx":{"objectFit":"cover"}}],["$","$L1f",null,{"children":[["$","$Lc",null,{"gutterBottom":true,"variant":"h6","component":"h2","children":[""," ","Serving a TensorFlow Model using FastAPI"]}],["$","$Lc",null,{"gutterBottom":true,"variant":"p","component":"p","sx":{"overflow":"hidden","textOverflow":"ellipsis","display":"-webkit-box","WebkitLineClamp":"3","WebkitBoxOrient":"vertical"},"children":"Learn how to serve a TensorFlow model with FastAPI."}],["$","$La",null,{"sx":{"width":"100%","display":"flex","flexDirection":"row","justifyContent":"flex-end","alignItems":"center"},"children":["$","$Lc",null,{"gutterBottom":true,"variant":"p","component":"p","children":"05m Read"}]}],false]}]]}]}]}],["$","$L11","/ml-ops/node-express-onnx-backend",{"item":true,"xs":12,"sm":6,"md":4,"lg":3,"children":["$","$Ld",null,{"href":"/ml-ops/node-express-onnx-backend","passHref":true,"style":{"textDecoration":"none"},"children":["$","$L1d",null,{"sx":{"width":"100%","height":"100%","boxShadow":"1px 1px 1px 1px \"#eeeeee\"","&:hover":{"boxShadow":"3px 3px 3px 3px \"#eeeeee\"","cursor":"pointer"}},"children":[["$","$L1e",null,{"component":"img","height":"150","image":"/media/images/node-express-onnx-backend-thumbnail.jpg","alt":"Express.js API for Inference using an ONNX Model","sx":{"objectFit":"cover"}}],["$","$L1f",null,{"children":[["$","$Lc",null,{"gutterBottom":true,"variant":"h6","component":"h2","children":[""," ","Express.js API for Inference using an ONNX Model"]}],["$","$Lc",null,{"gutterBottom":true,"variant":"p","component":"p","sx":{"overflow":"hidden","textOverflow":"ellipsis","display":"-webkit-box","WebkitLineClamp":"3","WebkitBoxOrient":"vertical"},"children":"Deploying an ONNX Model using Express.js."}],["$","$La",null,{"sx":{"width":"100%","display":"flex","flexDirection":"row","justifyContent":"flex-end","alignItems":"center"},"children":["$","$Lc",null,{"gutterBottom":true,"variant":"p","component":"p","children":"08m Read"}]}],false]}]]}]}]}],["$","$L11","/ml-ops/tensorflow-js-inference-in-react",{"item":true,"xs":12,"sm":6,"md":4,"lg":3,"children":["$","$Ld",null,{"href":"/ml-ops/tensorflow-js-inference-in-react","passHref":true,"style":{"textDecoration":"none"},"children":["$","$L1d",null,{"sx":{"width":"100%","height":"100%","boxShadow":"1px 1px 1px 1px \"#eeeeee\"","&:hover":{"boxShadow":"3px 3px 3px 3px \"#eeeeee\"","cursor":"pointer"}},"children":[["$","$L1e",null,{"component":"img","height":"150","image":"/media/images/react-digit-recog-app-final.jpg","alt":"TensorFlow.js Inference in React on an image drawn with Konva","sx":{"objectFit":"cover"}}],["$","$L1f",null,{"children":[["$","$Lc",null,{"gutterBottom":true,"variant":"h6","component":"h2","children":[""," ","TensorFlow.js Inference in React on an image drawn with Konva"]}],["$","$Lc",null,{"gutterBottom":true,"variant":"p","component":"p","sx":{"overflow":"hidden","textOverflow":"ellipsis","display":"-webkit-box","WebkitLineClamp":"3","WebkitBoxOrient":"vertical"},"children":"Inferencing on an ONNX model in a React App using ONNXRuntime Web."}],["$","$La",null,{"sx":{"width":"100%","display":"flex","flexDirection":"row","justifyContent":"flex-end","alignItems":"center"},"children":["$","$Lc",null,{"gutterBottom":true,"variant":"p","component":"p","children":"08m Read"}]}],false]}]]}]}]}],["$","$L11","/ml-ops/onnxruntime-web-inference-in-react",{"item":true,"xs":12,"sm":6,"md":4,"lg":3,"children":["$","$Ld",null,{"href":"/ml-ops/onnxruntime-web-inference-in-react","passHref":true,"style":{"textDecoration":"none"},"children":["$","$L1d",null,{"sx":{"width":"100%","height":"100%","boxShadow":"1px 1px 1px 1px \"#eeeeee\"","&:hover":{"boxShadow":"3px 3px 3px 3px \"#eeeeee\"","cursor":"pointer"}},"children":[["$","$L1e",null,{"component":"img","height":"150","image":"/media/images/react-digit-recog-app-final.jpg","alt":"ONNXRuntime Inference in a React App","sx":{"objectFit":"cover"}}],["$","$L1f",null,{"children":[["$","$Lc",null,{"gutterBottom":true,"variant":"h6","component":"h2","children":[""," ","ONNXRuntime Inference in a React App"]}],["$","$Lc",null,{"gutterBottom":true,"variant":"p","component":"p","sx":{"overflow":"hidden","textOverflow":"ellipsis","display":"-webkit-box","WebkitLineClamp":"3","WebkitBoxOrient":"vertical"},"children":"Inferencing on an ONNX model in a React App using ONNXRuntime Web."}],["$","$La",null,{"sx":{"width":"100%","display":"flex","flexDirection":"row","justifyContent":"flex-end","alignItems":"center"},"children":["$","$Lc",null,{"gutterBottom":true,"variant":"p","component":"p","children":"08m Read"}]}],false]}]]}]}]}],["$","$L11","/ml-ops/ml-inference-on-backend-vs-frontend",{"item":true,"xs":12,"sm":6,"md":4,"lg":3,"children":["$","$Ld",null,{"href":"/ml-ops/ml-inference-on-backend-vs-frontend","passHref":true,"style":{"textDecoration":"none"},"children":["$","$L1d",null,{"sx":{"width":"100%","height":"100%","boxShadow":"1px 1px 1px 1px \"#eeeeee\"","&:hover":{"boxShadow":"3px 3px 3px 3px \"#eeeeee\"","cursor":"pointer"}},"children":[["$","$L1e",null,{"component":"img","height":"150","image":"/media/images/ml-inference-on-backend-vs-frontend-thumbnail.jpg","alt":"ML Inference on Backend vs Frontend","sx":{"objectFit":"cover"}}],["$","$L1f",null,{"children":[["$","$Lc",null,{"gutterBottom":true,"variant":"h6","component":"h2","children":[""," ","ML Inference on Backend vs Frontend"]}],["$","$Lc",null,{"gutterBottom":true,"variant":"p","component":"p","sx":{"overflow":"hidden","textOverflow":"ellipsis","display":"-webkit-box","WebkitLineClamp":"3","WebkitBoxOrient":"vertical"},"children":"A comparison of ML inference speed and memory consumption across various batch sizes on both GPU and CPU."}],["$","$La",null,{"sx":{"width":"100%","display":"flex","flexDirection":"row","justifyContent":"flex-end","alignItems":"center"},"children":["$","$Lc",null,{"gutterBottom":true,"variant":"p","component":"p","children":"05m Read"}]}],false]}]]}]}]}]]}]}]
