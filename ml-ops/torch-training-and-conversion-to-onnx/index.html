<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      rel="preload"
      as="image"
      href="/media/images/main-contact-email-light.jpg"
    />
    <link
      rel="preload"
      as="image"
      href="/media/images/torch-training-and-conversion-to-onnx-thumbnail.jpg"
    />
    <link
      rel="preload"
      as="image"
      href="/media/images/tensorflow-training-plus-conversion-to-onnx-and-tfjs-thumbnail.jpg"
    />
    <link
      rel="stylesheet"
      href="/_next/static/css/1d4d01086947be98.css"
      data-precedence="next"
    />
    <link
      rel="preload"
      as="script"
      fetchpriority="low"
      href="/_next/static/chunks/webpack-83486951edee0db5.js"
    />
    <script
      src="/_next/static/chunks/fd9d1056-90960e0a7e77703c.js"
      async=""
    ></script>
    <script src="/_next/static/chunks/23-365ff0b9e0ad811d.js" async=""></script>
    <script
      src="/_next/static/chunks/main-app-37d3bbd360c1bff1.js"
      async=""
    ></script>
    <script src="/_next/static/chunks/98-7f6363f9ac68c942.js" async=""></script>
    <script
      src="/_next/static/chunks/748-1f14ee6eb3d7029a.js"
      async=""
    ></script>
    <script
      src="/_next/static/chunks/271-37a22bace913f735.js"
      async=""
    ></script>
    <script
      src="/_next/static/chunks/app/layout-08611f287dda1230.js"
      async=""
    ></script>
    <script
      src="/_next/static/chunks/134-9729e0afcc6dfdfe.js"
      async=""
    ></script>
    <script
      src="/_next/static/chunks/830-8a0df588e7c84864.js"
      async=""
    ></script>
    <script
      src="/_next/static/chunks/411-e5dcfc2304d91b2f.js"
      async=""
    ></script>
    <script
      src="/_next/static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"
      async=""
    ></script>
    <link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="16x16" />
    <script
      src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js"
      nomodule=""
    ></script>
  </head>
  <body class="__className_d65c78">
    <header style="margin-bottom: 25px">
      <style data-emotion="css 13x2oq7">
        .css-13x2oq7 {
          display: -webkit-box;
          display: -webkit-flex;
          display: -ms-flexbox;
          display: flex;
          -webkit-flex-direction: column;
          -ms-flex-direction: column;
          flex-direction: column;
          width: 100%;
          box-sizing: border-box;
          -webkit-flex-shrink: 0;
          -ms-flex-negative: 0;
          flex-shrink: 0;
          position: fixed;
          z-index: 1100;
          top: 0;
          left: auto;
          right: 0;
          background-color: #1976d2;
          color: #fff;
        }
        @media print {
          .css-13x2oq7 {
            position: absolute;
          }
        }</style
      ><style data-emotion="css 5poeop">
        .css-5poeop {
          background-color: #fff;
          color: rgba(0, 0, 0, 0.87);
          -webkit-transition: box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
          transition: box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
          box-shadow:
            0px 2px 4px -1px rgba(0, 0, 0, 0.2),
            0px 4px 5px 0px rgba(0, 0, 0, 0.14),
            0px 1px 10px 0px rgba(0, 0, 0, 0.12);
          display: -webkit-box;
          display: -webkit-flex;
          display: -ms-flexbox;
          display: flex;
          -webkit-flex-direction: column;
          -ms-flex-direction: column;
          flex-direction: column;
          width: 100%;
          box-sizing: border-box;
          -webkit-flex-shrink: 0;
          -ms-flex-negative: 0;
          flex-shrink: 0;
          position: fixed;
          z-index: 1100;
          top: 0;
          left: auto;
          right: 0;
          background-color: #1976d2;
          color: #fff;
        }
        @media print {
          .css-5poeop {
            position: absolute;
          }
        }
      </style>
      <header
        class="MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionFixed mui-fixed css-5poeop"
      >
        <style data-emotion="css 1qsxih2">
          .css-1qsxih2 {
            width: 100%;
            margin-left: auto;
            box-sizing: border-box;
            margin-right: auto;
            display: block;
            padding-left: 16px;
            padding-right: 16px;
          }
          @media (min-width: 600px) {
            .css-1qsxih2 {
              padding-left: 24px;
              padding-right: 24px;
            }
          }
          @media (min-width: 1200px) {
            .css-1qsxih2 {
              max-width: 1200px;
            }
          }
        </style>
        <div class="MuiContainer-root MuiContainer-maxWidthLg css-1qsxih2">
          <style data-emotion="css r4h1bh">
            .css-r4h1bh {
              position: relative;
              display: -webkit-box;
              display: -webkit-flex;
              display: -ms-flexbox;
              display: flex;
              -webkit-align-items: center;
              -webkit-box-align: center;
              -ms-flex-align: center;
              align-items: center;
              padding-left: 16px;
              padding-right: 16px;
              min-height: 56px;
              display: -webkit-box;
              display: -webkit-flex;
              display: -ms-flexbox;
              display: flex;
              -webkit-flex-direction: row;
              -ms-flex-direction: row;
              flex-direction: row;
              -webkit-box-pack: justify;
              -webkit-justify-content: space-between;
              justify-content: space-between;
              -webkit-align-items: center;
              -webkit-box-align: center;
              -ms-flex-align: center;
              align-items: center;
              height: 100%;
              padding: 0px;
            }
            @media (min-width: 600px) {
              .css-r4h1bh {
                padding-left: 24px;
                padding-right: 24px;
              }
            }
            @media (min-width: 0px) {
              @media (orientation: landscape) {
                .css-r4h1bh {
                  min-height: 48px;
                }
              }
            }
            @media (min-width: 600px) {
              .css-r4h1bh {
                min-height: 64px;
              }
            }
          </style>
          <div
            class="MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-r4h1bh"
          >
            <style data-emotion="css 1pna09g">
              .css-1pna09g {
                margin: 0;
                font-family: "Roboto", "Helvetica", "Arial", sans-serif;
                font-weight: 400;
                font-size: 2.125rem;
                line-height: 1.235;
                letter-spacing: 0.00735em;
                font-weight: 700;
                text-align: center;
                background: linear-gradient(45deg, #ffd700 30%, #ffa500 90%);
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
              }
              .css-1pna09g:hover {
                cursor: pointer;
              }
            </style>
            <h4 class="MuiTypography-root MuiTypography-h4 css-1pna09g">
              A.N.T
            </h4>
            <div class="MuiBox-root css-0">
              <style data-emotion="css j4ylzh">
                .css-j4ylzh {
                  text-align: center;
                  -webkit-flex: 0 0 auto;
                  -ms-flex: 0 0 auto;
                  flex: 0 0 auto;
                  font-size: 1.5rem;
                  padding: 8px;
                  border-radius: 50%;
                  overflow: visible;
                  color: rgba(0, 0, 0, 0.54);
                  -webkit-transition: background-color 150ms
                    cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                  transition: background-color 150ms
                    cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                  color: #ed6c02;
                }
                .css-j4ylzh:hover {
                  background-color: rgba(0, 0, 0, 0.04);
                }
                @media (hover: none) {
                  .css-j4ylzh:hover {
                    background-color: transparent;
                  }
                }
                .css-j4ylzh:hover {
                  background-color: rgba(237, 108, 2, 0.04);
                }
                @media (hover: none) {
                  .css-j4ylzh:hover {
                    background-color: transparent;
                  }
                }
                .css-j4ylzh.Mui-disabled {
                  background-color: transparent;
                  color: rgba(0, 0, 0, 0.26);
                }</style
              ><style data-emotion="css r4nl99">
                .css-r4nl99 {
                  display: -webkit-inline-box;
                  display: -webkit-inline-flex;
                  display: -ms-inline-flexbox;
                  display: inline-flex;
                  -webkit-align-items: center;
                  -webkit-box-align: center;
                  -ms-flex-align: center;
                  align-items: center;
                  -webkit-box-pack: center;
                  -ms-flex-pack: center;
                  -webkit-justify-content: center;
                  justify-content: center;
                  position: relative;
                  box-sizing: border-box;
                  -webkit-tap-highlight-color: transparent;
                  background-color: transparent;
                  outline: 0;
                  border: 0;
                  margin: 0;
                  border-radius: 0;
                  padding: 0;
                  cursor: pointer;
                  -webkit-user-select: none;
                  -moz-user-select: none;
                  -ms-user-select: none;
                  user-select: none;
                  vertical-align: middle;
                  -moz-appearance: none;
                  -webkit-appearance: none;
                  -webkit-text-decoration: none;
                  text-decoration: none;
                  color: inherit;
                  text-align: center;
                  -webkit-flex: 0 0 auto;
                  -ms-flex: 0 0 auto;
                  flex: 0 0 auto;
                  font-size: 1.5rem;
                  padding: 8px;
                  border-radius: 50%;
                  overflow: visible;
                  color: rgba(0, 0, 0, 0.54);
                  -webkit-transition: background-color 150ms
                    cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                  transition: background-color 150ms
                    cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                  color: #ed6c02;
                }
                .css-r4nl99::-moz-focus-inner {
                  border-style: none;
                }
                .css-r4nl99.Mui-disabled {
                  pointer-events: none;
                  cursor: default;
                }
                @media print {
                  .css-r4nl99 {
                    -webkit-print-color-adjust: exact;
                    color-adjust: exact;
                  }
                }
                .css-r4nl99:hover {
                  background-color: rgba(0, 0, 0, 0.04);
                }
                @media (hover: none) {
                  .css-r4nl99:hover {
                    background-color: transparent;
                  }
                }
                .css-r4nl99:hover {
                  background-color: rgba(237, 108, 2, 0.04);
                }
                @media (hover: none) {
                  .css-r4nl99:hover {
                    background-color: transparent;
                  }
                }
                .css-r4nl99.Mui-disabled {
                  background-color: transparent;
                  color: rgba(0, 0, 0, 0.26);
                }</style
              ><button
                class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorWarning MuiIconButton-sizeMedium css-r4nl99"
                tabindex="0"
                type="button"
              >
                <style data-emotion="css 6flbmm">
                  .css-6flbmm {
                    -webkit-user-select: none;
                    -moz-user-select: none;
                    -ms-user-select: none;
                    user-select: none;
                    width: 1em;
                    height: 1em;
                    display: inline-block;
                    fill: currentColor;
                    -webkit-flex-shrink: 0;
                    -ms-flex-negative: 0;
                    flex-shrink: 0;
                    -webkit-transition: fill 200ms cubic-bezier(0.4, 0, 0.2, 1)
                      0ms;
                    transition: fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                    font-size: 2.1875rem;
                  }</style
                ><svg
                  class="MuiSvgIcon-root MuiSvgIcon-fontSizeLarge css-6flbmm"
                  focusable="false"
                  aria-hidden="true"
                  viewBox="0 0 24 24"
                  data-testid="MenuIcon"
                >
                  <path d="M3 18h18v-2H3zm0-5h18v-2H3zm0-7v2h18V6z"></path>
                </svg>
              </button>
            </div>
          </div>
        </div>
      </header>
      <div style="padding-top: 55px"></div>
    </header>
    <style data-emotion="css 1qsxih2">
      .css-1qsxih2 {
        width: 100%;
        margin-left: auto;
        box-sizing: border-box;
        margin-right: auto;
        display: block;
        padding-left: 16px;
        padding-right: 16px;
      }
      @media (min-width: 600px) {
        .css-1qsxih2 {
          padding-left: 24px;
          padding-right: 24px;
        }
      }
      @media (min-width: 1200px) {
        .css-1qsxih2 {
          max-width: 1200px;
        }
      }
    </style>
    <div class="MuiContainer-root MuiContainer-maxWidthLg css-1qsxih2">
      <style data-emotion="css 1g0xyuw">
        .css-1g0xyuw {
          margin-bottom: 40px;
          padding-bottom: 16px;
          width: 100%;
          display: -webkit-box;
          display: -webkit-flex;
          display: -ms-flexbox;
          display: flex;
          -webkit-flex-direction: column;
          -ms-flex-direction: column;
          flex-direction: column;
          -webkit-box-pack: start;
          -ms-flex-pack: start;
          -webkit-justify-content: flex-start;
          justify-content: flex-start;
          -webkit-align-items: flex-start;
          -webkit-box-align: flex-start;
          -ms-flex-align: flex-start;
          align-items: flex-start;
        }
      </style>
      <div class="MuiBox-root css-1g0xyuw">
        <style data-emotion="css 1vl439b">
          .css-1vl439b {
            width: 100%;
            -webkit-flex-direction: row;
            -ms-flex-direction: row;
            flex-direction: row;
            -webkit-box-pack: start;
            -ms-flex-pack: start;
            -webkit-justify-content: flex-start;
            justify-content: flex-start;
            -webkit-align-items: center;
            -webkit-box-align: center;
            -ms-flex-align: center;
            align-items: center;
            margin-bottom: 24px;
          }
          @media (min-width: 0px) {
            .css-1vl439b {
              display: none;
            }
          }
          @media (min-width: 900px) {
            .css-1vl439b {
              display: -webkit-box;
              display: -webkit-flex;
              display: -ms-flexbox;
              display: flex;
            }
          }
        </style>
        <div class="MuiBox-root css-1vl439b">
          <style data-emotion="css 1yae3jf">
            .css-1yae3jf {
              display: -webkit-box;
              display: -webkit-flex;
              display: -ms-flexbox;
              display: flex;
              -webkit-flex-direction: row;
              -ms-flex-direction: row;
              flex-direction: row;
              -webkit-box-pack: start;
              -ms-flex-pack: start;
              -webkit-justify-content: flex-start;
              justify-content: flex-start;
              -webkit-align-items: center;
              -webkit-box-align: center;
              -ms-flex-align: center;
              align-items: center;
            }
          </style>
          <div class="MuiBox-root css-1yae3jf">
            <a href="/"
              ><style data-emotion="css pbbsfi">
                .css-pbbsfi {
                  font-family: "Roboto", "Helvetica", "Arial", sans-serif;
                  font-weight: 500;
                  font-size: 0.8125rem;
                  line-height: 1.75;
                  letter-spacing: 0.02857em;
                  text-transform: uppercase;
                  min-width: 64px;
                  padding: 3px 9px;
                  border-radius: 4px;
                  -webkit-transition:
                    background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
                    box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
                    border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
                    color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                  transition:
                    background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
                    box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
                    border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
                    color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                  border: 1px solid rgba(237, 108, 2, 0.5);
                  color: #ed6c02;
                }
                .css-pbbsfi:hover {
                  -webkit-text-decoration: none;
                  text-decoration: none;
                  background-color: rgba(237, 108, 2, 0.04);
                  border: 1px solid #ed6c02;
                }
                @media (hover: none) {
                  .css-pbbsfi:hover {
                    background-color: transparent;
                  }
                }
                .css-pbbsfi.Mui-disabled {
                  color: rgba(0, 0, 0, 0.26);
                  border: 1px solid rgba(0, 0, 0, 0.12);
                }</style
              ><style data-emotion="css 1184ln1">
                .css-1184ln1 {
                  display: -webkit-inline-box;
                  display: -webkit-inline-flex;
                  display: -ms-inline-flexbox;
                  display: inline-flex;
                  -webkit-align-items: center;
                  -webkit-box-align: center;
                  -ms-flex-align: center;
                  align-items: center;
                  -webkit-box-pack: center;
                  -ms-flex-pack: center;
                  -webkit-justify-content: center;
                  justify-content: center;
                  position: relative;
                  box-sizing: border-box;
                  -webkit-tap-highlight-color: transparent;
                  background-color: transparent;
                  outline: 0;
                  border: 0;
                  margin: 0;
                  border-radius: 0;
                  padding: 0;
                  cursor: pointer;
                  -webkit-user-select: none;
                  -moz-user-select: none;
                  -ms-user-select: none;
                  user-select: none;
                  vertical-align: middle;
                  -moz-appearance: none;
                  -webkit-appearance: none;
                  -webkit-text-decoration: none;
                  text-decoration: none;
                  color: inherit;
                  font-family: "Roboto", "Helvetica", "Arial", sans-serif;
                  font-weight: 500;
                  font-size: 0.8125rem;
                  line-height: 1.75;
                  letter-spacing: 0.02857em;
                  text-transform: uppercase;
                  min-width: 64px;
                  padding: 3px 9px;
                  border-radius: 4px;
                  -webkit-transition:
                    background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
                    box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
                    border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
                    color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                  transition:
                    background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
                    box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
                    border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
                    color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                  border: 1px solid rgba(237, 108, 2, 0.5);
                  color: #ed6c02;
                }
                .css-1184ln1::-moz-focus-inner {
                  border-style: none;
                }
                .css-1184ln1.Mui-disabled {
                  pointer-events: none;
                  cursor: default;
                }
                @media print {
                  .css-1184ln1 {
                    -webkit-print-color-adjust: exact;
                    color-adjust: exact;
                  }
                }
                .css-1184ln1:hover {
                  -webkit-text-decoration: none;
                  text-decoration: none;
                  background-color: rgba(237, 108, 2, 0.04);
                  border: 1px solid #ed6c02;
                }
                @media (hover: none) {
                  .css-1184ln1:hover {
                    background-color: transparent;
                  }
                }
                .css-1184ln1.Mui-disabled {
                  color: rgba(0, 0, 0, 0.26);
                  border: 1px solid rgba(0, 0, 0, 0.12);
                }</style
              ><button
                class="MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedWarning MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorWarning MuiButton-root MuiButton-outlined MuiButton-outlinedWarning MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorWarning css-1184ln1"
                tabindex="0"
                type="button"
              >
                Home
              </button></a
            >
          </div>
          <div class="MuiBox-root css-1yae3jf">
            <style data-emotion="css vubbuv">
              .css-vubbuv {
                -webkit-user-select: none;
                -moz-user-select: none;
                -ms-user-select: none;
                user-select: none;
                width: 1em;
                height: 1em;
                display: inline-block;
                fill: currentColor;
                -webkit-flex-shrink: 0;
                -ms-flex-negative: 0;
                flex-shrink: 0;
                -webkit-transition: fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                transition: fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                font-size: 1.5rem;
              }</style
            ><svg
              class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
              focusable="false"
              aria-hidden="true"
              viewBox="0 0 24 24"
              data-testid="KeyboardArrowRightIcon"
            >
              <path
                d="M8.59 16.59 13.17 12 8.59 7.41 10 6l6 6-6 6z"
              ></path></svg
            ><a href="/ml-ops/"
              ><button
                class="MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedWarning MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorWarning MuiButton-root MuiButton-outlined MuiButton-outlinedWarning MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorWarning css-1184ln1"
                tabindex="0"
                type="button"
              >
                ML Ops
              </button></a
            >
          </div>
          <div class="MuiBox-root css-1yae3jf">
            <svg
              class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
              focusable="false"
              aria-hidden="true"
              viewBox="0 0 24 24"
              data-testid="KeyboardArrowRightIcon"
            >
              <path
                d="M8.59 16.59 13.17 12 8.59 7.41 10 6l6 6-6 6z"
              ></path></svg
            ><a href="/ml-ops/torch-training-and-conversion-to-onnx/"
              ><button
                class="MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedWarning MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorWarning MuiButton-root MuiButton-outlined MuiButton-outlinedWarning MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorWarning css-1184ln1"
                tabindex="0"
                type="button"
              >
                Training a CNN in PyTorch and Exporting it to ONNX
              </button></a
            >
          </div>
        </div>
        <style data-emotion="css slaq2o">
          .css-slaq2o {
            box-sizing: border-box;
            display: -webkit-box;
            display: -webkit-flex;
            display: -ms-flexbox;
            display: flex;
            -webkit-box-flex-wrap: wrap;
            -webkit-flex-wrap: wrap;
            -ms-flex-wrap: wrap;
            flex-wrap: wrap;
            width: 100%;
            -webkit-flex-direction: row;
            -ms-flex-direction: row;
            flex-direction: row;
            margin-top: -16px;
            width: calc(100% + 16px);
            margin-left: -16px;
            margin-bottom: 0px;
          }
          .css-slaq2o > .MuiGrid-item {
            padding-top: 16px;
          }
          .css-slaq2o > .MuiGrid-item {
            padding-left: 16px;
          }
        </style>
        <div
          class="MuiGrid-root MuiGrid-container MuiGrid-spacing-xs-2 css-slaq2o"
        >
          <style data-emotion="css hr4540">
            .css-hr4540 {
              box-sizing: border-box;
              margin: 0;
              -webkit-flex-direction: row;
              -ms-flex-direction: row;
              flex-direction: row;
              -webkit-flex-basis: 100%;
              -ms-flex-preferred-size: 100%;
              flex-basis: 100%;
              -webkit-box-flex: 0;
              -webkit-flex-grow: 0;
              -ms-flex-positive: 0;
              flex-grow: 0;
              max-width: 100%;
              background: linear-gradient(to right, #eeeeee, #ffffff);
              border-radius: 20px;
            }
            @media (min-width: 600px) {
              .css-hr4540 {
                -webkit-flex-basis: 100%;
                -ms-flex-preferred-size: 100%;
                flex-basis: 100%;
                -webkit-box-flex: 0;
                -webkit-flex-grow: 0;
                -ms-flex-positive: 0;
                flex-grow: 0;
                max-width: 100%;
              }
            }
            @media (min-width: 900px) {
              .css-hr4540 {
                -webkit-flex-basis: 33.333333%;
                -ms-flex-preferred-size: 33.333333%;
                flex-basis: 33.333333%;
                -webkit-box-flex: 0;
                -webkit-flex-grow: 0;
                -ms-flex-positive: 0;
                flex-grow: 0;
                max-width: 33.333333%;
              }
            }
            @media (min-width: 1200px) {
              .css-hr4540 {
                -webkit-flex-basis: 33.333333%;
                -ms-flex-preferred-size: 33.333333%;
                flex-basis: 33.333333%;
                -webkit-box-flex: 0;
                -webkit-flex-grow: 0;
                -ms-flex-positive: 0;
                flex-grow: 0;
                max-width: 33.333333%;
              }
            }
            @media (min-width: 1536px) {
              .css-hr4540 {
                -webkit-flex-basis: 33.333333%;
                -ms-flex-preferred-size: 33.333333%;
                flex-basis: 33.333333%;
                -webkit-box-flex: 0;
                -webkit-flex-grow: 0;
                -ms-flex-positive: 0;
                flex-grow: 0;
                max-width: 33.333333%;
              }
            }
          </style>
          <div
            class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-12 MuiGrid-grid-sm-12 MuiGrid-grid-md-4 css-hr4540"
          >
            <style data-emotion="css 194lag7">
              .css-194lag7 {
                width: 100%;
                height: 100%;
                display: -webkit-box;
                display: -webkit-flex;
                display: -ms-flexbox;
                display: flex;
                -webkit-flex-direction: column;
                -ms-flex-direction: column;
                flex-direction: column;
                -webkit-box-pack: center;
                -ms-flex-pack: center;
                -webkit-justify-content: center;
                justify-content: center;
                -webkit-align-items: flex-start;
                -webkit-box-align: flex-start;
                -ms-flex-align: flex-start;
                align-items: flex-start;
                padding-bottom: 16px;
              }
            </style>
            <div class="MuiBox-root css-194lag7">
              <style data-emotion="css t1nuxs">
                .css-t1nuxs {
                  margin: 0;
                  font-family: "Roboto", "Helvetica", "Arial", sans-serif;
                  font-weight: 400;
                  font-size: 1.5rem;
                  line-height: 1.334;
                  letter-spacing: 0em;
                  margin-bottom: 0.35em;
                }
              </style>
              <h1
                class="MuiTypography-root MuiTypography-h5 MuiTypography-gutterBottom css-t1nuxs"
              >
                Training a CNN in PyTorch and Exporting it to ONNX
              </h1>
              <style data-emotion="css 15wzlf5">
                .css-15wzlf5 {
                  margin: 0;
                  margin-bottom: 0.35em;
                  margin-bottom: 32px;
                }
              </style>
              <p
                class="MuiTypography-root MuiTypography-p MuiTypography-gutterBottom css-15wzlf5"
              >
                Learn how to train a simple CNN in PyTorch and how to convert it
                to ONNX for deployment.
              </p>
              <style data-emotion="css 1aiyebw">
                .css-1aiyebw {
                  width: 100%;
                  display: -webkit-box;
                  display: -webkit-flex;
                  display: -ms-flexbox;
                  display: flex;
                  -webkit-flex-direction: row;
                  -ms-flex-direction: row;
                  flex-direction: row;
                  -webkit-box-pack: justify;
                  -webkit-justify-content: space-between;
                  justify-content: space-between;
                  -webkit-align-items: center;
                  -webkit-box-align: center;
                  -ms-flex-align: center;
                  align-items: center;
                  margin-bottom: 16px;
                }
              </style>
              <div class="MuiBox-root css-1aiyebw">
                <style data-emotion="css mxjm1x">
                  .css-mxjm1x {
                    margin: 0;
                    margin-bottom: 0.35em;
                  }
                </style>
                <p
                  class="MuiTypography-root MuiTypography-p MuiTypography-gutterBottom css-mxjm1x"
                >
                  July 26, 2024
                </p>
                <p
                  class="MuiTypography-root MuiTypography-p MuiTypography-gutterBottom css-mxjm1x"
                >
                  07m<!-- -->
                  Read
                </p>
              </div>
              <style data-emotion="css 1sdy4c7">
                .css-1sdy4c7 {
                  width: 100%;
                  display: -webkit-box;
                  display: -webkit-flex;
                  display: -ms-flexbox;
                  display: flex;
                  -webkit-flex-direction: row;
                  -ms-flex-direction: row;
                  flex-direction: row;
                  -webkit-box-pack: justify;
                  -webkit-justify-content: space-between;
                  justify-content: space-between;
                  -webkit-align-items: center;
                  -webkit-box-align: center;
                  -ms-flex-align: center;
                  align-items: center;
                }
              </style>
              <div class="MuiBox-root css-1sdy4c7">
                <style data-emotion="css 19115x2">
                  .css-19115x2 {
                    margin: 0;
                    margin-right: 16px;
                  }
                </style>
                <p class="MuiTypography-root MuiTypography-p css-19115x2">
                  By: Abhilaksh Singh Reen
                </p>
                <style data-emotion="css o6eoqx">
                  .css-o6eoqx {
                    display: -webkit-box;
                    display: -webkit-flex;
                    display: -ms-flexbox;
                    display: flex;
                    -webkit-flex-direction: row;
                    -ms-flex-direction: row;
                    flex-direction: row;
                    -webkit-box-pack: space-evenly;
                    -ms-flex-pack: space-evenly;
                    -webkit-justify-content: space-evenly;
                    justify-content: space-evenly;
                    -webkit-align-items: center;
                    -webkit-box-align: center;
                    -ms-flex-align: center;
                    align-items: center;
                  }
                </style>
                <div class="MuiBox-root css-o6eoqx">
                  <style data-emotion="css 1t2xui4">
                    .css-1t2xui4 {
                      text-align: center;
                      -webkit-flex: 0 0 auto;
                      -ms-flex: 0 0 auto;
                      flex: 0 0 auto;
                      font-size: 1.5rem;
                      padding: 8px;
                      border-radius: 50%;
                      overflow: visible;
                      color: rgba(0, 0, 0, 0.54);
                      -webkit-transition: background-color 150ms
                        cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                      transition: background-color 150ms
                        cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                      color: #0077b5;
                    }
                    .css-1t2xui4:hover {
                      background-color: rgba(0, 0, 0, 0.04);
                    }
                    @media (hover: none) {
                      .css-1t2xui4:hover {
                        background-color: transparent;
                      }
                    }
                    .css-1t2xui4.Mui-disabled {
                      background-color: transparent;
                      color: rgba(0, 0, 0, 0.26);
                    }</style
                  ><style data-emotion="css 1yl6xtp">
                    .css-1yl6xtp {
                      display: -webkit-inline-box;
                      display: -webkit-inline-flex;
                      display: -ms-inline-flexbox;
                      display: inline-flex;
                      -webkit-align-items: center;
                      -webkit-box-align: center;
                      -ms-flex-align: center;
                      align-items: center;
                      -webkit-box-pack: center;
                      -ms-flex-pack: center;
                      -webkit-justify-content: center;
                      justify-content: center;
                      position: relative;
                      box-sizing: border-box;
                      -webkit-tap-highlight-color: transparent;
                      background-color: transparent;
                      outline: 0;
                      border: 0;
                      margin: 0;
                      border-radius: 0;
                      padding: 0;
                      cursor: pointer;
                      -webkit-user-select: none;
                      -moz-user-select: none;
                      -ms-user-select: none;
                      user-select: none;
                      vertical-align: middle;
                      -moz-appearance: none;
                      -webkit-appearance: none;
                      -webkit-text-decoration: none;
                      text-decoration: none;
                      color: inherit;
                      text-align: center;
                      -webkit-flex: 0 0 auto;
                      -ms-flex: 0 0 auto;
                      flex: 0 0 auto;
                      font-size: 1.5rem;
                      padding: 8px;
                      border-radius: 50%;
                      overflow: visible;
                      color: rgba(0, 0, 0, 0.54);
                      -webkit-transition: background-color 150ms
                        cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                      transition: background-color 150ms
                        cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                      color: #0077b5;
                    }
                    .css-1yl6xtp::-moz-focus-inner {
                      border-style: none;
                    }
                    .css-1yl6xtp.Mui-disabled {
                      pointer-events: none;
                      cursor: default;
                    }
                    @media print {
                      .css-1yl6xtp {
                        -webkit-print-color-adjust: exact;
                        color-adjust: exact;
                      }
                    }
                    .css-1yl6xtp:hover {
                      background-color: rgba(0, 0, 0, 0.04);
                    }
                    @media (hover: none) {
                      .css-1yl6xtp:hover {
                        background-color: transparent;
                      }
                    }
                    .css-1yl6xtp.Mui-disabled {
                      background-color: transparent;
                      color: rgba(0, 0, 0, 0.26);
                    }</style
                  ><button
                    class="MuiButtonBase-root MuiIconButton-root MuiIconButton-sizeMedium css-1yl6xtp"
                    tabindex="0"
                    type="button"
                  >
                    <svg
                      class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                      focusable="false"
                      aria-hidden="true"
                      viewBox="0 0 24 24"
                      data-testid="LinkedInIcon"
                    >
                      <path
                        d="M19 3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14m-.5 15.5v-5.3a3.26 3.26 0 0 0-3.26-3.26c-.85 0-1.84.52-2.32 1.3v-1.11h-2.79v8.37h2.79v-4.93c0-.77.62-1.4 1.39-1.4a1.4 1.4 0 0 1 1.4 1.4v4.93h2.79M6.88 8.56a1.68 1.68 0 0 0 1.68-1.68c0-.93-.75-1.69-1.68-1.69a1.69 1.69 0 0 0-1.69 1.69c0 .93.76 1.68 1.69 1.68m1.39 9.94v-8.37H5.5v8.37h2.77z"
                      ></path>
                    </svg></button
                  ><style data-emotion="css 161nngb">
                    .css-161nngb {
                      text-align: center;
                      -webkit-flex: 0 0 auto;
                      -ms-flex: 0 0 auto;
                      flex: 0 0 auto;
                      font-size: 1.5rem;
                      padding: 8px;
                      border-radius: 50%;
                      overflow: visible;
                      color: rgba(0, 0, 0, 0.54);
                      -webkit-transition: background-color 150ms
                        cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                      transition: background-color 150ms
                        cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                      color: #000000;
                    }
                    .css-161nngb:hover {
                      background-color: rgba(0, 0, 0, 0.04);
                    }
                    @media (hover: none) {
                      .css-161nngb:hover {
                        background-color: transparent;
                      }
                    }
                    .css-161nngb.Mui-disabled {
                      background-color: transparent;
                      color: rgba(0, 0, 0, 0.26);
                    }</style
                  ><style data-emotion="css tn2bks">
                    .css-tn2bks {
                      display: -webkit-inline-box;
                      display: -webkit-inline-flex;
                      display: -ms-inline-flexbox;
                      display: inline-flex;
                      -webkit-align-items: center;
                      -webkit-box-align: center;
                      -ms-flex-align: center;
                      align-items: center;
                      -webkit-box-pack: center;
                      -ms-flex-pack: center;
                      -webkit-justify-content: center;
                      justify-content: center;
                      position: relative;
                      box-sizing: border-box;
                      -webkit-tap-highlight-color: transparent;
                      background-color: transparent;
                      outline: 0;
                      border: 0;
                      margin: 0;
                      border-radius: 0;
                      padding: 0;
                      cursor: pointer;
                      -webkit-user-select: none;
                      -moz-user-select: none;
                      -ms-user-select: none;
                      user-select: none;
                      vertical-align: middle;
                      -moz-appearance: none;
                      -webkit-appearance: none;
                      -webkit-text-decoration: none;
                      text-decoration: none;
                      color: inherit;
                      text-align: center;
                      -webkit-flex: 0 0 auto;
                      -ms-flex: 0 0 auto;
                      flex: 0 0 auto;
                      font-size: 1.5rem;
                      padding: 8px;
                      border-radius: 50%;
                      overflow: visible;
                      color: rgba(0, 0, 0, 0.54);
                      -webkit-transition: background-color 150ms
                        cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                      transition: background-color 150ms
                        cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                      color: #000000;
                    }
                    .css-tn2bks::-moz-focus-inner {
                      border-style: none;
                    }
                    .css-tn2bks.Mui-disabled {
                      pointer-events: none;
                      cursor: default;
                    }
                    @media print {
                      .css-tn2bks {
                        -webkit-print-color-adjust: exact;
                        color-adjust: exact;
                      }
                    }
                    .css-tn2bks:hover {
                      background-color: rgba(0, 0, 0, 0.04);
                    }
                    @media (hover: none) {
                      .css-tn2bks:hover {
                        background-color: transparent;
                      }
                    }
                    .css-tn2bks.Mui-disabled {
                      background-color: transparent;
                      color: rgba(0, 0, 0, 0.26);
                    }</style
                  ><button
                    class="MuiButtonBase-root MuiIconButton-root MuiIconButton-sizeMedium css-tn2bks"
                    tabindex="0"
                    type="button"
                  >
                    <svg
                      class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                      focusable="false"
                      aria-hidden="true"
                      viewBox="0 0 24 24"
                      data-testid="XIcon"
                    >
                      <path
                        d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"
                      ></path>
                    </svg></button
                  ><button
                    class="MuiButtonBase-root MuiIconButton-root MuiIconButton-sizeMedium css-tn2bks"
                    tabindex="0"
                    type="button"
                  >
                    <svg
                      class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                      focusable="false"
                      aria-hidden="true"
                      viewBox="0 0 24 24"
                      data-testid="GitHubIcon"
                    >
                      <path
                        d="M12 1.27a11 11 0 00-3.48 21.46c.55.09.73-.28.73-.55v-1.84c-3.03.64-3.67-1.46-3.67-1.46-.55-1.29-1.28-1.65-1.28-1.65-.92-.65.1-.65.1-.65 1.1 0 1.73 1.1 1.73 1.1.92 1.65 2.57 1.2 3.21.92a2 2 0 01.64-1.47c-2.47-.27-5.04-1.19-5.04-5.5 0-1.1.46-2.1 1.2-2.84a3.76 3.76 0 010-2.93s.91-.28 3.11 1.1c1.8-.49 3.7-.49 5.5 0 2.1-1.38 3.02-1.1 3.02-1.1a3.76 3.76 0 010 2.93c.83.74 1.2 1.74 1.2 2.94 0 4.21-2.57 5.13-5.04 5.4.45.37.82.92.82 2.02v3.03c0 .27.1.64.73.55A11 11 0 0012 1.27"
                      ></path>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          </div>
          <style data-emotion="css efwuvd">
            .css-efwuvd {
              box-sizing: border-box;
              margin: 0;
              -webkit-flex-direction: row;
              -ms-flex-direction: row;
              flex-direction: row;
              -webkit-flex-basis: 100%;
              -ms-flex-preferred-size: 100%;
              flex-basis: 100%;
              -webkit-box-flex: 0;
              -webkit-flex-grow: 0;
              -ms-flex-positive: 0;
              flex-grow: 0;
              max-width: 100%;
            }
            @media (min-width: 600px) {
              .css-efwuvd {
                -webkit-flex-basis: 100%;
                -ms-flex-preferred-size: 100%;
                flex-basis: 100%;
                -webkit-box-flex: 0;
                -webkit-flex-grow: 0;
                -ms-flex-positive: 0;
                flex-grow: 0;
                max-width: 100%;
              }
            }
            @media (min-width: 900px) {
              .css-efwuvd {
                -webkit-flex-basis: 66.666667%;
                -ms-flex-preferred-size: 66.666667%;
                flex-basis: 66.666667%;
                -webkit-box-flex: 0;
                -webkit-flex-grow: 0;
                -ms-flex-positive: 0;
                flex-grow: 0;
                max-width: 66.666667%;
              }
            }
            @media (min-width: 1200px) {
              .css-efwuvd {
                -webkit-flex-basis: 66.666667%;
                -ms-flex-preferred-size: 66.666667%;
                flex-basis: 66.666667%;
                -webkit-box-flex: 0;
                -webkit-flex-grow: 0;
                -ms-flex-positive: 0;
                flex-grow: 0;
                max-width: 66.666667%;
              }
            }
            @media (min-width: 1536px) {
              .css-efwuvd {
                -webkit-flex-basis: 66.666667%;
                -ms-flex-preferred-size: 66.666667%;
                flex-basis: 66.666667%;
                -webkit-box-flex: 0;
                -webkit-flex-grow: 0;
                -ms-flex-positive: 0;
                flex-grow: 0;
                max-width: 66.666667%;
              }
            }
          </style>
          <div
            class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-12 MuiGrid-grid-sm-12 MuiGrid-grid-md-8 css-efwuvd"
          >
            <style data-emotion="css fbmkol">
              .css-fbmkol {
                -webkit-flex: 1;
                -ms-flex: 1;
                flex: 1;
                display: -webkit-box;
                display: -webkit-flex;
                display: -ms-flexbox;
                display: flex;
                -webkit-flex-direction: column;
                -ms-flex-direction: column;
                flex-direction: column;
                -webkit-box-pack: center;
                -ms-flex-pack: center;
                -webkit-justify-content: center;
                justify-content: center;
                -webkit-align-items: center;
                -webkit-box-align: center;
                -ms-flex-align: center;
                align-items: center;
                margin-right: 16px;
              }
            </style>
            <div class="MuiBox-root css-fbmkol">
              <img
                src="/media/images/torch-training-and-conversion-to-onnx-thumbnail.jpg"
                style="
                  width: 100%;
                  max-width: 75vw;
                  height: auto;
                  max-height: 35vh;
                  object-fit: cover;
                "
              />
            </div>
          </div>
        </div>
        <style data-emotion="css 8atqhb">
          .css-8atqhb {
            width: 100%;
          }
        </style>
        <div class="MuiBox-root css-8atqhb">
          <style data-emotion="css iv262p">
            .css-iv262p {
              box-sizing: border-box;
              display: -webkit-box;
              display: -webkit-flex;
              display: -ms-flexbox;
              display: flex;
              -webkit-box-flex-wrap: wrap;
              -webkit-flex-wrap: wrap;
              -ms-flex-wrap: wrap;
              flex-wrap: wrap;
              width: 100%;
              -webkit-flex-direction: row;
              -ms-flex-direction: row;
              flex-direction: row;
              margin-top: -16px;
              width: calc(100% + 16px);
              margin-left: -16px;
              margin-top: 32px;
              margin-bottom: 0px;
            }
            .css-iv262p > .MuiGrid-item {
              padding-top: 16px;
            }
            .css-iv262p > .MuiGrid-item {
              padding-left: 16px;
            }
          </style>
          <div
            class="MuiGrid-root MuiGrid-container MuiGrid-spacing-xs-2 css-iv262p"
          >
            <style data-emotion="css 1hclw6t">
              .css-1hclw6t {
                box-sizing: border-box;
                margin: 0;
                -webkit-flex-direction: row;
                -ms-flex-direction: row;
                flex-direction: row;
                -webkit-flex-basis: 100%;
                -ms-flex-preferred-size: 100%;
                flex-basis: 100%;
                -webkit-box-flex: 0;
                -webkit-flex-grow: 0;
                -ms-flex-positive: 0;
                flex-grow: 0;
                max-width: 100%;
                background: linear-gradient(to right, #eeeeee, #ffffff);
                border-radius: 20px;
              }
              @media (min-width: 600px) {
                .css-1hclw6t {
                  -webkit-flex-basis: 100%;
                  -ms-flex-preferred-size: 100%;
                  flex-basis: 100%;
                  -webkit-box-flex: 0;
                  -webkit-flex-grow: 0;
                  -ms-flex-positive: 0;
                  flex-grow: 0;
                  max-width: 100%;
                }
              }
              @media (min-width: 900px) {
                .css-1hclw6t {
                  -webkit-flex-basis: 33.333333%;
                  -ms-flex-preferred-size: 33.333333%;
                  flex-basis: 33.333333%;
                  -webkit-box-flex: 0;
                  -webkit-flex-grow: 0;
                  -ms-flex-positive: 0;
                  flex-grow: 0;
                  max-width: 33.333333%;
                }
              }
              @media (min-width: 1200px) {
                .css-1hclw6t {
                  -webkit-flex-basis: 25%;
                  -ms-flex-preferred-size: 25%;
                  flex-basis: 25%;
                  -webkit-box-flex: 0;
                  -webkit-flex-grow: 0;
                  -ms-flex-positive: 0;
                  flex-grow: 0;
                  max-width: 25%;
                }
              }
              @media (min-width: 1536px) {
                .css-1hclw6t {
                  -webkit-flex-basis: 25%;
                  -ms-flex-preferred-size: 25%;
                  flex-basis: 25%;
                  -webkit-box-flex: 0;
                  -webkit-flex-grow: 0;
                  -ms-flex-positive: 0;
                  flex-grow: 0;
                  max-width: 25%;
                }
              }
            </style>
            <div
              class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-12 MuiGrid-grid-sm-12 MuiGrid-grid-md-4 MuiGrid-grid-lg-3 css-1hclw6t"
            >
              <div class="MuiBox-root css-8atqhb">
                <style data-emotion="css 1zqdou">
                  .css-1zqdou {
                    width: 100%;
                    margin-bottom: 16px;
                  }
                  @media (min-width: 0px) {
                    .css-1zqdou {
                      display: block;
                    }
                  }
                  @media (min-width: 900px) {
                    .css-1zqdou {
                      display: none;
                    }
                  }
                </style>
                <div class="MuiBox-root css-1zqdou">
                  <style data-emotion="css mgu3mc">
                    .css-mgu3mc {
                      position: relative;
                      -webkit-transition: margin 150ms
                        cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                      transition: margin 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                      overflow-anchor: none;
                      border-radius: 0;
                      width: 100%;
                      margin-bottom: 16px;
                      box-shadow:
                        0px 3px 3px -2px rgba(0, 0, 0, 0.2),
                        0px 3px 4px 0px rgba(0, 0, 0, 0.14),
                        0px 1px 8px 0px rgba(0, 0, 0, 0.12);
                      background-color: #ffffff22;
                    }
                    .css-mgu3mc::before {
                      position: absolute;
                      left: 0;
                      top: -1px;
                      right: 0;
                      height: 1px;
                      content: "";
                      opacity: 1;
                      background-color: rgba(0, 0, 0, 0.12);
                      -webkit-transition:
                        opacity 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
                        background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                      transition:
                        opacity 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
                        background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                    }
                    .css-mgu3mc:first-of-type::before {
                      display: none;
                    }
                    .css-mgu3mc.Mui-expanded::before {
                      opacity: 0;
                    }
                    .css-mgu3mc.Mui-expanded:first-of-type {
                      margin-top: 0;
                    }
                    .css-mgu3mc.Mui-expanded:last-of-type {
                      margin-bottom: 0;
                    }
                    .css-mgu3mc.Mui-expanded
                      + .css-mgu3mc.Mui-expanded::before {
                      display: none;
                    }
                    .css-mgu3mc.Mui-disabled {
                      background-color: rgba(0, 0, 0, 0.12);
                    }
                    .css-mgu3mc:first-of-type {
                      border-top-left-radius: 4px;
                      border-top-right-radius: 4px;
                    }
                    .css-mgu3mc:last-of-type {
                      border-bottom-left-radius: 4px;
                      border-bottom-right-radius: 4px;
                    }
                    @supports (-ms-ime-align: auto) {
                      .css-mgu3mc:last-of-type {
                        border-bottom-left-radius: 0;
                        border-bottom-right-radius: 0;
                      }
                    }</style
                  ><style data-emotion="css 16ex79u">
                    .css-16ex79u {
                      background-color: #fff;
                      color: rgba(0, 0, 0, 0.87);
                      -webkit-transition: box-shadow 300ms
                        cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                      transition: box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1)
                        0ms;
                      border-radius: 4px;
                      box-shadow:
                        0px 2px 1px -1px rgba(0, 0, 0, 0.2),
                        0px 1px 1px 0px rgba(0, 0, 0, 0.14),
                        0px 1px 3px 0px rgba(0, 0, 0, 0.12);
                      position: relative;
                      -webkit-transition: margin 150ms
                        cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                      transition: margin 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                      overflow-anchor: none;
                      border-radius: 0;
                      width: 100%;
                      margin-bottom: 16px;
                      box-shadow:
                        0px 3px 3px -2px rgba(0, 0, 0, 0.2),
                        0px 3px 4px 0px rgba(0, 0, 0, 0.14),
                        0px 1px 8px 0px rgba(0, 0, 0, 0.12);
                      background-color: #ffffff22;
                    }
                    .css-16ex79u::before {
                      position: absolute;
                      left: 0;
                      top: -1px;
                      right: 0;
                      height: 1px;
                      content: "";
                      opacity: 1;
                      background-color: rgba(0, 0, 0, 0.12);
                      -webkit-transition:
                        opacity 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
                        background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                      transition:
                        opacity 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
                        background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                    }
                    .css-16ex79u:first-of-type::before {
                      display: none;
                    }
                    .css-16ex79u.Mui-expanded::before {
                      opacity: 0;
                    }
                    .css-16ex79u.Mui-expanded:first-of-type {
                      margin-top: 0;
                    }
                    .css-16ex79u.Mui-expanded:last-of-type {
                      margin-bottom: 0;
                    }
                    .css-16ex79u.Mui-expanded
                      + .css-16ex79u.Mui-expanded::before {
                      display: none;
                    }
                    .css-16ex79u.Mui-disabled {
                      background-color: rgba(0, 0, 0, 0.12);
                    }
                    .css-16ex79u:first-of-type {
                      border-top-left-radius: 4px;
                      border-top-right-radius: 4px;
                    }
                    .css-16ex79u:last-of-type {
                      border-bottom-left-radius: 4px;
                      border-bottom-right-radius: 4px;
                    }
                    @supports (-ms-ime-align: auto) {
                      .css-16ex79u:last-of-type {
                        border-bottom-left-radius: 0;
                        border-bottom-right-radius: 0;
                      }
                    }
                  </style>
                  <div
                    class="MuiPaper-root MuiPaper-elevation MuiPaper-rounded MuiPaper-elevation1 MuiAccordion-root MuiAccordion-rounded css-16ex79u"
                  >
                    <style data-emotion="css 148gpqp">
                      .css-148gpqp {
                        display: -webkit-box;
                        display: -webkit-flex;
                        display: -ms-flexbox;
                        display: flex;
                        min-height: 48px;
                        padding: 0px 16px;
                        -webkit-transition:
                          min-height 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
                          background-color 150ms cubic-bezier(0.4, 0, 0.2, 1)
                            0ms;
                        transition:
                          min-height 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
                          background-color 150ms cubic-bezier(0.4, 0, 0.2, 1)
                            0ms;
                      }
                      .css-148gpqp.Mui-focusVisible {
                        background-color: rgba(0, 0, 0, 0.12);
                      }
                      .css-148gpqp.Mui-disabled {
                        opacity: 0.38;
                      }
                      .css-148gpqp:hover:not(.Mui-disabled) {
                        cursor: pointer;
                      }</style
                    ><style data-emotion="css 1uaukoe">
                      .css-1uaukoe {
                        display: -webkit-inline-box;
                        display: -webkit-inline-flex;
                        display: -ms-inline-flexbox;
                        display: inline-flex;
                        -webkit-align-items: center;
                        -webkit-box-align: center;
                        -ms-flex-align: center;
                        align-items: center;
                        -webkit-box-pack: center;
                        -ms-flex-pack: center;
                        -webkit-justify-content: center;
                        justify-content: center;
                        position: relative;
                        box-sizing: border-box;
                        -webkit-tap-highlight-color: transparent;
                        background-color: transparent;
                        outline: 0;
                        border: 0;
                        margin: 0;
                        border-radius: 0;
                        padding: 0;
                        cursor: pointer;
                        -webkit-user-select: none;
                        -moz-user-select: none;
                        -ms-user-select: none;
                        user-select: none;
                        vertical-align: middle;
                        -moz-appearance: none;
                        -webkit-appearance: none;
                        -webkit-text-decoration: none;
                        text-decoration: none;
                        color: inherit;
                        display: -webkit-box;
                        display: -webkit-flex;
                        display: -ms-flexbox;
                        display: flex;
                        min-height: 48px;
                        padding: 0px 16px;
                        -webkit-transition:
                          min-height 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
                          background-color 150ms cubic-bezier(0.4, 0, 0.2, 1)
                            0ms;
                        transition:
                          min-height 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,
                          background-color 150ms cubic-bezier(0.4, 0, 0.2, 1)
                            0ms;
                      }
                      .css-1uaukoe::-moz-focus-inner {
                        border-style: none;
                      }
                      .css-1uaukoe.Mui-disabled {
                        pointer-events: none;
                        cursor: default;
                      }
                      @media print {
                        .css-1uaukoe {
                          -webkit-print-color-adjust: exact;
                          color-adjust: exact;
                        }
                      }
                      .css-1uaukoe.Mui-focusVisible {
                        background-color: rgba(0, 0, 0, 0.12);
                      }
                      .css-1uaukoe.Mui-disabled {
                        opacity: 0.38;
                      }
                      .css-1uaukoe:hover:not(.Mui-disabled) {
                        cursor: pointer;
                      }
                    </style>
                    <div
                      class="MuiButtonBase-root MuiAccordionSummary-root css-1uaukoe"
                      tabindex="0"
                      role="button"
                      aria-expanded="false"
                    >
                      <style data-emotion="css 1n11r91">
                        .css-1n11r91 {
                          display: -webkit-box;
                          display: -webkit-flex;
                          display: -ms-flexbox;
                          display: flex;
                          -webkit-box-flex: 1;
                          -webkit-flex-grow: 1;
                          -ms-flex-positive: 1;
                          flex-grow: 1;
                          margin: 12px 0;
                        }
                      </style>
                      <div class="MuiAccordionSummary-content css-1n11r91">
                        <style data-emotion="css 10n6ggx">
                          .css-10n6ggx {
                            margin: 0;
                            font-family: "Roboto", "Helvetica", "Arial",
                              sans-serif;
                            font-weight: 500;
                            font-size: 1.25rem;
                            line-height: 1.6;
                            letter-spacing: 0.0075em;
                            margin: 0px;
                            padding: 0px;
                          }
                        </style>
                        <h6
                          class="MuiTypography-root MuiTypography-h6 css-10n6ggx"
                        >
                          Table of Contents
                        </h6>
                      </div>
                      <style data-emotion="css 1fx8m19">
                        .css-1fx8m19 {
                          display: -webkit-box;
                          display: -webkit-flex;
                          display: -ms-flexbox;
                          display: flex;
                          color: rgba(0, 0, 0, 0.54);
                          -webkit-transform: rotate(0deg);
                          -moz-transform: rotate(0deg);
                          -ms-transform: rotate(0deg);
                          transform: rotate(0deg);
                          -webkit-transition: -webkit-transform 150ms
                            cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                          transition: transform 150ms
                            cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                        }
                        .css-1fx8m19.Mui-expanded {
                          -webkit-transform: rotate(180deg);
                          -moz-transform: rotate(180deg);
                          -ms-transform: rotate(180deg);
                          transform: rotate(180deg);
                        }
                      </style>
                      <div
                        class="MuiAccordionSummary-expandIconWrapper css-1fx8m19"
                      >
                        <svg
                          class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                          focusable="false"
                          aria-hidden="true"
                          viewBox="0 0 24 24"
                          data-testid="ExpandMoreIcon"
                        >
                          <path
                            d="M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"
                          ></path>
                        </svg>
                      </div>
                    </div>
                    <style data-emotion="css a0y2e3">
                      .css-a0y2e3 {
                        height: 0;
                        overflow: hidden;
                        -webkit-transition: height 300ms
                          cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                        transition: height 300ms cubic-bezier(0.4, 0, 0.2, 1)
                          0ms;
                        visibility: hidden;
                      }
                    </style>
                    <div
                      class="MuiCollapse-root MuiCollapse-vertical MuiCollapse-hidden css-a0y2e3"
                      style="min-height: 0px"
                    >
                      <style data-emotion="css hboir5">
                        .css-hboir5 {
                          display: -webkit-box;
                          display: -webkit-flex;
                          display: -ms-flexbox;
                          display: flex;
                          width: 100%;
                        }
                      </style>
                      <div
                        class="MuiCollapse-wrapper MuiCollapse-vertical css-hboir5"
                      >
                        <div
                          class="MuiCollapse-wrapperInner MuiCollapse-vertical css-8atqhb"
                        >
                          <div role="region" class="MuiAccordion-region">
                            <style data-emotion="css 2m6k8o">
                              .css-2m6k8o {
                                padding: 8px 16px 16px;
                                width: 90%;
                                display: -webkit-box;
                                display: -webkit-flex;
                                display: -ms-flexbox;
                                display: flex;
                                -webkit-flex-direction: column;
                                -ms-flex-direction: column;
                                flex-direction: column;
                                -webkit-box-pack: start;
                                -ms-flex-pack: start;
                                -webkit-justify-content: flex-start;
                                justify-content: flex-start;
                                -webkit-align-items: flex-start;
                                -webkit-box-align: flex-start;
                                -ms-flex-align: flex-start;
                                align-items: flex-start;
                                margin-bottom: 16px;
                              }
                            </style>
                            <div class="MuiAccordionDetails-root css-2m6k8o">
                              <a
                                href="#the-code"
                                style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"
                                ><style data-emotion="css vmnodn">
                                  .css-vmnodn {
                                    margin: 0;
                                    margin-left: 0px;
                                    margin-bottom: 20px;
                                  }
                                  .css-vmnodn:hover {
                                    color: blue;
                                  }
                                </style>
                                <p
                                  class="MuiTypography-root MuiTypography-p css-vmnodn"
                                >
                                  The Code
                                </p></a
                              ><a
                                href="#configuration"
                                style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"
                                ><style data-emotion="css 1i0m0sm">
                                  .css-1i0m0sm {
                                    margin: 0;
                                    margin-left: 8px;
                                    margin-bottom: 16px;
                                  }
                                  .css-1i0m0sm:hover {
                                    color: blue;
                                  }
                                </style>
                                <p
                                  class="MuiTypography-root MuiTypography-p css-1i0m0sm"
                                >
                                  Configuration
                                </p></a
                              ><a
                                href="#loading-the-dataset"
                                style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"
                                ><p
                                  class="MuiTypography-root MuiTypography-p css-1i0m0sm"
                                >
                                  Loading the Dataset
                                </p></a
                              ><a
                                href="#the-model"
                                style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"
                                ><p
                                  class="MuiTypography-root MuiTypography-p css-1i0m0sm"
                                >
                                  The Model
                                </p></a
                              ><a
                                href="#training"
                                style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"
                                ><p
                                  class="MuiTypography-root MuiTypography-p css-1i0m0sm"
                                >
                                  Training
                                </p></a
                              ><a
                                href="#testing"
                                style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"
                                ><p
                                  class="MuiTypography-root MuiTypography-p css-1i0m0sm"
                                >
                                  Testing
                                </p></a
                              ><a
                                href="#testing-on-mnist-test-data"
                                style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"
                                ><style data-emotion="css ype23k">
                                  .css-ype23k {
                                    margin: 0;
                                    margin-left: 16px;
                                    margin-bottom: 12px;
                                  }
                                  .css-ype23k:hover {
                                    color: blue;
                                  }
                                </style>
                                <p
                                  class="MuiTypography-root MuiTypography-p css-ype23k"
                                >
                                  Testing on MNIST Test Data
                                </p></a
                              ><a
                                href="#testing-on-custom-images"
                                style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"
                                ><p
                                  class="MuiTypography-root MuiTypography-p css-ype23k"
                                >
                                  Testing on Custom Images
                                </p></a
                              ><a
                                href="#conversion-to-onnx"
                                style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"
                                ><p
                                  class="MuiTypography-root MuiTypography-p css-1i0m0sm"
                                >
                                  Conversion to ONNX
                                </p></a
                              ><a
                                href="#conclusion"
                                style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"
                                ><p
                                  class="MuiTypography-root MuiTypography-p css-vmnodn"
                                >
                                  Conclusion
                                </p></a
                              >
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <style data-emotion="css 8e7o3j">
                  .css-8e7o3j {
                    width: 100%;
                  }
                  @media (min-width: 0px) {
                    .css-8e7o3j {
                      display: none;
                    }
                  }
                  @media (min-width: 900px) {
                    .css-8e7o3j {
                      display: block;
                    }
                  }
                </style>
                <div class="MuiBox-root css-8e7o3j">
                  <style data-emotion="css 1npmiby">
                    .css-1npmiby {
                      margin: 0;
                      font-family: "Roboto", "Helvetica", "Arial", sans-serif;
                      font-weight: 400;
                      font-size: 1.5rem;
                      line-height: 1.334;
                      letter-spacing: 0em;
                      margin: 0px;
                      padding: 0px;
                    }
                  </style>
                  <h5 class="MuiTypography-root MuiTypography-h5 css-1npmiby">
                    Table of Contents
                  </h5>
                  <a
                    href="#the-code"
                    style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"
                    ><p class="MuiTypography-root MuiTypography-p css-vmnodn">
                      The Code
                    </p></a
                  ><a
                    href="#configuration"
                    style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"
                    ><p class="MuiTypography-root MuiTypography-p css-1i0m0sm">
                      Configuration
                    </p></a
                  ><a
                    href="#loading-the-dataset"
                    style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"
                    ><p class="MuiTypography-root MuiTypography-p css-1i0m0sm">
                      Loading the Dataset
                    </p></a
                  ><a
                    href="#the-model"
                    style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"
                    ><p class="MuiTypography-root MuiTypography-p css-1i0m0sm">
                      The Model
                    </p></a
                  ><a
                    href="#training"
                    style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"
                    ><p class="MuiTypography-root MuiTypography-p css-1i0m0sm">
                      Training
                    </p></a
                  ><a
                    href="#testing"
                    style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"
                    ><p class="MuiTypography-root MuiTypography-p css-1i0m0sm">
                      Testing
                    </p></a
                  ><a
                    href="#testing-on-mnist-test-data"
                    style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"
                    ><p class="MuiTypography-root MuiTypography-p css-ype23k">
                      Testing on MNIST Test Data
                    </p></a
                  ><a
                    href="#testing-on-custom-images"
                    style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"
                    ><p class="MuiTypography-root MuiTypography-p css-ype23k">
                      Testing on Custom Images
                    </p></a
                  ><a
                    href="#conversion-to-onnx"
                    style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"
                    ><p class="MuiTypography-root MuiTypography-p css-1i0m0sm">
                      Conversion to ONNX
                    </p></a
                  ><a
                    href="#conclusion"
                    style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"
                    ><p class="MuiTypography-root MuiTypography-p css-vmnodn">
                      Conclusion
                    </p></a
                  >
                </div>
              </div>
            </div>
            <style data-emotion="css 4uwbp1">
              .css-4uwbp1 {
                box-sizing: border-box;
                margin: 0;
                -webkit-flex-direction: row;
                -ms-flex-direction: row;
                flex-direction: row;
                -webkit-flex-basis: 100%;
                -ms-flex-preferred-size: 100%;
                flex-basis: 100%;
                -webkit-box-flex: 0;
                -webkit-flex-grow: 0;
                -ms-flex-positive: 0;
                flex-grow: 0;
                max-width: 100%;
                background: linear-gradient(to right, #ffffff, #eeeeee);
                border-radius: 20px;
              }
              @media (min-width: 600px) {
                .css-4uwbp1 {
                  -webkit-flex-basis: 100%;
                  -ms-flex-preferred-size: 100%;
                  flex-basis: 100%;
                  -webkit-box-flex: 0;
                  -webkit-flex-grow: 0;
                  -ms-flex-positive: 0;
                  flex-grow: 0;
                  max-width: 100%;
                }
              }
              @media (min-width: 900px) {
                .css-4uwbp1 {
                  -webkit-flex-basis: 66.666667%;
                  -ms-flex-preferred-size: 66.666667%;
                  flex-basis: 66.666667%;
                  -webkit-box-flex: 0;
                  -webkit-flex-grow: 0;
                  -ms-flex-positive: 0;
                  flex-grow: 0;
                  max-width: 66.666667%;
                }
              }
              @media (min-width: 1200px) {
                .css-4uwbp1 {
                  -webkit-flex-basis: 75%;
                  -ms-flex-preferred-size: 75%;
                  flex-basis: 75%;
                  -webkit-box-flex: 0;
                  -webkit-flex-grow: 0;
                  -ms-flex-positive: 0;
                  flex-grow: 0;
                  max-width: 75%;
                }
              }
              @media (min-width: 1536px) {
                .css-4uwbp1 {
                  -webkit-flex-basis: 75%;
                  -ms-flex-preferred-size: 75%;
                  flex-basis: 75%;
                  -webkit-box-flex: 0;
                  -webkit-flex-grow: 0;
                  -ms-flex-positive: 0;
                  flex-grow: 0;
                  max-width: 75%;
                }
              }
            </style>
            <div
              class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-12 MuiGrid-grid-sm-12 MuiGrid-grid-md-8 MuiGrid-grid-lg-9 css-4uwbp1"
            >
              <style data-emotion="css 1zo2vp">
                .css-1zo2vp {
                  -webkit-flex: 1;
                  -ms-flex: 1;
                  flex: 1;
                  margin-right: 16px;
                }
              </style>
              <div class="MuiBox-root css-1zo2vp">
                <style data-emotion="css vsuld9">
                  .css-vsuld9 {
                    margin: 0;
                    text-align: justify;
                    margin-bottom: 16px;
                  }
                </style>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  In this article, we&#x27;ll create a very basic CNN using
                  PyTorch that will serve as a baseline for the various
                  deployment methods we&#x27;ll be going over in future Blog
                  Posts. Today, we&#x27;ll make a CNN (Convolutional Neural
                  Network) that can recognize handwritten digits (0 to 9)
                  trained using the
                  <style data-emotion="css ct9vl7">
                    .css-ct9vl7 {
                      -webkit-text-decoration: none;
                      text-decoration: none;
                    }
                    .css-ct9vl7:hover {
                      -webkit-text-decoration: underline;
                      text-decoration: underline;
                    }</style
                  ><style data-emotion="css 1vxruma">
                    .css-1vxruma {
                      margin: 0;
                      font: inherit;
                      color: #1976d2;
                      -webkit-text-decoration: none;
                      text-decoration: none;
                    }
                    .css-1vxruma:hover {
                      -webkit-text-decoration: underline;
                      text-decoration: underline;
                    }</style
                  ><a
                    class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover css-1vxruma"
                    href="https://en.wikipedia.org/wiki/MNIST_database"
                    rel="noopener noreferrer"
                    target="_blank"
                    >MNIST dataset</a
                  >. We&#x27;ll also export our model to
                  <a
                    class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover css-1vxruma"
                    href="https://onnx.ai/"
                    rel="noopener noreferrer"
                    target="_blank"
                    >ONNX</a
                  >, this way it can be used with any language that has an
                  <a
                    class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover css-1vxruma"
                    href="https://onnxruntime.ai/"
                    rel="noopener noreferrer"
                    target="_blank"
                    >ONNX Runtime</a
                  >
                  available for it (for example JavaScript).
                </p>
                <style data-emotion="css rg843f">
                  .css-rg843f {
                    margin: 0;
                    font-family: "Roboto", "Helvetica", "Arial", sans-serif;
                    font-weight: 400;
                    font-size: 2.125rem;
                    line-height: 1.235;
                    letter-spacing: 0.00735em;
                    margin-bottom: 16px;
                  }
                </style>
                <h1
                  class="MuiTypography-root MuiTypography-h4 css-rg843f"
                  id="the-code"
                >
                  <strong>The Code</strong>
                </h1>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  Here&#x27;s the directory structure of the codebase we&#x27;ll
                  be creating.
                </p>
                <style data-emotion="css dzaqf9">
                  .css-dzaqf9 {
                    width: 100%;
                    margin-bottom: 16px;
                  }
                </style>
                <div class="MuiBox-root css-dzaqf9">
                  <style data-emotion="css 125pbeb">
                    .css-125pbeb {
                      background-color: rgb(227, 234, 242);
                      width: 100%;
                      display: -webkit-box;
                      display: -webkit-flex;
                      display: -ms-flexbox;
                      display: flex;
                      -webkit-flex-direction: row;
                      -ms-flex-direction: row;
                      flex-direction: row;
                      -webkit-box-pack: end;
                      -ms-flex-pack: end;
                      -webkit-justify-content: flex-end;
                      justify-content: flex-end;
                      -webkit-align-items: center;
                      -webkit-box-align: center;
                      -ms-flex-align: center;
                      align-items: center;
                    }
                  </style>
                  <div class="MuiBox-root css-125pbeb">
                    <style data-emotion="css 1xdvxj1">
                      .css-1xdvxj1 {
                        text-align: center;
                        -webkit-flex: 0 0 auto;
                        -ms-flex: 0 0 auto;
                        flex: 0 0 auto;
                        font-size: 1.5rem;
                        padding: 8px;
                        border-radius: 50%;
                        overflow: visible;
                        color: rgba(0, 0, 0, 0.54);
                        -webkit-transition: background-color 150ms
                          cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                        transition: background-color 150ms
                          cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                        color: #1976d2;
                        padding: 12px;
                        font-size: 1.75rem;
                      }
                      .css-1xdvxj1:hover {
                        background-color: rgba(0, 0, 0, 0.04);
                      }
                      @media (hover: none) {
                        .css-1xdvxj1:hover {
                          background-color: transparent;
                        }
                      }
                      .css-1xdvxj1:hover {
                        background-color: rgba(25, 118, 210, 0.04);
                      }
                      @media (hover: none) {
                        .css-1xdvxj1:hover {
                          background-color: transparent;
                        }
                      }
                      .css-1xdvxj1.Mui-disabled {
                        background-color: transparent;
                        color: rgba(0, 0, 0, 0.26);
                      }</style
                    ><style data-emotion="css h1oho">
                      .css-h1oho {
                        display: -webkit-inline-box;
                        display: -webkit-inline-flex;
                        display: -ms-inline-flexbox;
                        display: inline-flex;
                        -webkit-align-items: center;
                        -webkit-box-align: center;
                        -ms-flex-align: center;
                        align-items: center;
                        -webkit-box-pack: center;
                        -ms-flex-pack: center;
                        -webkit-justify-content: center;
                        justify-content: center;
                        position: relative;
                        box-sizing: border-box;
                        -webkit-tap-highlight-color: transparent;
                        background-color: transparent;
                        outline: 0;
                        border: 0;
                        margin: 0;
                        border-radius: 0;
                        padding: 0;
                        cursor: pointer;
                        -webkit-user-select: none;
                        -moz-user-select: none;
                        -ms-user-select: none;
                        user-select: none;
                        vertical-align: middle;
                        -moz-appearance: none;
                        -webkit-appearance: none;
                        -webkit-text-decoration: none;
                        text-decoration: none;
                        color: inherit;
                        text-align: center;
                        -webkit-flex: 0 0 auto;
                        -ms-flex: 0 0 auto;
                        flex: 0 0 auto;
                        font-size: 1.5rem;
                        padding: 8px;
                        border-radius: 50%;
                        overflow: visible;
                        color: rgba(0, 0, 0, 0.54);
                        -webkit-transition: background-color 150ms
                          cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                        transition: background-color 150ms
                          cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                        color: #1976d2;
                        padding: 12px;
                        font-size: 1.75rem;
                      }
                      .css-h1oho::-moz-focus-inner {
                        border-style: none;
                      }
                      .css-h1oho.Mui-disabled {
                        pointer-events: none;
                        cursor: default;
                      }
                      @media print {
                        .css-h1oho {
                          -webkit-print-color-adjust: exact;
                          color-adjust: exact;
                        }
                      }
                      .css-h1oho:hover {
                        background-color: rgba(0, 0, 0, 0.04);
                      }
                      @media (hover: none) {
                        .css-h1oho:hover {
                          background-color: transparent;
                        }
                      }
                      .css-h1oho:hover {
                        background-color: rgba(25, 118, 210, 0.04);
                      }
                      @media (hover: none) {
                        .css-h1oho:hover {
                          background-color: transparent;
                        }
                      }
                      .css-h1oho.Mui-disabled {
                        background-color: transparent;
                        color: rgba(0, 0, 0, 0.26);
                      }</style
                    ><button
                      class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho"
                      tabindex="0"
                      type="button"
                    >
                      <svg
                        class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                        focusable="false"
                        aria-hidden="true"
                        viewBox="0 0 24 24"
                        data-testid="ContentCopyIcon"
                      >
                        <path
                          d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"
                        ></path>
                      </svg>
                    </button>
                  </div>
                  <pre
                    style="
                      color: #111b27;
                      background: #e3eaf2;
                      font-family: Consolas, Monaco, &quot;Andale Mono&quot;,
                        &quot;Ubuntu Mono&quot;, monospace;
                      text-align: left;
                      white-space: pre;
                      word-spacing: normal;
                      word-break: normal;
                      word-wrap: normal;
                      line-height: 1.5;
                      -moz-tab-size: 4;
                      -o-tab-size: 4;
                      tab-size: 4;
                      -webkit-hyphens: none;
                      -moz-hyphens: none;
                      -ms-hyphens: none;
                      hyphens: none;
                      padding: 1em;
                      margin: 0;
                      overflow: auto;
                    "
                  ><code class="language-bash" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>   config.yaml
</span>   requirements.txt
<!-- -->
<!-- -->data
<!-- -->models
<!-- -->src
<!-- -->       config.py
<!-- -->       dataset.py
<!-- -->       model.py
<!-- -->       test.py
<!-- -->       train.py
<!-- -->    
<!-- -->    converters
<!-- -->            converter_onnx.py</code></pre>
                </div>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  We have the
                  <style data-emotion="css 87x4qo">
                    .css-87x4qo {
                      padding-left: 4px;
                      padding-right: 4px;
                      border-radius: 4px;
                      background-color: rgb(227, 234, 242);
                    }</style
                  ><span class="MuiBox-root css-87x4qo">config</span> and
                  <span class="MuiBox-root css-87x4qo">requirements</span> files
                  that define our training and testing configuration and the
                  project&#x27;s required packages respectively.
                </p>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  The <span class="MuiBox-root css-87x4qo">data</span> directory
                  will be used to store the dataset that PyTorch will download
                  for us and we&#x27;ll store our model weights in the
                  <span class="MuiBox-root css-87x4qo">models</span> directory.
                  The <span class="MuiBox-root css-87x4qo">src</span> directory
                  contains our codebase.
                </p>
                <style data-emotion="css 1oj41as">
                  .css-1oj41as {
                    margin: 0;
                    font-family: "Roboto", "Helvetica", "Arial", sans-serif;
                    font-weight: 400;
                    font-size: 1.5rem;
                    line-height: 1.334;
                    letter-spacing: 0em;
                    margin-bottom: 16px;
                  }
                </style>
                <h2
                  class="MuiTypography-root MuiTypography-h5 css-1oj41as"
                  id="configuration"
                >
                  <strong>Configuration</strong>
                </h2>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  Let&#x27;s create the
                  <span class="MuiBox-root css-87x4qo">config.yaml</span> file
                  to define the training and testing config.
                </p>
                <div class="MuiBox-root css-dzaqf9">
                  <div class="MuiBox-root css-125pbeb">
                    <button
                      class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho"
                      tabindex="0"
                      type="button"
                    >
                      <svg
                        class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                        focusable="false"
                        aria-hidden="true"
                        viewBox="0 0 24 24"
                        data-testid="ContentCopyIcon"
                      >
                        <path
                          d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"
                        ></path>
                      </svg>
                    </button>
                  </div>
                  <pre
                    style="
                      color: #111b27;
                      background: #e3eaf2;
                      font-family: Consolas, Monaco, &quot;Andale Mono&quot;,
                        &quot;Ubuntu Mono&quot;, monospace;
                      text-align: left;
                      white-space: pre;
                      word-spacing: normal;
                      word-break: normal;
                      word-wrap: normal;
                      line-height: 1.5;
                      -moz-tab-size: 4;
                      -o-tab-size: 4;
                      tab-size: 4;
                      -webkit-hyphens: none;
                      -moz-hyphens: none;
                      -ms-hyphens: none;
                      hyphens: none;
                      padding: 1em;
                      margin: 0;
                      overflow: auto;
                    "
                  ><code class="language-yaml" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#005a8e">training_num_epochs</span><span class="token" style="color:#111b27">:</span><span> </span><span class="token" style="color:#755f00">10</span><span>
</span><span></span><span class="token" style="color:#005a8e">training_save_weights_epoch_interval</span><span class="token" style="color:#111b27">:</span><span> </span><span class="token" style="color:#755f00">1</span><span>
</span><span></span><span class="token" style="color:#005a8e">training_batch_size</span><span class="token" style="color:#111b27">:</span><span> </span><span class="token" style="color:#755f00">100</span><span>
</span><span></span><span class="token" style="color:#005a8e">learning_rate</span><span class="token" style="color:#111b27">:</span><span> </span><span class="token" style="color:#755f00">0.001</span><span>
</span><span></span><span class="token" style="color:#005a8e">testing_batch_size</span><span class="token" style="color:#111b27">:</span><span> </span><span class="token" style="color:#755f00">100</span><span>
</span><span></span><span class="token" style="color:#005a8e">log_batch_interval</span><span class="token" style="color:#111b27">:</span><span> </span><span class="token" style="color:#755f00">100</span></code></pre>
                </div>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  Next, we create the
                  <span class="MuiBox-root css-87x4qo">src/config.py</span> file
                  that loads this configuration into Python and also defines
                  some directory paths for our convenience.
                </p>
                <div class="MuiBox-root css-dzaqf9">
                  <div class="MuiBox-root css-125pbeb">
                    <button
                      class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho"
                      tabindex="0"
                      type="button"
                    >
                      <svg
                        class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                        focusable="false"
                        aria-hidden="true"
                        viewBox="0 0 24 24"
                        data-testid="ContentCopyIcon"
                      >
                        <path
                          d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"
                        ></path>
                      </svg>
                    </button>
                  </div>
                  <pre
                    style="
                      color: #111b27;
                      background: #e3eaf2;
                      font-family: Consolas, Monaco, &quot;Andale Mono&quot;,
                        &quot;Ubuntu Mono&quot;, monospace;
                      text-align: left;
                      white-space: pre;
                      word-spacing: normal;
                      word-break: normal;
                      word-wrap: normal;
                      line-height: 1.5;
                      -moz-tab-size: 4;
                      -o-tab-size: 4;
                      tab-size: 4;
                      -webkit-hyphens: none;
                      -moz-hyphens: none;
                      -ms-hyphens: none;
                      hyphens: none;
                      padding: 1em;
                      margin: 0;
                      overflow: auto;
                    "
                  ><code class="language-python" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#a04900">from</span><span> os</span><span class="token" style="color:#111b27">.</span><span>path </span><span class="token" style="color:#a04900">import</span><span> dirname</span><span class="token" style="color:#111b27">,</span><span> join </span><span class="token" style="color:#a04900">as</span><span> path_join
</span><span></span><span class="token" style="color:#a04900">from</span><span> yaml </span><span class="token" style="color:#a04900">import</span><span> FullLoader </span><span class="token" style="color:#a04900">as</span><span> yaml_FullLoader</span><span class="token" style="color:#111b27">,</span><span> load </span><span class="token" style="color:#a04900">as</span><span> yaml_load
</span>
<!-- -->
<span>config_file_path </span><span class="token" style="color:#a04900">=</span><span> path_join</span><span class="token" style="color:#111b27">(</span><span>dirname</span><span class="token" style="color:#111b27">(</span><span>dirname</span><span class="token" style="color:#111b27">(</span><span>__file__</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;config.yaml&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span><span></span><span class="token" style="color:#a04900">with</span><span> </span><span class="token" style="color:#af00af">open</span><span class="token" style="color:#111b27">(</span><span>config_file_path</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;r&quot;</span><span class="token" style="color:#111b27">)</span><span> </span><span class="token" style="color:#a04900">as</span><span> model_params_file</span><span class="token" style="color:#111b27">:</span><span>
</span><span>    config </span><span class="token" style="color:#a04900">=</span><span> yaml_load</span><span class="token" style="color:#111b27">(</span><span>model_params_file</span><span class="token" style="color:#111b27">,</span><span> Loader</span><span class="token" style="color:#a04900">=</span><span>yaml_FullLoader</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>models_dir </span><span class="token" style="color:#a04900">=</span><span> path_join</span><span class="token" style="color:#111b27">(</span><span>dirname</span><span class="token" style="color:#111b27">(</span><span>dirname</span><span class="token" style="color:#111b27">(</span><span>__file__</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;models&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span><span>data_dir </span><span class="token" style="color:#a04900">=</span><span> path_join</span><span class="token" style="color:#111b27">(</span><span>dirname</span><span class="token" style="color:#111b27">(</span><span>dirname</span><span class="token" style="color:#111b27">(</span><span>__file__</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;data&quot;</span><span class="token" style="color:#111b27">)</span></code></pre>
                </div>
                <h2
                  class="MuiTypography-root MuiTypography-h5 css-1oj41as"
                  id="loading-the-dataset"
                >
                  <strong>Loading the Dataset</strong>
                </h2>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  Inside the
                  <span class="MuiBox-root css-87x4qo">src</span> folder, create
                  a file called
                  <span class="MuiBox-root css-87x4qo">dataset.py</span>, in
                  which we will define our data loaders.
                </p>
                <div class="MuiBox-root css-dzaqf9">
                  <div class="MuiBox-root css-125pbeb">
                    <button
                      class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho"
                      tabindex="0"
                      type="button"
                    >
                      <svg
                        class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                        focusable="false"
                        aria-hidden="true"
                        viewBox="0 0 24 24"
                        data-testid="ContentCopyIcon"
                      >
                        <path
                          d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"
                        ></path>
                      </svg>
                    </button>
                  </div>
                  <pre
                    style="
                      color: #111b27;
                      background: #e3eaf2;
                      font-family: Consolas, Monaco, &quot;Andale Mono&quot;,
                        &quot;Ubuntu Mono&quot;, monospace;
                      text-align: left;
                      white-space: pre;
                      word-spacing: normal;
                      word-break: normal;
                      word-wrap: normal;
                      line-height: 1.5;
                      -moz-tab-size: 4;
                      -o-tab-size: 4;
                      tab-size: 4;
                      -webkit-hyphens: none;
                      -moz-hyphens: none;
                      -ms-hyphens: none;
                      hyphens: none;
                      padding: 1em;
                      margin: 0;
                      overflow: auto;
                    "
                  ><code class="language-python" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#a04900">from</span><span> torch</span><span class="token" style="color:#111b27">.</span><span>utils</span><span class="token" style="color:#111b27">.</span><span>data </span><span class="token" style="color:#a04900">import</span><span> DataLoader
</span><span></span><span class="token" style="color:#a04900">from</span><span> torchvision</span><span class="token" style="color:#111b27">.</span><span>datasets </span><span class="token" style="color:#a04900">import</span><span> MNIST
</span><span></span><span class="token" style="color:#a04900">from</span><span> torchvision</span><span class="token" style="color:#111b27">.</span><span>transforms </span><span class="token" style="color:#a04900">import</span><span> ToTensor
</span>
<span></span><span class="token" style="color:#a04900">from</span><span> config </span><span class="token" style="color:#a04900">import</span><span> config
</span>
<!-- -->
<span>train_data </span><span class="token" style="color:#a04900">=</span><span> MNIST</span><span class="token" style="color:#111b27">(</span><span>
</span><span>    root</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#116b00">&quot;data&quot;</span><span class="token" style="color:#111b27">,</span><span>
</span><span>    train</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">True</span><span class="token" style="color:#111b27">,</span><span>
</span><span>    transform</span><span class="token" style="color:#a04900">=</span><span>ToTensor</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span>
</span><span>    download</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">True</span><span>
</span><span></span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>test_data </span><span class="token" style="color:#a04900">=</span><span> MNIST</span><span class="token" style="color:#111b27">(</span><span>
</span><span>    root</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#116b00">&quot;data&quot;</span><span class="token" style="color:#111b27">,</span><span>
</span><span>    train</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">False</span><span class="token" style="color:#111b27">,</span><span>
</span><span>    transform</span><span class="token" style="color:#a04900">=</span><span>ToTensor</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span>
</span><span>    download</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">True</span><span>
</span><span></span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>data_loaders </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token" style="color:#111b27">{</span><span>
</span><span>    </span><span class="token" style="color:#116b00">&quot;train&quot;</span><span class="token" style="color:#111b27">:</span><span> DataLoader</span><span class="token" style="color:#111b27">(</span><span>
</span><span>        train_data</span><span class="token" style="color:#111b27">,</span><span>
</span><span>        batch_size</span><span class="token" style="color:#a04900">=</span><span>config</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#116b00">&#x27;training_batch_size&#x27;</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">,</span><span>
</span><span>        shuffle</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">True</span><span class="token" style="color:#111b27">,</span><span>
</span><span>        num_workers</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">1</span><span>
</span><span>    </span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span>
</span><span>    </span><span class="token" style="color:#116b00">&quot;test&quot;</span><span class="token" style="color:#111b27">:</span><span> DataLoader</span><span class="token" style="color:#111b27">(</span><span>
</span><span>        test_data</span><span class="token" style="color:#111b27">,</span><span>
</span><span>        batch_size</span><span class="token" style="color:#a04900">=</span><span>config</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#116b00">&#x27;testing_batch_size&#x27;</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">,</span><span>
</span><span>        shuffle</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">True</span><span class="token" style="color:#111b27">,</span><span>
</span><span>        num_workers</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">1</span><span>
</span><span>    </span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span>
</span><span></span><span class="token" style="color:#111b27">}</span></code></pre>
                </div>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  The
                  <span class="MuiBox-root css-87x4qo">torchvision</span>
                  package allows us easy access to the MNIST dataset using
                  <span class="MuiBox-root css-87x4qo"
                    >torchvision.datasets.MNIST</span
                  >. We first load the training and testing data, which is
                  determined by the
                  <span class="MuiBox-root css-87x4qo">train</span> parameter
                  passed to the
                  <span class="MuiBox-root css-87x4qo">MNIST</span> constructor.
                  We also call the
                  <span class="MuiBox-root css-87x4qo">ToTensor</span> transform
                  on this data.
                </p>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  Then, we define our data loaders which are instances of
                  <span class="MuiBox-root css-87x4qo"
                    >torch.utils.data.DataLoader</span
                  >: one for training and another for testing. Note how the
                  training and testing batch sizes are being loaded from the
                  config.
                </p>
                <h2
                  class="MuiTypography-root MuiTypography-h5 css-1oj41as"
                  id="the-model"
                >
                  <strong>The Model</strong>
                </h2>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  Next up, let&#x27;s create the architecture of our CNN. In the
                  <span class="MuiBox-root css-87x4qo">src</span> folder, create
                  a new file called
                  <span class="MuiBox-root css-87x4qo">model.py</span>.
                </p>
                <div class="MuiBox-root css-dzaqf9">
                  <div class="MuiBox-root css-125pbeb">
                    <button
                      class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho"
                      tabindex="0"
                      type="button"
                    >
                      <svg
                        class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                        focusable="false"
                        aria-hidden="true"
                        viewBox="0 0 24 24"
                        data-testid="ContentCopyIcon"
                      >
                        <path
                          d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"
                        ></path>
                      </svg>
                    </button>
                  </div>
                  <pre
                    style="
                      color: #111b27;
                      background: #e3eaf2;
                      font-family: Consolas, Monaco, &quot;Andale Mono&quot;,
                        &quot;Ubuntu Mono&quot;, monospace;
                      text-align: left;
                      white-space: pre;
                      word-spacing: normal;
                      word-break: normal;
                      word-wrap: normal;
                      line-height: 1.5;
                      -moz-tab-size: 4;
                      -o-tab-size: 4;
                      tab-size: 4;
                      -webkit-hyphens: none;
                      -moz-hyphens: none;
                      -ms-hyphens: none;
                      hyphens: none;
                      padding: 1em;
                      margin: 0;
                      overflow: auto;
                    "
                  ><code class="language-python" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#a04900">import</span><span> torch
</span><span></span><span class="token" style="color:#a04900">import</span><span> torch</span><span class="token" style="color:#111b27">.</span><span>nn </span><span class="token" style="color:#a04900">as</span><span> nn
</span><span></span><span class="token" style="color:#a04900">import</span><span> torch</span><span class="token" style="color:#111b27">.</span><span>optim </span><span class="token" style="color:#a04900">as</span><span> optim
</span>
<!-- -->
<span></span><span class="token" style="color:#a04900">class</span><span> </span><span class="token" style="color:#005a8e">CNN</span><span class="token" style="color:#111b27">(</span><span>nn</span><span class="token" style="color:#111b27">.</span><span>Module</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>    </span><span class="token" style="color:#a04900">def</span><span> </span><span class="token" style="color:#7c00aa">__init__</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>        </span><span class="token" style="color:#af00af">super</span><span class="token" style="color:#111b27">(</span><span>CNN</span><span class="token" style="color:#111b27">,</span><span> self</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">.</span><span>__init__</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        self</span><span class="token" style="color:#111b27">.</span><span>conv1 </span><span class="token" style="color:#a04900">=</span><span> nn</span><span class="token" style="color:#111b27">.</span><span>Conv2d</span><span class="token" style="color:#111b27">(</span><span>in_channels</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">1</span><span class="token" style="color:#111b27">,</span><span> out_channels</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">10</span><span class="token" style="color:#111b27">,</span><span> kernel_size</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">5</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        self</span><span class="token" style="color:#111b27">.</span><span>pool </span><span class="token" style="color:#a04900">=</span><span> nn</span><span class="token" style="color:#111b27">.</span><span>MaxPool2d</span><span class="token" style="color:#111b27">(</span><span>kernel_size</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">2</span><span class="token" style="color:#111b27">,</span><span> stride</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">2</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        self</span><span class="token" style="color:#111b27">.</span><span>conv2 </span><span class="token" style="color:#a04900">=</span><span> nn</span><span class="token" style="color:#111b27">.</span><span>Conv2d</span><span class="token" style="color:#111b27">(</span><span>in_channels</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">10</span><span class="token" style="color:#111b27">,</span><span> out_channels</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">20</span><span class="token" style="color:#111b27">,</span><span> kernel_size</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">5</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        self</span><span class="token" style="color:#111b27">.</span><span>dropout </span><span class="token" style="color:#a04900">=</span><span> nn</span><span class="token" style="color:#111b27">.</span><span>Dropout</span><span class="token" style="color:#111b27">(</span><span>p</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">0.5</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        self</span><span class="token" style="color:#111b27">.</span><span>fc1 </span><span class="token" style="color:#a04900">=</span><span> nn</span><span class="token" style="color:#111b27">.</span><span>Linear</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#755f00">20</span><span> </span><span class="token" style="color:#a04900">*</span><span> </span><span class="token" style="color:#755f00">4</span><span> </span><span class="token" style="color:#a04900">*</span><span> </span><span class="token" style="color:#755f00">4</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">50</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        self</span><span class="token" style="color:#111b27">.</span><span>fc2 </span><span class="token" style="color:#a04900">=</span><span> nn</span><span class="token" style="color:#111b27">.</span><span>Linear</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#755f00">50</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">10</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    </span><span class="token" style="color:#a04900">def</span><span> </span><span class="token" style="color:#7c00aa">forward</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">,</span><span> x</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>        x </span><span class="token" style="color:#a04900">=</span><span> self</span><span class="token" style="color:#111b27">.</span><span>pool</span><span class="token" style="color:#111b27">(</span><span>torch</span><span class="token" style="color:#111b27">.</span><span>relu</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">.</span><span>conv1</span><span class="token" style="color:#111b27">(</span><span>x</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        x </span><span class="token" style="color:#a04900">=</span><span> self</span><span class="token" style="color:#111b27">.</span><span>pool</span><span class="token" style="color:#111b27">(</span><span>torch</span><span class="token" style="color:#111b27">.</span><span>relu</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">.</span><span>conv2</span><span class="token" style="color:#111b27">(</span><span>x</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        x </span><span class="token" style="color:#a04900">=</span><span> self</span><span class="token" style="color:#111b27">.</span><span>dropout</span><span class="token" style="color:#111b27">(</span><span>x</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        x </span><span class="token" style="color:#a04900">=</span><span> x</span><span class="token" style="color:#111b27">.</span><span>view</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#a04900">-</span><span class="token" style="color:#755f00">1</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">20</span><span> </span><span class="token" style="color:#a04900">*</span><span> </span><span class="token" style="color:#755f00">4</span><span> </span><span class="token" style="color:#a04900">*</span><span> </span><span class="token" style="color:#755f00">4</span><span class="token" style="color:#111b27">)</span><span>  </span><span class="token" style="color:#3c526d"># Flatten the tensor</span><span>
</span><span>        x </span><span class="token" style="color:#a04900">=</span><span> torch</span><span class="token" style="color:#111b27">.</span><span>relu</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">.</span><span>fc1</span><span class="token" style="color:#111b27">(</span><span>x</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        x </span><span class="token" style="color:#a04900">=</span><span> self</span><span class="token" style="color:#111b27">.</span><span>dropout</span><span class="token" style="color:#111b27">(</span><span>x</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        x </span><span class="token" style="color:#a04900">=</span><span> self</span><span class="token" style="color:#111b27">.</span><span>fc2</span><span class="token" style="color:#111b27">(</span><span>x</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        </span><span class="token" style="color:#a04900">return</span><span> torch</span><span class="token" style="color:#111b27">.</span><span>softmax</span><span class="token" style="color:#111b27">(</span><span>x</span><span class="token" style="color:#111b27">,</span><span> dim</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">1</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span></span><span class="token" style="color:#3c526d"># Create an instance of the CNN model</span><span>
</span><span>model </span><span class="token" style="color:#a04900">=</span><span> CNN</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span></span><span class="token" style="color:#3c526d"># Define loss function and optimizer</span><span>
</span><span>criterion </span><span class="token" style="color:#a04900">=</span><span> nn</span><span class="token" style="color:#111b27">.</span><span>CrossEntropyLoss</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span><span>optimizer </span><span class="token" style="color:#a04900">=</span><span> optim</span><span class="token" style="color:#111b27">.</span><span>Adam</span><span class="token" style="color:#111b27">(</span><span>model</span><span class="token" style="color:#111b27">.</span><span>parameters</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span> lr</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">0.001</span><span class="token" style="color:#111b27">)</span></code></pre>
                </div>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  We create a simple CNN with two convolution, one max pooling,
                  one dropout, and two fully-connected layers. We use
                  <a
                    class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover css-1vxruma"
                    href="https://pytorch.org/docs/stable/generated/torch.nn.CrossEntropyLoss.html"
                    rel="noopener noreferrer"
                    target="_blank"
                    >Cross Entropy</a
                  >
                  as our loss function and the
                  <a
                    class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover css-1vxruma"
                    href="https://pytorch.org/docs/stable/generated/torch.optim.Adam.html"
                    rel="noopener noreferrer"
                    target="_blank"
                    >Adam Optimizer</a
                  >.
                </p>
                <h2
                  class="MuiTypography-root MuiTypography-h5 css-1oj41as"
                  id="training"
                >
                  <strong>Training</strong>
                </h2>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  In the same directory, create a file called
                  <span class="MuiBox-root css-87x4qo">train.py</span>. Calling
                  this file will train our model. Inside this file, we make the
                  required imports and then define a class called
                  <span class="MuiBox-root css-87x4qo">ModelTrainer</span>.
                </p>
                <div class="MuiBox-root css-dzaqf9">
                  <div class="MuiBox-root css-125pbeb">
                    <button
                      class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho"
                      tabindex="0"
                      type="button"
                    >
                      <svg
                        class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                        focusable="false"
                        aria-hidden="true"
                        viewBox="0 0 24 24"
                        data-testid="ContentCopyIcon"
                      >
                        <path
                          d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"
                        ></path>
                      </svg>
                    </button>
                  </div>
                  <pre
                    style="
                      color: #111b27;
                      background: #e3eaf2;
                      font-family: Consolas, Monaco, &quot;Andale Mono&quot;,
                        &quot;Ubuntu Mono&quot;, monospace;
                      text-align: left;
                      white-space: pre;
                      word-spacing: normal;
                      word-break: normal;
                      word-wrap: normal;
                      line-height: 1.5;
                      -moz-tab-size: 4;
                      -o-tab-size: 4;
                      tab-size: 4;
                      -webkit-hyphens: none;
                      -moz-hyphens: none;
                      -ms-hyphens: none;
                      hyphens: none;
                      padding: 1em;
                      margin: 0;
                      overflow: auto;
                    "
                  ><code class="language-python" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#a04900">from</span><span> datetime </span><span class="token" style="color:#a04900">import</span><span> datetime
</span><span></span><span class="token" style="color:#a04900">from</span><span> os </span><span class="token" style="color:#a04900">import</span><span> makedirs
</span><span></span><span class="token" style="color:#a04900">from</span><span> os</span><span class="token" style="color:#111b27">.</span><span>path </span><span class="token" style="color:#a04900">import</span><span> join
</span>
<span></span><span class="token" style="color:#a04900">import</span><span> torch
</span><span></span><span class="token" style="color:#a04900">import</span><span> torch</span><span class="token" style="color:#111b27">.</span><span>nn </span><span class="token" style="color:#a04900">as</span><span> nn
</span><span></span><span class="token" style="color:#a04900">import</span><span> torch</span><span class="token" style="color:#111b27">.</span><span>optim </span><span class="token" style="color:#a04900">as</span><span> optim
</span>
<span></span><span class="token" style="color:#a04900">from</span><span> </span><span class="token" style="color:#111b27">.</span><span>config </span><span class="token" style="color:#a04900">import</span><span> config</span><span class="token" style="color:#111b27">,</span><span> models_dir
</span><span></span><span class="token" style="color:#a04900">from</span><span> </span><span class="token" style="color:#111b27">.</span><span>dataset </span><span class="token" style="color:#a04900">import</span><span> data_loaders
</span><span></span><span class="token" style="color:#a04900">from</span><span> </span><span class="token" style="color:#111b27">.</span><span>model </span><span class="token" style="color:#a04900">import</span><span> CNN
</span>
<!-- -->
<span></span><span class="token" style="color:#a04900">class</span><span> </span><span class="token" style="color:#005a8e">ModelTrainer</span><span class="token" style="color:#111b27">:</span><span>
</span><span>    </span><span class="token" style="color:#a04900">def</span><span> </span><span class="token" style="color:#7c00aa">__init__</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>        self</span><span class="token" style="color:#111b27">.</span><span>training_id </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token" style="color:#116b00">&quot;torch---&quot;</span><span> </span><span class="token" style="color:#a04900">+</span><span> datetime</span><span class="token" style="color:#111b27">.</span><span>now</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">.</span><span>strftime</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;%Y-%m-%d-%H-%M-%S&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        self</span><span class="token" style="color:#111b27">.</span><span>device </span><span class="token" style="color:#a04900">=</span><span> torch</span><span class="token" style="color:#111b27">.</span><span>device</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;cuda&quot;</span><span> </span><span class="token" style="color:#a04900">if</span><span> torch</span><span class="token" style="color:#111b27">.</span><span>cuda</span><span class="token" style="color:#111b27">.</span><span>is_available</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span> </span><span class="token" style="color:#a04900">else</span><span> </span><span class="token" style="color:#116b00">&quot;cpu&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        self</span><span class="token" style="color:#111b27">.</span><span>model </span><span class="token" style="color:#a04900">=</span><span> CNN</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        self</span><span class="token" style="color:#111b27">.</span><span>model </span><span class="token" style="color:#a04900">=</span><span> self</span><span class="token" style="color:#111b27">.</span><span>model</span><span class="token" style="color:#111b27">.</span><span>to</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">.</span><span>device</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        self</span><span class="token" style="color:#111b27">.</span><span>optimizer </span><span class="token" style="color:#a04900">=</span><span> optim</span><span class="token" style="color:#111b27">.</span><span>Adam</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">.</span><span>model</span><span class="token" style="color:#111b27">.</span><span>parameters</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span> lr</span><span class="token" style="color:#a04900">=</span><span>config</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#116b00">&#x27;learning_rate&#x27;</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        self</span><span class="token" style="color:#111b27">.</span><span>loss_fn </span><span class="token" style="color:#a04900">=</span><span> nn</span><span class="token" style="color:#111b27">.</span><span>CrossEntropyLoss</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        self</span><span class="token" style="color:#111b27">.</span><span>models_dir </span><span class="token" style="color:#a04900">=</span><span> join</span><span class="token" style="color:#111b27">(</span><span>models_dir</span><span class="token" style="color:#111b27">,</span><span> self</span><span class="token" style="color:#111b27">.</span><span>training_id</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        makedirs</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">.</span><span>models_dir</span><span class="token" style="color:#111b27">,</span><span> exist_ok</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">False</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    </span><span class="token" style="color:#a04900">def</span><span> </span><span class="token" style="color:#7c00aa">save_weights</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">,</span><span> file_path</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>        torch</span><span class="token" style="color:#111b27">.</span><span>save</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">.</span><span>model</span><span class="token" style="color:#111b27">.</span><span>state_dict</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span> file_path</span><span class="token" style="color:#111b27">)</span></code></pre>
                </div>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  In the constructor, we generate a unique training id,
                  instantiate the model, the optimizer, and the loss function.
                  We move the model to our device (CPU/GPU) and make a new
                  directory in our models dir for the particular training id. We
                  also define a function
                  <span class="MuiBox-root css-87x4qo">save_weights</span> that
                  will save our model&#x27;s weights at the provided file path -
                  we&#x27;ll use this to save the model weights after every
                  training epoch.
                </p>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  Speaking of epochs, let&#x27;s create a function that can
                  train our model for one epoch.
                </p>
                <div class="MuiBox-root css-dzaqf9">
                  <div class="MuiBox-root css-125pbeb">
                    <button
                      class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho"
                      tabindex="0"
                      type="button"
                    >
                      <svg
                        class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                        focusable="false"
                        aria-hidden="true"
                        viewBox="0 0 24 24"
                        data-testid="ContentCopyIcon"
                      >
                        <path
                          d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"
                        ></path>
                      </svg>
                    </button>
                  </div>
                  <pre
                    style="
                      color: #111b27;
                      background: #e3eaf2;
                      font-family: Consolas, Monaco, &quot;Andale Mono&quot;,
                        &quot;Ubuntu Mono&quot;, monospace;
                      text-align: left;
                      white-space: pre;
                      word-spacing: normal;
                      word-break: normal;
                      word-wrap: normal;
                      line-height: 1.5;
                      -moz-tab-size: 4;
                      -o-tab-size: 4;
                      tab-size: 4;
                      -webkit-hyphens: none;
                      -moz-hyphens: none;
                      -ms-hyphens: none;
                      hyphens: none;
                      padding: 1em;
                      margin: 0;
                      overflow: auto;
                    "
                  ><code class="language-python" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#a04900">def</span><span> </span><span class="token" style="color:#7c00aa">train_single_epoch</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>    self</span><span class="token" style="color:#111b27">.</span><span>model</span><span class="token" style="color:#111b27">.</span><span>train</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    </span><span class="token" style="color:#a04900">for</span><span> batch_index</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#111b27">(</span><span>data</span><span class="token" style="color:#111b27">,</span><span> target</span><span class="token" style="color:#111b27">)</span><span> </span><span class="token" style="color:#a04900">in</span><span> </span><span class="token" style="color:#af00af">enumerate</span><span class="token" style="color:#111b27">(</span><span>data_loaders</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#116b00">&quot;train&quot;</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>        data </span><span class="token" style="color:#a04900">=</span><span> data</span><span class="token" style="color:#111b27">.</span><span>to</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">.</span><span>device</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        target </span><span class="token" style="color:#a04900">=</span><span> target</span><span class="token" style="color:#111b27">.</span><span>to</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">.</span><span>device</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        self</span><span class="token" style="color:#111b27">.</span><span>optimizer</span><span class="token" style="color:#111b27">.</span><span>zero_grad</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        output </span><span class="token" style="color:#a04900">=</span><span> self</span><span class="token" style="color:#111b27">.</span><span>model</span><span class="token" style="color:#111b27">(</span><span>data</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        loss </span><span class="token" style="color:#a04900">=</span><span> self</span><span class="token" style="color:#111b27">.</span><span>loss_fn</span><span class="token" style="color:#111b27">(</span><span>output</span><span class="token" style="color:#111b27">,</span><span> target</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        loss</span><span class="token" style="color:#111b27">.</span><span>backward</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        self</span><span class="token" style="color:#111b27">.</span><span>optimizer</span><span class="token" style="color:#111b27">.</span><span>step</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        </span><span class="token" style="color:#a04900">if</span><span> batch_index </span><span class="token" style="color:#a04900">%</span><span> config</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#116b00">&#x27;log_batch_interval&#x27;</span><span class="token" style="color:#111b27">]</span><span> </span><span class="token" style="color:#a04900">==</span><span> </span><span class="token" style="color:#755f00">0</span><span class="token" style="color:#111b27">:</span><span>
</span><span>            </span><span class="token" style="color:#a04900">print</span><span class="token" style="color:#111b27">(</span><span class="token string-interpolation" style="color:#116b00">f&quot;    </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">batch_index</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00"> / </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation" style="color:#af00af">len</span><span class="token string-interpolation interpolation" style="color:#111b27">(</span><span class="token string-interpolation interpolation">data_loaders</span><span class="token string-interpolation interpolation" style="color:#111b27">[</span><span class="token string-interpolation interpolation" style="color:#116b00">&#x27;train&#x27;</span><span class="token string-interpolation interpolation" style="color:#111b27">]</span><span class="token string-interpolation interpolation" style="color:#111b27">)</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">&quot;</span><span class="token" style="color:#111b27">)</span></code></pre>
                </div>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  This is the standard training strategy. The last couple of
                  lines are just for logging the training progress at the
                  specified interval.
                </p>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  Now, we want to create a function that can test the model on
                  our test data and get us the loss and accuracy.
                </p>
                <div class="MuiBox-root css-dzaqf9">
                  <div class="MuiBox-root css-125pbeb">
                    <button
                      class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho"
                      tabindex="0"
                      type="button"
                    >
                      <svg
                        class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                        focusable="false"
                        aria-hidden="true"
                        viewBox="0 0 24 24"
                        data-testid="ContentCopyIcon"
                      >
                        <path
                          d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"
                        ></path>
                      </svg>
                    </button>
                  </div>
                  <pre
                    style="
                      color: #111b27;
                      background: #e3eaf2;
                      font-family: Consolas, Monaco, &quot;Andale Mono&quot;,
                        &quot;Ubuntu Mono&quot;, monospace;
                      text-align: left;
                      white-space: pre;
                      word-spacing: normal;
                      word-break: normal;
                      word-wrap: normal;
                      line-height: 1.5;
                      -moz-tab-size: 4;
                      -o-tab-size: 4;
                      tab-size: 4;
                      -webkit-hyphens: none;
                      -moz-hyphens: none;
                      -ms-hyphens: none;
                      hyphens: none;
                      padding: 1em;
                      margin: 0;
                      overflow: auto;
                    "
                  ><code class="language-python" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#a04900">def</span><span> </span><span class="token" style="color:#7c00aa">test</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>    self</span><span class="token" style="color:#111b27">.</span><span>model</span><span class="token" style="color:#111b27">.</span><span class="token" style="color:#af00af">eval</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    sum_test_loss </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token" style="color:#755f00">0</span><span>
</span><span>    num_correct </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token" style="color:#755f00">0</span><span>
</span>
<span>    </span><span class="token" style="color:#a04900">with</span><span> torch</span><span class="token" style="color:#111b27">.</span><span>no_grad</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>        </span><span class="token" style="color:#a04900">for</span><span> data</span><span class="token" style="color:#111b27">,</span><span> target </span><span class="token" style="color:#a04900">in</span><span> data_loaders</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#116b00">&quot;test&quot;</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">:</span><span>
</span><span>            data </span><span class="token" style="color:#a04900">=</span><span> data</span><span class="token" style="color:#111b27">.</span><span>to</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">.</span><span>device</span><span class="token" style="color:#111b27">)</span><span>
</span><span>            target </span><span class="token" style="color:#a04900">=</span><span> target</span><span class="token" style="color:#111b27">.</span><span>to</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">.</span><span>device</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>            output </span><span class="token" style="color:#a04900">=</span><span> self</span><span class="token" style="color:#111b27">.</span><span>model</span><span class="token" style="color:#111b27">(</span><span>data</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>            sum_test_loss </span><span class="token" style="color:#a04900">+=</span><span> self</span><span class="token" style="color:#111b27">.</span><span>loss_fn</span><span class="token" style="color:#111b27">(</span><span>output</span><span class="token" style="color:#111b27">,</span><span> target</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">.</span><span>item</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>            prediction </span><span class="token" style="color:#a04900">=</span><span> output</span><span class="token" style="color:#111b27">.</span><span>argmax</span><span class="token" style="color:#111b27">(</span><span>dim</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">1</span><span class="token" style="color:#111b27">,</span><span> keepdim</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">True</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>            num_correct </span><span class="token" style="color:#a04900">+=</span><span> prediction</span><span class="token" style="color:#111b27">.</span><span>eq</span><span class="token" style="color:#111b27">(</span><span>target</span><span class="token" style="color:#111b27">.</span><span>view_as</span><span class="token" style="color:#111b27">(</span><span>prediction</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">.</span><span class="token" style="color:#af00af">sum</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">.</span><span>item</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    average_test_loss </span><span class="token" style="color:#a04900">=</span><span> sum_test_loss </span><span class="token" style="color:#a04900">/</span><span> </span><span class="token" style="color:#af00af">len</span><span class="token" style="color:#111b27">(</span><span>data_loaders</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#116b00">&#x27;test&#x27;</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">.</span><span>dataset</span><span class="token" style="color:#111b27">)</span><span>
</span><span>    accuracy </span><span class="token" style="color:#a04900">=</span><span> num_correct </span><span class="token" style="color:#a04900">/</span><span> </span><span class="token" style="color:#af00af">len</span><span class="token" style="color:#111b27">(</span><span>data_loaders</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#116b00">&#x27;test&#x27;</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">.</span><span>dataset</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    </span><span class="token" style="color:#a04900">print</span><span class="token" style="color:#111b27">(</span><span class="token string-interpolation" style="color:#116b00">f&quot;    Average loss: </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">average_test_loss</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span><span>    </span><span class="token" style="color:#a04900">print</span><span class="token" style="color:#111b27">(</span><span class="token string-interpolation" style="color:#116b00">f&quot;    Accuracy: </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">accuracy</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">&quot;</span><span class="token" style="color:#111b27">)</span></code></pre>
                </div>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  For all the testing samples, we calculate the average loss and
                  the number of predictions the model got correct and then print
                  them to the console.
                </p>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  And, finally, we can define our
                  <span class="MuiBox-root css-87x4qo">train</span> function,
                  which just trains our model for the specified number of
                  epochs.
                </p>
                <div class="MuiBox-root css-dzaqf9">
                  <div class="MuiBox-root css-125pbeb">
                    <button
                      class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho"
                      tabindex="0"
                      type="button"
                    >
                      <svg
                        class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                        focusable="false"
                        aria-hidden="true"
                        viewBox="0 0 24 24"
                        data-testid="ContentCopyIcon"
                      >
                        <path
                          d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"
                        ></path>
                      </svg>
                    </button>
                  </div>
                  <pre
                    style="
                      color: #111b27;
                      background: #e3eaf2;
                      font-family: Consolas, Monaco, &quot;Andale Mono&quot;,
                        &quot;Ubuntu Mono&quot;, monospace;
                      text-align: left;
                      white-space: pre;
                      word-spacing: normal;
                      word-break: normal;
                      word-wrap: normal;
                      line-height: 1.5;
                      -moz-tab-size: 4;
                      -o-tab-size: 4;
                      tab-size: 4;
                      -webkit-hyphens: none;
                      -moz-hyphens: none;
                      -ms-hyphens: none;
                      hyphens: none;
                      padding: 1em;
                      margin: 0;
                      overflow: auto;
                    "
                  ><code class="language-python" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#a04900">def</span><span> </span><span class="token" style="color:#7c00aa">train</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>    </span><span class="token" style="color:#a04900">for</span><span> epoch_index </span><span class="token" style="color:#a04900">in</span><span> </span><span class="token" style="color:#af00af">range</span><span class="token" style="color:#111b27">(</span><span>config</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#116b00">&#x27;training_num_epochs&#x27;</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>        </span><span class="token" style="color:#a04900">print</span><span class="token" style="color:#111b27">(</span><span class="token string-interpolation" style="color:#116b00">f&quot;Epoch: </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">epoch_index</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        self</span><span class="token" style="color:#111b27">.</span><span>train_single_epoch</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        model_save_file_path </span><span class="token" style="color:#a04900">=</span><span> join</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">.</span><span>models_dir</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token string-interpolation" style="color:#116b00">f&quot;epoch-</span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">epoch_index</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">.pt&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        self</span><span class="token" style="color:#111b27">.</span><span>save_weights</span><span class="token" style="color:#111b27">(</span><span>model_save_file_path</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        self</span><span class="token" style="color:#111b27">.</span><span>test</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span></code></pre>
                </div>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  Outside the
                  <span class="MuiBox-root css-87x4qo">ModelTrainer</span>
                  class, in the
                  <span class="MuiBox-root css-87x4qo">main</span> block, we can
                  create an instance of the class and call the train function.
                </p>
                <div class="MuiBox-root css-dzaqf9">
                  <div class="MuiBox-root css-125pbeb">
                    <button
                      class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho"
                      tabindex="0"
                      type="button"
                    >
                      <svg
                        class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                        focusable="false"
                        aria-hidden="true"
                        viewBox="0 0 24 24"
                        data-testid="ContentCopyIcon"
                      >
                        <path
                          d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"
                        ></path>
                      </svg>
                    </button>
                  </div>
                  <pre
                    style="
                      color: #111b27;
                      background: #e3eaf2;
                      font-family: Consolas, Monaco, &quot;Andale Mono&quot;,
                        &quot;Ubuntu Mono&quot;, monospace;
                      text-align: left;
                      white-space: pre;
                      word-spacing: normal;
                      word-break: normal;
                      word-wrap: normal;
                      line-height: 1.5;
                      -moz-tab-size: 4;
                      -o-tab-size: 4;
                      tab-size: 4;
                      -webkit-hyphens: none;
                      -moz-hyphens: none;
                      -ms-hyphens: none;
                      hyphens: none;
                      padding: 1em;
                      margin: 0;
                      overflow: auto;
                    "
                  ><code class="language-python" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#a04900">if</span><span> __name__ </span><span class="token" style="color:#a04900">==</span><span> </span><span class="token" style="color:#116b00">&quot;__main__&quot;</span><span class="token" style="color:#111b27">:</span><span>
</span><span>    model_trainer </span><span class="token" style="color:#a04900">=</span><span> ModelTrainer</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span><span>    model_trainer</span><span class="token" style="color:#111b27">.</span><span>train</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span></code></pre>
                </div>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  Here&#x27;s the entire
                  <span class="MuiBox-root css-87x4qo">train.py</span> file.
                </p>
                <div class="MuiBox-root css-dzaqf9">
                  <div class="MuiBox-root css-125pbeb">
                    <button
                      class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho"
                      tabindex="0"
                      type="button"
                    >
                      <svg
                        class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                        focusable="false"
                        aria-hidden="true"
                        viewBox="0 0 24 24"
                        data-testid="ContentCopyIcon"
                      >
                        <path
                          d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"
                        ></path>
                      </svg>
                    </button>
                  </div>
                  <pre
                    style="
                      color: #111b27;
                      background: #e3eaf2;
                      font-family: Consolas, Monaco, &quot;Andale Mono&quot;,
                        &quot;Ubuntu Mono&quot;, monospace;
                      text-align: left;
                      white-space: pre;
                      word-spacing: normal;
                      word-break: normal;
                      word-wrap: normal;
                      line-height: 1.5;
                      -moz-tab-size: 4;
                      -o-tab-size: 4;
                      tab-size: 4;
                      -webkit-hyphens: none;
                      -moz-hyphens: none;
                      -ms-hyphens: none;
                      hyphens: none;
                      padding: 1em;
                      margin: 0;
                      overflow: auto;
                    "
                  ><code class="language-python" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#a04900">from</span><span> datetime </span><span class="token" style="color:#a04900">import</span><span> datetime
</span><span></span><span class="token" style="color:#a04900">from</span><span> os </span><span class="token" style="color:#a04900">import</span><span> makedirs
</span><span></span><span class="token" style="color:#a04900">from</span><span> os</span><span class="token" style="color:#111b27">.</span><span>path </span><span class="token" style="color:#a04900">import</span><span> join
</span>
<span></span><span class="token" style="color:#a04900">import</span><span> torch
</span><span></span><span class="token" style="color:#a04900">import</span><span> torch</span><span class="token" style="color:#111b27">.</span><span>nn </span><span class="token" style="color:#a04900">as</span><span> nn
</span><span></span><span class="token" style="color:#a04900">import</span><span> torch</span><span class="token" style="color:#111b27">.</span><span>optim </span><span class="token" style="color:#a04900">as</span><span> optim
</span>
<span></span><span class="token" style="color:#a04900">from</span><span> </span><span class="token" style="color:#111b27">.</span><span>config </span><span class="token" style="color:#a04900">import</span><span> config</span><span class="token" style="color:#111b27">,</span><span> models_dir
</span><span></span><span class="token" style="color:#a04900">from</span><span> </span><span class="token" style="color:#111b27">.</span><span>dataset </span><span class="token" style="color:#a04900">import</span><span> data_loaders
</span><span></span><span class="token" style="color:#a04900">from</span><span> </span><span class="token" style="color:#111b27">.</span><span>model </span><span class="token" style="color:#a04900">import</span><span> CNN
</span>
<!-- -->
<span></span><span class="token" style="color:#a04900">class</span><span> </span><span class="token" style="color:#005a8e">ModelTrainer</span><span class="token" style="color:#111b27">:</span><span>
</span><span>    </span><span class="token" style="color:#a04900">def</span><span> </span><span class="token" style="color:#7c00aa">__init__</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>        self</span><span class="token" style="color:#111b27">.</span><span>training_id </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token" style="color:#116b00">&quot;torch---&quot;</span><span> </span><span class="token" style="color:#a04900">+</span><span> datetime</span><span class="token" style="color:#111b27">.</span><span>now</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">.</span><span>strftime</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;%Y-%m-%d-%H-%M-%S&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        self</span><span class="token" style="color:#111b27">.</span><span>device </span><span class="token" style="color:#a04900">=</span><span> torch</span><span class="token" style="color:#111b27">.</span><span>device</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;cuda&quot;</span><span> </span><span class="token" style="color:#a04900">if</span><span> torch</span><span class="token" style="color:#111b27">.</span><span>cuda</span><span class="token" style="color:#111b27">.</span><span>is_available</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span> </span><span class="token" style="color:#a04900">else</span><span> </span><span class="token" style="color:#116b00">&quot;cpu&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        self</span><span class="token" style="color:#111b27">.</span><span>model </span><span class="token" style="color:#a04900">=</span><span> CNN</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        self</span><span class="token" style="color:#111b27">.</span><span>model </span><span class="token" style="color:#a04900">=</span><span> self</span><span class="token" style="color:#111b27">.</span><span>model</span><span class="token" style="color:#111b27">.</span><span>to</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">.</span><span>device</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        self</span><span class="token" style="color:#111b27">.</span><span>optimizer </span><span class="token" style="color:#a04900">=</span><span> optim</span><span class="token" style="color:#111b27">.</span><span>Adam</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">.</span><span>model</span><span class="token" style="color:#111b27">.</span><span>parameters</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span> lr</span><span class="token" style="color:#a04900">=</span><span>config</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#116b00">&#x27;learning_rate&#x27;</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        self</span><span class="token" style="color:#111b27">.</span><span>loss_fn </span><span class="token" style="color:#a04900">=</span><span> nn</span><span class="token" style="color:#111b27">.</span><span>CrossEntropyLoss</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        self</span><span class="token" style="color:#111b27">.</span><span>models_dir </span><span class="token" style="color:#a04900">=</span><span> join</span><span class="token" style="color:#111b27">(</span><span>models_dir</span><span class="token" style="color:#111b27">,</span><span> self</span><span class="token" style="color:#111b27">.</span><span>training_id</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        makedirs</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">.</span><span>models_dir</span><span class="token" style="color:#111b27">,</span><span> exist_ok</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">False</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    </span><span class="token" style="color:#a04900">def</span><span> </span><span class="token" style="color:#7c00aa">train_single_epoch</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>        self</span><span class="token" style="color:#111b27">.</span><span>model</span><span class="token" style="color:#111b27">.</span><span>train</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        </span><span class="token" style="color:#a04900">for</span><span> batch_index</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#111b27">(</span><span>data</span><span class="token" style="color:#111b27">,</span><span> target</span><span class="token" style="color:#111b27">)</span><span> </span><span class="token" style="color:#a04900">in</span><span> </span><span class="token" style="color:#af00af">enumerate</span><span class="token" style="color:#111b27">(</span><span>data_loaders</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#116b00">&quot;train&quot;</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>            data </span><span class="token" style="color:#a04900">=</span><span> data</span><span class="token" style="color:#111b27">.</span><span>to</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">.</span><span>device</span><span class="token" style="color:#111b27">)</span><span>
</span><span>            target </span><span class="token" style="color:#a04900">=</span><span> target</span><span class="token" style="color:#111b27">.</span><span>to</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">.</span><span>device</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>            self</span><span class="token" style="color:#111b27">.</span><span>optimizer</span><span class="token" style="color:#111b27">.</span><span>zero_grad</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>            output </span><span class="token" style="color:#a04900">=</span><span> self</span><span class="token" style="color:#111b27">.</span><span>model</span><span class="token" style="color:#111b27">(</span><span>data</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>            loss </span><span class="token" style="color:#a04900">=</span><span> self</span><span class="token" style="color:#111b27">.</span><span>loss_fn</span><span class="token" style="color:#111b27">(</span><span>output</span><span class="token" style="color:#111b27">,</span><span> target</span><span class="token" style="color:#111b27">)</span><span>
</span><span>            loss</span><span class="token" style="color:#111b27">.</span><span>backward</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>            self</span><span class="token" style="color:#111b27">.</span><span>optimizer</span><span class="token" style="color:#111b27">.</span><span>step</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>            </span><span class="token" style="color:#a04900">if</span><span> batch_index </span><span class="token" style="color:#a04900">%</span><span> config</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#116b00">&#x27;log_batch_interval&#x27;</span><span class="token" style="color:#111b27">]</span><span> </span><span class="token" style="color:#a04900">==</span><span> </span><span class="token" style="color:#755f00">0</span><span class="token" style="color:#111b27">:</span><span>
</span><span>                </span><span class="token" style="color:#a04900">print</span><span class="token" style="color:#111b27">(</span><span class="token string-interpolation" style="color:#116b00">f&quot;    </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">batch_index</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00"> / </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation" style="color:#af00af">len</span><span class="token string-interpolation interpolation" style="color:#111b27">(</span><span class="token string-interpolation interpolation">data_loaders</span><span class="token string-interpolation interpolation" style="color:#111b27">[</span><span class="token string-interpolation interpolation" style="color:#116b00">&#x27;train&#x27;</span><span class="token string-interpolation interpolation" style="color:#111b27">]</span><span class="token string-interpolation interpolation" style="color:#111b27">)</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    </span><span class="token" style="color:#a04900">def</span><span> </span><span class="token" style="color:#7c00aa">test</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>        self</span><span class="token" style="color:#111b27">.</span><span>model</span><span class="token" style="color:#111b27">.</span><span class="token" style="color:#af00af">eval</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        sum_test_loss </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token" style="color:#755f00">0</span><span>
</span><span>        num_correct </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token" style="color:#755f00">0</span><span>
</span>
<span>        </span><span class="token" style="color:#a04900">with</span><span> torch</span><span class="token" style="color:#111b27">.</span><span>no_grad</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>            </span><span class="token" style="color:#a04900">for</span><span> data</span><span class="token" style="color:#111b27">,</span><span> target </span><span class="token" style="color:#a04900">in</span><span> data_loaders</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#116b00">&quot;test&quot;</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">:</span><span>
</span><span>                data </span><span class="token" style="color:#a04900">=</span><span> data</span><span class="token" style="color:#111b27">.</span><span>to</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">.</span><span>device</span><span class="token" style="color:#111b27">)</span><span>
</span><span>                target </span><span class="token" style="color:#a04900">=</span><span> target</span><span class="token" style="color:#111b27">.</span><span>to</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">.</span><span>device</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>                output </span><span class="token" style="color:#a04900">=</span><span> self</span><span class="token" style="color:#111b27">.</span><span>model</span><span class="token" style="color:#111b27">(</span><span>data</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>                sum_test_loss </span><span class="token" style="color:#a04900">+=</span><span> self</span><span class="token" style="color:#111b27">.</span><span>loss_fn</span><span class="token" style="color:#111b27">(</span><span>output</span><span class="token" style="color:#111b27">,</span><span> target</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">.</span><span>item</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>                prediction </span><span class="token" style="color:#a04900">=</span><span> output</span><span class="token" style="color:#111b27">.</span><span>argmax</span><span class="token" style="color:#111b27">(</span><span>dim</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">1</span><span class="token" style="color:#111b27">,</span><span> keepdim</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">True</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>                num_correct </span><span class="token" style="color:#a04900">+=</span><span> prediction</span><span class="token" style="color:#111b27">.</span><span>eq</span><span class="token" style="color:#111b27">(</span><span>target</span><span class="token" style="color:#111b27">.</span><span>view_as</span><span class="token" style="color:#111b27">(</span><span>prediction</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">.</span><span class="token" style="color:#af00af">sum</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">.</span><span>item</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        average_test_loss </span><span class="token" style="color:#a04900">=</span><span> sum_test_loss </span><span class="token" style="color:#a04900">/</span><span> </span><span class="token" style="color:#af00af">len</span><span class="token" style="color:#111b27">(</span><span>data_loaders</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#116b00">&#x27;test&#x27;</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">.</span><span>dataset</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        accuracy </span><span class="token" style="color:#a04900">=</span><span> num_correct </span><span class="token" style="color:#a04900">/</span><span> </span><span class="token" style="color:#af00af">len</span><span class="token" style="color:#111b27">(</span><span>data_loaders</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#116b00">&#x27;test&#x27;</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">.</span><span>dataset</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        </span><span class="token" style="color:#a04900">print</span><span class="token" style="color:#111b27">(</span><span class="token string-interpolation" style="color:#116b00">f&quot;    Average loss: </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">average_test_loss</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        </span><span class="token" style="color:#a04900">print</span><span class="token" style="color:#111b27">(</span><span class="token string-interpolation" style="color:#116b00">f&quot;    Accuracy: </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">accuracy</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    </span><span class="token" style="color:#a04900">def</span><span> </span><span class="token" style="color:#7c00aa">save_weights</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">,</span><span> file_path</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>        torch</span><span class="token" style="color:#111b27">.</span><span>save</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">.</span><span>model</span><span class="token" style="color:#111b27">.</span><span>state_dict</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span> file_path</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    </span><span class="token" style="color:#a04900">def</span><span> </span><span class="token" style="color:#7c00aa">train</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>        </span><span class="token" style="color:#a04900">for</span><span> epoch_index </span><span class="token" style="color:#a04900">in</span><span> </span><span class="token" style="color:#af00af">range</span><span class="token" style="color:#111b27">(</span><span>config</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#116b00">&#x27;training_num_epochs&#x27;</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>            </span><span class="token" style="color:#a04900">print</span><span class="token" style="color:#111b27">(</span><span class="token string-interpolation" style="color:#116b00">f&quot;Epoch: </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">epoch_index</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span><span>            self</span><span class="token" style="color:#111b27">.</span><span>train_single_epoch</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>            model_save_file_path </span><span class="token" style="color:#a04900">=</span><span> join</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">.</span><span>models_dir</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token string-interpolation" style="color:#116b00">f&quot;epoch-</span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">epoch_index</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">.pt&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span><span>            self</span><span class="token" style="color:#111b27">.</span><span>save_weights</span><span class="token" style="color:#111b27">(</span><span>model_save_file_path</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>            self</span><span class="token" style="color:#111b27">.</span><span>test</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span>
<!-- -->
<span></span><span class="token" style="color:#a04900">if</span><span> __name__ </span><span class="token" style="color:#a04900">==</span><span> </span><span class="token" style="color:#116b00">&quot;__main__&quot;</span><span class="token" style="color:#111b27">:</span><span>
</span><span>    model_trainer </span><span class="token" style="color:#a04900">=</span><span> ModelTrainer</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span><span>    model_trainer</span><span class="token" style="color:#111b27">.</span><span>train</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span></code></pre>
                </div>
                <h2
                  class="MuiTypography-root MuiTypography-h5 css-1oj41as"
                  id="testing"
                >
                  <strong>Testing</strong>
                </h2>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  Still inside the
                  <span class="MuiBox-root css-87x4qo">src</span> folder, we
                  create another file called
                  <span class="MuiBox-root css-87x4qo">test.py</span>.
                  Let&#x27;s import the required packages and load our model.
                </p>
                <div class="MuiBox-root css-dzaqf9">
                  <div class="MuiBox-root css-125pbeb">
                    <button
                      class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho"
                      tabindex="0"
                      type="button"
                    >
                      <svg
                        class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                        focusable="false"
                        aria-hidden="true"
                        viewBox="0 0 24 24"
                        data-testid="ContentCopyIcon"
                      >
                        <path
                          d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"
                        ></path>
                      </svg>
                    </button>
                  </div>
                  <pre
                    style="
                      color: #111b27;
                      background: #e3eaf2;
                      font-family: Consolas, Monaco, &quot;Andale Mono&quot;,
                        &quot;Ubuntu Mono&quot;, monospace;
                      text-align: left;
                      white-space: pre;
                      word-spacing: normal;
                      word-break: normal;
                      word-wrap: normal;
                      line-height: 1.5;
                      -moz-tab-size: 4;
                      -o-tab-size: 4;
                      tab-size: 4;
                      -webkit-hyphens: none;
                      -moz-hyphens: none;
                      -ms-hyphens: none;
                      hyphens: none;
                      padding: 1em;
                      margin: 0;
                      overflow: auto;
                    "
                  ><code class="language-python" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#a04900">from</span><span> json </span><span class="token" style="color:#a04900">import</span><span> load </span><span class="token" style="color:#a04900">as</span><span> json_load
</span><span></span><span class="token" style="color:#a04900">from</span><span> os </span><span class="token" style="color:#a04900">import</span><span> listdir
</span><span></span><span class="token" style="color:#a04900">from</span><span> os</span><span class="token" style="color:#111b27">.</span><span>path </span><span class="token" style="color:#a04900">import</span><span> join </span><span class="token" style="color:#a04900">as</span><span> path_join
</span>
<span></span><span class="token" style="color:#a04900">import</span><span> cv2
</span><span></span><span class="token" style="color:#a04900">import</span><span> torch
</span><span></span><span class="token" style="color:#a04900">from</span><span> torchvision </span><span class="token" style="color:#a04900">import</span><span> transforms
</span>
<span></span><span class="token" style="color:#a04900">from</span><span> </span><span class="token" style="color:#111b27">.</span><span>config </span><span class="token" style="color:#a04900">import</span><span> data_dir</span><span class="token" style="color:#111b27">,</span><span> models_dir
</span><span></span><span class="token" style="color:#a04900">from</span><span> </span><span class="token" style="color:#111b27">.</span><span>dataset </span><span class="token" style="color:#a04900">import</span><span> data_loaders
</span><span></span><span class="token" style="color:#a04900">from</span><span> </span><span class="token" style="color:#111b27">.</span><span>model </span><span class="token" style="color:#a04900">import</span><span> CNN
</span>
<!-- -->
<span></span><span class="token" style="color:#3c526d"># MODEL_WEIGHTS_FILE_PATH = path_join(models_dir, &quot;training_id&quot;, &quot;epoch-epoch_numbe&quot;)</span><span>
</span><span>MODEL_WEIGHTS_FILE_PATH </span><span class="token" style="color:#a04900">=</span><span> path_join</span><span class="token" style="color:#111b27">(</span><span>models_dir</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;torch---2024-04-23-08-25-15&quot;</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;epoch-9.pt&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<!-- -->
<span></span><span class="token" style="color:#a04900">if</span><span> __name__ </span><span class="token" style="color:#a04900">==</span><span> </span><span class="token" style="color:#116b00">&quot;__main__&quot;</span><span class="token" style="color:#111b27">:</span><span>
</span><span>    device </span><span class="token" style="color:#a04900">=</span><span> torch</span><span class="token" style="color:#111b27">.</span><span>device</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;cuda&quot;</span><span> </span><span class="token" style="color:#a04900">if</span><span> torch</span><span class="token" style="color:#111b27">.</span><span>cuda</span><span class="token" style="color:#111b27">.</span><span>is_available</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span> </span><span class="token" style="color:#a04900">else</span><span> </span><span class="token" style="color:#116b00">&quot;cpu&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    model </span><span class="token" style="color:#a04900">=</span><span> CNN</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span><span>    model </span><span class="token" style="color:#a04900">=</span><span> model</span><span class="token" style="color:#111b27">.</span><span>to</span><span class="token" style="color:#111b27">(</span><span>device</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    model</span><span class="token" style="color:#111b27">.</span><span>load_state_dict</span><span class="token" style="color:#111b27">(</span><span>torch</span><span class="token" style="color:#111b27">.</span><span>load</span><span class="token" style="color:#111b27">(</span><span>MODEL_WEIGHTS_FILE_PATH</span><span class="token" style="color:#111b27">,</span><span> map_location</span><span class="token" style="color:#a04900">=</span><span>device</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    model</span><span class="token" style="color:#111b27">.</span><span class="token" style="color:#af00af">eval</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span></code></pre>
                </div>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  We&#x27;ll first test on data from our test data loader and
                  then on some custom images.
                </p>
                <style data-emotion="css 14mppol">
                  .css-14mppol {
                    margin: 0;
                    font-family: "Roboto", "Helvetica", "Arial", sans-serif;
                    font-weight: 500;
                    font-size: 1.25rem;
                    line-height: 1.6;
                    letter-spacing: 0.0075em;
                    margin-bottom: 16px;
                  }
                </style>
                <h3
                  class="MuiTypography-root MuiTypography-h6 css-14mppol"
                  id="testing-on-mnist-test-data"
                >
                  <strong>Testing on MNIST Test Data</strong>
                </h3>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  This would be similar to the
                  <span class="MuiBox-root css-87x4qo">ModelTrainer.test</span>
                  function defined in the
                  <span class="MuiBox-root css-87x4qo">train.py</span> file.
                </p>
                <div class="MuiBox-root css-dzaqf9">
                  <div class="MuiBox-root css-125pbeb">
                    <button
                      class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho"
                      tabindex="0"
                      type="button"
                    >
                      <svg
                        class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                        focusable="false"
                        aria-hidden="true"
                        viewBox="0 0 24 24"
                        data-testid="ContentCopyIcon"
                      >
                        <path
                          d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"
                        ></path>
                      </svg>
                    </button>
                  </div>
                  <pre
                    style="
                      color: #111b27;
                      background: #e3eaf2;
                      font-family: Consolas, Monaco, &quot;Andale Mono&quot;,
                        &quot;Ubuntu Mono&quot;, monospace;
                      text-align: left;
                      white-space: pre;
                      word-spacing: normal;
                      word-break: normal;
                      word-wrap: normal;
                      line-height: 1.5;
                      -moz-tab-size: 4;
                      -o-tab-size: 4;
                      tab-size: 4;
                      -webkit-hyphens: none;
                      -moz-hyphens: none;
                      -ms-hyphens: none;
                      hyphens: none;
                      padding: 1em;
                      margin: 0;
                      overflow: auto;
                    "
                  ><code class="language-python" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#a04900">print</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;Testing on MNIST Test Set&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>num_correct </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token" style="color:#755f00">0</span><span>
</span><span></span><span class="token" style="color:#a04900">with</span><span> torch</span><span class="token" style="color:#111b27">.</span><span>no_grad</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>    </span><span class="token" style="color:#a04900">for</span><span> data</span><span class="token" style="color:#111b27">,</span><span> target </span><span class="token" style="color:#a04900">in</span><span> data_loaders</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#116b00">&quot;test&quot;</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">:</span><span>
</span><span>        data </span><span class="token" style="color:#a04900">=</span><span> data</span><span class="token" style="color:#111b27">.</span><span>to</span><span class="token" style="color:#111b27">(</span><span>device</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        target </span><span class="token" style="color:#a04900">=</span><span> target</span><span class="token" style="color:#111b27">.</span><span>to</span><span class="token" style="color:#111b27">(</span><span>device</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        output </span><span class="token" style="color:#a04900">=</span><span> model</span><span class="token" style="color:#111b27">(</span><span>data</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        prediction </span><span class="token" style="color:#a04900">=</span><span> output</span><span class="token" style="color:#111b27">.</span><span>argmax</span><span class="token" style="color:#111b27">(</span><span>dim</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">1</span><span class="token" style="color:#111b27">,</span><span> keepdim</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">True</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        num_correct </span><span class="token" style="color:#a04900">+=</span><span> prediction</span><span class="token" style="color:#111b27">.</span><span>eq</span><span class="token" style="color:#111b27">(</span><span>target</span><span class="token" style="color:#111b27">.</span><span>view_as</span><span class="token" style="color:#111b27">(</span><span>prediction</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">.</span><span class="token" style="color:#af00af">sum</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">.</span><span>item</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>accuracy </span><span class="token" style="color:#a04900">=</span><span> num_correct </span><span class="token" style="color:#a04900">/</span><span> </span><span class="token" style="color:#af00af">len</span><span class="token" style="color:#111b27">(</span><span>data_loaders</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#116b00">&#x27;test&#x27;</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">.</span><span>dataset</span><span class="token" style="color:#111b27">)</span><span>
</span><span></span><span class="token" style="color:#a04900">print</span><span class="token" style="color:#111b27">(</span><span class="token string-interpolation" style="color:#116b00">f&quot;    Accuracy: </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">accuracy</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span><span></span><span class="token" style="color:#a04900">print</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span></code></pre>
                </div>
                <h3
                  class="MuiTypography-root MuiTypography-h6 css-14mppol"
                  id="testing-on-custom-images"
                >
                  <strong>Testing on Custom Images</strong>
                </h3>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  Inside our
                  <span class="MuiBox-root css-87x4qo">data</span> directory, I
                  have created another folder called
                  <span class="MuiBox-root css-87x4qo">test_images</span>
                  containing some 28x28 pngs with a black background and digits
                  drawn in white. I also have a file called
                  <span class="MuiBox-root css-87x4qo"
                    >test_images_labels.json</span
                  >
                  that contains labels for each of the images. Here is the
                  labels file.
                </p>
                <div class="MuiBox-root css-dzaqf9">
                  <div class="MuiBox-root css-125pbeb">
                    <button
                      class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho"
                      tabindex="0"
                      type="button"
                    >
                      <svg
                        class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                        focusable="false"
                        aria-hidden="true"
                        viewBox="0 0 24 24"
                        data-testid="ContentCopyIcon"
                      >
                        <path
                          d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"
                        ></path>
                      </svg>
                    </button>
                  </div>
                  <pre
                    style="
                      color: #111b27;
                      background: #e3eaf2;
                      font-family: Consolas, Monaco, &quot;Andale Mono&quot;,
                        &quot;Ubuntu Mono&quot;, monospace;
                      text-align: left;
                      white-space: pre;
                      word-spacing: normal;
                      word-break: normal;
                      word-wrap: normal;
                      line-height: 1.5;
                      -moz-tab-size: 4;
                      -o-tab-size: 4;
                      tab-size: 4;
                      -webkit-hyphens: none;
                      -moz-hyphens: none;
                      -ms-hyphens: none;
                      hyphens: none;
                      padding: 1em;
                      margin: 0;
                      overflow: auto;
                    "
                  ><code class="language-json" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#111b27">{</span><span>
</span><span>    </span><span class="token" style="color:#005a8e">&quot;1.png&quot;</span><span class="token" style="color:#a04900">:</span><span> </span><span class="token" style="color:#755f00">1</span><span class="token" style="color:#111b27">,</span><span>
</span><span>    </span><span class="token" style="color:#005a8e">&quot;2.png&quot;</span><span class="token" style="color:#a04900">:</span><span> </span><span class="token" style="color:#755f00">7</span><span class="token" style="color:#111b27">,</span><span>
</span><span>    </span><span class="token" style="color:#005a8e">&quot;3.png&quot;</span><span class="token" style="color:#a04900">:</span><span> </span><span class="token" style="color:#755f00">2</span><span class="token" style="color:#111b27">,</span><span>
</span><span>    </span><span class="token" style="color:#005a8e">&quot;4.png&quot;</span><span class="token" style="color:#a04900">:</span><span> </span><span class="token" style="color:#755f00">9</span><span class="token" style="color:#111b27">,</span><span>
</span><span>    </span><span class="token" style="color:#005a8e">&quot;5.png&quot;</span><span class="token" style="color:#a04900">:</span><span> </span><span class="token" style="color:#755f00">8</span><span class="token" style="color:#111b27">,</span><span>
</span><span>    </span><span class="token" style="color:#005a8e">&quot;6.png&quot;</span><span class="token" style="color:#a04900">:</span><span> </span><span class="token" style="color:#755f00">5</span><span class="token" style="color:#111b27">,</span><span>
</span><span>    </span><span class="token" style="color:#005a8e">&quot;7.png&quot;</span><span class="token" style="color:#a04900">:</span><span> </span><span class="token" style="color:#755f00">1</span><span class="token" style="color:#111b27">,</span><span>
</span><span>    </span><span class="token" style="color:#005a8e">&quot;8.png&quot;</span><span class="token" style="color:#a04900">:</span><span> </span><span class="token" style="color:#755f00">7</span><span class="token" style="color:#111b27">,</span><span>
</span><span>    </span><span class="token" style="color:#005a8e">&quot;9.png&quot;</span><span class="token" style="color:#a04900">:</span><span> </span><span class="token" style="color:#755f00">1</span><span class="token" style="color:#111b27">,</span><span>
</span><span>    </span><span class="token" style="color:#005a8e">&quot;10.png&quot;</span><span class="token" style="color:#a04900">:</span><span> </span><span class="token" style="color:#755f00">7</span><span class="token" style="color:#111b27">,</span><span>
</span><span>    </span><span class="token" style="color:#005a8e">&quot;11.png&quot;</span><span class="token" style="color:#a04900">:</span><span> </span><span class="token" style="color:#755f00">7</span><span class="token" style="color:#111b27">,</span><span>
</span><span>    </span><span class="token" style="color:#005a8e">&quot;12.png&quot;</span><span class="token" style="color:#a04900">:</span><span> </span><span class="token" style="color:#755f00">0</span><span class="token" style="color:#111b27">,</span><span>
</span><span>    </span><span class="token" style="color:#005a8e">&quot;13.png&quot;</span><span class="token" style="color:#a04900">:</span><span> </span><span class="token" style="color:#755f00">5</span><span class="token" style="color:#111b27">,</span><span>
</span><span>    </span><span class="token" style="color:#005a8e">&quot;14.png&quot;</span><span class="token" style="color:#a04900">:</span><span> </span><span class="token" style="color:#755f00">3</span><span class="token" style="color:#111b27">,</span><span>
</span><span>    </span><span class="token" style="color:#005a8e">&quot;15.png&quot;</span><span class="token" style="color:#a04900">:</span><span> </span><span class="token" style="color:#755f00">2</span><span class="token" style="color:#111b27">,</span><span>
</span><span>    </span><span class="token" style="color:#005a8e">&quot;16.png&quot;</span><span class="token" style="color:#a04900">:</span><span> </span><span class="token" style="color:#755f00">1</span><span class="token" style="color:#111b27">,</span><span>
</span><span>    </span><span class="token" style="color:#005a8e">&quot;17.png&quot;</span><span class="token" style="color:#a04900">:</span><span> </span><span class="token" style="color:#755f00">0</span><span class="token" style="color:#111b27">,</span><span>
</span><span>    </span><span class="token" style="color:#005a8e">&quot;18.png&quot;</span><span class="token" style="color:#a04900">:</span><span> </span><span class="token" style="color:#755f00">8</span><span class="token" style="color:#111b27">,</span><span>
</span><span>    </span><span class="token" style="color:#005a8e">&quot;19.png&quot;</span><span class="token" style="color:#a04900">:</span><span> </span><span class="token" style="color:#755f00">7</span><span class="token" style="color:#111b27">,</span><span>
</span><span>    </span><span class="token" style="color:#005a8e">&quot;20.png&quot;</span><span class="token" style="color:#a04900">:</span><span> </span><span class="token" style="color:#755f00">4</span><span>
</span><span></span><span class="token" style="color:#111b27">}</span></code></pre>
                </div>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  We want to preprocess our testing images exactly in the same
                  way we preprocessed our training data, so we define a set of
                  transforms for the same.
                </p>
                <div class="MuiBox-root css-dzaqf9">
                  <div class="MuiBox-root css-125pbeb">
                    <button
                      class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho"
                      tabindex="0"
                      type="button"
                    >
                      <svg
                        class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                        focusable="false"
                        aria-hidden="true"
                        viewBox="0 0 24 24"
                        data-testid="ContentCopyIcon"
                      >
                        <path
                          d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"
                        ></path>
                      </svg>
                    </button>
                  </div>
                  <pre
                    style="
                      color: #111b27;
                      background: #e3eaf2;
                      font-family: Consolas, Monaco, &quot;Andale Mono&quot;,
                        &quot;Ubuntu Mono&quot;, monospace;
                      text-align: left;
                      white-space: pre;
                      word-spacing: normal;
                      word-break: normal;
                      word-wrap: normal;
                      line-height: 1.5;
                      -moz-tab-size: 4;
                      -o-tab-size: 4;
                      tab-size: 4;
                      -webkit-hyphens: none;
                      -moz-hyphens: none;
                      -ms-hyphens: none;
                      hyphens: none;
                      padding: 1em;
                      margin: 0;
                      overflow: auto;
                    "
                  ><code class="language-python" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>preprocessing_transforms </span><span class="token" style="color:#a04900">=</span><span> transforms</span><span class="token" style="color:#111b27">.</span><span>Compose</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">[</span><span>
</span><span>    transforms</span><span class="token" style="color:#111b27">.</span><span>ToTensor</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span>
</span><span></span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">)</span></code></pre>
                </div>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  We can now load the images, get predictions on them, and
                  calculate the accuracy.
                </p>
                <div class="MuiBox-root css-dzaqf9">
                  <div class="MuiBox-root css-125pbeb">
                    <button
                      class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho"
                      tabindex="0"
                      type="button"
                    >
                      <svg
                        class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                        focusable="false"
                        aria-hidden="true"
                        viewBox="0 0 24 24"
                        data-testid="ContentCopyIcon"
                      >
                        <path
                          d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"
                        ></path>
                      </svg>
                    </button>
                  </div>
                  <pre
                    style="
                      color: #111b27;
                      background: #e3eaf2;
                      font-family: Consolas, Monaco, &quot;Andale Mono&quot;,
                        &quot;Ubuntu Mono&quot;, monospace;
                      text-align: left;
                      white-space: pre;
                      word-spacing: normal;
                      word-break: normal;
                      word-wrap: normal;
                      line-height: 1.5;
                      -moz-tab-size: 4;
                      -o-tab-size: 4;
                      tab-size: 4;
                      -webkit-hyphens: none;
                      -moz-hyphens: none;
                      -ms-hyphens: none;
                      hyphens: none;
                      padding: 1em;
                      margin: 0;
                      overflow: auto;
                    "
                  ><code class="language-python" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>test_images_dir </span><span class="token" style="color:#a04900">=</span><span> path_join</span><span class="token" style="color:#111b27">(</span><span>data_dir</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;test_images&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>test_images_labels_file_path </span><span class="token" style="color:#a04900">=</span><span> path_join</span><span class="token" style="color:#111b27">(</span><span>data_dir</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;test_images_labels.json&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span><span></span><span class="token" style="color:#a04900">with</span><span> </span><span class="token" style="color:#af00af">open</span><span class="token" style="color:#111b27">(</span><span>test_images_labels_file_path</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&#x27;r&#x27;</span><span class="token" style="color:#111b27">)</span><span> </span><span class="token" style="color:#a04900">as</span><span> test_images_labels_file</span><span class="token" style="color:#111b27">:</span><span>
</span><span>    test_images_labels </span><span class="token" style="color:#a04900">=</span><span> json_load</span><span class="token" style="color:#111b27">(</span><span>test_images_labels_file</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>test_images </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#111b27">]</span><span>
</span><span>test_labels </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#111b27">]</span><span>
</span><span></span><span class="token" style="color:#a04900">for</span><span> image_name </span><span class="token" style="color:#a04900">in</span><span> listdir</span><span class="token" style="color:#111b27">(</span><span>test_images_dir</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>    image_path </span><span class="token" style="color:#a04900">=</span><span> path_join</span><span class="token" style="color:#111b27">(</span><span>test_images_dir</span><span class="token" style="color:#111b27">,</span><span> image_name</span><span class="token" style="color:#111b27">)</span><span>
</span><span>    image </span><span class="token" style="color:#a04900">=</span><span> cv2</span><span class="token" style="color:#111b27">.</span><span>imread</span><span class="token" style="color:#111b27">(</span><span>image_path</span><span class="token" style="color:#111b27">,</span><span> cv2</span><span class="token" style="color:#111b27">.</span><span>IMREAD_GRAYSCALE</span><span class="token" style="color:#111b27">)</span><span>
</span><span>    test_images</span><span class="token" style="color:#111b27">.</span><span>append</span><span class="token" style="color:#111b27">(</span><span>image</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    test_labels</span><span class="token" style="color:#111b27">.</span><span>append</span><span class="token" style="color:#111b27">(</span><span>test_images_labels</span><span class="token" style="color:#111b27">[</span><span>image_name</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span></span><span class="token" style="color:#3c526d"># Preprocess</span><span>
</span><span></span><span class="token" style="color:#a04900">for</span><span> i </span><span class="token" style="color:#a04900">in</span><span> </span><span class="token" style="color:#af00af">range</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#af00af">len</span><span class="token" style="color:#111b27">(</span><span>test_images</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>    test_images</span><span class="token" style="color:#111b27">[</span><span>i</span><span class="token" style="color:#111b27">]</span><span> </span><span class="token" style="color:#a04900">=</span><span> preprocessing_transforms</span><span class="token" style="color:#111b27">(</span><span>test_images</span><span class="token" style="color:#111b27">[</span><span>i</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">)</span><span>
</span><span>    test_images</span><span class="token" style="color:#111b27">[</span><span>i</span><span class="token" style="color:#111b27">]</span><span> </span><span class="token" style="color:#a04900">=</span><span> test_images</span><span class="token" style="color:#111b27">[</span><span>i</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">.</span><span>unsqueeze</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#755f00">0</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span></span><span class="token" style="color:#3c526d"># Predict</span><span>
</span><span>num_correct </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token" style="color:#755f00">0</span><span>
</span><span></span><span class="token" style="color:#a04900">for</span><span> preprocessed_image</span><span class="token" style="color:#111b27">,</span><span> label </span><span class="token" style="color:#a04900">in</span><span> </span><span class="token" style="color:#af00af">zip</span><span class="token" style="color:#111b27">(</span><span>test_images</span><span class="token" style="color:#111b27">,</span><span> test_labels</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>    output </span><span class="token" style="color:#a04900">=</span><span> model</span><span class="token" style="color:#111b27">(</span><span>preprocessed_image</span><span class="token" style="color:#111b27">)</span><span>
</span><span>    prediction </span><span class="token" style="color:#a04900">=</span><span> output</span><span class="token" style="color:#111b27">.</span><span>argmax</span><span class="token" style="color:#111b27">(</span><span>dim</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">1</span><span class="token" style="color:#111b27">,</span><span> keepdim</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">True</span><span class="token" style="color:#111b27">)</span><span>
</span><span>    prediction </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token" style="color:#af00af">int</span><span class="token" style="color:#111b27">(</span><span>prediction</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    num_correct </span><span class="token" style="color:#a04900">+=</span><span> prediction </span><span class="token" style="color:#a04900">==</span><span> label
</span>
<span>accuracy </span><span class="token" style="color:#a04900">=</span><span> num_correct </span><span class="token" style="color:#a04900">/</span><span> </span><span class="token" style="color:#af00af">len</span><span class="token" style="color:#111b27">(</span><span>test_images</span><span class="token" style="color:#111b27">)</span><span>
</span><span></span><span class="token" style="color:#a04900">print</span><span class="token" style="color:#111b27">(</span><span class="token string-interpolation" style="color:#116b00">f&quot;Correct: </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">num_correct</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00"> / </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation" style="color:#af00af">len</span><span class="token string-interpolation interpolation" style="color:#111b27">(</span><span class="token string-interpolation interpolation">test_images</span><span class="token string-interpolation interpolation" style="color:#111b27">)</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">, Accuracy: </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">accuracy</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">&quot;</span><span class="token" style="color:#111b27">)</span></code></pre>
                </div>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  Here&#x27;s the entire
                  <span class="MuiBox-root css-87x4qo">src/test.py</span> file.
                </p>
                <div class="MuiBox-root css-dzaqf9">
                  <div class="MuiBox-root css-125pbeb">
                    <button
                      class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho"
                      tabindex="0"
                      type="button"
                    >
                      <svg
                        class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                        focusable="false"
                        aria-hidden="true"
                        viewBox="0 0 24 24"
                        data-testid="ContentCopyIcon"
                      >
                        <path
                          d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"
                        ></path>
                      </svg>
                    </button>
                  </div>
                  <pre
                    style="
                      color: #111b27;
                      background: #e3eaf2;
                      font-family: Consolas, Monaco, &quot;Andale Mono&quot;,
                        &quot;Ubuntu Mono&quot;, monospace;
                      text-align: left;
                      white-space: pre;
                      word-spacing: normal;
                      word-break: normal;
                      word-wrap: normal;
                      line-height: 1.5;
                      -moz-tab-size: 4;
                      -o-tab-size: 4;
                      tab-size: 4;
                      -webkit-hyphens: none;
                      -moz-hyphens: none;
                      -ms-hyphens: none;
                      hyphens: none;
                      padding: 1em;
                      margin: 0;
                      overflow: auto;
                    "
                  ><code class="language-python" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#a04900">from</span><span> json </span><span class="token" style="color:#a04900">import</span><span> load </span><span class="token" style="color:#a04900">as</span><span> json_load
</span><span></span><span class="token" style="color:#a04900">from</span><span> os </span><span class="token" style="color:#a04900">import</span><span> listdir
</span><span></span><span class="token" style="color:#a04900">from</span><span> os</span><span class="token" style="color:#111b27">.</span><span>path </span><span class="token" style="color:#a04900">import</span><span> join </span><span class="token" style="color:#a04900">as</span><span> path_join
</span>
<span></span><span class="token" style="color:#a04900">import</span><span> cv2
</span><span></span><span class="token" style="color:#a04900">import</span><span> torch
</span><span></span><span class="token" style="color:#a04900">from</span><span> torchvision </span><span class="token" style="color:#a04900">import</span><span> transforms
</span>
<span></span><span class="token" style="color:#a04900">from</span><span> </span><span class="token" style="color:#111b27">.</span><span>config </span><span class="token" style="color:#a04900">import</span><span> data_dir</span><span class="token" style="color:#111b27">,</span><span> models_dir
</span><span></span><span class="token" style="color:#a04900">from</span><span> </span><span class="token" style="color:#111b27">.</span><span>dataset </span><span class="token" style="color:#a04900">import</span><span> data_loaders
</span><span></span><span class="token" style="color:#a04900">from</span><span> </span><span class="token" style="color:#111b27">.</span><span>model </span><span class="token" style="color:#a04900">import</span><span> CNN
</span>
<!-- -->
<span></span><span class="token" style="color:#3c526d"># MODEL_WEIGHTS_FILE_PATH = path_join(models_dir, &quot;training_id&quot;, &quot;epoch-epoch_numbe&quot;)</span><span>
</span><span>MODEL_WEIGHTS_FILE_PATH </span><span class="token" style="color:#a04900">=</span><span> path_join</span><span class="token" style="color:#111b27">(</span><span>models_dir</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;torch---2024-04-23-08-25-15&quot;</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;epoch-9.pt&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<!-- -->
<span></span><span class="token" style="color:#a04900">if</span><span> __name__ </span><span class="token" style="color:#a04900">==</span><span> </span><span class="token" style="color:#116b00">&quot;__main__&quot;</span><span class="token" style="color:#111b27">:</span><span>
</span><span>    device </span><span class="token" style="color:#a04900">=</span><span> torch</span><span class="token" style="color:#111b27">.</span><span>device</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;cuda&quot;</span><span> </span><span class="token" style="color:#a04900">if</span><span> torch</span><span class="token" style="color:#111b27">.</span><span>cuda</span><span class="token" style="color:#111b27">.</span><span>is_available</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span> </span><span class="token" style="color:#a04900">else</span><span> </span><span class="token" style="color:#116b00">&quot;cpu&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    model </span><span class="token" style="color:#a04900">=</span><span> CNN</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span><span>    model </span><span class="token" style="color:#a04900">=</span><span> model</span><span class="token" style="color:#111b27">.</span><span>to</span><span class="token" style="color:#111b27">(</span><span>device</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    model</span><span class="token" style="color:#111b27">.</span><span>load_state_dict</span><span class="token" style="color:#111b27">(</span><span>torch</span><span class="token" style="color:#111b27">.</span><span>load</span><span class="token" style="color:#111b27">(</span><span>MODEL_WEIGHTS_FILE_PATH</span><span class="token" style="color:#111b27">,</span><span> map_location</span><span class="token" style="color:#a04900">=</span><span>device</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    model</span><span class="token" style="color:#111b27">.</span><span class="token" style="color:#af00af">eval</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    </span><span class="token" style="color:#a04900">print</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;Testing on MNIST Test Set&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    num_correct </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token" style="color:#755f00">0</span><span>
</span><span>    </span><span class="token" style="color:#a04900">with</span><span> torch</span><span class="token" style="color:#111b27">.</span><span>no_grad</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>        </span><span class="token" style="color:#a04900">for</span><span> data</span><span class="token" style="color:#111b27">,</span><span> target </span><span class="token" style="color:#a04900">in</span><span> data_loaders</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#116b00">&quot;test&quot;</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">:</span><span>
</span><span>            data </span><span class="token" style="color:#a04900">=</span><span> data</span><span class="token" style="color:#111b27">.</span><span>to</span><span class="token" style="color:#111b27">(</span><span>device</span><span class="token" style="color:#111b27">)</span><span>
</span><span>            target </span><span class="token" style="color:#a04900">=</span><span> target</span><span class="token" style="color:#111b27">.</span><span>to</span><span class="token" style="color:#111b27">(</span><span>device</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>            output </span><span class="token" style="color:#a04900">=</span><span> model</span><span class="token" style="color:#111b27">(</span><span>data</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>            prediction </span><span class="token" style="color:#a04900">=</span><span> output</span><span class="token" style="color:#111b27">.</span><span>argmax</span><span class="token" style="color:#111b27">(</span><span>dim</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">1</span><span class="token" style="color:#111b27">,</span><span> keepdim</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">True</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>            num_correct </span><span class="token" style="color:#a04900">+=</span><span> prediction</span><span class="token" style="color:#111b27">.</span><span>eq</span><span class="token" style="color:#111b27">(</span><span>target</span><span class="token" style="color:#111b27">.</span><span>view_as</span><span class="token" style="color:#111b27">(</span><span>prediction</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">.</span><span class="token" style="color:#af00af">sum</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">.</span><span>item</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    accuracy </span><span class="token" style="color:#a04900">=</span><span> num_correct </span><span class="token" style="color:#a04900">/</span><span> </span><span class="token" style="color:#af00af">len</span><span class="token" style="color:#111b27">(</span><span>data_loaders</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#116b00">&#x27;test&#x27;</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">.</span><span>dataset</span><span class="token" style="color:#111b27">)</span><span>
</span><span>    </span><span class="token" style="color:#a04900">print</span><span class="token" style="color:#111b27">(</span><span class="token string-interpolation" style="color:#116b00">f&quot;    Accuracy: </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">accuracy</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span><span>    </span><span class="token" style="color:#a04900">print</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    </span><span class="token" style="color:#3c526d">### Test on Custom Images</span><span>
</span><span>    preprocessing_transforms </span><span class="token" style="color:#a04900">=</span><span> transforms</span><span class="token" style="color:#111b27">.</span><span>Compose</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">[</span><span>
</span><span>        transforms</span><span class="token" style="color:#111b27">.</span><span>ToTensor</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span>
</span><span>    </span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    </span><span class="token" style="color:#3c526d"># Load Images</span><span>
</span><span>    test_images_dir </span><span class="token" style="color:#a04900">=</span><span> path_join</span><span class="token" style="color:#111b27">(</span><span>data_dir</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;test_images&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    test_images_labels_file_path </span><span class="token" style="color:#a04900">=</span><span> path_join</span><span class="token" style="color:#111b27">(</span><span>data_dir</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;test_images_labels.json&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span><span>    </span><span class="token" style="color:#a04900">with</span><span> </span><span class="token" style="color:#af00af">open</span><span class="token" style="color:#111b27">(</span><span>test_images_labels_file_path</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&#x27;r&#x27;</span><span class="token" style="color:#111b27">)</span><span> </span><span class="token" style="color:#a04900">as</span><span> test_images_labels_file</span><span class="token" style="color:#111b27">:</span><span>
</span><span>        test_images_labels </span><span class="token" style="color:#a04900">=</span><span> json_load</span><span class="token" style="color:#111b27">(</span><span>test_images_labels_file</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    test_images </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#111b27">]</span><span>
</span><span>    test_labels </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#111b27">]</span><span>
</span><span>    </span><span class="token" style="color:#a04900">for</span><span> image_name </span><span class="token" style="color:#a04900">in</span><span> listdir</span><span class="token" style="color:#111b27">(</span><span>test_images_dir</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>        image_path </span><span class="token" style="color:#a04900">=</span><span> path_join</span><span class="token" style="color:#111b27">(</span><span>test_images_dir</span><span class="token" style="color:#111b27">,</span><span> image_name</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        image </span><span class="token" style="color:#a04900">=</span><span> cv2</span><span class="token" style="color:#111b27">.</span><span>imread</span><span class="token" style="color:#111b27">(</span><span>image_path</span><span class="token" style="color:#111b27">,</span><span> cv2</span><span class="token" style="color:#111b27">.</span><span>IMREAD_GRAYSCALE</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        test_images</span><span class="token" style="color:#111b27">.</span><span>append</span><span class="token" style="color:#111b27">(</span><span>image</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        test_labels</span><span class="token" style="color:#111b27">.</span><span>append</span><span class="token" style="color:#111b27">(</span><span>test_images_labels</span><span class="token" style="color:#111b27">[</span><span>image_name</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    </span><span class="token" style="color:#3c526d"># Preprocess</span><span>
</span><span>    </span><span class="token" style="color:#a04900">for</span><span> i </span><span class="token" style="color:#a04900">in</span><span> </span><span class="token" style="color:#af00af">range</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#af00af">len</span><span class="token" style="color:#111b27">(</span><span>test_images</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>        test_images</span><span class="token" style="color:#111b27">[</span><span>i</span><span class="token" style="color:#111b27">]</span><span> </span><span class="token" style="color:#a04900">=</span><span> preprocessing_transforms</span><span class="token" style="color:#111b27">(</span><span>test_images</span><span class="token" style="color:#111b27">[</span><span>i</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        test_images</span><span class="token" style="color:#111b27">[</span><span>i</span><span class="token" style="color:#111b27">]</span><span> </span><span class="token" style="color:#a04900">=</span><span> test_images</span><span class="token" style="color:#111b27">[</span><span>i</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">.</span><span>unsqueeze</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#755f00">0</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    </span><span class="token" style="color:#3c526d"># Predict</span><span>
</span><span>    num_correct </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token" style="color:#755f00">0</span><span>
</span><span>    </span><span class="token" style="color:#a04900">for</span><span> preprocessed_image</span><span class="token" style="color:#111b27">,</span><span> label </span><span class="token" style="color:#a04900">in</span><span> </span><span class="token" style="color:#af00af">zip</span><span class="token" style="color:#111b27">(</span><span>test_images</span><span class="token" style="color:#111b27">,</span><span> test_labels</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>        output </span><span class="token" style="color:#a04900">=</span><span> model</span><span class="token" style="color:#111b27">(</span><span>preprocessed_image</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        prediction </span><span class="token" style="color:#a04900">=</span><span> output</span><span class="token" style="color:#111b27">.</span><span>argmax</span><span class="token" style="color:#111b27">(</span><span>dim</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">1</span><span class="token" style="color:#111b27">,</span><span> keepdim</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">True</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        prediction </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token" style="color:#af00af">int</span><span class="token" style="color:#111b27">(</span><span>prediction</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        num_correct </span><span class="token" style="color:#a04900">+=</span><span> prediction </span><span class="token" style="color:#a04900">==</span><span> label
</span>
<span>    accuracy </span><span class="token" style="color:#a04900">=</span><span> num_correct </span><span class="token" style="color:#a04900">/</span><span> </span><span class="token" style="color:#af00af">len</span><span class="token" style="color:#111b27">(</span><span>test_images</span><span class="token" style="color:#111b27">)</span><span>
</span><span>    </span><span class="token" style="color:#a04900">print</span><span class="token" style="color:#111b27">(</span><span class="token string-interpolation" style="color:#116b00">f&quot;Correct: </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">num_correct</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00"> / </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation" style="color:#af00af">len</span><span class="token string-interpolation interpolation" style="color:#111b27">(</span><span class="token string-interpolation interpolation">test_images</span><span class="token string-interpolation interpolation" style="color:#111b27">)</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">, Accuracy: </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">accuracy</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">&quot;</span><span class="token" style="color:#111b27">)</span></code></pre>
                </div>
                <h2
                  class="MuiTypography-root MuiTypography-h5 css-1oj41as"
                  id="conversion-to-onnx"
                >
                  <strong>Conversion to ONNX</strong>
                </h2>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  Inside the
                  <span class="MuiBox-root css-87x4qo">src</span> folder, create
                  another folder called
                  <span class="MuiBox-root css-87x4qo">converters</span> and in
                  it create a file called
                  <span class="MuiBox-root css-87x4qo">converter_onnx.py</span>.
                </p>
                <div class="MuiBox-root css-dzaqf9">
                  <div class="MuiBox-root css-125pbeb">
                    <button
                      class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho"
                      tabindex="0"
                      type="button"
                    >
                      <svg
                        class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv"
                        focusable="false"
                        aria-hidden="true"
                        viewBox="0 0 24 24"
                        data-testid="ContentCopyIcon"
                      >
                        <path
                          d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"
                        ></path>
                      </svg>
                    </button>
                  </div>
                  <pre
                    style="
                      color: #111b27;
                      background: #e3eaf2;
                      font-family: Consolas, Monaco, &quot;Andale Mono&quot;,
                        &quot;Ubuntu Mono&quot;, monospace;
                      text-align: left;
                      white-space: pre;
                      word-spacing: normal;
                      word-break: normal;
                      word-wrap: normal;
                      line-height: 1.5;
                      -moz-tab-size: 4;
                      -o-tab-size: 4;
                      tab-size: 4;
                      -webkit-hyphens: none;
                      -moz-hyphens: none;
                      -ms-hyphens: none;
                      hyphens: none;
                      padding: 1em;
                      margin: 0;
                      overflow: auto;
                    "
                  ><code class="language-python" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#a04900">from</span><span> os</span><span class="token" style="color:#111b27">.</span><span>path </span><span class="token" style="color:#a04900">import</span><span> dirname</span><span class="token" style="color:#111b27">,</span><span> join </span><span class="token" style="color:#a04900">as</span><span> path_join
</span>
<span></span><span class="token" style="color:#a04900">import</span><span> torch
</span>
<span></span><span class="token" style="color:#a04900">from</span><span> </span><span class="token" style="color:#111b27">.</span><span class="token" style="color:#111b27">.</span><span>config </span><span class="token" style="color:#a04900">import</span><span> models_dir
</span><span></span><span class="token" style="color:#a04900">from</span><span> </span><span class="token" style="color:#111b27">.</span><span class="token" style="color:#111b27">.</span><span>dataset </span><span class="token" style="color:#a04900">import</span><span> data_loaders
</span><span></span><span class="token" style="color:#a04900">from</span><span> </span><span class="token" style="color:#111b27">.</span><span class="token" style="color:#111b27">.</span><span>model </span><span class="token" style="color:#a04900">import</span><span> CNN
</span>
<!-- -->
<span></span><span class="token" style="color:#3c526d"># MODEL_WEIGHTS_FILE_PATH = path_join(models_dir, &quot;training_id&quot;, &quot;epoch-epoch_numbe&quot;)</span><span>
</span><span>MODEL_WEIGHTS_FILE_PATH </span><span class="token" style="color:#a04900">=</span><span> path_join</span><span class="token" style="color:#111b27">(</span><span>models_dir</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;torch---2024-04-23-08-25-15&quot;</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;epoch-9.pt&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span><span>ONNX_MODEL_FILE_PATH </span><span class="token" style="color:#a04900">=</span><span> path_join</span><span class="token" style="color:#111b27">(</span><span>dirname</span><span class="token" style="color:#111b27">(</span><span>MODEL_WEIGHTS_FILE_PATH</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;model.onnx&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<!-- -->
<span></span><span class="token" style="color:#a04900">if</span><span> __name__ </span><span class="token" style="color:#a04900">==</span><span> </span><span class="token" style="color:#116b00">&quot;__main__&quot;</span><span class="token" style="color:#111b27">:</span><span>
</span><span>    device </span><span class="token" style="color:#a04900">=</span><span> torch</span><span class="token" style="color:#111b27">.</span><span>device</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;cpu&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    torch_model </span><span class="token" style="color:#a04900">=</span><span> CNN</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span><span>    torch_model </span><span class="token" style="color:#a04900">=</span><span> torch_model</span><span class="token" style="color:#111b27">.</span><span>to</span><span class="token" style="color:#111b27">(</span><span>device</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    torch_model</span><span class="token" style="color:#111b27">.</span><span>load_state_dict</span><span class="token" style="color:#111b27">(</span><span>torch</span><span class="token" style="color:#111b27">.</span><span>load</span><span class="token" style="color:#111b27">(</span><span>MODEL_WEIGHTS_FILE_PATH</span><span class="token" style="color:#111b27">,</span><span> map_location</span><span class="token" style="color:#a04900">=</span><span>device</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    torch_model</span><span class="token" style="color:#111b27">.</span><span class="token" style="color:#af00af">eval</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    </span><span class="token" style="color:#a04900">for</span><span> data</span><span class="token" style="color:#111b27">,</span><span> target </span><span class="token" style="color:#a04900">in</span><span> data_loaders</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#116b00">&quot;test&quot;</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">:</span><span>
</span><span>        data </span><span class="token" style="color:#a04900">=</span><span> data</span><span class="token" style="color:#111b27">.</span><span>to</span><span class="token" style="color:#111b27">(</span><span>device</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        target </span><span class="token" style="color:#a04900">=</span><span> target</span><span class="token" style="color:#111b27">.</span><span>to</span><span class="token" style="color:#111b27">(</span><span>device</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        </span><span class="token" style="color:#a04900">break</span><span>
</span>
<span>    sample_input </span><span class="token" style="color:#a04900">=</span><span> data</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#755f00">0</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">.</span><span>unsqueeze</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#755f00">0</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    onnx_model </span><span class="token" style="color:#a04900">=</span><span> torch</span><span class="token" style="color:#111b27">.</span><span>onnx</span><span class="token" style="color:#111b27">.</span><span>dynamo_export</span><span class="token" style="color:#111b27">(</span><span>
</span><span>        torch_model</span><span class="token" style="color:#111b27">,</span><span>
</span>        sample_input
<span>    </span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    onnx_model</span><span class="token" style="color:#111b27">.</span><span>save</span><span class="token" style="color:#111b27">(</span><span>ONNX_MODEL_FILE_PATH</span><span class="token" style="color:#111b27">)</span></code></pre>
                </div>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  We load our model similar to how we load it in the
                  <span class="MuiBox-root css-87x4qo">test.py</span> file, and
                  convert it to ONNX using
                  <a
                    class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover css-1vxruma"
                    href="https://pytorch.org/tutorials/beginner/onnx/export_simple_model_to_onnx_tutorial.html"
                    rel="noopener noreferrer"
                    target="_blank"
                    >torch.onnx.dynamo_export</a
                  >
                  and save it in the same directory as our torch model.
                </p>
                <h1
                  class="MuiTypography-root MuiTypography-h4 css-rg843f"
                  id="conclusion"
                >
                  <strong>Conclusion</strong>
                </h1>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  In this small Post, we have trained a Convolutional Neural
                  Network on the MNIST dataset, tested it on custom images, and
                  exported the model to ONNX. It&#x27;s nothing fancy but
                  we&#x27;ll use this model in some of our following tutorials
                  where we build a website in which the user can draw digits and
                  get the model&#x27;s prediction on the image.
                </p>
                <p class="MuiTypography-root MuiTypography-p css-vsuld9">
                  See you next time :)
                </p>
              </div>
            </div>
          </div>
        </div>
        <style data-emotion="css sdeu8y">
          .css-sdeu8y {
            margin-top: 40px;
            margin-bottom: 40px;
            padding-bottom: 16px;
            width: 100%;
            display: -webkit-box;
            display: -webkit-flex;
            display: -ms-flexbox;
            display: flex;
            -webkit-flex-direction: column;
            -ms-flex-direction: column;
            flex-direction: column;
            -webkit-box-pack: start;
            -ms-flex-pack: start;
            -webkit-justify-content: flex-start;
            justify-content: flex-start;
            -webkit-align-items: center;
            -webkit-box-align: center;
            -ms-flex-align: center;
            align-items: center;
          }
        </style>
        <div class="MuiBox-root css-sdeu8y">
          <style data-emotion="css iyxjf1">
            .css-iyxjf1 {
              box-sizing: border-box;
              display: -webkit-box;
              display: -webkit-flex;
              display: -ms-flexbox;
              display: flex;
              -webkit-box-flex-wrap: wrap;
              -webkit-flex-wrap: wrap;
              -ms-flex-wrap: wrap;
              flex-wrap: wrap;
              width: 100%;
              -webkit-flex-direction: row;
              -ms-flex-direction: row;
              flex-direction: row;
              margin-top: -16px;
              width: calc(100% + 16px);
              margin-left: -16px;
              margin-top: 32px;
              margin-bottom: 32px;
            }
            .css-iyxjf1 > .MuiGrid-item {
              padding-top: 16px;
            }
            .css-iyxjf1 > .MuiGrid-item {
              padding-left: 16px;
            }
          </style>
          <div
            class="MuiGrid-root MuiGrid-container MuiGrid-spacing-xs-2 css-iyxjf1"
          >
            <style data-emotion="css 1etv89n">
              .css-1etv89n {
                box-sizing: border-box;
                margin: 0;
                -webkit-flex-direction: row;
                -ms-flex-direction: row;
                flex-direction: row;
                -webkit-flex-basis: 100%;
                -ms-flex-preferred-size: 100%;
                flex-basis: 100%;
                -webkit-box-flex: 0;
                -webkit-flex-grow: 0;
                -ms-flex-positive: 0;
                flex-grow: 0;
                max-width: 100%;
              }
              @media (min-width: 600px) {
                .css-1etv89n {
                  -webkit-flex-basis: 50%;
                  -ms-flex-preferred-size: 50%;
                  flex-basis: 50%;
                  -webkit-box-flex: 0;
                  -webkit-flex-grow: 0;
                  -ms-flex-positive: 0;
                  flex-grow: 0;
                  max-width: 50%;
                }
              }
              @media (min-width: 900px) {
                .css-1etv89n {
                  -webkit-flex-basis: 33.333333%;
                  -ms-flex-preferred-size: 33.333333%;
                  flex-basis: 33.333333%;
                  -webkit-box-flex: 0;
                  -webkit-flex-grow: 0;
                  -ms-flex-positive: 0;
                  flex-grow: 0;
                  max-width: 33.333333%;
                }
              }
              @media (min-width: 1200px) {
                .css-1etv89n {
                  -webkit-flex-basis: 25%;
                  -ms-flex-preferred-size: 25%;
                  flex-basis: 25%;
                  -webkit-box-flex: 0;
                  -webkit-flex-grow: 0;
                  -ms-flex-positive: 0;
                  flex-grow: 0;
                  max-width: 25%;
                }
              }
              @media (min-width: 1536px) {
                .css-1etv89n {
                  -webkit-flex-basis: 25%;
                  -ms-flex-preferred-size: 25%;
                  flex-basis: 25%;
                  -webkit-box-flex: 0;
                  -webkit-flex-grow: 0;
                  -ms-flex-positive: 0;
                  flex-grow: 0;
                  max-width: 25%;
                }
              }
            </style>
            <div
              class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-12 MuiGrid-grid-sm-6 MuiGrid-grid-md-4 MuiGrid-grid-lg-3 css-1etv89n"
            >
              <a
                style="text-decoration: none"
                href="/ml-ops/tensorflow-training-plus-conversion-to-onnx-and-tfjs/"
                ><style data-emotion="css 1dp4q5j">
                  .css-1dp4q5j {
                    overflow: hidden;
                    width: 100%;
                    height: 100%;
                    box-shadow: 1px 1px 1px 1px "#eeeeee";
                  }
                  .css-1dp4q5j:hover {
                    box-shadow: 3px 3px 3px 3px "#eeeeee";
                    cursor: pointer;
                  }</style
                ><style data-emotion="css ewbf0o">
                  .css-ewbf0o {
                    background-color: #fff;
                    color: rgba(0, 0, 0, 0.87);
                    -webkit-transition: box-shadow 300ms
                      cubic-bezier(0.4, 0, 0.2, 1) 0ms;
                    transition: box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1)
                      0ms;
                    border-radius: 4px;
                    box-shadow:
                      0px 2px 1px -1px rgba(0, 0, 0, 0.2),
                      0px 1px 1px 0px rgba(0, 0, 0, 0.14),
                      0px 1px 3px 0px rgba(0, 0, 0, 0.12);
                    overflow: hidden;
                    width: 100%;
                    height: 100%;
                    box-shadow: 1px 1px 1px 1px "#eeeeee";
                  }
                  .css-ewbf0o:hover {
                    box-shadow: 3px 3px 3px 3px "#eeeeee";
                    cursor: pointer;
                  }
                </style>
                <div
                  class="MuiPaper-root MuiPaper-elevation MuiPaper-rounded MuiPaper-elevation1 MuiCard-root css-ewbf0o"
                >
                  <style data-emotion="css 146e5oc">
                    .css-146e5oc {
                      display: block;
                      -webkit-background-size: cover;
                      background-size: cover;
                      background-repeat: no-repeat;
                      -webkit-background-position: center;
                      background-position: center;
                      width: 100%;
                      object-fit: cover;
                      object-fit: cover;
                    }</style
                  ><img
                    class="MuiCardMedia-root MuiCardMedia-media MuiCardMedia-img css-146e5oc"
                    src="/media/images/tensorflow-training-plus-conversion-to-onnx-and-tfjs-thumbnail.jpg"
                    height="150"
                    alt="Training a CNN in TensorFlow and Exporting it to ONNX and TFJS"
                  /><style data-emotion="css 1qw96cp">
                    .css-1qw96cp {
                      padding: 16px;
                    }
                    .css-1qw96cp:last-child {
                      padding-bottom: 24px;
                    }
                  </style>
                  <div class="MuiCardContent-root css-1qw96cp">
                    <style data-emotion="css 4an0mh">
                      .css-4an0mh {
                        margin: 0;
                        font-family: "Roboto", "Helvetica", "Arial", sans-serif;
                        font-weight: 500;
                        font-size: 1.25rem;
                        line-height: 1.6;
                        letter-spacing: 0.0075em;
                        margin-bottom: 0.35em;
                      }
                    </style>
                    <h2
                      class="MuiTypography-root MuiTypography-h6 MuiTypography-gutterBottom css-4an0mh"
                    >
                      <!-- -->Training a CNN in TensorFlow and Exporting it to
                      ONNX and TFJS
                    </h2>
                    <style data-emotion="css r1ev5b">
                      .css-r1ev5b {
                        margin: 0;
                        margin-bottom: 0.35em;
                        overflow: hidden;
                        text-overflow: ellipsis;
                        display: -webkit-box;
                        -webkit-line-clamp: 3;
                        -webkit-box-orient: vertical;
                      }
                    </style>
                    <p
                      class="MuiTypography-root MuiTypography-p MuiTypography-gutterBottom css-r1ev5b"
                    >
                      Learn how to train a simple CNN in TensorFlow and how to
                      convert it to ONNX or TensorFlow.js for deployment.
                    </p>
                    <style data-emotion="css 4jg4rq">
                      .css-4jg4rq {
                        width: 100%;
                        display: -webkit-box;
                        display: -webkit-flex;
                        display: -ms-flexbox;
                        display: flex;
                        -webkit-flex-direction: row;
                        -ms-flex-direction: row;
                        flex-direction: row;
                        -webkit-box-pack: end;
                        -ms-flex-pack: end;
                        -webkit-justify-content: flex-end;
                        justify-content: flex-end;
                        -webkit-align-items: center;
                        -webkit-box-align: center;
                        -ms-flex-align: center;
                        align-items: center;
                      }
                    </style>
                    <div class="MuiBox-root css-4jg4rq">
                      <p
                        class="MuiTypography-root MuiTypography-p MuiTypography-gutterBottom css-mxjm1x"
                      >
                        05m Read
                      </p>
                    </div>
                  </div>
                </div></a
              >
            </div>
          </div>
        </div>
      </div>
      <footer style="margin-top: 25px">
        <style data-emotion="css 1uy1rgq">
          .css-1uy1rgq {
            width: 100%;
            display: -webkit-box;
            display: -webkit-flex;
            display: -ms-flexbox;
            display: flex;
            -webkit-flex-direction: column;
            -ms-flex-direction: column;
            flex-direction: column;
            -webkit-box-pack: start;
            -ms-flex-pack: start;
            -webkit-justify-content: flex-start;
            justify-content: flex-start;
            -webkit-align-items: flex-end;
            -webkit-box-align: flex-end;
            -ms-flex-align: flex-end;
            align-items: flex-end;
            padding-top: 200px;
            border-top: 1px solid black;
          }
        </style>
        <div class="MuiBox-root css-1uy1rgq">
          <img
            src="/media/images/main-contact-email-light.jpg"
            style="width: 250px; height: 27px"
          /><style data-emotion="css 1uk1gs8">
            .css-1uk1gs8 {
              margin: 0;
            }</style
          ><span class="MuiTypography-root MuiTypography-p css-1uk1gs8"
            >We typically reply within 24 hours.</span
          ><style data-emotion="css zq6grw">
            .css-zq6grw {
              margin: 0;
              font-family: "Roboto", "Helvetica", "Arial", sans-serif;
              font-weight: 400;
              font-size: 1.5rem;
              line-height: 1.334;
              letter-spacing: 0em;
            }
          </style>
          <h5 class="MuiTypography-root MuiTypography-h5 css-zq6grw">
             2024
            <!-- -->A Nice Teacher
          </h5>
        </div>
      </footer>
    </div>
    <script
      src="/_next/static/chunks/webpack-83486951edee0db5.js"
      async=""
    ></script>
    <script>
      (self.__next_f = self.__next_f || []).push([0]);
      self.__next_f.push([2, null]);
    </script>
    <script>
      self.__next_f.push([
        1,
        '1:HL["/_next/static/css/1d4d01086947be98.css","style"]\n',
      ]);
    </script>
    <script>
      self.__next_f.push([
        1,
        '2:I[5751,[],""]\n5:I[9275,[],""]\n8:I[1343,[],""]\n9:I[6871,["98","static/chunks/98-7f6363f9ac68c942.js","748","static/chunks/748-1f14ee6eb3d7029a.js","271","static/chunks/271-37a22bace913f735.js","185","static/chunks/app/layout-08611f287dda1230.js"],"default"]\na:I[5877,["98","static/chunks/98-7f6363f9ac68c942.js","748","static/chunks/748-1f14ee6eb3d7029a.js","271","static/chunks/271-37a22bace913f735.js","185","static/chunks/app/layout-08611f287dda1230.js"],"default"]\nb:I[902,["98","static/chunks/98-7f6363f9ac68c942.js","748","static/chunks/748-1f14ee6eb3d7029a.js","271","static/chunks/271-37a22bace913f735.js","185","static/chunks/app/layout-08611f287dda1230.js"],""]\nc:I[5218,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],""]\nd:I[2324,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],"default"]\ne:I[2591,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],""]\nf:I[231,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],""]\n10:I[3180,["98","static/c',
      ]);
    </script>
    <script>
      self.__next_f.push([
        1,
        'hunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],""]\n11:I[3245,["98","static/chunks/98-7f6363f9ac68c942.js","748","static/chunks/748-1f14ee6eb3d7029a.js","271","static/chunks/271-37a22bace913f735.js","185","static/chunks/app/layout-08611f287dda1230.js"],"default"]\n13:I[6130,[],""]\n6:["categorySlug","ml-ops","d"]\n7:["postOrSeriesSlug","torch-training-and-conversion-to-onnx","d"]\n14:[]\n',
      ]);
    </script>
    <script>
      self.__next_f.push([
        1,
        '0:[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/1d4d01086947be98.css","precedence":"next","crossOrigin":"$undefined"}]],["$","$L2",null,{"buildId":"WOpoYNfSyePVsNQIvcvfm","assetPrefix":"","initialCanonicalUrl":"/ml-ops/torch-training-and-conversion-to-onnx/","initialTree":["",{"children":[["categorySlug","ml-ops","d"],{"children":[["postOrSeriesSlug","torch-training-and-conversion-to-onnx","d"],{"children":["__PAGE__?{\\"categorySlug\\":\\"ml-ops\\",\\"postOrSeriesSlug\\":\\"torch-training-and-conversion-to-onnx\\"}",{}]}]}]},"$undefined","$undefined",true],"initialSeedData":["",{"children":[["categorySlug","ml-ops","d"],{"children":[["postOrSeriesSlug","torch-training-and-conversion-to-onnx","d"],{"children":["__PAGE__",{},[["$L3","$L4"],null],null]},["$","$L5",null,{"parallelRouterKey":"children","segmentPath":["children","$6","children","$7","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L8",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}],null]},["$","$L5",null,{"parallelRouterKey":"children","segmentPath":["children","$6","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L8",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}],null]},[["$","html",null,{"lang":"en","suppressHydrationWarning":true,"children":["$","body",null,{"className":"__className_d65c78","children":["$","$L9",null,{"children":[["$","$La",null,{}],["$","$Lb",null,{"maxWidth":"lg","children":[["$","$L5",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L8",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":["$","$Lc",null,{"children":[["$","$Ld",null,{"render":false,"targetSiteNavigationState":[],"targetPageNavigationState":[]}],["$","$Le",null,{"variant":"h4","children":["$","strong",null,{"children":"Not Found"}]}],["$","$Le",null,{"variant":"h6","mb":3,"children":"Oops! It looks like the page you\'re looking for does not exist."}],["$","$Lf",null,{"href":"/","children":["$","$L10",null,{"variant":"contained","sx":{"marginRight":5,"marginBottom":1},"children":"Take me Home"}]}]]}],"notFoundStyles":[],"styles":null}],["$","$L11",null,{}]]}]]}]}]}],null],null],"couldBeIntercepted":false,"initialHead":[false,"$L12"],"globalErrorComponent":"$13","missingSlots":"$W14"}]]\n',
      ]);
    </script>
    <script>
      self.__next_f.push([
        1,
        '12:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","1",{"charSet":"utf-8"}],["$","link","2",{"rel":"icon","href":"/favicon.ico","type":"image/x-icon","sizes":"16x16"}]]\n3:null\n',
      ]);
    </script>
    <script>
      self.__next_f.push([
        1,
        '15:I[3507,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],""]\n17:I[4204,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],"default"]\n18:I[1847,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],"default"]\n19:I[8125,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],""]\n1a:I[3578,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],"default"]\n1b:I[7005,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],""]\n1c:I[',
      ]);
    </script>
    <script>
      self.__next_f.push([
        1,
        '6480,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],"default"]\n1d:Ta49,',
      ]);
    </script>
    <script>
      self.__next_f.push([
        1,
        'from datetime import datetime\nfrom os import makedirs\nfrom os.path import join\n\nimport torch\nimport torch.nn as nn\nimport torch.optim as optim\n\nfrom .config import config, models_dir\nfrom .dataset import data_loaders\nfrom .model import CNN\n\n\nclass ModelTrainer:\n    def __init__(self):\n        self.training_id = "torch---" + datetime.now().strftime("%Y-%m-%d-%H-%M-%S")\n\n        self.device = torch.device("cuda" if torch.cuda.is_available() else "cpu")\n\n        self.model = CNN()\n        self.model = self.model.to(self.device)\n\n        self.optimizer = optim.Adam(self.model.parameters(), lr=config[\'learning_rate\'])\n        self.loss_fn = nn.CrossEntropyLoss()\n\n        self.models_dir = join(models_dir, self.training_id)\n        makedirs(self.models_dir, exist_ok=False)\n\n    def train_single_epoch(self):\n        self.model.train()\n\n        for batch_index, (data, target) in enumerate(data_loaders["train"]):\n            data = data.to(self.device)\n            target = target.to(self.device)\n\n            self.optimizer.zero_grad()\n\n            output = self.model(data)\n\n            loss = self.loss_fn(output, target)\n            loss.backward()\n\n            self.optimizer.step()\n\n            if batch_index % config[\'log_batch_interval\'] == 0:\n                print(f"    {batch_index} / {len(data_loaders[\'train\'])}")\n\n    def test(self):\n        self.model.eval()\n\n        sum_test_loss = 0\n        num_correct = 0\n\n        with torch.no_grad():\n            for data, target in data_loaders["test"]:\n                data = data.to(self.device)\n                target = target.to(self.device)\n\n                output = self.model(data)\n\n                sum_test_loss += self.loss_fn(output, target).item()\n\n                prediction = output.argmax(dim=1, keepdim=True)\n\n                num_correct += prediction.eq(target.view_as(prediction)).sum().item()\n\n        average_test_loss = sum_test_loss / len(data_loaders[\'test\'].dataset)\n        accuracy = num_correct / len(data_loaders[\'test\'].dataset)\n\n        print(f"    Average loss: {average_test_loss}")\n        print(f"    Accuracy: {accuracy}")\n\n    def save_weights(self, file_path):\n        torch.save(self.model.state_dict(), file_path)\n\n    def train(self):\n        for epoch_index in range(config[\'training_num_epochs\']):\n            print(f"Epoch: {epoch_index}")\n            self.train_single_epoch()\n\n            model_save_file_path = join(self.models_dir, f"epoch-{epoch_index}.pt")\n            self.save_weights(model_save_file_path)\n\n            self.test()\n\n\nif __name__ == "__main__":\n    model_trainer = ModelTrainer()\n    model_trainer.train()',
      ]);
    </script>
    <script>
      self.__next_f.push([
        1,
        '1e:T433,test_images_dir = path_join(data_dir, "test_images")\n\ntest_images_labels_file_path = path_join(data_dir, "test_images_labels.json")\nwith open(test_images_labels_file_path, \'r\') as test_images_labels_file:\n    test_images_labels = json_load(test_images_labels_file)\n\ntest_images = []\ntest_labels = []\nfor image_name in listdir(test_images_dir):\n    image_path = path_join(test_images_dir, image_name)\n    image = cv2.imread(image_path, cv2.IMREAD_GRAYSCALE)\n    test_images.append(image)\n\n    test_labels.append(test_images_labels[image_name])\n\n# Preprocess\nfor i in range(len(test_images)):\n    test_images[i] = preprocessing_transforms(test_images[i])\n    test_images[i] = test_images[i].unsqueeze(0)\n\n# Predict\nnum_correct = 0\nfor preprocessed_image, label in zip(test_images, test_labels):\n    output = model(preprocessed_image)\n    prediction = output.argmax(dim=1, keepdim=True)\n    prediction = int(prediction)\n\n    num_correct += prediction == label\n\naccuracy = num_correct / len(test_images)\nprint(f"Correct: {num_correct} / {len(test_images)}, Accuracy: {accuracy}")1f:T9c9,',
      ]);
    </script>
    <script>
      self.__next_f.push([
        1,
        'from json import load as json_load\nfrom os import listdir\nfrom os.path import join as path_join\n\nimport cv2\nimport torch\nfrom torchvision import transforms\n\nfrom .config import data_dir, models_dir\nfrom .dataset import data_loaders\nfrom .model import CNN\n\n\n# MODEL_WEIGHTS_FILE_PATH = path_join(models_dir, "training_id", "epoch-epoch_numbe")\nMODEL_WEIGHTS_FILE_PATH = path_join(models_dir, "torch---2024-04-23-08-25-15", "epoch-9.pt")\n\n\nif __name__ == "__main__":\n    device = torch.device("cuda" if torch.cuda.is_available() else "cpu")\n\n    model = CNN()\n    model = model.to(device)\n\n    model.load_state_dict(torch.load(MODEL_WEIGHTS_FILE_PATH, map_location=device))\n\n    model.eval()\n\n    print("Testing on MNIST Test Set")\n\n    num_correct = 0\n    with torch.no_grad():\n        for data, target in data_loaders["test"]:\n            data = data.to(device)\n            target = target.to(device)\n\n            output = model(data)\n\n            prediction = output.argmax(dim=1, keepdim=True)\n\n            num_correct += prediction.eq(target.view_as(prediction)).sum().item()\n\n    accuracy = num_correct / len(data_loaders[\'test\'].dataset)\n    print(f"    Accuracy: {accuracy}")\n    print()\n\n    ### Test on Custom Images\n    preprocessing_transforms = transforms.Compose([\n        transforms.ToTensor(),\n    ])\n\n    # Load Images\n    test_images_dir = path_join(data_dir, "test_images")\n\n    test_images_labels_file_path = path_join(data_dir, "test_images_labels.json")\n    with open(test_images_labels_file_path, \'r\') as test_images_labels_file:\n        test_images_labels = json_load(test_images_labels_file)\n\n    test_images = []\n    test_labels = []\n    for image_name in listdir(test_images_dir):\n        image_path = path_join(test_images_dir, image_name)\n        image = cv2.imread(image_path, cv2.IMREAD_GRAYSCALE)\n        test_images.append(image)\n\n        test_labels.append(test_images_labels[image_name])\n\n    # Preprocess\n    for i in range(len(test_images)):\n        test_images[i] = preprocessing_transforms(test_images[i])\n        test_images[i] = test_images[i].unsqueeze(0)\n\n    # Predict\n    num_correct = 0\n    for preprocessed_image, label in zip(test_images, test_labels):\n        output = model(preprocessed_image)\n        prediction = output.argmax(dim=1, keepdim=True)\n        prediction = int(prediction)\n\n        num_correct += prediction == label\n\n    accuracy = num_correct / len(test_images)\n    print(f"Correct: {num_correct} / {len(test_images)}, Accuracy: {accuracy}")',
      ]);
    </script>
    <script>
      self.__next_f.push([
        1,
        '4:["$","$Lc",null,{"mb":5,"pb":2,"sx":{"width":"100%","display":"flex","flexDirection":"column","justifyContent":"flex-start","alignItems":"flex-start"},"children":[["$","$Ld",null,{"render":true,"targetSiteNavigationState":[{"absoluteSlug":"/ml-ops","title":"ML Ops"},{"absoluteSlug":"/ml-ops/torch-training-and-conversion-to-onnx","title":"Training a CNN in PyTorch and Exporting it to ONNX"}],"targetPageNavigationState":[{"title":"The Code","absoluteSlug":"#the-code"},{"title":"Configuration","absoluteSlug":"#configuration"},{"title":"Loading the Dataset","absoluteSlug":"#loading-the-dataset"},{"title":"The Model","absoluteSlug":"#the-model"},{"title":"Training","absoluteSlug":"#training"},{"title":"Testing","absoluteSlug":"#testing"},{"title":"Testing on MNIST Test Data","absoluteSlug":"#testing-on-mnist-test-data"},{"title":"Testing on Custom Images","absoluteSlug":"#testing-on-custom-images"},{"title":"Conversion to ONNX","absoluteSlug":"#conversion-to-onnx"},{"title":"Conclusion","absoluteSlug":"#conclusion"}]}],["$","$L15",null,{"container":true,"spacing":2,"mb":0,"children":[["$","$L15",null,{"item":true,"xs":12,"sm":12,"md":4,"sx":{"background":"linear-gradient(to right, #eeeeee, #ffffff)","borderRadius":5},"children":["$","$Lc",null,{"sx":{"width":"100%","height":"100%","display":"flex","flexDirection":"column","justifyContent":"center","alignItems":"flex-start","paddingBottom":2},"children":[["$","$Le",null,{"gutterBottom":true,"variant":"h5","component":"h1","children":"Training a CNN in PyTorch and Exporting it to ONNX"}],["$","$Le",null,{"gutterBottom":true,"variant":"p","component":"p","mb":4,"children":"Learn how to train a simple CNN in PyTorch and how to convert it to ONNX for deployment."}],["$","$Lc",null,{"sx":{"width":"100%","display":"flex","flexDirection":"row","justifyContent":"space-between","alignItems":"center","marginBottom":2},"children":[["$","$Le",null,{"gutterBottom":true,"variant":"p","component":"p","children":"July 26, 2024"}],["$","$Le",null,{"gutterBottom":true,"variant":"p","component":"p","children":["07m"," Read"]}]]}],"$L16",false]}]}],["$","$L15",null,{"item":true,"xs":12,"sm":12,"md":8,"children":["$","$Lc",null,{"sx":{"flex":1,"display":"flex","flexDirection":"column","justifyContent":"center","alignItems":"center","marginRight":2},"children":["$","img",null,{"src":"/media/images/torch-training-and-conversion-to-onnx-thumbnail.jpg","style":{"width":"100%","maxWidth":"75vw","height":"auto","maxHeight":"35vh","objectFit":"cover"}}]}]}]]}],["$","$Lc",null,{"sx":{"width":"100%"},"children":["$","$L15",null,{"container":true,"spacing":2,"mt":4,"mb":0,"children":[["$","$L15",null,{"item":true,"xs":12,"sm":12,"md":4,"lg":3,"sx":{"background":"linear-gradient(to right, #eeeeee, #ffffff)","borderRadius":5},"children":["$","$Lc",null,{"sx":{"width":"100%"},"children":[["$","$Lc",null,{"sx":{"width":"100%","display":{"xs":"block","md":"none"},"marginBottom":2},"children":["$","$L17",null,{"sx":{"width":"100%","marginBottom":2,"boxShadow":3,"backgroundColor":"#ffffff22"},"disableGutters":true,"children":[["$","$L18",null,{"expandIcon":["$","$L19",null,{}],"children":["$","$Le",null,{"variant":"h6","component":"h6","sx":{"margin":0,"padding":0},"children":"Table of Contents"}]}],["$","$L1a",null,{"sx":{"width":"90%","display":"flex","flexDirection":"column","justifyContent":"flex-start","alignItems":"flex-start","marginBottom":2},"children":[["$","a","0",{"href":"#the-code","style":{"textDecoration":"none","color":"inherit","\u0026:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Le","0",{"variant":"p","component":"p","ml":0,"mb":2.5,"sx":{"\u0026:hover":{"color":"blue"}},"children":"The Code"}]}],["$","a","1",{"href":"#configuration","style":{"textDecoration":"none","color":"inherit","\u0026:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Le","1",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"\u0026:hover":{"color":"blue"}},"children":"Configuration"}]}],["$","a","2",{"href":"#loading-the-dataset","style":{"textDecoration":"none","color":"inherit","\u0026:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Le","2",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"\u0026:hover":{"color":"blue"}},"children":"Loading the Dataset"}]}],["$","a","3",{"href":"#the-model","style":{"textDecoration":"none","color":"inherit","\u0026:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Le","3",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"\u0026:hover":{"color":"blue"}},"children":"The Model"}]}],["$","a","4",{"href":"#training","style":{"textDecoration":"none","color":"inherit","\u0026:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Le","4",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"\u0026:hover":{"color":"blue"}},"children":"Training"}]}],["$","a","5",{"href":"#testing","style":{"textDecoration":"none","color":"inherit","\u0026:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Le","5",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"\u0026:hover":{"color":"blue"}},"children":"Testing"}]}],["$","a","6",{"href":"#testing-on-mnist-test-data","style":{"textDecoration":"none","color":"inherit","\u0026:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Le","6",{"variant":"p","component":"p","ml":2,"mb":1.5,"sx":{"\u0026:hover":{"color":"blue"}},"children":"Testing on MNIST Test Data"}]}],["$","a","7",{"href":"#testing-on-custom-images","style":{"textDecoration":"none","color":"inherit","\u0026:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Le","7",{"variant":"p","component":"p","ml":2,"mb":1.5,"sx":{"\u0026:hover":{"color":"blue"}},"children":"Testing on Custom Images"}]}],["$","a","8",{"href":"#conversion-to-onnx","style":{"textDecoration":"none","color":"inherit","\u0026:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Le","8",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"\u0026:hover":{"color":"blue"}},"children":"Conversion to ONNX"}]}],["$","a","9",{"href":"#conclusion","style":{"textDecoration":"none","color":"inherit","\u0026:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Le","9",{"variant":"p","component":"p","ml":0,"mb":2.5,"sx":{"\u0026:hover":{"color":"blue"}},"children":"Conclusion"}]}]]}]]}]}],["$","$Lc",null,{"sx":{"width":"100%","display":{"xs":"none","md":"block"}},"children":[["$","$Le",null,{"variant":"h5","component":"h5","sx":{"margin":0,"padding":0},"children":"Table of Contents"}],[["$","a","0",{"href":"#the-code","style":{"textDecoration":"none","color":"inherit","\u0026:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Le","0",{"variant":"p","component":"p","ml":0,"mb":2.5,"sx":{"\u0026:hover":{"color":"blue"}},"children":"The Code"}]}],["$","a","1",{"href":"#configuration","style":{"textDecoration":"none","color":"inherit","\u0026:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Le","1",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"\u0026:hover":{"color":"blue"}},"children":"Configuration"}]}],["$","a","2",{"href":"#loading-the-dataset","style":{"textDecoration":"none","color":"inherit","\u0026:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Le","2",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"\u0026:hover":{"color":"blue"}},"children":"Loading the Dataset"}]}],["$","a","3",{"href":"#the-model","style":{"textDecoration":"none","color":"inherit","\u0026:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Le","3",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"\u0026:hover":{"color":"blue"}},"children":"The Model"}]}],["$","a","4",{"href":"#training","style":{"textDecoration":"none","color":"inherit","\u0026:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Le","4",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"\u0026:hover":{"color":"blue"}},"children":"Training"}]}],["$","a","5",{"href":"#testing","style":{"textDecoration":"none","color":"inherit","\u0026:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Le","5",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"\u0026:hover":{"color":"blue"}},"children":"Testing"}]}],["$","a","6",{"href":"#testing-on-mnist-test-data","style":{"textDecoration":"none","color":"inherit","\u0026:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Le","6",{"variant":"p","component":"p","ml":2,"mb":1.5,"sx":{"\u0026:hover":{"color":"blue"}},"children":"Testing on MNIST Test Data"}]}],["$","a","7",{"href":"#testing-on-custom-images","style":{"textDecoration":"none","color":"inherit","\u0026:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Le","7",{"variant":"p","component":"p","ml":2,"mb":1.5,"sx":{"\u0026:hover":{"color":"blue"}},"children":"Testing on Custom Images"}]}],["$","a","8",{"href":"#conversion-to-onnx","style":{"textDecoration":"none","color":"inherit","\u0026:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Le","8",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"\u0026:hover":{"color":"blue"}},"children":"Conversion to ONNX"}]}],["$","a","9",{"href":"#conclusion","style":{"textDecoration":"none","color":"inherit","\u0026:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Le","9",{"variant":"p","component":"p","ml":0,"mb":2.5,"sx":{"\u0026:hover":{"color":"blue"}},"children":"Conclusion"}]}]]]}]]}]}],["$","$L15",null,{"item":true,"xs":12,"sm":12,"md":8,"lg":9,"sx":{"background":"linear-gradient(to right, #ffffff, #eeeeee)","borderRadius":5},"children":["$","$Lc",null,{"sx":{"flex":1,"marginRight":2},"children":[["$","$Le","0",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","In this article, we\'ll create a very basic CNN using PyTorch that will serve as a baseline for the various deployment methods we\'ll be going over in future Blog Posts. Today, we\'ll make a CNN (Convolutional Neural Network) that can recognize handwritten digits (0 to 9) trained using the ",["$","$L1b","0-link",{"href":"https://en.wikipedia.org/wiki/MNIST_database","rel":"noopener noreferrer","target":"_blank","color":"primary","underline":"hover","children":"MNIST dataset"}],". We\'ll also export our model to ",["$","$L1b","0-link",{"href":"https://onnx.ai/","rel":"noopener noreferrer","target":"_blank","color":"primary","underline":"hover","children":"ONNX"}],", this way it can be used with any language that has an ",["$","$L1b","0-link",{"href":"https://onnxruntime.ai/","rel":"noopener noreferrer","target":"_blank","color":"primary","underline":"hover","children":"ONNX Runtime"}]," available for it (for example JavaScript)."]}],["$","$Le","1",{"id":"the-code","variant":"h4","component":"h1","mb":2,"children":["$","strong",null,{"children":"The Code"}]}],["$","$Le","2",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Here\'s the directory structure of the codebase we\'ll be creating."]}],["$","$Lc",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L1c",null,{"contentToCopy":"   config.yaml\\n   requirements.txt\\n\\ndata\\nmodels\\nsrc\\n       config.py\\n       dataset.py\\n       model.py\\n       test.py\\n       train.py\\n    \\n    converters\\n            converter_onnx.py"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-bash","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"$undefined","style":{},"children":["   config.yaml\\n"]}],"   requirements.txt\\n","\\n","data\\n","models\\n","src\\n","       config.py\\n","       dataset.py\\n","       model.py\\n","       test.py\\n","       train.py\\n","    \\n","    converters\\n","            converter_onnx.py"]]}]}]]}],["$","$Le","4",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","We have the ",["$","$Lc","4-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"config"}]," and ",["$","$Lc","4-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"requirements"}]," files that define our training and testing configuration and the project\'s required packages respectively."]}],["$","$Le","5",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","The ",["$","$Lc","5-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"data"}]," directory will be used to store the dataset that PyTorch will download for us and we\'ll store our model weights in the ",["$","$Lc","5-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"models"}]," directory. The ",["$","$Lc","5-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"src"}]," directory contains our codebase."]}],["$","$Le","6",{"id":"configuration","variant":"h5","component":"h2","mb":2,"children":["$","strong",null,{"children":"Configuration"}]}],["$","$Le","7",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Let\'s create the ",["$","$Lc","7-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"config.yaml"}]," file to define the training and testing config."]}],["$","$Lc",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L1c",null,{"contentToCopy":"training_num_epochs: 10\\ntraining_save_weights_epoch_interval: 1\\ntraining_batch_size: 100\\nlearning_rate: 0.001\\ntesting_batch_size: 100\\nlog_batch_interval: 100"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-yaml","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#005a8e"},"children":["training_num_epochs"]}],["$","span","code-segement1",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement2",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement3",{"className":"token","style":{"color":"#755f00"},"children":["10"]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement5",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement6",{"className":"token","style":{"color":"#005a8e"},"children":["training_save_weights_epoch_interval"]}],["$","span","code-segement7",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement9",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement11",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement12",{"className":"token","style":{"color":"#005a8e"},"children":["training_batch_size"]}],["$","span","code-segement13",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement14",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement15",{"className":"token","style":{"color":"#755f00"},"children":["100"]}],["$","span","code-segement16",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement17",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement18",{"className":"token","style":{"color":"#005a8e"},"children":["learning_rate"]}],["$","span","code-segement19",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement20",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement21",{"className":"token","style":{"color":"#755f00"},"children":["0.001"]}],["$","span","code-segement22",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement23",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement24",{"className":"token","style":{"color":"#005a8e"},"children":["testing_batch_size"]}],["$","span","code-segement25",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement27",{"className":"token","style":{"color":"#755f00"},"children":["100"]}],["$","span","code-segement28",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement29",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement30",{"className":"token","style":{"color":"#005a8e"},"children":["log_batch_interval"]}],["$","span","code-segement31",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement32",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement33",{"className":"token","style":{"color":"#755f00"},"children":["100"]}]]]}]}]]}],["$","$Le","9",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Next, we create the ",["$","$Lc","9-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"src/config.py"}]," file that loads this configuration into Python and also defines some directory paths for our convenience."]}],["$","$Lc",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L1c",null,{"contentToCopy":"from os.path import dirname, join as path_join\\nfrom yaml import FullLoader as yaml_FullLoader, load as yaml_load\\n\\n\\nconfig_file_path = path_join(dirname(dirname(__file__)), \\"config.yaml\\")\\nwith open(config_file_path, \\"r\\") as model_params_file:\\n    config = yaml_load(model_params_file, Loader=yaml_FullLoader)\\n\\nmodels_dir = path_join(dirname(dirname(__file__)), \\"models\\")\\ndata_dir = path_join(dirname(dirname(__file__)), \\"data\\")"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" os"]}],["$","span","code-segement2",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":["path "]}],["$","span","code-segement4",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement5",{"className":"$undefined","style":{},"children":[" dirname"]}],["$","span","code-segement6",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement7",{"className":"$undefined","style":{},"children":[" join "]}],["$","span","code-segement8",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement9",{"className":"$undefined","style":{},"children":[" path_join\\n"]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement11",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement12",{"className":"$undefined","style":{},"children":[" yaml "]}],["$","span","code-segement13",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement14",{"className":"$undefined","style":{},"children":[" FullLoader "]}],["$","span","code-segement15",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement16",{"className":"$undefined","style":{},"children":[" yaml_FullLoader"]}],["$","span","code-segement17",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement18",{"className":"$undefined","style":{},"children":[" load "]}],["$","span","code-segement19",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement20",{"className":"$undefined","style":{},"children":[" yaml_load\\n"]}],"\\n","\\n",["$","span","code-segement23",{"className":"$undefined","style":{},"children":["config_file_path "]}],["$","span","code-segement24",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement25",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement26",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement27",{"className":"$undefined","style":{},"children":["dirname"]}],["$","span","code-segement28",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement29",{"className":"$undefined","style":{},"children":["dirname"]}],["$","span","code-segement30",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement31",{"className":"$undefined","style":{},"children":["__file__"]}],["$","span","code-segement32",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement33",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement34",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement35",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement36",{"className":"token","style":{"color":"#116b00"},"children":["\\"config.yaml\\""]}],["$","span","code-segement37",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement38",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement39",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement40",{"className":"token","style":{"color":"#a04900"},"children":["with"]}],["$","span","code-segement41",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement42",{"className":"token","style":{"color":"#af00af"},"children":["open"]}],["$","span","code-segement43",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement44",{"className":"$undefined","style":{},"children":["config_file_path"]}],["$","span","code-segement45",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement46",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement47",{"className":"token","style":{"color":"#116b00"},"children":["\\"r\\""]}],["$","span","code-segement48",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement49",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement50",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement51",{"className":"$undefined","style":{},"children":[" model_params_file"]}],["$","span","code-segement52",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement53",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement54",{"className":"$undefined","style":{},"children":["    config "]}],["$","span","code-segement55",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement56",{"className":"$undefined","style":{},"children":[" yaml_load"]}],["$","span","code-segement57",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement58",{"className":"$undefined","style":{},"children":["model_params_file"]}],["$","span","code-segement59",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement60",{"className":"$undefined","style":{},"children":[" Loader"]}],["$","span","code-segement61",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement62",{"className":"$undefined","style":{},"children":["yaml_FullLoader"]}],["$","span","code-segement63",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement64",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement66",{"className":"$undefined","style":{},"children":["models_dir "]}],["$","span","code-segement67",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement68",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement69",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement70",{"className":"$undefined","style":{},"children":["dirname"]}],["$","span","code-segement71",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement72",{"className":"$undefined","style":{},"children":["dirname"]}],["$","span","code-segement73",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement74",{"className":"$undefined","style":{},"children":["__file__"]}],["$","span","code-segement75",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement76",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement77",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement78",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement79",{"className":"token","style":{"color":"#116b00"},"children":["\\"models\\""]}],["$","span","code-segement80",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement81",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement82",{"className":"$undefined","style":{},"children":["data_dir "]}],["$","span","code-segement83",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement84",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement85",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement86",{"className":"$undefined","style":{},"children":["dirname"]}],["$","span","code-segement87",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement88",{"className":"$undefined","style":{},"children":["dirname"]}],["$","span","code-segement89",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement90",{"className":"$undefined","style":{},"children":["__file__"]}],["$","span","code-segement91",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement92",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement93",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement94",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement95",{"className":"token","style":{"color":"#116b00"},"children":["\\"data\\""]}],["$","span","code-segement96",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Le","11",{"id":"loading-the-dataset","variant":"h5","component":"h2","mb":2,"children":["$","strong",null,{"children":"Loading the Dataset"}]}],["$","$Le","12",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Inside the ",["$","$Lc","12-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"src"}]," folder, create a file called ",["$","$Lc","12-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"dataset.py"}],", in which we will define our data loaders."]}],["$","$Lc",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L1c",null,{"contentToCopy":"from torch.utils.data import DataLoader\\nfrom torchvision.datasets import MNIST\\nfrom torchvision.transforms import ToTensor\\n\\nfrom config import config\\n\\n\\ntrain_data = MNIST(\\n    root=\\"data\\",\\n    train=True,\\n    transform=ToTensor(),\\n    download=True\\n)\\n\\ntest_data = MNIST(\\n    root=\\"data\\",\\n    train=False,\\n    transform=ToTensor(),\\n    download=True\\n)\\n\\ndata_loaders = {\\n    \\"train\\": DataLoader(\\n        train_data,\\n        batch_size=config[\'training_batch_size\'],\\n        shuffle=True,\\n        num_workers=1\\n    ),\\n    \\"test\\": DataLoader(\\n        test_data,\\n        batch_size=config[\'testing_batch_size\'],\\n        shuffle=True,\\n        num_workers=1\\n    ),\\n}"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement2",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":["utils"]}],["$","span","code-segement4",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement5",{"className":"$undefined","style":{},"children":["data "]}],["$","span","code-segement6",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement7",{"className":"$undefined","style":{},"children":[" DataLoader\\n"]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement9",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":[" torchvision"]}],["$","span","code-segement11",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement12",{"className":"$undefined","style":{},"children":["datasets "]}],["$","span","code-segement13",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement14",{"className":"$undefined","style":{},"children":[" MNIST\\n"]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement16",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement17",{"className":"$undefined","style":{},"children":[" torchvision"]}],["$","span","code-segement18",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement19",{"className":"$undefined","style":{},"children":["transforms "]}],["$","span","code-segement20",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement21",{"className":"$undefined","style":{},"children":[" ToTensor\\n"]}],"\\n",["$","span","code-segement23",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement24",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement25",{"className":"$undefined","style":{},"children":[" config "]}],["$","span","code-segement26",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement27",{"className":"$undefined","style":{},"children":[" config\\n"]}],"\\n","\\n",["$","span","code-segement30",{"className":"$undefined","style":{},"children":["train_data "]}],["$","span","code-segement31",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement32",{"className":"$undefined","style":{},"children":[" MNIST"]}],["$","span","code-segement33",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement34",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement35",{"className":"$undefined","style":{},"children":["    root"]}],["$","span","code-segement36",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement37",{"className":"token","style":{"color":"#116b00"},"children":["\\"data\\""]}],["$","span","code-segement38",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement39",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement40",{"className":"$undefined","style":{},"children":["    train"]}],["$","span","code-segement41",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement42",{"className":"token","style":{"color":"#755f00"},"children":["True"]}],["$","span","code-segement43",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement44",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement45",{"className":"$undefined","style":{},"children":["    transform"]}],["$","span","code-segement46",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement47",{"className":"$undefined","style":{},"children":["ToTensor"]}],["$","span","code-segement48",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement49",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement50",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement51",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement52",{"className":"$undefined","style":{},"children":["    download"]}],["$","span","code-segement53",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement54",{"className":"token","style":{"color":"#755f00"},"children":["True"]}],["$","span","code-segement55",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement56",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement57",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement58",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement60",{"className":"$undefined","style":{},"children":["test_data "]}],["$","span","code-segement61",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement62",{"className":"$undefined","style":{},"children":[" MNIST"]}],["$","span","code-segement63",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement64",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement65",{"className":"$undefined","style":{},"children":["    root"]}],["$","span","code-segement66",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement67",{"className":"token","style":{"color":"#116b00"},"children":["\\"data\\""]}],["$","span","code-segement68",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement69",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement70",{"className":"$undefined","style":{},"children":["    train"]}],["$","span","code-segement71",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement72",{"className":"token","style":{"color":"#755f00"},"children":["False"]}],["$","span","code-segement73",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement74",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement75",{"className":"$undefined","style":{},"children":["    transform"]}],["$","span","code-segement76",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement77",{"className":"$undefined","style":{},"children":["ToTensor"]}],["$","span","code-segement78",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement79",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement80",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement81",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement82",{"className":"$undefined","style":{},"children":["    download"]}],["$","span","code-segement83",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement84",{"className":"token","style":{"color":"#755f00"},"children":["True"]}],["$","span","code-segement85",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement86",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement87",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement88",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement90",{"className":"$undefined","style":{},"children":["data_loaders "]}],["$","span","code-segement91",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement92",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement93",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement94",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement95",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement96",{"className":"token","style":{"color":"#116b00"},"children":["\\"train\\""]}],["$","span","code-segement97",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement98",{"className":"$undefined","style":{},"children":[" DataLoader"]}],["$","span","code-segement99",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement100",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement101",{"className":"$undefined","style":{},"children":["        train_data"]}],["$","span","code-segement102",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement103",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement104",{"className":"$undefined","style":{},"children":["        batch_size"]}],["$","span","code-segement105",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement106",{"className":"$undefined","style":{},"children":["config"]}],["$","span","code-segement107",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement108",{"className":"token","style":{"color":"#116b00"},"children":["\'training_batch_size\'"]}],["$","span","code-segement109",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement110",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement111",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement112",{"className":"$undefined","style":{},"children":["        shuffle"]}],["$","span","code-segement113",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement114",{"className":"token","style":{"color":"#755f00"},"children":["True"]}],["$","span","code-segement115",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement116",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement117",{"className":"$undefined","style":{},"children":["        num_workers"]}],["$","span","code-segement118",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement119",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement120",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement121",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement122",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement123",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement124",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement125",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement126",{"className":"token","style":{"color":"#116b00"},"children":["\\"test\\""]}],["$","span","code-segement127",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement128",{"className":"$undefined","style":{},"children":[" DataLoader"]}],["$","span","code-segement129",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement130",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement131",{"className":"$undefined","style":{},"children":["        test_data"]}],["$","span","code-segement132",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement133",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement134",{"className":"$undefined","style":{},"children":["        batch_size"]}],["$","span","code-segement135",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement136",{"className":"$undefined","style":{},"children":["config"]}],["$","span","code-segement137",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement138",{"className":"token","style":{"color":"#116b00"},"children":["\'testing_batch_size\'"]}],["$","span","code-segement139",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement140",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement141",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement142",{"className":"$undefined","style":{},"children":["        shuffle"]}],["$","span","code-segement143",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement144",{"className":"token","style":{"color":"#755f00"},"children":["True"]}],["$","span","code-segement145",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement146",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement147",{"className":"$undefined","style":{},"children":["        num_workers"]}],["$","span","code-segement148",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement149",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement150",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement151",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement152",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement153",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement154",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement155",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement156",{"className":"token","style":{"color":"#111b27"},"children":["}"]}]]]}]}]]}],["$","$Le","14",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","The ",["$","$Lc","14-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"torchvision"}]," package allows us easy access to the MNIST dataset using ",["$","$Lc","14-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"torchvision.datasets.MNIST"}],". We first load the training and testing data, which is determined by the ",["$","$Lc","14-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"train"}]," parameter passed to the ",["$","$Lc","14-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"MNIST"}]," constructor. We also call the ",["$","$Lc","14-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"ToTensor"}]," transform on this data."]}],["$","$Le","15",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Then, we define our data loaders which are instances of ",["$","$Lc","15-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"torch.utils.data.DataLoader"}],": one for training and another for testing. Note how the training and testing batch sizes are being loaded from the config."]}],["$","$Le","16",{"id":"the-model","variant":"h5","component":"h2","mb":2,"children":["$","strong",null,{"children":"The Model"}]}],["$","$Le","17",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Next up, let\'s create the architecture of our CNN. In the ",["$","$Lc","17-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"src"}]," folder, create a new file called ",["$","$Lc","17-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"model.py"}],"."]}],["$","$Lc",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L1c",null,{"contentToCopy":"import torch\\nimport torch.nn as nn\\nimport torch.optim as optim\\n\\n\\nclass CNN(nn.Module):\\n    def __init__(self):\\n        super(CNN, self).__init__()\\n\\n        self.conv1 = nn.Conv2d(in_channels=1, out_channels=10, kernel_size=5)\\n        self.pool = nn.MaxPool2d(kernel_size=2, stride=2)\\n        self.conv2 = nn.Conv2d(in_channels=10, out_channels=20, kernel_size=5)\\n        self.dropout = nn.Dropout(p=0.5)\\n        self.fc1 = nn.Linear(20 * 4 * 4, 50)\\n        self.fc2 = nn.Linear(50, 10)\\n\\n    def forward(self, x):\\n        x = self.pool(torch.relu(self.conv1(x)))\\n        x = self.pool(torch.relu(self.conv2(x)))\\n        x = self.dropout(x)\\n        x = x.view(-1, 20 * 4 * 4)  # Flatten the tensor\\n        x = torch.relu(self.fc1(x))\\n        x = self.dropout(x)\\n        x = self.fc2(x)\\n        return torch.softmax(x, dim=1)\\n\\n# Create an instance of the CNN model\\nmodel = CNN()\\n\\n# Define loss function and optimizer\\ncriterion = nn.CrossEntropyLoss()\\noptimizer = optim.Adam(model.parameters(), lr=0.001)"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" torch\\n"]}],["$","span","code-segement2",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement3",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement5",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement6",{"className":"$undefined","style":{},"children":["nn "]}],["$","span","code-segement7",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":[" nn\\n"]}],["$","span","code-segement9",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement10",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement11",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement12",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement13",{"className":"$undefined","style":{},"children":["optim "]}],["$","span","code-segement14",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":[" optim\\n"]}],"\\n","\\n",["$","span","code-segement18",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement19",{"className":"token","style":{"color":"#a04900"},"children":["class"]}],["$","span","code-segement20",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement21",{"className":"token","style":{"color":"#005a8e"},"children":["CNN"]}],["$","span","code-segement22",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement23",{"className":"$undefined","style":{},"children":["nn"]}],["$","span","code-segement24",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement25",{"className":"$undefined","style":{},"children":["Module"]}],["$","span","code-segement26",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement27",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement28",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement29",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement30",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement31",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement32",{"className":"token","style":{"color":"#7c00aa"},"children":["__init__"]}],["$","span","code-segement33",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement34",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement35",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement36",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement37",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement38",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement39",{"className":"token","style":{"color":"#af00af"},"children":["super"]}],["$","span","code-segement40",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement41",{"className":"$undefined","style":{},"children":["CNN"]}],["$","span","code-segement42",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement43",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement44",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement45",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement46",{"className":"$undefined","style":{},"children":["__init__"]}],["$","span","code-segement47",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement48",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement49",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement51",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement52",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement53",{"className":"$undefined","style":{},"children":["conv1 "]}],["$","span","code-segement54",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement55",{"className":"$undefined","style":{},"children":[" nn"]}],["$","span","code-segement56",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement57",{"className":"$undefined","style":{},"children":["Conv2d"]}],["$","span","code-segement58",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement59",{"className":"$undefined","style":{},"children":["in_channels"]}],["$","span","code-segement60",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement61",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement62",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement63",{"className":"$undefined","style":{},"children":[" out_channels"]}],["$","span","code-segement64",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement65",{"className":"token","style":{"color":"#755f00"},"children":["10"]}],["$","span","code-segement66",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement67",{"className":"$undefined","style":{},"children":[" kernel_size"]}],["$","span","code-segement68",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement69",{"className":"token","style":{"color":"#755f00"},"children":["5"]}],["$","span","code-segement70",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement71",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement72",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement73",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement74",{"className":"$undefined","style":{},"children":["pool "]}],["$","span","code-segement75",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement76",{"className":"$undefined","style":{},"children":[" nn"]}],["$","span","code-segement77",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement78",{"className":"$undefined","style":{},"children":["MaxPool2d"]}],["$","span","code-segement79",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement80",{"className":"$undefined","style":{},"children":["kernel_size"]}],["$","span","code-segement81",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement82",{"className":"token","style":{"color":"#755f00"},"children":["2"]}],["$","span","code-segement83",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement84",{"className":"$undefined","style":{},"children":[" stride"]}],["$","span","code-segement85",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement86",{"className":"token","style":{"color":"#755f00"},"children":["2"]}],["$","span","code-segement87",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement88",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement89",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement90",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement91",{"className":"$undefined","style":{},"children":["conv2 "]}],["$","span","code-segement92",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement93",{"className":"$undefined","style":{},"children":[" nn"]}],["$","span","code-segement94",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement95",{"className":"$undefined","style":{},"children":["Conv2d"]}],["$","span","code-segement96",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement97",{"className":"$undefined","style":{},"children":["in_channels"]}],["$","span","code-segement98",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement99",{"className":"token","style":{"color":"#755f00"},"children":["10"]}],["$","span","code-segement100",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement101",{"className":"$undefined","style":{},"children":[" out_channels"]}],["$","span","code-segement102",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement103",{"className":"token","style":{"color":"#755f00"},"children":["20"]}],["$","span","code-segement104",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement105",{"className":"$undefined","style":{},"children":[" kernel_size"]}],["$","span","code-segement106",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement107",{"className":"token","style":{"color":"#755f00"},"children":["5"]}],["$","span","code-segement108",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement109",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement110",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement111",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement112",{"className":"$undefined","style":{},"children":["dropout "]}],["$","span","code-segement113",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement114",{"className":"$undefined","style":{},"children":[" nn"]}],["$","span","code-segement115",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement116",{"className":"$undefined","style":{},"children":["Dropout"]}],["$","span","code-segement117",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement118",{"className":"$undefined","style":{},"children":["p"]}],["$","span","code-segement119",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement120",{"className":"token","style":{"color":"#755f00"},"children":["0.5"]}],["$","span","code-segement121",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement122",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement123",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement124",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement125",{"className":"$undefined","style":{},"children":["fc1 "]}],["$","span","code-segement126",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement127",{"className":"$undefined","style":{},"children":[" nn"]}],["$","span","code-segement128",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement129",{"className":"$undefined","style":{},"children":["Linear"]}],["$","span","code-segement130",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement131",{"className":"token","style":{"color":"#755f00"},"children":["20"]}],["$","span","code-segement132",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement133",{"className":"token","style":{"color":"#a04900"},"children":["*"]}],["$","span","code-segement134",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement135",{"className":"token","style":{"color":"#755f00"},"children":["4"]}],["$","span","code-segement136",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement137",{"className":"token","style":{"color":"#a04900"},"children":["*"]}],["$","span","code-segement138",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement139",{"className":"token","style":{"color":"#755f00"},"children":["4"]}],["$","span","code-segement140",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement141",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement142",{"className":"token","style":{"color":"#755f00"},"children":["50"]}],["$","span","code-segement143",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement144",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement145",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement146",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement147",{"className":"$undefined","style":{},"children":["fc2 "]}],["$","span","code-segement148",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement149",{"className":"$undefined","style":{},"children":[" nn"]}],["$","span","code-segement150",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement151",{"className":"$undefined","style":{},"children":["Linear"]}],["$","span","code-segement152",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement153",{"className":"token","style":{"color":"#755f00"},"children":["50"]}],["$","span","code-segement154",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement155",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement156",{"className":"token","style":{"color":"#755f00"},"children":["10"]}],["$","span","code-segement157",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement158",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement160",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement161",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement162",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement163",{"className":"token","style":{"color":"#7c00aa"},"children":["forward"]}],["$","span","code-segement164",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement165",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement166",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement167",{"className":"$undefined","style":{},"children":[" x"]}],["$","span","code-segement168",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement169",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement170",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement171",{"className":"$undefined","style":{},"children":["        x "]}],["$","span","code-segement172",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement173",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement174",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement175",{"className":"$undefined","style":{},"children":["pool"]}],["$","span","code-segement176",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement177",{"className":"$undefined","style":{},"children":["torch"]}],["$","span","code-segement178",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement179",{"className":"$undefined","style":{},"children":["relu"]}],["$","span","code-segement180",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement181",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement182",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement183",{"className":"$undefined","style":{},"children":["conv1"]}],["$","span","code-segement184",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement185",{"className":"$undefined","style":{},"children":["x"]}],["$","span","code-segement186",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement187",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement188",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement189",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement190",{"className":"$undefined","style":{},"children":["        x "]}],["$","span","code-segement191",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement192",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement193",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement194",{"className":"$undefined","style":{},"children":["pool"]}],["$","span","code-segement195",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement196",{"className":"$undefined","style":{},"children":["torch"]}],["$","span","code-segement197",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement198",{"className":"$undefined","style":{},"children":["relu"]}],["$","span","code-segement199",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement200",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement201",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement202",{"className":"$undefined","style":{},"children":["conv2"]}],["$","span","code-segement203",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement204",{"className":"$undefined","style":{},"children":["x"]}],["$","span","code-segement205",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement206",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement207",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement208",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement209",{"className":"$undefined","style":{},"children":["        x "]}],["$","span","code-segement210",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement211",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement212",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement213",{"className":"$undefined","style":{},"children":["dropout"]}],["$","span","code-segement214",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement215",{"className":"$undefined","style":{},"children":["x"]}],["$","span","code-segement216",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement217",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement218",{"className":"$undefined","style":{},"children":["        x "]}],["$","span","code-segement219",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement220",{"className":"$undefined","style":{},"children":[" x"]}],["$","span","code-segement221",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement222",{"className":"$undefined","style":{},"children":["view"]}],["$","span","code-segement223",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement224",{"className":"token","style":{"color":"#a04900"},"children":["-"]}],["$","span","code-segement225",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement226",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement227",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement228",{"className":"token","style":{"color":"#755f00"},"children":["20"]}],["$","span","code-segement229",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement230",{"className":"token","style":{"color":"#a04900"},"children":["*"]}],["$","span","code-segement231",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement232",{"className":"token","style":{"color":"#755f00"},"children":["4"]}],["$","span","code-segement233",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement234",{"className":"token","style":{"color":"#a04900"},"children":["*"]}],["$","span","code-segement235",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement236",{"className":"token","style":{"color":"#755f00"},"children":["4"]}],["$","span","code-segement237",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement238",{"className":"$undefined","style":{},"children":["  "]}],["$","span","code-segement239",{"className":"token","style":{"color":"#3c526d"},"children":["# Flatten the tensor"]}],["$","span","code-segement240",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement241",{"className":"$undefined","style":{},"children":["        x "]}],["$","span","code-segement242",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement243",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement244",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement245",{"className":"$undefined","style":{},"children":["relu"]}],["$","span","code-segement246",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement247",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement248",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement249",{"className":"$undefined","style":{},"children":["fc1"]}],["$","span","code-segement250",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement251",{"className":"$undefined","style":{},"children":["x"]}],["$","span","code-segement252",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement253",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement254",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement255",{"className":"$undefined","style":{},"children":["        x "]}],["$","span","code-segement256",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement257",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement258",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement259",{"className":"$undefined","style":{},"children":["dropout"]}],["$","span","code-segement260",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement261",{"className":"$undefined","style":{},"children":["x"]}],["$","span","code-segement262",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement263",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement264",{"className":"$undefined","style":{},"children":["        x "]}],["$","span","code-segement265",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement266",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement267",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement268",{"className":"$undefined","style":{},"children":["fc2"]}],["$","span","code-segement269",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement270",{"className":"$undefined","style":{},"children":["x"]}],["$","span","code-segement271",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement272",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement273",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement274",{"className":"token","style":{"color":"#a04900"},"children":["return"]}],["$","span","code-segement275",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement276",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement277",{"className":"$undefined","style":{},"children":["softmax"]}],["$","span","code-segement278",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement279",{"className":"$undefined","style":{},"children":["x"]}],["$","span","code-segement280",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement281",{"className":"$undefined","style":{},"children":[" dim"]}],["$","span","code-segement282",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement283",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement284",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement285",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement287",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement288",{"className":"token","style":{"color":"#3c526d"},"children":["# Create an instance of the CNN model"]}],["$","span","code-segement289",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement290",{"className":"$undefined","style":{},"children":["model "]}],["$","span","code-segement291",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement292",{"className":"$undefined","style":{},"children":[" CNN"]}],["$","span","code-segement293",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement294",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement295",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement297",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement298",{"className":"token","style":{"color":"#3c526d"},"children":["# Define loss function and optimizer"]}],["$","span","code-segement299",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement300",{"className":"$undefined","style":{},"children":["criterion "]}],["$","span","code-segement301",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement302",{"className":"$undefined","style":{},"children":[" nn"]}],["$","span","code-segement303",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement304",{"className":"$undefined","style":{},"children":["CrossEntropyLoss"]}],["$","span","code-segement305",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement306",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement307",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement308",{"className":"$undefined","style":{},"children":["optimizer "]}],["$","span","code-segement309",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement310",{"className":"$undefined","style":{},"children":[" optim"]}],["$","span","code-segement311",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement312",{"className":"$undefined","style":{},"children":["Adam"]}],["$","span","code-segement313",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement314",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement315",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement316",{"className":"$undefined","style":{},"children":["parameters"]}],["$","span","code-segement317",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement318",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement319",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement320",{"className":"$undefined","style":{},"children":[" lr"]}],["$","span","code-segement321",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement322",{"className":"token","style":{"color":"#755f00"},"children":["0.001"]}],["$","span","code-segement323",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Le","19",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","We create a simple CNN with two convolution, one max pooling, one dropout, and two fully-connected layers. We use ",["$","$L1b","19-link",{"href":"https://pytorch.org/docs/stable/generated/torch.nn.CrossEntropyLoss.html","rel":"noopener noreferrer","target":"_blank","color":"primary","underline":"hover","children":"Cross Entropy"}]," as our loss function and the ",["$","$L1b","19-link",{"href":"https://pytorch.org/docs/stable/generated/torch.optim.Adam.html","rel":"noopener noreferrer","target":"_blank","color":"primary","underline":"hover","children":"Adam Optimizer"}],"."]}],["$","$Le","20",{"id":"training","variant":"h5","component":"h2","mb":2,"children":["$","strong",null,{"children":"Training"}]}],["$","$Le","21",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","In the same directory, create a file called ",["$","$Lc","21-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"train.py"}],". Calling this file will train our model. Inside this file, we make the required imports and then define a class called ",["$","$Lc","21-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"ModelTrainer"}],"."]}],["$","$Lc",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L1c",null,{"contentToCopy":"from datetime import datetime\\nfrom os import makedirs\\nfrom os.path import join\\n\\nimport torch\\nimport torch.nn as nn\\nimport torch.optim as optim\\n\\nfrom .config import config, models_dir\\nfrom .dataset import data_loaders\\nfrom .model import CNN\\n\\n\\nclass ModelTrainer:\\n    def __init__(self):\\n        self.training_id = \\"torch---\\" + datetime.now().strftime(\\"%Y-%m-%d-%H-%M-%S\\")\\n\\n        self.device = torch.device(\\"cuda\\" if torch.cuda.is_available() else \\"cpu\\")\\n\\n        self.model = CNN()\\n        self.model = self.model.to(self.device)\\n\\n        self.optimizer = optim.Adam(self.model.parameters(), lr=config[\'learning_rate\'])\\n        self.loss_fn = nn.CrossEntropyLoss()\\n\\n        self.models_dir = join(models_dir, self.training_id)\\n        makedirs(self.models_dir, exist_ok=False)\\n\\n    def save_weights(self, file_path):\\n        torch.save(self.model.state_dict(), file_path)"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" datetime "]}],["$","span","code-segement2",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":[" datetime\\n"]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement5",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement6",{"className":"$undefined","style":{},"children":[" os "]}],["$","span","code-segement7",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":[" makedirs\\n"]}],["$","span","code-segement9",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement10",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement11",{"className":"$undefined","style":{},"children":[" os"]}],["$","span","code-segement12",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement13",{"className":"$undefined","style":{},"children":["path "]}],["$","span","code-segement14",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":[" join\\n"]}],"\\n",["$","span","code-segement17",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement18",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement19",{"className":"$undefined","style":{},"children":[" torch\\n"]}],["$","span","code-segement20",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement21",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement22",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement23",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement24",{"className":"$undefined","style":{},"children":["nn "]}],["$","span","code-segement25",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":[" nn\\n"]}],["$","span","code-segement27",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement28",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement29",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement30",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement31",{"className":"$undefined","style":{},"children":["optim "]}],["$","span","code-segement32",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement33",{"className":"$undefined","style":{},"children":[" optim\\n"]}],"\\n",["$","span","code-segement35",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement36",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement37",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement38",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement39",{"className":"$undefined","style":{},"children":["config "]}],["$","span","code-segement40",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement41",{"className":"$undefined","style":{},"children":[" config"]}],["$","span","code-segement42",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement43",{"className":"$undefined","style":{},"children":[" models_dir\\n"]}],["$","span","code-segement44",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement45",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement46",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement47",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement48",{"className":"$undefined","style":{},"children":["dataset "]}],["$","span","code-segement49",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement50",{"className":"$undefined","style":{},"children":[" data_loaders\\n"]}],["$","span","code-segement51",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement52",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement53",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement54",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement55",{"className":"$undefined","style":{},"children":["model "]}],["$","span","code-segement56",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement57",{"className":"$undefined","style":{},"children":[" CNN\\n"]}],"\\n","\\n",["$","span","code-segement60",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement61",{"className":"token","style":{"color":"#a04900"},"children":["class"]}],["$","span","code-segement62",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement63",{"className":"token","style":{"color":"#005a8e"},"children":["ModelTrainer"]}],["$","span","code-segement64",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement65",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement66",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement67",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement68",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement69",{"className":"token","style":{"color":"#7c00aa"},"children":["__init__"]}],["$","span","code-segement70",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement71",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement72",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement73",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement74",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement75",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement76",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement77",{"className":"$undefined","style":{},"children":["training_id "]}],["$","span","code-segement78",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement79",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement80",{"className":"token","style":{"color":"#116b00"},"children":["\\"torch---\\""]}],["$","span","code-segement81",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement82",{"className":"token","style":{"color":"#a04900"},"children":["+"]}],["$","span","code-segement83",{"className":"$undefined","style":{},"children":[" datetime"]}],["$","span","code-segement84",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement85",{"className":"$undefined","style":{},"children":["now"]}],["$","span","code-segement86",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement87",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement88",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement89",{"className":"$undefined","style":{},"children":["strftime"]}],["$","span","code-segement90",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement91",{"className":"token","style":{"color":"#116b00"},"children":["\\"%Y-%m-%d-%H-%M-%S\\""]}],["$","span","code-segement92",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement93",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement95",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement96",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement97",{"className":"$undefined","style":{},"children":["device "]}],["$","span","code-segement98",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement99",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement100",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement101",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement102",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement103",{"className":"token","style":{"color":"#116b00"},"children":["\\"cuda\\""]}],["$","span","code-segement104",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement105",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement106",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement107",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement108",{"className":"$undefined","style":{},"children":["cuda"]}],["$","span","code-segement109",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement110",{"className":"$undefined","style":{},"children":["is_available"]}],["$","span","code-segement111",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement112",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement113",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement114",{"className":"token","style":{"color":"#a04900"},"children":["else"]}],["$","span","code-segement115",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement116",{"className":"token","style":{"color":"#116b00"},"children":["\\"cpu\\""]}],["$","span","code-segement117",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement118",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement120",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement121",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement122",{"className":"$undefined","style":{},"children":["model "]}],["$","span","code-segement123",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement124",{"className":"$undefined","style":{},"children":[" CNN"]}],["$","span","code-segement125",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement126",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement127",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement128",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement129",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement130",{"className":"$undefined","style":{},"children":["model "]}],["$","span","code-segement131",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement132",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement133",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement134",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement135",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement136",{"className":"$undefined","style":{},"children":["to"]}],["$","span","code-segement137",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement138",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement139",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement140",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement141",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement142",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement144",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement145",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement146",{"className":"$undefined","style":{},"children":["optimizer "]}],["$","span","code-segement147",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement148",{"className":"$undefined","style":{},"children":[" optim"]}],["$","span","code-segement149",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement150",{"className":"$undefined","style":{},"children":["Adam"]}],["$","span","code-segement151",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement152",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement153",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement154",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement155",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement156",{"className":"$undefined","style":{},"children":["parameters"]}],["$","span","code-segement157",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement158",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement159",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement160",{"className":"$undefined","style":{},"children":[" lr"]}],["$","span","code-segement161",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement162",{"className":"$undefined","style":{},"children":["config"]}],["$","span","code-segement163",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement164",{"className":"token","style":{"color":"#116b00"},"children":["\'learning_rate\'"]}],["$","span","code-segement165",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement166",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement167",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement168",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement169",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement170",{"className":"$undefined","style":{},"children":["loss_fn "]}],["$","span","code-segement171",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement172",{"className":"$undefined","style":{},"children":[" nn"]}],["$","span","code-segement173",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement174",{"className":"$undefined","style":{},"children":["CrossEntropyLoss"]}],["$","span","code-segement175",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement176",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement177",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement179",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement180",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement181",{"className":"$undefined","style":{},"children":["models_dir "]}],["$","span","code-segement182",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement183",{"className":"$undefined","style":{},"children":[" join"]}],["$","span","code-segement184",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement185",{"className":"$undefined","style":{},"children":["models_dir"]}],["$","span","code-segement186",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement187",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement188",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement189",{"className":"$undefined","style":{},"children":["training_id"]}],["$","span","code-segement190",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement191",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement192",{"className":"$undefined","style":{},"children":["        makedirs"]}],["$","span","code-segement193",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement194",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement195",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement196",{"className":"$undefined","style":{},"children":["models_dir"]}],["$","span","code-segement197",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement198",{"className":"$undefined","style":{},"children":[" exist_ok"]}],["$","span","code-segement199",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement200",{"className":"token","style":{"color":"#755f00"},"children":["False"]}],["$","span","code-segement201",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement202",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement204",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement205",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement206",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement207",{"className":"token","style":{"color":"#7c00aa"},"children":["save_weights"]}],["$","span","code-segement208",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement209",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement210",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement211",{"className":"$undefined","style":{},"children":[" file_path"]}],["$","span","code-segement212",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement213",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement214",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement215",{"className":"$undefined","style":{},"children":["        torch"]}],["$","span","code-segement216",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement217",{"className":"$undefined","style":{},"children":["save"]}],["$","span","code-segement218",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement219",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement220",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement221",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement222",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement223",{"className":"$undefined","style":{},"children":["state_dict"]}],["$","span","code-segement224",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement225",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement226",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement227",{"className":"$undefined","style":{},"children":[" file_path"]}],["$","span","code-segement228",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Le","23",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","In the constructor, we generate a unique training id, instantiate the model, the optimizer, and the loss function. We move the model to our device (CPU/GPU) and make a new directory in our models dir for the particular training id. We also define a function ",["$","$Lc","23-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"save_weights"}]," that will save our model\'s weights at the provided file path - we\'ll use this to save the model weights after every training epoch."]}],["$","$Le","24",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Speaking of epochs, let\'s create a function that can train our model for one epoch."]}],["$","$Lc",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L1c",null,{"contentToCopy":"def train_single_epoch(self):\\n    self.model.train()\\n\\n    for batch_index, (data, target) in enumerate(data_loaders[\\"train\\"]):\\n        data = data.to(self.device)\\n        target = target.to(self.device)\\n\\n        self.optimizer.zero_grad()\\n\\n        output = self.model(data)\\n\\n        loss = self.loss_fn(output, target)\\n        loss.backward()\\n\\n        self.optimizer.step()\\n\\n        if batch_index % config[\'log_batch_interval\'] == 0:\\n            print(f\\"    {batch_index} / {len(data_loaders[\'train\'])}\\")"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement2",{"className":"token","style":{"color":"#7c00aa"},"children":["train_single_epoch"]}],["$","span","code-segement3",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement5",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement6",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement7",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":["    self"]}],["$","span","code-segement9",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement11",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement12",{"className":"$undefined","style":{},"children":["train"]}],["$","span","code-segement13",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement14",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement17",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement18",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement19",{"className":"$undefined","style":{},"children":[" batch_index"]}],["$","span","code-segement20",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement21",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement22",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement23",{"className":"$undefined","style":{},"children":["data"]}],["$","span","code-segement24",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement25",{"className":"$undefined","style":{},"children":[" target"]}],["$","span","code-segement26",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement27",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement28",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement29",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement30",{"className":"token","style":{"color":"#af00af"},"children":["enumerate"]}],["$","span","code-segement31",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement32",{"className":"$undefined","style":{},"children":["data_loaders"]}],["$","span","code-segement33",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement34",{"className":"token","style":{"color":"#116b00"},"children":["\\"train\\""]}],["$","span","code-segement35",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement36",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement37",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement38",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement39",{"className":"$undefined","style":{},"children":["        data "]}],["$","span","code-segement40",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement41",{"className":"$undefined","style":{},"children":[" data"]}],["$","span","code-segement42",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement43",{"className":"$undefined","style":{},"children":["to"]}],["$","span","code-segement44",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement45",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement46",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement47",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement48",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement49",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement50",{"className":"$undefined","style":{},"children":["        target "]}],["$","span","code-segement51",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement52",{"className":"$undefined","style":{},"children":[" target"]}],["$","span","code-segement53",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement54",{"className":"$undefined","style":{},"children":["to"]}],["$","span","code-segement55",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement56",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement57",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement58",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement59",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement60",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement62",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement63",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement64",{"className":"$undefined","style":{},"children":["optimizer"]}],["$","span","code-segement65",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement66",{"className":"$undefined","style":{},"children":["zero_grad"]}],["$","span","code-segement67",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement68",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement69",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement71",{"className":"$undefined","style":{},"children":["        output "]}],["$","span","code-segement72",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement73",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement74",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement75",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement76",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement77",{"className":"$undefined","style":{},"children":["data"]}],["$","span","code-segement78",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement79",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement81",{"className":"$undefined","style":{},"children":["        loss "]}],["$","span","code-segement82",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement83",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement84",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement85",{"className":"$undefined","style":{},"children":["loss_fn"]}],["$","span","code-segement86",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement87",{"className":"$undefined","style":{},"children":["output"]}],["$","span","code-segement88",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement89",{"className":"$undefined","style":{},"children":[" target"]}],["$","span","code-segement90",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement91",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement92",{"className":"$undefined","style":{},"children":["        loss"]}],["$","span","code-segement93",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement94",{"className":"$undefined","style":{},"children":["backward"]}],["$","span","code-segement95",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement96",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement97",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement99",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement100",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement101",{"className":"$undefined","style":{},"children":["optimizer"]}],["$","span","code-segement102",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement103",{"className":"$undefined","style":{},"children":["step"]}],["$","span","code-segement104",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement105",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement106",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement108",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement109",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement110",{"className":"$undefined","style":{},"children":[" batch_index "]}],["$","span","code-segement111",{"className":"token","style":{"color":"#a04900"},"children":["%"]}],["$","span","code-segement112",{"className":"$undefined","style":{},"children":[" config"]}],["$","span","code-segement113",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement114",{"className":"token","style":{"color":"#116b00"},"children":["\'log_batch_interval\'"]}],["$","span","code-segement115",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement116",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement117",{"className":"token","style":{"color":"#a04900"},"children":["=="]}],["$","span","code-segement118",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement119",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement120",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement121",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement122",{"className":"$undefined","style":{},"children":["            "]}],["$","span","code-segement123",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement124",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement125",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\\"    "]}],["$","span","code-segement126",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement127",{"className":"token string-interpolation interpolation","style":{},"children":["batch_index"]}],["$","span","code-segement128",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement129",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[" / "]}],["$","span","code-segement130",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement131",{"className":"token string-interpolation interpolation","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement132",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement133",{"className":"token string-interpolation interpolation","style":{},"children":["data_loaders"]}],["$","span","code-segement134",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement135",{"className":"token string-interpolation interpolation","style":{"color":"#116b00"},"children":["\'train\'"]}],["$","span","code-segement136",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement137",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement138",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement139",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["\\""]}],["$","span","code-segement140",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Le","26",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","This is the standard training strategy. The last couple of lines are just for logging the training progress at the specified interval."]}],["$","$Le","27",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Now, we want to create a function that can test the model on our test data and get us the loss and accuracy."]}],["$","$Lc",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L1c",null,{"contentToCopy":"def test(self):\\n    self.model.eval()\\n\\n    sum_test_loss = 0\\n    num_correct = 0\\n\\n    with torch.no_grad():\\n        for data, target in data_loaders[\\"test\\"]:\\n            data = data.to(self.device)\\n            target = target.to(self.device)\\n\\n            output = self.model(data)\\n\\n            sum_test_loss += self.loss_fn(output, target).item()\\n\\n            prediction = output.argmax(dim=1, keepdim=True)\\n\\n            num_correct += prediction.eq(target.view_as(prediction)).sum().item()\\n\\n    average_test_loss = sum_test_loss / len(data_loaders[\'test\'].dataset)\\n    accuracy = num_correct / len(data_loaders[\'test\'].dataset)\\n\\n    print(f\\"    Average loss: {average_test_loss}\\")\\n    print(f\\"    Accuracy: {accuracy}\\")"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement2",{"className":"token","style":{"color":"#7c00aa"},"children":["test"]}],["$","span","code-segement3",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement5",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement6",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement7",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":["    self"]}],["$","span","code-segement9",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement11",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement12",{"className":"token","style":{"color":"#af00af"},"children":["eval"]}],["$","span","code-segement13",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement14",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement17",{"className":"$undefined","style":{},"children":["    sum_test_loss "]}],["$","span","code-segement18",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement19",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement20",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement21",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement22",{"className":"$undefined","style":{},"children":["    num_correct "]}],["$","span","code-segement23",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement24",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement25",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement28",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement29",{"className":"token","style":{"color":"#a04900"},"children":["with"]}],["$","span","code-segement30",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement31",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement32",{"className":"$undefined","style":{},"children":["no_grad"]}],["$","span","code-segement33",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement34",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement35",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement36",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement37",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement38",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement39",{"className":"$undefined","style":{},"children":[" data"]}],["$","span","code-segement40",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement41",{"className":"$undefined","style":{},"children":[" target "]}],["$","span","code-segement42",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement43",{"className":"$undefined","style":{},"children":[" data_loaders"]}],["$","span","code-segement44",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement45",{"className":"token","style":{"color":"#116b00"},"children":["\\"test\\""]}],["$","span","code-segement46",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement47",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement48",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement49",{"className":"$undefined","style":{},"children":["            data "]}],["$","span","code-segement50",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement51",{"className":"$undefined","style":{},"children":[" data"]}],["$","span","code-segement52",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement53",{"className":"$undefined","style":{},"children":["to"]}],["$","span","code-segement54",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement55",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement56",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement57",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement58",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement59",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement60",{"className":"$undefined","style":{},"children":["            target "]}],["$","span","code-segement61",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement62",{"className":"$undefined","style":{},"children":[" target"]}],["$","span","code-segement63",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement64",{"className":"$undefined","style":{},"children":["to"]}],["$","span","code-segement65",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement66",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement67",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement68",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement69",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement70",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement72",{"className":"$undefined","style":{},"children":["            output "]}],["$","span","code-segement73",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement74",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement75",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement76",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement77",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement78",{"className":"$undefined","style":{},"children":["data"]}],["$","span","code-segement79",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement80",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement82",{"className":"$undefined","style":{},"children":["            sum_test_loss "]}],["$","span","code-segement83",{"className":"token","style":{"color":"#a04900"},"children":["+="]}],["$","span","code-segement84",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement85",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement86",{"className":"$undefined","style":{},"children":["loss_fn"]}],["$","span","code-segement87",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement88",{"className":"$undefined","style":{},"children":["output"]}],["$","span","code-segement89",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement90",{"className":"$undefined","style":{},"children":[" target"]}],["$","span","code-segement91",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement92",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement93",{"className":"$undefined","style":{},"children":["item"]}],["$","span","code-segement94",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement95",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement96",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement98",{"className":"$undefined","style":{},"children":["            prediction "]}],["$","span","code-segement99",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement100",{"className":"$undefined","style":{},"children":[" output"]}],["$","span","code-segement101",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement102",{"className":"$undefined","style":{},"children":["argmax"]}],["$","span","code-segement103",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement104",{"className":"$undefined","style":{},"children":["dim"]}],["$","span","code-segement105",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement106",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement107",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement108",{"className":"$undefined","style":{},"children":[" keepdim"]}],["$","span","code-segement109",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement110",{"className":"token","style":{"color":"#755f00"},"children":["True"]}],["$","span","code-segement111",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement112",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement114",{"className":"$undefined","style":{},"children":["            num_correct "]}],["$","span","code-segement115",{"className":"token","style":{"color":"#a04900"},"children":["+="]}],["$","span","code-segement116",{"className":"$undefined","style":{},"children":[" prediction"]}],["$","span","code-segement117",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement118",{"className":"$undefined","style":{},"children":["eq"]}],["$","span","code-segement119",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement120",{"className":"$undefined","style":{},"children":["target"]}],["$","span","code-segement121",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement122",{"className":"$undefined","style":{},"children":["view_as"]}],["$","span","code-segement123",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement124",{"className":"$undefined","style":{},"children":["prediction"]}],["$","span","code-segement125",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement126",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement127",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement128",{"className":"token","style":{"color":"#af00af"},"children":["sum"]}],["$","span","code-segement129",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement130",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement131",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement132",{"className":"$undefined","style":{},"children":["item"]}],["$","span","code-segement133",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement134",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement135",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement137",{"className":"$undefined","style":{},"children":["    average_test_loss "]}],["$","span","code-segement138",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement139",{"className":"$undefined","style":{},"children":[" sum_test_loss "]}],["$","span","code-segement140",{"className":"token","style":{"color":"#a04900"},"children":["/"]}],["$","span","code-segement141",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement142",{"className":"token","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement143",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement144",{"className":"$undefined","style":{},"children":["data_loaders"]}],["$","span","code-segement145",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement146",{"className":"token","style":{"color":"#116b00"},"children":["\'test\'"]}],["$","span","code-segement147",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement148",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement149",{"className":"$undefined","style":{},"children":["dataset"]}],["$","span","code-segement150",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement151",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement152",{"className":"$undefined","style":{},"children":["    accuracy "]}],["$","span","code-segement153",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement154",{"className":"$undefined","style":{},"children":[" num_correct "]}],["$","span","code-segement155",{"className":"token","style":{"color":"#a04900"},"children":["/"]}],["$","span","code-segement156",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement157",{"className":"token","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement158",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement159",{"className":"$undefined","style":{},"children":["data_loaders"]}],["$","span","code-segement160",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement161",{"className":"token","style":{"color":"#116b00"},"children":["\'test\'"]}],["$","span","code-segement162",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement163",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement164",{"className":"$undefined","style":{},"children":["dataset"]}],["$","span","code-segement165",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement166",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement168",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement169",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement170",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement171",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\\"    Average loss: "]}],["$","span","code-segement172",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement173",{"className":"token string-interpolation interpolation","style":{},"children":["average_test_loss"]}],["$","span","code-segement174",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement175",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["\\""]}],["$","span","code-segement176",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement177",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement178",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement179",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement180",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement181",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\\"    Accuracy: "]}],["$","span","code-segement182",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement183",{"className":"token string-interpolation interpolation","style":{},"children":["accuracy"]}],["$","span","code-segement184",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement185",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["\\""]}],["$","span","code-segement186",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Le","29",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","For all the testing samples, we calculate the average loss and the number of predictions the model got correct and then print them to the console."]}],["$","$Le","30",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","And, finally, we can define our ",["$","$Lc","30-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"train"}]," function, which just trains our model for the specified number of epochs."]}],["$","$Lc",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L1c",null,{"contentToCopy":"def train(self):\\n    for epoch_index in range(config[\'training_num_epochs\']):\\n        print(f\\"Epoch: {epoch_index}\\")\\n        self.train_single_epoch()\\n\\n        model_save_file_path = join(self.models_dir, f\\"epoch-{epoch_index}.pt\\")\\n        self.save_weights(model_save_file_path)\\n\\n        self.test()"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement2",{"className":"token","style":{"color":"#7c00aa"},"children":["train"]}],["$","span","code-segement3",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement5",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement6",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement7",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement9",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":[" epoch_index "]}],["$","span","code-segement11",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement12",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement13",{"className":"token","style":{"color":"#af00af"},"children":["range"]}],["$","span","code-segement14",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":["config"]}],["$","span","code-segement16",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement17",{"className":"token","style":{"color":"#116b00"},"children":["\'training_num_epochs\'"]}],["$","span","code-segement18",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement19",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement20",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement21",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement22",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement23",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement24",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement25",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\\"Epoch: "]}],["$","span","code-segement26",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement27",{"className":"token string-interpolation interpolation","style":{},"children":["epoch_index"]}],["$","span","code-segement28",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement29",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["\\""]}],["$","span","code-segement30",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement31",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement32",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement33",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement34",{"className":"$undefined","style":{},"children":["train_single_epoch"]}],["$","span","code-segement35",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement36",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement37",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement39",{"className":"$undefined","style":{},"children":["        model_save_file_path "]}],["$","span","code-segement40",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement41",{"className":"$undefined","style":{},"children":[" join"]}],["$","span","code-segement42",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement43",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement44",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement45",{"className":"$undefined","style":{},"children":["models_dir"]}],["$","span","code-segement46",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement47",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement48",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\\"epoch-"]}],["$","span","code-segement49",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement50",{"className":"token string-interpolation interpolation","style":{},"children":["epoch_index"]}],["$","span","code-segement51",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement52",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[".pt\\""]}],["$","span","code-segement53",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement54",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement55",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement56",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement57",{"className":"$undefined","style":{},"children":["save_weights"]}],["$","span","code-segement58",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement59",{"className":"$undefined","style":{},"children":["model_save_file_path"]}],["$","span","code-segement60",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement61",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement63",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement64",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement65",{"className":"$undefined","style":{},"children":["test"]}],["$","span","code-segement66",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement67",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Le","32",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Outside the ",["$","$Lc","32-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"ModelTrainer"}]," class, in the ",["$","$Lc","32-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"main"}]," block, we can create an instance of the class and call the train function."]}],["$","$Lc",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L1c",null,{"contentToCopy":"if __name__ == \\"__main__\\":\\n    model_trainer = ModelTrainer()\\n    model_trainer.train()"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" __name__ "]}],["$","span","code-segement2",{"className":"token","style":{"color":"#a04900"},"children":["=="]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement4",{"className":"token","style":{"color":"#116b00"},"children":["\\"__main__\\""]}],["$","span","code-segement5",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement6",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement7",{"className":"$undefined","style":{},"children":["    model_trainer "]}],["$","span","code-segement8",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement9",{"className":"$undefined","style":{},"children":[" ModelTrainer"]}],["$","span","code-segement10",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement11",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement12",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement13",{"className":"$undefined","style":{},"children":["    model_trainer"]}],["$","span","code-segement14",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":["train"]}],["$","span","code-segement16",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement17",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Le","34",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Here\'s the entire ",["$","$Lc","34-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"train.py"}]," file."]}],["$","$Lc",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L1c",null,{"contentToCopy":"$1d"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" datetime "]}],["$","span","code-segement2",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":[" datetime\\n"]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement5",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement6",{"className":"$undefined","style":{},"children":[" os "]}],["$","span","code-segement7",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":[" makedirs\\n"]}],["$","span","code-segement9",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement10",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement11",{"className":"$undefined","style":{},"children":[" os"]}],["$","span","code-segement12",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement13",{"className":"$undefined","style":{},"children":["path "]}],["$","span","code-segement14",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":[" join\\n"]}],"\\n",["$","span","code-segement17",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement18",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement19",{"className":"$undefined","style":{},"children":[" torch\\n"]}],["$","span","code-segement20",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement21",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement22",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement23",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement24",{"className":"$undefined","style":{},"children":["nn "]}],["$","span","code-segement25",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":[" nn\\n"]}],["$","span","code-segement27",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement28",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement29",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement30",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement31",{"className":"$undefined","style":{},"children":["optim "]}],["$","span","code-segement32",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement33",{"className":"$undefined","style":{},"children":[" optim\\n"]}],"\\n",["$","span","code-segement35",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement36",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement37",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement38",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement39",{"className":"$undefined","style":{},"children":["config "]}],["$","span","code-segement40",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement41",{"className":"$undefined","style":{},"children":[" config"]}],["$","span","code-segement42",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement43",{"className":"$undefined","style":{},"children":[" models_dir\\n"]}],["$","span","code-segement44",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement45",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement46",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement47",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement48",{"className":"$undefined","style":{},"children":["dataset "]}],["$","span","code-segement49",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement50",{"className":"$undefined","style":{},"children":[" data_loaders\\n"]}],["$","span","code-segement51",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement52",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement53",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement54",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement55",{"className":"$undefined","style":{},"children":["model "]}],["$","span","code-segement56",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement57",{"className":"$undefined","style":{},"children":[" CNN\\n"]}],"\\n","\\n",["$","span","code-segement60",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement61",{"className":"token","style":{"color":"#a04900"},"children":["class"]}],["$","span","code-segement62",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement63",{"className":"token","style":{"color":"#005a8e"},"children":["ModelTrainer"]}],["$","span","code-segement64",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement65",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement66",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement67",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement68",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement69",{"className":"token","style":{"color":"#7c00aa"},"children":["__init__"]}],["$","span","code-segement70",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement71",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement72",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement73",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement74",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement75",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement76",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement77",{"className":"$undefined","style":{},"children":["training_id "]}],["$","span","code-segement78",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement79",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement80",{"className":"token","style":{"color":"#116b00"},"children":["\\"torch---\\""]}],["$","span","code-segement81",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement82",{"className":"token","style":{"color":"#a04900"},"children":["+"]}],["$","span","code-segement83",{"className":"$undefined","style":{},"children":[" datetime"]}],["$","span","code-segement84",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement85",{"className":"$undefined","style":{},"children":["now"]}],["$","span","code-segement86",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement87",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement88",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement89",{"className":"$undefined","style":{},"children":["strftime"]}],["$","span","code-segement90",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement91",{"className":"token","style":{"color":"#116b00"},"children":["\\"%Y-%m-%d-%H-%M-%S\\""]}],["$","span","code-segement92",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement93",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement95",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement96",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement97",{"className":"$undefined","style":{},"children":["device "]}],["$","span","code-segement98",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement99",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement100",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement101",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement102",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement103",{"className":"token","style":{"color":"#116b00"},"children":["\\"cuda\\""]}],["$","span","code-segement104",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement105",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement106",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement107",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement108",{"className":"$undefined","style":{},"children":["cuda"]}],["$","span","code-segement109",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement110",{"className":"$undefined","style":{},"children":["is_available"]}],["$","span","code-segement111",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement112",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement113",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement114",{"className":"token","style":{"color":"#a04900"},"children":["else"]}],["$","span","code-segement115",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement116",{"className":"token","style":{"color":"#116b00"},"children":["\\"cpu\\""]}],["$","span","code-segement117",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement118",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement120",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement121",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement122",{"className":"$undefined","style":{},"children":["model "]}],["$","span","code-segement123",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement124",{"className":"$undefined","style":{},"children":[" CNN"]}],["$","span","code-segement125",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement126",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement127",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement128",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement129",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement130",{"className":"$undefined","style":{},"children":["model "]}],["$","span","code-segement131",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement132",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement133",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement134",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement135",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement136",{"className":"$undefined","style":{},"children":["to"]}],["$","span","code-segement137",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement138",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement139",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement140",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement141",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement142",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement144",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement145",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement146",{"className":"$undefined","style":{},"children":["optimizer "]}],["$","span","code-segement147",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement148",{"className":"$undefined","style":{},"children":[" optim"]}],["$","span","code-segement149",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement150",{"className":"$undefined","style":{},"children":["Adam"]}],["$","span","code-segement151",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement152",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement153",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement154",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement155",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement156",{"className":"$undefined","style":{},"children":["parameters"]}],["$","span","code-segement157",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement158",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement159",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement160",{"className":"$undefined","style":{},"children":[" lr"]}],["$","span","code-segement161",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement162",{"className":"$undefined","style":{},"children":["config"]}],["$","span","code-segement163",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement164",{"className":"token","style":{"color":"#116b00"},"children":["\'learning_rate\'"]}],["$","span","code-segement165",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement166",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement167",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement168",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement169",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement170",{"className":"$undefined","style":{},"children":["loss_fn "]}],["$","span","code-segement171",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement172",{"className":"$undefined","style":{},"children":[" nn"]}],["$","span","code-segement173",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement174",{"className":"$undefined","style":{},"children":["CrossEntropyLoss"]}],["$","span","code-segement175",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement176",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement177",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement179",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement180",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement181",{"className":"$undefined","style":{},"children":["models_dir "]}],["$","span","code-segement182",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement183",{"className":"$undefined","style":{},"children":[" join"]}],["$","span","code-segement184",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement185",{"className":"$undefined","style":{},"children":["models_dir"]}],["$","span","code-segement186",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement187",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement188",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement189",{"className":"$undefined","style":{},"children":["training_id"]}],["$","span","code-segement190",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement191",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement192",{"className":"$undefined","style":{},"children":["        makedirs"]}],["$","span","code-segement193",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement194",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement195",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement196",{"className":"$undefined","style":{},"children":["models_dir"]}],["$","span","code-segement197",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement198",{"className":"$undefined","style":{},"children":[" exist_ok"]}],["$","span","code-segement199",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement200",{"className":"token","style":{"color":"#755f00"},"children":["False"]}],["$","span","code-segement201",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement202",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement204",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement205",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement206",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement207",{"className":"token","style":{"color":"#7c00aa"},"children":["train_single_epoch"]}],["$","span","code-segement208",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement209",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement210",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement211",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement212",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement213",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement214",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement215",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement216",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement217",{"className":"$undefined","style":{},"children":["train"]}],["$","span","code-segement218",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement219",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement220",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement222",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement223",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement224",{"className":"$undefined","style":{},"children":[" batch_index"]}],["$","span","code-segement225",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement226",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement227",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement228",{"className":"$undefined","style":{},"children":["data"]}],["$","span","code-segement229",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement230",{"className":"$undefined","style":{},"children":[" target"]}],["$","span","code-segement231",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement232",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement233",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement234",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement235",{"className":"token","style":{"color":"#af00af"},"children":["enumerate"]}],["$","span","code-segement236",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement237",{"className":"$undefined","style":{},"children":["data_loaders"]}],["$","span","code-segement238",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement239",{"className":"token","style":{"color":"#116b00"},"children":["\\"train\\""]}],["$","span","code-segement240",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement241",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement242",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement243",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement244",{"className":"$undefined","style":{},"children":["            data "]}],["$","span","code-segement245",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement246",{"className":"$undefined","style":{},"children":[" data"]}],["$","span","code-segement247",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement248",{"className":"$undefined","style":{},"children":["to"]}],["$","span","code-segement249",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement250",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement251",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement252",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement253",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement254",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement255",{"className":"$undefined","style":{},"children":["            target "]}],["$","span","code-segement256",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement257",{"className":"$undefined","style":{},"children":[" target"]}],["$","span","code-segement258",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement259",{"className":"$undefined","style":{},"children":["to"]}],["$","span","code-segement260",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement261",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement262",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement263",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement264",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement265",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement267",{"className":"$undefined","style":{},"children":["            self"]}],["$","span","code-segement268",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement269",{"className":"$undefined","style":{},"children":["optimizer"]}],["$","span","code-segement270",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement271",{"className":"$undefined","style":{},"children":["zero_grad"]}],["$","span","code-segement272",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement273",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement274",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement276",{"className":"$undefined","style":{},"children":["            output "]}],["$","span","code-segement277",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement278",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement279",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement280",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement281",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement282",{"className":"$undefined","style":{},"children":["data"]}],["$","span","code-segement283",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement284",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement286",{"className":"$undefined","style":{},"children":["            loss "]}],["$","span","code-segement287",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement288",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement289",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement290",{"className":"$undefined","style":{},"children":["loss_fn"]}],["$","span","code-segement291",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement292",{"className":"$undefined","style":{},"children":["output"]}],["$","span","code-segement293",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement294",{"className":"$undefined","style":{},"children":[" target"]}],["$","span","code-segement295",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement296",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement297",{"className":"$undefined","style":{},"children":["            loss"]}],["$","span","code-segement298",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement299",{"className":"$undefined","style":{},"children":["backward"]}],["$","span","code-segement300",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement301",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement302",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement304",{"className":"$undefined","style":{},"children":["            self"]}],["$","span","code-segement305",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement306",{"className":"$undefined","style":{},"children":["optimizer"]}],["$","span","code-segement307",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement308",{"className":"$undefined","style":{},"children":["step"]}],["$","span","code-segement309",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement310",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement311",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement313",{"className":"$undefined","style":{},"children":["            "]}],["$","span","code-segement314",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement315",{"className":"$undefined","style":{},"children":[" batch_index "]}],["$","span","code-segement316",{"className":"token","style":{"color":"#a04900"},"children":["%"]}],["$","span","code-segement317",{"className":"$undefined","style":{},"children":[" config"]}],["$","span","code-segement318",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement319",{"className":"token","style":{"color":"#116b00"},"children":["\'log_batch_interval\'"]}],["$","span","code-segement320",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement321",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement322",{"className":"token","style":{"color":"#a04900"},"children":["=="]}],["$","span","code-segement323",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement324",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement325",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement326",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement327",{"className":"$undefined","style":{},"children":["                "]}],["$","span","code-segement328",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement329",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement330",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\\"    "]}],["$","span","code-segement331",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement332",{"className":"token string-interpolation interpolation","style":{},"children":["batch_index"]}],["$","span","code-segement333",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement334",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[" / "]}],["$","span","code-segement335",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement336",{"className":"token string-interpolation interpolation","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement337",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement338",{"className":"token string-interpolation interpolation","style":{},"children":["data_loaders"]}],["$","span","code-segement339",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement340",{"className":"token string-interpolation interpolation","style":{"color":"#116b00"},"children":["\'train\'"]}],["$","span","code-segement341",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement342",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement343",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement344",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["\\""]}],["$","span","code-segement345",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement346",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement348",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement349",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement350",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement351",{"className":"token","style":{"color":"#7c00aa"},"children":["test"]}],["$","span","code-segement352",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement353",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement354",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement355",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement356",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement357",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement358",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement359",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement360",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement361",{"className":"token","style":{"color":"#af00af"},"children":["eval"]}],["$","span","code-segement362",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement363",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement364",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement366",{"className":"$undefined","style":{},"children":["        sum_test_loss "]}],["$","span","code-segement367",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement368",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement369",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement370",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement371",{"className":"$undefined","style":{},"children":["        num_correct "]}],["$","span","code-segement372",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement373",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement374",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement375",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement377",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement378",{"className":"token","style":{"color":"#a04900"},"children":["with"]}],["$","span","code-segement379",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement380",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement381",{"className":"$undefined","style":{},"children":["no_grad"]}],["$","span","code-segement382",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement383",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement384",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement385",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement386",{"className":"$undefined","style":{},"children":["            "]}],["$","span","code-segement387",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement388",{"className":"$undefined","style":{},"children":[" data"]}],["$","span","code-segement389",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement390",{"className":"$undefined","style":{},"children":[" target "]}],["$","span","code-segement391",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement392",{"className":"$undefined","style":{},"children":[" data_loaders"]}],["$","span","code-segement393",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement394",{"className":"token","style":{"color":"#116b00"},"children":["\\"test\\""]}],["$","span","code-segement395",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement396",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement397",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement398",{"className":"$undefined","style":{},"children":["                data "]}],["$","span","code-segement399",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement400",{"className":"$undefined","style":{},"children":[" data"]}],["$","span","code-segement401",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement402",{"className":"$undefined","style":{},"children":["to"]}],["$","span","code-segement403",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement404",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement405",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement406",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement407",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement408",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement409",{"className":"$undefined","style":{},"children":["                target "]}],["$","span","code-segement410",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement411",{"className":"$undefined","style":{},"children":[" target"]}],["$","span","code-segement412",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement413",{"className":"$undefined","style":{},"children":["to"]}],["$","span","code-segement414",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement415",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement416",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement417",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement418",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement419",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement421",{"className":"$undefined","style":{},"children":["                output "]}],["$","span","code-segement422",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement423",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement424",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement425",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement426",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement427",{"className":"$undefined","style":{},"children":["data"]}],["$","span","code-segement428",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement429",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement431",{"className":"$undefined","style":{},"children":["                sum_test_loss "]}],["$","span","code-segement432",{"className":"token","style":{"color":"#a04900"},"children":["+="]}],["$","span","code-segement433",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement434",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement435",{"className":"$undefined","style":{},"children":["loss_fn"]}],["$","span","code-segement436",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement437",{"className":"$undefined","style":{},"children":["output"]}],["$","span","code-segement438",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement439",{"className":"$undefined","style":{},"children":[" target"]}],["$","span","code-segement440",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement441",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement442",{"className":"$undefined","style":{},"children":["item"]}],["$","span","code-segement443",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement444",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement445",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement447",{"className":"$undefined","style":{},"children":["                prediction "]}],["$","span","code-segement448",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement449",{"className":"$undefined","style":{},"children":[" output"]}],["$","span","code-segement450",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement451",{"className":"$undefined","style":{},"children":["argmax"]}],["$","span","code-segement452",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement453",{"className":"$undefined","style":{},"children":["dim"]}],["$","span","code-segement454",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement455",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement456",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement457",{"className":"$undefined","style":{},"children":[" keepdim"]}],["$","span","code-segement458",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement459",{"className":"token","style":{"color":"#755f00"},"children":["True"]}],["$","span","code-segement460",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement461",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement463",{"className":"$undefined","style":{},"children":["                num_correct "]}],["$","span","code-segement464",{"className":"token","style":{"color":"#a04900"},"children":["+="]}],["$","span","code-segement465",{"className":"$undefined","style":{},"children":[" prediction"]}],["$","span","code-segement466",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement467",{"className":"$undefined","style":{},"children":["eq"]}],["$","span","code-segement468",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement469",{"className":"$undefined","style":{},"children":["target"]}],["$","span","code-segement470",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement471",{"className":"$undefined","style":{},"children":["view_as"]}],["$","span","code-segement472",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement473",{"className":"$undefined","style":{},"children":["prediction"]}],["$","span","code-segement474",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement475",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement476",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement477",{"className":"token","style":{"color":"#af00af"},"children":["sum"]}],["$","span","code-segement478",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement479",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement480",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement481",{"className":"$undefined","style":{},"children":["item"]}],["$","span","code-segement482",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement483",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement484",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement486",{"className":"$undefined","style":{},"children":["        average_test_loss "]}],["$","span","code-segement487",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement488",{"className":"$undefined","style":{},"children":[" sum_test_loss "]}],["$","span","code-segement489",{"className":"token","style":{"color":"#a04900"},"children":["/"]}],["$","span","code-segement490",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement491",{"className":"token","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement492",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement493",{"className":"$undefined","style":{},"children":["data_loaders"]}],["$","span","code-segement494",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement495",{"className":"token","style":{"color":"#116b00"},"children":["\'test\'"]}],["$","span","code-segement496",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement497",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement498",{"className":"$undefined","style":{},"children":["dataset"]}],["$","span","code-segement499",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement500",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement501",{"className":"$undefined","style":{},"children":["        accuracy "]}],["$","span","code-segement502",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement503",{"className":"$undefined","style":{},"children":[" num_correct "]}],["$","span","code-segement504",{"className":"token","style":{"color":"#a04900"},"children":["/"]}],["$","span","code-segement505",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement506",{"className":"token","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement507",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement508",{"className":"$undefined","style":{},"children":["data_loaders"]}],["$","span","code-segement509",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement510",{"className":"token","style":{"color":"#116b00"},"children":["\'test\'"]}],["$","span","code-segement511",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement512",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement513",{"className":"$undefined","style":{},"children":["dataset"]}],["$","span","code-segement514",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement515",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement517",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement518",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement519",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement520",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\\"    Average loss: "]}],["$","span","code-segement521",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement522",{"className":"token string-interpolation interpolation","style":{},"children":["average_test_loss"]}],["$","span","code-segement523",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement524",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["\\""]}],["$","span","code-segement525",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement526",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement527",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement528",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement529",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement530",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\\"    Accuracy: "]}],["$","span","code-segement531",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement532",{"className":"token string-interpolation interpolation","style":{},"children":["accuracy"]}],["$","span","code-segement533",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement534",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["\\""]}],["$","span","code-segement535",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement536",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement538",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement539",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement540",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement541",{"className":"token","style":{"color":"#7c00aa"},"children":["save_weights"]}],["$","span","code-segement542",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement543",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement544",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement545",{"className":"$undefined","style":{},"children":[" file_path"]}],["$","span","code-segement546",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement547",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement548",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement549",{"className":"$undefined","style":{},"children":["        torch"]}],["$","span","code-segement550",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement551",{"className":"$undefined","style":{},"children":["save"]}],["$","span","code-segement552",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement553",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement554",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement555",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement556",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement557",{"className":"$undefined","style":{},"children":["state_dict"]}],["$","span","code-segement558",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement559",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement560",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement561",{"className":"$undefined","style":{},"children":[" file_path"]}],["$","span","code-segement562",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement563",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement565",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement566",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement567",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement568",{"className":"token","style":{"color":"#7c00aa"},"children":["train"]}],["$","span","code-segement569",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement570",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement571",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement572",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement573",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement574",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement575",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement576",{"className":"$undefined","style":{},"children":[" epoch_index "]}],["$","span","code-segement577",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement578",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement579",{"className":"token","style":{"color":"#af00af"},"children":["range"]}],["$","span","code-segement580",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement581",{"className":"$undefined","style":{},"children":["config"]}],["$","span","code-segement582",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement583",{"className":"token","style":{"color":"#116b00"},"children":["\'training_num_epochs\'"]}],["$","span","code-segement584",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement585",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement586",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement587",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement588",{"className":"$undefined","style":{},"children":["            "]}],["$","span","code-segement589",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement590",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement591",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\\"Epoch: "]}],["$","span","code-segement592",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement593",{"className":"token string-interpolation interpolation","style":{},"children":["epoch_index"]}],["$","span","code-segement594",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement595",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["\\""]}],["$","span","code-segement596",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement597",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement598",{"className":"$undefined","style":{},"children":["            self"]}],["$","span","code-segement599",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement600",{"className":"$undefined","style":{},"children":["train_single_epoch"]}],["$","span","code-segement601",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement602",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement603",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement605",{"className":"$undefined","style":{},"children":["            model_save_file_path "]}],["$","span","code-segement606",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement607",{"className":"$undefined","style":{},"children":[" join"]}],["$","span","code-segement608",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement609",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement610",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement611",{"className":"$undefined","style":{},"children":["models_dir"]}],["$","span","code-segement612",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement613",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement614",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\\"epoch-"]}],["$","span","code-segement615",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement616",{"className":"token string-interpolation interpolation","style":{},"children":["epoch_index"]}],["$","span","code-segement617",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement618",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[".pt\\""]}],["$","span","code-segement619",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement620",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement621",{"className":"$undefined","style":{},"children":["            self"]}],["$","span","code-segement622",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement623",{"className":"$undefined","style":{},"children":["save_weights"]}],["$","span","code-segement624",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement625",{"className":"$undefined","style":{},"children":["model_save_file_path"]}],["$","span","code-segement626",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement627",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement629",{"className":"$undefined","style":{},"children":["            self"]}],["$","span","code-segement630",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement631",{"className":"$undefined","style":{},"children":["test"]}],["$","span","code-segement632",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement633",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement634",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n","\\n",["$","span","code-segement637",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement638",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement639",{"className":"$undefined","style":{},"children":[" __name__ "]}],["$","span","code-segement640",{"className":"token","style":{"color":"#a04900"},"children":["=="]}],["$","span","code-segement641",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement642",{"className":"token","style":{"color":"#116b00"},"children":["\\"__main__\\""]}],["$","span","code-segement643",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement644",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement645",{"className":"$undefined","style":{},"children":["    model_trainer "]}],["$","span","code-segement646",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement647",{"className":"$undefined","style":{},"children":[" ModelTrainer"]}],["$","span","code-segement648",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement649",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement650",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement651",{"className":"$undefined","style":{},"children":["    model_trainer"]}],["$","span","code-segement652",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement653",{"className":"$undefined","style":{},"children":["train"]}],["$","span","code-segement654",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement655",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Le","36",{"id":"testing","variant":"h5","component":"h2","mb":2,"children":["$","strong",null,{"children":"Testing"}]}],["$","$Le","37",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Still inside the ",["$","$Lc","37-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"src"}]," folder, we create another file called ",["$","$Lc","37-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"test.py"}],". Let\'s import the required packages and load our model."]}],["$","$Lc",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L1c",null,{"contentToCopy":"from json import load as json_load\\nfrom os import listdir\\nfrom os.path import join as path_join\\n\\nimport cv2\\nimport torch\\nfrom torchvision import transforms\\n\\nfrom .config import data_dir, models_dir\\nfrom .dataset import data_loaders\\nfrom .model import CNN\\n\\n\\n# MODEL_WEIGHTS_FILE_PATH = path_join(models_dir, \\"training_id\\", \\"epoch-epoch_numbe\\")\\nMODEL_WEIGHTS_FILE_PATH = path_join(models_dir, \\"torch---2024-04-23-08-25-15\\", \\"epoch-9.pt\\")\\n\\n\\nif __name__ == \\"__main__\\":\\n    device = torch.device(\\"cuda\\" if torch.cuda.is_available() else \\"cpu\\")\\n\\n    model = CNN()\\n    model = model.to(device)\\n\\n    model.load_state_dict(torch.load(MODEL_WEIGHTS_FILE_PATH, map_location=device))\\n\\n    model.eval()"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" json "]}],["$","span","code-segement2",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":[" load "]}],["$","span","code-segement4",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement5",{"className":"$undefined","style":{},"children":[" json_load\\n"]}],["$","span","code-segement6",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement7",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":[" os "]}],["$","span","code-segement9",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":[" listdir\\n"]}],["$","span","code-segement11",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement12",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement13",{"className":"$undefined","style":{},"children":[" os"]}],["$","span","code-segement14",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":["path "]}],["$","span","code-segement16",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement17",{"className":"$undefined","style":{},"children":[" join "]}],["$","span","code-segement18",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement19",{"className":"$undefined","style":{},"children":[" path_join\\n"]}],"\\n",["$","span","code-segement21",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement22",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement23",{"className":"$undefined","style":{},"children":[" cv2\\n"]}],["$","span","code-segement24",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement25",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":[" torch\\n"]}],["$","span","code-segement27",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement28",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement29",{"className":"$undefined","style":{},"children":[" torchvision "]}],["$","span","code-segement30",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement31",{"className":"$undefined","style":{},"children":[" transforms\\n"]}],"\\n",["$","span","code-segement33",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement34",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement35",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement36",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement37",{"className":"$undefined","style":{},"children":["config "]}],["$","span","code-segement38",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement39",{"className":"$undefined","style":{},"children":[" data_dir"]}],["$","span","code-segement40",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement41",{"className":"$undefined","style":{},"children":[" models_dir\\n"]}],["$","span","code-segement42",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement43",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement44",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement45",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement46",{"className":"$undefined","style":{},"children":["dataset "]}],["$","span","code-segement47",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement48",{"className":"$undefined","style":{},"children":[" data_loaders\\n"]}],["$","span","code-segement49",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement50",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement51",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement52",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement53",{"className":"$undefined","style":{},"children":["model "]}],["$","span","code-segement54",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement55",{"className":"$undefined","style":{},"children":[" CNN\\n"]}],"\\n","\\n",["$","span","code-segement58",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement59",{"className":"token","style":{"color":"#3c526d"},"children":["# MODEL_WEIGHTS_FILE_PATH = path_join(models_dir, \\"training_id\\", \\"epoch-epoch_numbe\\")"]}],["$","span","code-segement60",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement61",{"className":"$undefined","style":{},"children":["MODEL_WEIGHTS_FILE_PATH "]}],["$","span","code-segement62",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement63",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement64",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement65",{"className":"$undefined","style":{},"children":["models_dir"]}],["$","span","code-segement66",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement67",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement68",{"className":"token","style":{"color":"#116b00"},"children":["\\"torch---2024-04-23-08-25-15\\""]}],["$","span","code-segement69",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement70",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement71",{"className":"token","style":{"color":"#116b00"},"children":["\\"epoch-9.pt\\""]}],["$","span","code-segement72",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement73",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n","\\n",["$","span","code-segement76",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement77",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement78",{"className":"$undefined","style":{},"children":[" __name__ "]}],["$","span","code-segement79",{"className":"token","style":{"color":"#a04900"},"children":["=="]}],["$","span","code-segement80",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement81",{"className":"token","style":{"color":"#116b00"},"children":["\\"__main__\\""]}],["$","span","code-segement82",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement83",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement84",{"className":"$undefined","style":{},"children":["    device "]}],["$","span","code-segement85",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement86",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement87",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement88",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement89",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement90",{"className":"token","style":{"color":"#116b00"},"children":["\\"cuda\\""]}],["$","span","code-segement91",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement92",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement93",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement94",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement95",{"className":"$undefined","style":{},"children":["cuda"]}],["$","span","code-segement96",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement97",{"className":"$undefined","style":{},"children":["is_available"]}],["$","span","code-segement98",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement99",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement100",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement101",{"className":"token","style":{"color":"#a04900"},"children":["else"]}],["$","span","code-segement102",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement103",{"className":"token","style":{"color":"#116b00"},"children":["\\"cpu\\""]}],["$","span","code-segement104",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement105",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement107",{"className":"$undefined","style":{},"children":["    model "]}],["$","span","code-segement108",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement109",{"className":"$undefined","style":{},"children":[" CNN"]}],["$","span","code-segement110",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement111",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement112",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement113",{"className":"$undefined","style":{},"children":["    model "]}],["$","span","code-segement114",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement115",{"className":"$undefined","style":{},"children":[" model"]}],["$","span","code-segement116",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement117",{"className":"$undefined","style":{},"children":["to"]}],["$","span","code-segement118",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement119",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement120",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement121",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement123",{"className":"$undefined","style":{},"children":["    model"]}],["$","span","code-segement124",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement125",{"className":"$undefined","style":{},"children":["load_state_dict"]}],["$","span","code-segement126",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement127",{"className":"$undefined","style":{},"children":["torch"]}],["$","span","code-segement128",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement129",{"className":"$undefined","style":{},"children":["load"]}],["$","span","code-segement130",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement131",{"className":"$undefined","style":{},"children":["MODEL_WEIGHTS_FILE_PATH"]}],["$","span","code-segement132",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement133",{"className":"$undefined","style":{},"children":[" map_location"]}],["$","span","code-segement134",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement135",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement136",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement137",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement138",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement140",{"className":"$undefined","style":{},"children":["    model"]}],["$","span","code-segement141",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement142",{"className":"token","style":{"color":"#af00af"},"children":["eval"]}],["$","span","code-segement143",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement144",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Le","39",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","We\'ll first test on data from our test data loader and then on some custom images."]}],["$","$Le","40",{"id":"testing-on-mnist-test-data","variant":"h6","component":"h3","mb":2,"children":["$","strong",null,{"children":"Testing on MNIST Test Data"}]}],["$","$Le","41",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","This would be similar to the ",["$","$Lc","41-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"ModelTrainer.test"}]," function defined in the ",["$","$Lc","41-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"train.py"}]," file."]}],["$","$Lc",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L1c",null,{"contentToCopy":"print(\\"Testing on MNIST Test Set\\")\\n\\nnum_correct = 0\\nwith torch.no_grad():\\n    for data, target in data_loaders[\\"test\\"]:\\n        data = data.to(device)\\n        target = target.to(device)\\n\\n        output = model(data)\\n\\n        prediction = output.argmax(dim=1, keepdim=True)\\n\\n        num_correct += prediction.eq(target.view_as(prediction)).sum().item()\\n\\naccuracy = num_correct / len(data_loaders[\'test\'].dataset)\\nprint(f\\"    Accuracy: {accuracy}\\")\\nprint()"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement1",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement2",{"className":"token","style":{"color":"#116b00"},"children":["\\"Testing on MNIST Test Set\\""]}],["$","span","code-segement3",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement6",{"className":"$undefined","style":{},"children":["num_correct "]}],["$","span","code-segement7",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement9",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement11",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement12",{"className":"token","style":{"color":"#a04900"},"children":["with"]}],["$","span","code-segement13",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement14",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":["no_grad"]}],["$","span","code-segement16",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement17",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement18",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement19",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement20",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement21",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement22",{"className":"$undefined","style":{},"children":[" data"]}],["$","span","code-segement23",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement24",{"className":"$undefined","style":{},"children":[" target "]}],["$","span","code-segement25",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":[" data_loaders"]}],["$","span","code-segement27",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement28",{"className":"token","style":{"color":"#116b00"},"children":["\\"test\\""]}],["$","span","code-segement29",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement30",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement31",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement32",{"className":"$undefined","style":{},"children":["        data "]}],["$","span","code-segement33",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement34",{"className":"$undefined","style":{},"children":[" data"]}],["$","span","code-segement35",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement36",{"className":"$undefined","style":{},"children":["to"]}],["$","span","code-segement37",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement38",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement39",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement40",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement41",{"className":"$undefined","style":{},"children":["        target "]}],["$","span","code-segement42",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement43",{"className":"$undefined","style":{},"children":[" target"]}],["$","span","code-segement44",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement45",{"className":"$undefined","style":{},"children":["to"]}],["$","span","code-segement46",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement47",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement48",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement49",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement51",{"className":"$undefined","style":{},"children":["        output "]}],["$","span","code-segement52",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement53",{"className":"$undefined","style":{},"children":[" model"]}],["$","span","code-segement54",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement55",{"className":"$undefined","style":{},"children":["data"]}],["$","span","code-segement56",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement57",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement59",{"className":"$undefined","style":{},"children":["        prediction "]}],["$","span","code-segement60",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement61",{"className":"$undefined","style":{},"children":[" output"]}],["$","span","code-segement62",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement63",{"className":"$undefined","style":{},"children":["argmax"]}],["$","span","code-segement64",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement65",{"className":"$undefined","style":{},"children":["dim"]}],["$","span","code-segement66",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement67",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement68",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement69",{"className":"$undefined","style":{},"children":[" keepdim"]}],["$","span","code-segement70",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement71",{"className":"token","style":{"color":"#755f00"},"children":["True"]}],["$","span","code-segement72",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement73",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement75",{"className":"$undefined","style":{},"children":["        num_correct "]}],["$","span","code-segement76",{"className":"token","style":{"color":"#a04900"},"children":["+="]}],["$","span","code-segement77",{"className":"$undefined","style":{},"children":[" prediction"]}],["$","span","code-segement78",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement79",{"className":"$undefined","style":{},"children":["eq"]}],["$","span","code-segement80",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement81",{"className":"$undefined","style":{},"children":["target"]}],["$","span","code-segement82",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement83",{"className":"$undefined","style":{},"children":["view_as"]}],["$","span","code-segement84",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement85",{"className":"$undefined","style":{},"children":["prediction"]}],["$","span","code-segement86",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement87",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement88",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement89",{"className":"token","style":{"color":"#af00af"},"children":["sum"]}],["$","span","code-segement90",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement91",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement92",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement93",{"className":"$undefined","style":{},"children":["item"]}],["$","span","code-segement94",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement95",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement96",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement98",{"className":"$undefined","style":{},"children":["accuracy "]}],["$","span","code-segement99",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement100",{"className":"$undefined","style":{},"children":[" num_correct "]}],["$","span","code-segement101",{"className":"token","style":{"color":"#a04900"},"children":["/"]}],["$","span","code-segement102",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement103",{"className":"token","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement104",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement105",{"className":"$undefined","style":{},"children":["data_loaders"]}],["$","span","code-segement106",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement107",{"className":"token","style":{"color":"#116b00"},"children":["\'test\'"]}],["$","span","code-segement108",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement109",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement110",{"className":"$undefined","style":{},"children":["dataset"]}],["$","span","code-segement111",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement112",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement113",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement114",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement115",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement116",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\\"    Accuracy: "]}],["$","span","code-segement117",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement118",{"className":"token string-interpolation interpolation","style":{},"children":["accuracy"]}],["$","span","code-segement119",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement120",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["\\""]}],["$","span","code-segement121",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement122",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement123",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement124",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement125",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement126",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Le","43",{"id":"testing-on-custom-images","variant":"h6","component":"h3","mb":2,"children":["$","strong",null,{"children":"Testing on Custom Images"}]}],["$","$Le","44",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Inside our ",["$","$Lc","44-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"data"}]," directory, I have created another folder called ",["$","$Lc","44-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"test_images"}]," containing some 28x28 pngs with a black background and digits drawn in white. I also have a file called ",["$","$Lc","44-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"test_images_labels.json"}]," that contains labels for each of the images. Here is the labels file."]}],["$","$Lc",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L1c",null,{"contentToCopy":"{\\n    \\"1.png\\": 1,\\n    \\"2.png\\": 7,\\n    \\"3.png\\": 2,\\n    \\"4.png\\": 9,\\n    \\"5.png\\": 8,\\n    \\"6.png\\": 5,\\n    \\"7.png\\": 1,\\n    \\"8.png\\": 7,\\n    \\"9.png\\": 1,\\n    \\"10.png\\": 7,\\n    \\"11.png\\": 7,\\n    \\"12.png\\": 0,\\n    \\"13.png\\": 5,\\n    \\"14.png\\": 3,\\n    \\"15.png\\": 2,\\n    \\"16.png\\": 1,\\n    \\"17.png\\": 0,\\n    \\"18.png\\": 8,\\n    \\"19.png\\": 7,\\n    \\"20.png\\": 4\\n}"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-json","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement2",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement3",{"className":"token","style":{"color":"#005a8e"},"children":["\\"1.png\\""]}],["$","span","code-segement4",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement5",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement6",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement7",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement9",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement10",{"className":"token","style":{"color":"#005a8e"},"children":["\\"2.png\\""]}],["$","span","code-segement11",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement12",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement13",{"className":"token","style":{"color":"#755f00"},"children":["7"]}],["$","span","code-segement14",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement16",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement17",{"className":"token","style":{"color":"#005a8e"},"children":["\\"3.png\\""]}],["$","span","code-segement18",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement19",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement20",{"className":"token","style":{"color":"#755f00"},"children":["2"]}],["$","span","code-segement21",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement22",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement23",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement24",{"className":"token","style":{"color":"#005a8e"},"children":["\\"4.png\\""]}],["$","span","code-segement25",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement27",{"className":"token","style":{"color":"#755f00"},"children":["9"]}],["$","span","code-segement28",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement29",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement30",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement31",{"className":"token","style":{"color":"#005a8e"},"children":["\\"5.png\\""]}],["$","span","code-segement32",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement33",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement34",{"className":"token","style":{"color":"#755f00"},"children":["8"]}],["$","span","code-segement35",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement36",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement37",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement38",{"className":"token","style":{"color":"#005a8e"},"children":["\\"6.png\\""]}],["$","span","code-segement39",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement40",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement41",{"className":"token","style":{"color":"#755f00"},"children":["5"]}],["$","span","code-segement42",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement43",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement44",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement45",{"className":"token","style":{"color":"#005a8e"},"children":["\\"7.png\\""]}],["$","span","code-segement46",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement47",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement48",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement49",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement50",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement51",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement52",{"className":"token","style":{"color":"#005a8e"},"children":["\\"8.png\\""]}],["$","span","code-segement53",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement54",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement55",{"className":"token","style":{"color":"#755f00"},"children":["7"]}],["$","span","code-segement56",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement57",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement58",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement59",{"className":"token","style":{"color":"#005a8e"},"children":["\\"9.png\\""]}],["$","span","code-segement60",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement61",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement62",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement63",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement64",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement65",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement66",{"className":"token","style":{"color":"#005a8e"},"children":["\\"10.png\\""]}],["$","span","code-segement67",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement68",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement69",{"className":"token","style":{"color":"#755f00"},"children":["7"]}],["$","span","code-segement70",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement71",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement72",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement73",{"className":"token","style":{"color":"#005a8e"},"children":["\\"11.png\\""]}],["$","span","code-segement74",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement75",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement76",{"className":"token","style":{"color":"#755f00"},"children":["7"]}],["$","span","code-segement77",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement78",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement79",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement80",{"className":"token","style":{"color":"#005a8e"},"children":["\\"12.png\\""]}],["$","span","code-segement81",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement82",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement83",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement84",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement85",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement86",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement87",{"className":"token","style":{"color":"#005a8e"},"children":["\\"13.png\\""]}],["$","span","code-segement88",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement89",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement90",{"className":"token","style":{"color":"#755f00"},"children":["5"]}],["$","span","code-segement91",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement92",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement93",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement94",{"className":"token","style":{"color":"#005a8e"},"children":["\\"14.png\\""]}],["$","span","code-segement95",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement96",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement97",{"className":"token","style":{"color":"#755f00"},"children":["3"]}],["$","span","code-segement98",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement99",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement100",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement101",{"className":"token","style":{"color":"#005a8e"},"children":["\\"15.png\\""]}],["$","span","code-segement102",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement103",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement104",{"className":"token","style":{"color":"#755f00"},"children":["2"]}],["$","span","code-segement105",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement106",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement107",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement108",{"className":"token","style":{"color":"#005a8e"},"children":["\\"16.png\\""]}],["$","span","code-segement109",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement110",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement111",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement112",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement113",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement114",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement115",{"className":"token","style":{"color":"#005a8e"},"children":["\\"17.png\\""]}],["$","span","code-segement116",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement117",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement118",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement119",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement120",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement121",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement122",{"className":"token","style":{"color":"#005a8e"},"children":["\\"18.png\\""]}],["$","span","code-segement123",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement124",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement125",{"className":"token","style":{"color":"#755f00"},"children":["8"]}],["$","span","code-segement126",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement127",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement128",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement129",{"className":"token","style":{"color":"#005a8e"},"children":["\\"19.png\\""]}],["$","span","code-segement130",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement131",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement132",{"className":"token","style":{"color":"#755f00"},"children":["7"]}],["$","span","code-segement133",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement134",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement135",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement136",{"className":"token","style":{"color":"#005a8e"},"children":["\\"20.png\\""]}],["$","span","code-segement137",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement138",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement139",{"className":"token","style":{"color":"#755f00"},"children":["4"]}],["$","span","code-segement140",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement141",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement142",{"className":"token","style":{"color":"#111b27"},"children":["}"]}]]]}]}]]}],["$","$Le","46",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","We want to preprocess our testing images exactly in the same way we preprocessed our training data, so we define a set of transforms for the same."]}],["$","$Lc",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L1c",null,{"contentToCopy":"preprocessing_transforms = transforms.Compose([\\n    transforms.ToTensor(),\\n])"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"$undefined","style":{},"children":["preprocessing_transforms "]}],["$","span","code-segement1",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement2",{"className":"$undefined","style":{},"children":[" transforms"]}],["$","span","code-segement3",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":["Compose"]}],["$","span","code-segement5",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement6",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement7",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":["    transforms"]}],["$","span","code-segement9",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":["ToTensor"]}],["$","span","code-segement11",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement12",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement13",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement14",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement16",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement17",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Le","48",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","We can now load the images, get predictions on them, and calculate the accuracy."]}],["$","$Lc",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L1c",null,{"contentToCopy":"$1e"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"$undefined","style":{},"children":["test_images_dir "]}],["$","span","code-segement1",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement2",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement3",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":["data_dir"]}],["$","span","code-segement5",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement6",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement7",{"className":"token","style":{"color":"#116b00"},"children":["\\"test_images\\""]}],["$","span","code-segement8",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement9",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement11",{"className":"$undefined","style":{},"children":["test_images_labels_file_path "]}],["$","span","code-segement12",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement13",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement14",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":["data_dir"]}],["$","span","code-segement16",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement17",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement18",{"className":"token","style":{"color":"#116b00"},"children":["\\"test_images_labels.json\\""]}],["$","span","code-segement19",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement20",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement21",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement22",{"className":"token","style":{"color":"#a04900"},"children":["with"]}],["$","span","code-segement23",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement24",{"className":"token","style":{"color":"#af00af"},"children":["open"]}],["$","span","code-segement25",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":["test_images_labels_file_path"]}],["$","span","code-segement27",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement28",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement29",{"className":"token","style":{"color":"#116b00"},"children":["\'r\'"]}],["$","span","code-segement30",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement31",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement32",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement33",{"className":"$undefined","style":{},"children":[" test_images_labels_file"]}],["$","span","code-segement34",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement35",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement36",{"className":"$undefined","style":{},"children":["    test_images_labels "]}],["$","span","code-segement37",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement38",{"className":"$undefined","style":{},"children":[" json_load"]}],["$","span","code-segement39",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement40",{"className":"$undefined","style":{},"children":["test_images_labels_file"]}],["$","span","code-segement41",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement42",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement44",{"className":"$undefined","style":{},"children":["test_images "]}],["$","span","code-segement45",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement46",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement47",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement48",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement49",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement50",{"className":"$undefined","style":{},"children":["test_labels "]}],["$","span","code-segement51",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement52",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement53",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement54",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement55",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement56",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement57",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement58",{"className":"$undefined","style":{},"children":[" image_name "]}],["$","span","code-segement59",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement60",{"className":"$undefined","style":{},"children":[" listdir"]}],["$","span","code-segement61",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement62",{"className":"$undefined","style":{},"children":["test_images_dir"]}],["$","span","code-segement63",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement64",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement65",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement66",{"className":"$undefined","style":{},"children":["    image_path "]}],["$","span","code-segement67",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement68",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement69",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement70",{"className":"$undefined","style":{},"children":["test_images_dir"]}],["$","span","code-segement71",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement72",{"className":"$undefined","style":{},"children":[" image_name"]}],["$","span","code-segement73",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement74",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement75",{"className":"$undefined","style":{},"children":["    image "]}],["$","span","code-segement76",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement77",{"className":"$undefined","style":{},"children":[" cv2"]}],["$","span","code-segement78",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement79",{"className":"$undefined","style":{},"children":["imread"]}],["$","span","code-segement80",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement81",{"className":"$undefined","style":{},"children":["image_path"]}],["$","span","code-segement82",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement83",{"className":"$undefined","style":{},"children":[" cv2"]}],["$","span","code-segement84",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement85",{"className":"$undefined","style":{},"children":["IMREAD_GRAYSCALE"]}],["$","span","code-segement86",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement87",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement88",{"className":"$undefined","style":{},"children":["    test_images"]}],["$","span","code-segement89",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement90",{"className":"$undefined","style":{},"children":["append"]}],["$","span","code-segement91",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement92",{"className":"$undefined","style":{},"children":["image"]}],["$","span","code-segement93",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement94",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement96",{"className":"$undefined","style":{},"children":["    test_labels"]}],["$","span","code-segement97",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement98",{"className":"$undefined","style":{},"children":["append"]}],["$","span","code-segement99",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement100",{"className":"$undefined","style":{},"children":["test_images_labels"]}],["$","span","code-segement101",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement102",{"className":"$undefined","style":{},"children":["image_name"]}],["$","span","code-segement103",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement104",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement105",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement107",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement108",{"className":"token","style":{"color":"#3c526d"},"children":["# Preprocess"]}],["$","span","code-segement109",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement110",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement111",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement112",{"className":"$undefined","style":{},"children":[" i "]}],["$","span","code-segement113",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement114",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement115",{"className":"token","style":{"color":"#af00af"},"children":["range"]}],["$","span","code-segement116",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement117",{"className":"token","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement118",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement119",{"className":"$undefined","style":{},"children":["test_images"]}],["$","span","code-segement120",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement121",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement122",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement123",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement124",{"className":"$undefined","style":{},"children":["    test_images"]}],["$","span","code-segement125",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement126",{"className":"$undefined","style":{},"children":["i"]}],["$","span","code-segement127",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement128",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement129",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement130",{"className":"$undefined","style":{},"children":[" preprocessing_transforms"]}],["$","span","code-segement131",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement132",{"className":"$undefined","style":{},"children":["test_images"]}],["$","span","code-segement133",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement134",{"className":"$undefined","style":{},"children":["i"]}],["$","span","code-segement135",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement136",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement137",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement138",{"className":"$undefined","style":{},"children":["    test_images"]}],["$","span","code-segement139",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement140",{"className":"$undefined","style":{},"children":["i"]}],["$","span","code-segement141",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement142",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement143",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement144",{"className":"$undefined","style":{},"children":[" test_images"]}],["$","span","code-segement145",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement146",{"className":"$undefined","style":{},"children":["i"]}],["$","span","code-segement147",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement148",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement149",{"className":"$undefined","style":{},"children":["unsqueeze"]}],["$","span","code-segement150",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement151",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement152",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement153",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement155",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement156",{"className":"token","style":{"color":"#3c526d"},"children":["# Predict"]}],["$","span","code-segement157",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement158",{"className":"$undefined","style":{},"children":["num_correct "]}],["$","span","code-segement159",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement160",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement161",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement162",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement163",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement164",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement165",{"className":"$undefined","style":{},"children":[" preprocessed_image"]}],["$","span","code-segement166",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement167",{"className":"$undefined","style":{},"children":[" label "]}],["$","span","code-segement168",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement169",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement170",{"className":"token","style":{"color":"#af00af"},"children":["zip"]}],["$","span","code-segement171",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement172",{"className":"$undefined","style":{},"children":["test_images"]}],["$","span","code-segement173",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement174",{"className":"$undefined","style":{},"children":[" test_labels"]}],["$","span","code-segement175",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement176",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement177",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement178",{"className":"$undefined","style":{},"children":["    output "]}],["$","span","code-segement179",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement180",{"className":"$undefined","style":{},"children":[" model"]}],["$","span","code-segement181",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement182",{"className":"$undefined","style":{},"children":["preprocessed_image"]}],["$","span","code-segement183",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement184",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement185",{"className":"$undefined","style":{},"children":["    prediction "]}],["$","span","code-segement186",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement187",{"className":"$undefined","style":{},"children":[" output"]}],["$","span","code-segement188",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement189",{"className":"$undefined","style":{},"children":["argmax"]}],["$","span","code-segement190",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement191",{"className":"$undefined","style":{},"children":["dim"]}],["$","span","code-segement192",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement193",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement194",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement195",{"className":"$undefined","style":{},"children":[" keepdim"]}],["$","span","code-segement196",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement197",{"className":"token","style":{"color":"#755f00"},"children":["True"]}],["$","span","code-segement198",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement199",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement200",{"className":"$undefined","style":{},"children":["    prediction "]}],["$","span","code-segement201",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement202",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement203",{"className":"token","style":{"color":"#af00af"},"children":["int"]}],["$","span","code-segement204",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement205",{"className":"$undefined","style":{},"children":["prediction"]}],["$","span","code-segement206",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement207",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement209",{"className":"$undefined","style":{},"children":["    num_correct "]}],["$","span","code-segement210",{"className":"token","style":{"color":"#a04900"},"children":["+="]}],["$","span","code-segement211",{"className":"$undefined","style":{},"children":[" prediction "]}],["$","span","code-segement212",{"className":"token","style":{"color":"#a04900"},"children":["=="]}],["$","span","code-segement213",{"className":"$undefined","style":{},"children":[" label\\n"]}],"\\n",["$","span","code-segement215",{"className":"$undefined","style":{},"children":["accuracy "]}],["$","span","code-segement216",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement217",{"className":"$undefined","style":{},"children":[" num_correct "]}],["$","span","code-segement218",{"className":"token","style":{"color":"#a04900"},"children":["/"]}],["$","span","code-segement219",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement220",{"className":"token","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement221",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement222",{"className":"$undefined","style":{},"children":["test_images"]}],["$","span","code-segement223",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement224",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement225",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement226",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement227",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement228",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\\"Correct: "]}],["$","span","code-segement229",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement230",{"className":"token string-interpolation interpolation","style":{},"children":["num_correct"]}],["$","span","code-segement231",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement232",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[" / "]}],["$","span","code-segement233",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement234",{"className":"token string-interpolation interpolation","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement235",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement236",{"className":"token string-interpolation interpolation","style":{},"children":["test_images"]}],["$","span","code-segement237",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement238",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement239",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[", Accuracy: "]}],["$","span","code-segement240",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement241",{"className":"token string-interpolation interpolation","style":{},"children":["accuracy"]}],["$","span","code-segement242",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement243",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["\\""]}],["$","span","code-segement244",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Le","50",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Here\'s the entire ",["$","$Lc","50-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"src/test.py"}]," file."]}],["$","$Lc",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L1c",null,{"contentToCopy":"$1f"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" json "]}],["$","span","code-segement2",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":[" load "]}],["$","span","code-segement4",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement5",{"className":"$undefined","style":{},"children":[" json_load\\n"]}],["$","span","code-segement6",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement7",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":[" os "]}],["$","span","code-segement9",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":[" listdir\\n"]}],["$","span","code-segement11",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement12",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement13",{"className":"$undefined","style":{},"children":[" os"]}],["$","span","code-segement14",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":["path "]}],["$","span","code-segement16",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement17",{"className":"$undefined","style":{},"children":[" join "]}],["$","span","code-segement18",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement19",{"className":"$undefined","style":{},"children":[" path_join\\n"]}],"\\n",["$","span","code-segement21",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement22",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement23",{"className":"$undefined","style":{},"children":[" cv2\\n"]}],["$","span","code-segement24",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement25",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":[" torch\\n"]}],["$","span","code-segement27",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement28",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement29",{"className":"$undefined","style":{},"children":[" torchvision "]}],["$","span","code-segement30",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement31",{"className":"$undefined","style":{},"children":[" transforms\\n"]}],"\\n",["$","span","code-segement33",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement34",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement35",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement36",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement37",{"className":"$undefined","style":{},"children":["config "]}],["$","span","code-segement38",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement39",{"className":"$undefined","style":{},"children":[" data_dir"]}],["$","span","code-segement40",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement41",{"className":"$undefined","style":{},"children":[" models_dir\\n"]}],["$","span","code-segement42",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement43",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement44",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement45",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement46",{"className":"$undefined","style":{},"children":["dataset "]}],["$","span","code-segement47",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement48",{"className":"$undefined","style":{},"children":[" data_loaders\\n"]}],["$","span","code-segement49",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement50",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement51",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement52",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement53",{"className":"$undefined","style":{},"children":["model "]}],["$","span","code-segement54",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement55",{"className":"$undefined","style":{},"children":[" CNN\\n"]}],"\\n","\\n",["$","span","code-segement58",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement59",{"className":"token","style":{"color":"#3c526d"},"children":["# MODEL_WEIGHTS_FILE_PATH = path_join(models_dir, \\"training_id\\", \\"epoch-epoch_numbe\\")"]}],["$","span","code-segement60",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement61",{"className":"$undefined","style":{},"children":["MODEL_WEIGHTS_FILE_PATH "]}],["$","span","code-segement62",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement63",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement64",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement65",{"className":"$undefined","style":{},"children":["models_dir"]}],["$","span","code-segement66",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement67",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement68",{"className":"token","style":{"color":"#116b00"},"children":["\\"torch---2024-04-23-08-25-15\\""]}],["$","span","code-segement69",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement70",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement71",{"className":"token","style":{"color":"#116b00"},"children":["\\"epoch-9.pt\\""]}],["$","span","code-segement72",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement73",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n","\\n",["$","span","code-segement76",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement77",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement78",{"className":"$undefined","style":{},"children":[" __name__ "]}],["$","span","code-segement79",{"className":"token","style":{"color":"#a04900"},"children":["=="]}],["$","span","code-segement80",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement81",{"className":"token","style":{"color":"#116b00"},"children":["\\"__main__\\""]}],["$","span","code-segement82",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement83",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement84",{"className":"$undefined","style":{},"children":["    device "]}],["$","span","code-segement85",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement86",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement87",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement88",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement89",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement90",{"className":"token","style":{"color":"#116b00"},"children":["\\"cuda\\""]}],["$","span","code-segement91",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement92",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement93",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement94",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement95",{"className":"$undefined","style":{},"children":["cuda"]}],["$","span","code-segement96",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement97",{"className":"$undefined","style":{},"children":["is_available"]}],["$","span","code-segement98",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement99",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement100",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement101",{"className":"token","style":{"color":"#a04900"},"children":["else"]}],["$","span","code-segement102",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement103",{"className":"token","style":{"color":"#116b00"},"children":["\\"cpu\\""]}],["$","span","code-segement104",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement105",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement107",{"className":"$undefined","style":{},"children":["    model "]}],["$","span","code-segement108",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement109",{"className":"$undefined","style":{},"children":[" CNN"]}],["$","span","code-segement110",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement111",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement112",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement113",{"className":"$undefined","style":{},"children":["    model "]}],["$","span","code-segement114",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement115",{"className":"$undefined","style":{},"children":[" model"]}],["$","span","code-segement116",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement117",{"className":"$undefined","style":{},"children":["to"]}],["$","span","code-segement118",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement119",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement120",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement121",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement123",{"className":"$undefined","style":{},"children":["    model"]}],["$","span","code-segement124",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement125",{"className":"$undefined","style":{},"children":["load_state_dict"]}],["$","span","code-segement126",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement127",{"className":"$undefined","style":{},"children":["torch"]}],["$","span","code-segement128",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement129",{"className":"$undefined","style":{},"children":["load"]}],["$","span","code-segement130",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement131",{"className":"$undefined","style":{},"children":["MODEL_WEIGHTS_FILE_PATH"]}],["$","span","code-segement132",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement133",{"className":"$undefined","style":{},"children":[" map_location"]}],["$","span","code-segement134",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement135",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement136",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement137",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement138",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement140",{"className":"$undefined","style":{},"children":["    model"]}],["$","span","code-segement141",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement142",{"className":"token","style":{"color":"#af00af"},"children":["eval"]}],["$","span","code-segement143",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement144",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement145",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement147",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement148",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement149",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement150",{"className":"token","style":{"color":"#116b00"},"children":["\\"Testing on MNIST Test Set\\""]}],["$","span","code-segement151",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement152",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement154",{"className":"$undefined","style":{},"children":["    num_correct "]}],["$","span","code-segement155",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement156",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement157",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement158",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement159",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement160",{"className":"token","style":{"color":"#a04900"},"children":["with"]}],["$","span","code-segement161",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement162",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement163",{"className":"$undefined","style":{},"children":["no_grad"]}],["$","span","code-segement164",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement165",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement166",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement167",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement168",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement169",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement170",{"className":"$undefined","style":{},"children":[" data"]}],["$","span","code-segement171",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement172",{"className":"$undefined","style":{},"children":[" target "]}],["$","span","code-segement173",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement174",{"className":"$undefined","style":{},"children":[" data_loaders"]}],["$","span","code-segement175",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement176",{"className":"token","style":{"color":"#116b00"},"children":["\\"test\\""]}],["$","span","code-segement177",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement178",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement179",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement180",{"className":"$undefined","style":{},"children":["            data "]}],["$","span","code-segement181",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement182",{"className":"$undefined","style":{},"children":[" data"]}],["$","span","code-segement183",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement184",{"className":"$undefined","style":{},"children":["to"]}],["$","span","code-segement185",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement186",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement187",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement188",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement189",{"className":"$undefined","style":{},"children":["            target "]}],["$","span","code-segement190",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement191",{"className":"$undefined","style":{},"children":[" target"]}],["$","span","code-segement192",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement193",{"className":"$undefined","style":{},"children":["to"]}],["$","span","code-segement194",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement195",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement196",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement197",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement199",{"className":"$undefined","style":{},"children":["            output "]}],["$","span","code-segement200",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement201",{"className":"$undefined","style":{},"children":[" model"]}],["$","span","code-segement202",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement203",{"className":"$undefined","style":{},"children":["data"]}],["$","span","code-segement204",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement205",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement207",{"className":"$undefined","style":{},"children":["            prediction "]}],["$","span","code-segement208",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement209",{"className":"$undefined","style":{},"children":[" output"]}],["$","span","code-segement210",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement211",{"className":"$undefined","style":{},"children":["argmax"]}],["$","span","code-segement212",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement213",{"className":"$undefined","style":{},"children":["dim"]}],["$","span","code-segement214",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement215",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement216",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement217",{"className":"$undefined","style":{},"children":[" keepdim"]}],["$","span","code-segement218",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement219",{"className":"token","style":{"color":"#755f00"},"children":["True"]}],["$","span","code-segement220",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement221",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement223",{"className":"$undefined","style":{},"children":["            num_correct "]}],["$","span","code-segement224",{"className":"token","style":{"color":"#a04900"},"children":["+="]}],["$","span","code-segement225",{"className":"$undefined","style":{},"children":[" prediction"]}],["$","span","code-segement226",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement227",{"className":"$undefined","style":{},"children":["eq"]}],["$","span","code-segement228",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement229",{"className":"$undefined","style":{},"children":["target"]}],["$","span","code-segement230",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement231",{"className":"$undefined","style":{},"children":["view_as"]}],["$","span","code-segement232",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement233",{"className":"$undefined","style":{},"children":["prediction"]}],["$","span","code-segement234",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement235",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement236",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement237",{"className":"token","style":{"color":"#af00af"},"children":["sum"]}],["$","span","code-segement238",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement239",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement240",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement241",{"className":"$undefined","style":{},"children":["item"]}],["$","span","code-segement242",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement243",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement244",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement246",{"className":"$undefined","style":{},"children":["    accuracy "]}],["$","span","code-segement247",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement248",{"className":"$undefined","style":{},"children":[" num_correct "]}],["$","span","code-segement249",{"className":"token","style":{"color":"#a04900"},"children":["/"]}],["$","span","code-segement250",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement251",{"className":"token","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement252",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement253",{"className":"$undefined","style":{},"children":["data_loaders"]}],["$","span","code-segement254",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement255",{"className":"token","style":{"color":"#116b00"},"children":["\'test\'"]}],["$","span","code-segement256",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement257",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement258",{"className":"$undefined","style":{},"children":["dataset"]}],["$","span","code-segement259",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement260",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement261",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement262",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement263",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement264",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\\"    Accuracy: "]}],["$","span","code-segement265",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement266",{"className":"token string-interpolation interpolation","style":{},"children":["accuracy"]}],["$","span","code-segement267",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement268",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["\\""]}],["$","span","code-segement269",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement270",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement271",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement272",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement273",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement274",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement275",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement277",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement278",{"className":"token","style":{"color":"#3c526d"},"children":["### Test on Custom Images"]}],["$","span","code-segement279",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement280",{"className":"$undefined","style":{},"children":["    preprocessing_transforms "]}],["$","span","code-segement281",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement282",{"className":"$undefined","style":{},"children":[" transforms"]}],["$","span","code-segement283",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement284",{"className":"$undefined","style":{},"children":["Compose"]}],["$","span","code-segement285",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement286",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement287",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement288",{"className":"$undefined","style":{},"children":["        transforms"]}],["$","span","code-segement289",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement290",{"className":"$undefined","style":{},"children":["ToTensor"]}],["$","span","code-segement291",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement292",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement293",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement294",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement295",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement296",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement297",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement298",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement300",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement301",{"className":"token","style":{"color":"#3c526d"},"children":["# Load Images"]}],["$","span","code-segement302",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement303",{"className":"$undefined","style":{},"children":["    test_images_dir "]}],["$","span","code-segement304",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement305",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement306",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement307",{"className":"$undefined","style":{},"children":["data_dir"]}],["$","span","code-segement308",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement309",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement310",{"className":"token","style":{"color":"#116b00"},"children":["\\"test_images\\""]}],["$","span","code-segement311",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement312",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement314",{"className":"$undefined","style":{},"children":["    test_images_labels_file_path "]}],["$","span","code-segement315",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement316",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement317",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement318",{"className":"$undefined","style":{},"children":["data_dir"]}],["$","span","code-segement319",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement320",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement321",{"className":"token","style":{"color":"#116b00"},"children":["\\"test_images_labels.json\\""]}],["$","span","code-segement322",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement323",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement324",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement325",{"className":"token","style":{"color":"#a04900"},"children":["with"]}],["$","span","code-segement326",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement327",{"className":"token","style":{"color":"#af00af"},"children":["open"]}],["$","span","code-segement328",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement329",{"className":"$undefined","style":{},"children":["test_images_labels_file_path"]}],["$","span","code-segement330",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement331",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement332",{"className":"token","style":{"color":"#116b00"},"children":["\'r\'"]}],["$","span","code-segement333",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement334",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement335",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement336",{"className":"$undefined","style":{},"children":[" test_images_labels_file"]}],["$","span","code-segement337",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement338",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement339",{"className":"$undefined","style":{},"children":["        test_images_labels "]}],["$","span","code-segement340",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement341",{"className":"$undefined","style":{},"children":[" json_load"]}],["$","span","code-segement342",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement343",{"className":"$undefined","style":{},"children":["test_images_labels_file"]}],["$","span","code-segement344",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement345",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement347",{"className":"$undefined","style":{},"children":["    test_images "]}],["$","span","code-segement348",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement349",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement350",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement351",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement352",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement353",{"className":"$undefined","style":{},"children":["    test_labels "]}],["$","span","code-segement354",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement355",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement356",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement357",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement358",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement359",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement360",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement361",{"className":"$undefined","style":{},"children":[" image_name "]}],["$","span","code-segement362",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement363",{"className":"$undefined","style":{},"children":[" listdir"]}],["$","span","code-segement364",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement365",{"className":"$undefined","style":{},"children":["test_images_dir"]}],["$","span","code-segement366",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement367",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement368",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement369",{"className":"$undefined","style":{},"children":["        image_path "]}],["$","span","code-segement370",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement371",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement372",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement373",{"className":"$undefined","style":{},"children":["test_images_dir"]}],["$","span","code-segement374",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement375",{"className":"$undefined","style":{},"children":[" image_name"]}],["$","span","code-segement376",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement377",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement378",{"className":"$undefined","style":{},"children":["        image "]}],["$","span","code-segement379",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement380",{"className":"$undefined","style":{},"children":[" cv2"]}],["$","span","code-segement381",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement382",{"className":"$undefined","style":{},"children":["imread"]}],["$","span","code-segement383",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement384",{"className":"$undefined","style":{},"children":["image_path"]}],["$","span","code-segement385",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement386",{"className":"$undefined","style":{},"children":[" cv2"]}],["$","span","code-segement387",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement388",{"className":"$undefined","style":{},"children":["IMREAD_GRAYSCALE"]}],["$","span","code-segement389",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement390",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement391",{"className":"$undefined","style":{},"children":["        test_images"]}],["$","span","code-segement392",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement393",{"className":"$undefined","style":{},"children":["append"]}],["$","span","code-segement394",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement395",{"className":"$undefined","style":{},"children":["image"]}],["$","span","code-segement396",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement397",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement399",{"className":"$undefined","style":{},"children":["        test_labels"]}],["$","span","code-segement400",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement401",{"className":"$undefined","style":{},"children":["append"]}],["$","span","code-segement402",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement403",{"className":"$undefined","style":{},"children":["test_images_labels"]}],["$","span","code-segement404",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement405",{"className":"$undefined","style":{},"children":["image_name"]}],["$","span","code-segement406",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement407",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement408",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement410",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement411",{"className":"token","style":{"color":"#3c526d"},"children":["# Preprocess"]}],["$","span","code-segement412",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement413",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement414",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement415",{"className":"$undefined","style":{},"children":[" i "]}],["$","span","code-segement416",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement417",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement418",{"className":"token","style":{"color":"#af00af"},"children":["range"]}],["$","span","code-segement419",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement420",{"className":"token","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement421",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement422",{"className":"$undefined","style":{},"children":["test_images"]}],["$","span","code-segement423",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement424",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement425",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement426",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement427",{"className":"$undefined","style":{},"children":["        test_images"]}],["$","span","code-segement428",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement429",{"className":"$undefined","style":{},"children":["i"]}],["$","span","code-segement430",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement431",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement432",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement433",{"className":"$undefined","style":{},"children":[" preprocessing_transforms"]}],["$","span","code-segement434",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement435",{"className":"$undefined","style":{},"children":["test_images"]}],["$","span","code-segement436",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement437",{"className":"$undefined","style":{},"children":["i"]}],["$","span","code-segement438",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement439",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement440",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement441",{"className":"$undefined","style":{},"children":["        test_images"]}],["$","span","code-segement442",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement443",{"className":"$undefined","style":{},"children":["i"]}],["$","span","code-segement444",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement445",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement446",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement447",{"className":"$undefined","style":{},"children":[" test_images"]}],["$","span","code-segement448",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement449",{"className":"$undefined","style":{},"children":["i"]}],["$","span","code-segement450",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement451",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement452",{"className":"$undefined","style":{},"children":["unsqueeze"]}],["$","span","code-segement453",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement454",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement455",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement456",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement458",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement459",{"className":"token","style":{"color":"#3c526d"},"children":["# Predict"]}],["$","span","code-segement460",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement461",{"className":"$undefined","style":{},"children":["    num_correct "]}],["$","span","code-segement462",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement463",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement464",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement465",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement466",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement467",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement468",{"className":"$undefined","style":{},"children":[" preprocessed_image"]}],["$","span","code-segement469",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement470",{"className":"$undefined","style":{},"children":[" label "]}],["$","span","code-segement471",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement472",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement473",{"className":"token","style":{"color":"#af00af"},"children":["zip"]}],["$","span","code-segement474",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement475",{"className":"$undefined","style":{},"children":["test_images"]}],["$","span","code-segement476",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement477",{"className":"$undefined","style":{},"children":[" test_labels"]}],["$","span","code-segement478",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement479",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement480",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement481",{"className":"$undefined","style":{},"children":["        output "]}],["$","span","code-segement482",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement483",{"className":"$undefined","style":{},"children":[" model"]}],["$","span","code-segement484",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement485",{"className":"$undefined","style":{},"children":["preprocessed_image"]}],["$","span","code-segement486",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement487",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement488",{"className":"$undefined","style":{},"children":["        prediction "]}],["$","span","code-segement489",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement490",{"className":"$undefined","style":{},"children":[" output"]}],["$","span","code-segement491",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement492",{"className":"$undefined","style":{},"children":["argmax"]}],["$","span","code-segement493",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement494",{"className":"$undefined","style":{},"children":["dim"]}],["$","span","code-segement495",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement496",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement497",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement498",{"className":"$undefined","style":{},"children":[" keepdim"]}],["$","span","code-segement499",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement500",{"className":"token","style":{"color":"#755f00"},"children":["True"]}],["$","span","code-segement501",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement502",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement503",{"className":"$undefined","style":{},"children":["        prediction "]}],["$","span","code-segement504",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement505",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement506",{"className":"token","style":{"color":"#af00af"},"children":["int"]}],["$","span","code-segement507",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement508",{"className":"$undefined","style":{},"children":["prediction"]}],["$","span","code-segement509",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement510",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement512",{"className":"$undefined","style":{},"children":["        num_correct "]}],["$","span","code-segement513",{"className":"token","style":{"color":"#a04900"},"children":["+="]}],["$","span","code-segement514",{"className":"$undefined","style":{},"children":[" prediction "]}],["$","span","code-segement515",{"className":"token","style":{"color":"#a04900"},"children":["=="]}],["$","span","code-segement516",{"className":"$undefined","style":{},"children":[" label\\n"]}],"\\n",["$","span","code-segement518",{"className":"$undefined","style":{},"children":["    accuracy "]}],["$","span","code-segement519",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement520",{"className":"$undefined","style":{},"children":[" num_correct "]}],["$","span","code-segement521",{"className":"token","style":{"color":"#a04900"},"children":["/"]}],["$","span","code-segement522",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement523",{"className":"token","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement524",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement525",{"className":"$undefined","style":{},"children":["test_images"]}],["$","span","code-segement526",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement527",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement528",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement529",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement530",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement531",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\\"Correct: "]}],["$","span","code-segement532",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement533",{"className":"token string-interpolation interpolation","style":{},"children":["num_correct"]}],["$","span","code-segement534",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement535",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[" / "]}],["$","span","code-segement536",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement537",{"className":"token string-interpolation interpolation","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement538",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement539",{"className":"token string-interpolation interpolation","style":{},"children":["test_images"]}],["$","span","code-segement540",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement541",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement542",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[", Accuracy: "]}],["$","span","code-segement543",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement544",{"className":"token string-interpolation interpolation","style":{},"children":["accuracy"]}],["$","span","code-segement545",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement546",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["\\""]}],["$","span","code-segement547",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Le","52",{"id":"conversion-to-onnx","variant":"h5","component":"h2","mb":2,"children":["$","strong",null,{"children":"Conversion to ONNX"}]}],["$","$Le","53",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Inside the ",["$","$Lc","53-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"src"}]," folder, create another folder called ",["$","$Lc","53-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"converters"}]," and in it create a file called ",["$","$Lc","53-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"converter_onnx.py"}],"."]}],["$","$Lc",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L1c",null,{"contentToCopy":"from os.path import dirname, join as path_join\\n\\nimport torch\\n\\nfrom ..config import models_dir\\nfrom ..dataset import data_loaders\\nfrom ..model import CNN\\n\\n\\n# MODEL_WEIGHTS_FILE_PATH = path_join(models_dir, \\"training_id\\", \\"epoch-epoch_numbe\\")\\nMODEL_WEIGHTS_FILE_PATH = path_join(models_dir, \\"torch---2024-04-23-08-25-15\\", \\"epoch-9.pt\\")\\nONNX_MODEL_FILE_PATH = path_join(dirname(MODEL_WEIGHTS_FILE_PATH), \\"model.onnx\\")\\n\\n\\nif __name__ == \\"__main__\\":\\n    device = torch.device(\\"cpu\\")\\n\\n    torch_model = CNN()\\n    torch_model = torch_model.to(device)\\n\\n    torch_model.load_state_dict(torch.load(MODEL_WEIGHTS_FILE_PATH, map_location=device))\\n\\n    torch_model.eval()\\n\\n    for data, target in data_loaders[\\"test\\"]:\\n        data = data.to(device)\\n        target = target.to(device)\\n        break\\n\\n    sample_input = data[0].unsqueeze(0)\\n\\n    onnx_model = torch.onnx.dynamo_export(\\n        torch_model,\\n        sample_input\\n    )\\n\\n    onnx_model.save(ONNX_MODEL_FILE_PATH)"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \\"Andale Mono\\", \\"Ubuntu Mono\\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" os"]}],["$","span","code-segement2",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":["path "]}],["$","span","code-segement4",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement5",{"className":"$undefined","style":{},"children":[" dirname"]}],["$","span","code-segement6",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement7",{"className":"$undefined","style":{},"children":[" join "]}],["$","span","code-segement8",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement9",{"className":"$undefined","style":{},"children":[" path_join\\n"]}],"\\n",["$","span","code-segement11",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement12",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement13",{"className":"$undefined","style":{},"children":[" torch\\n"]}],"\\n",["$","span","code-segement15",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement16",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement17",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement18",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement19",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement20",{"className":"$undefined","style":{},"children":["config "]}],["$","span","code-segement21",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement22",{"className":"$undefined","style":{},"children":[" models_dir\\n"]}],["$","span","code-segement23",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement24",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement25",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement26",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement27",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement28",{"className":"$undefined","style":{},"children":["dataset "]}],["$","span","code-segement29",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement30",{"className":"$undefined","style":{},"children":[" data_loaders\\n"]}],["$","span","code-segement31",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement32",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement33",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement34",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement35",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement36",{"className":"$undefined","style":{},"children":["model "]}],["$","span","code-segement37",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement38",{"className":"$undefined","style":{},"children":[" CNN\\n"]}],"\\n","\\n",["$","span","code-segement41",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement42",{"className":"token","style":{"color":"#3c526d"},"children":["# MODEL_WEIGHTS_FILE_PATH = path_join(models_dir, \\"training_id\\", \\"epoch-epoch_numbe\\")"]}],["$","span","code-segement43",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement44",{"className":"$undefined","style":{},"children":["MODEL_WEIGHTS_FILE_PATH "]}],["$","span","code-segement45",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement46",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement47",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement48",{"className":"$undefined","style":{},"children":["models_dir"]}],["$","span","code-segement49",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement50",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement51",{"className":"token","style":{"color":"#116b00"},"children":["\\"torch---2024-04-23-08-25-15\\""]}],["$","span","code-segement52",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement53",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement54",{"className":"token","style":{"color":"#116b00"},"children":["\\"epoch-9.pt\\""]}],["$","span","code-segement55",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement56",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement57",{"className":"$undefined","style":{},"children":["ONNX_MODEL_FILE_PATH "]}],["$","span","code-segement58",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement59",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement60",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement61",{"className":"$undefined","style":{},"children":["dirname"]}],["$","span","code-segement62",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement63",{"className":"$undefined","style":{},"children":["MODEL_WEIGHTS_FILE_PATH"]}],["$","span","code-segement64",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement65",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement66",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement67",{"className":"token","style":{"color":"#116b00"},"children":["\\"model.onnx\\""]}],["$","span","code-segement68",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement69",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n","\\n",["$","span","code-segement72",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement73",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement74",{"className":"$undefined","style":{},"children":[" __name__ "]}],["$","span","code-segement75",{"className":"token","style":{"color":"#a04900"},"children":["=="]}],["$","span","code-segement76",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement77",{"className":"token","style":{"color":"#116b00"},"children":["\\"__main__\\""]}],["$","span","code-segement78",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement79",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement80",{"className":"$undefined","style":{},"children":["    device "]}],["$","span","code-segement81",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement82",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement83",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement84",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement85",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement86",{"className":"token","style":{"color":"#116b00"},"children":["\\"cpu\\""]}],["$","span","code-segement87",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement88",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement90",{"className":"$undefined","style":{},"children":["    torch_model "]}],["$","span","code-segement91",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement92",{"className":"$undefined","style":{},"children":[" CNN"]}],["$","span","code-segement93",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement94",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement95",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement96",{"className":"$undefined","style":{},"children":["    torch_model "]}],["$","span","code-segement97",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement98",{"className":"$undefined","style":{},"children":[" torch_model"]}],["$","span","code-segement99",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement100",{"className":"$undefined","style":{},"children":["to"]}],["$","span","code-segement101",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement102",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement103",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement104",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement106",{"className":"$undefined","style":{},"children":["    torch_model"]}],["$","span","code-segement107",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement108",{"className":"$undefined","style":{},"children":["load_state_dict"]}],["$","span","code-segement109",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement110",{"className":"$undefined","style":{},"children":["torch"]}],["$","span","code-segement111",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement112",{"className":"$undefined","style":{},"children":["load"]}],["$","span","code-segement113",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement114",{"className":"$undefined","style":{},"children":["MODEL_WEIGHTS_FILE_PATH"]}],["$","span","code-segement115",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement116",{"className":"$undefined","style":{},"children":[" map_location"]}],["$","span","code-segement117",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement118",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement119",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement120",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement121",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement123",{"className":"$undefined","style":{},"children":["    torch_model"]}],["$","span","code-segement124",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement125",{"className":"token","style":{"color":"#af00af"},"children":["eval"]}],["$","span","code-segement126",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement127",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement128",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement130",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement131",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement132",{"className":"$undefined","style":{},"children":[" data"]}],["$","span","code-segement133",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement134",{"className":"$undefined","style":{},"children":[" target "]}],["$","span","code-segement135",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement136",{"className":"$undefined","style":{},"children":[" data_loaders"]}],["$","span","code-segement137",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement138",{"className":"token","style":{"color":"#116b00"},"children":["\\"test\\""]}],["$","span","code-segement139",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement140",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement141",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement142",{"className":"$undefined","style":{},"children":["        data "]}],["$","span","code-segement143",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement144",{"className":"$undefined","style":{},"children":[" data"]}],["$","span","code-segement145",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement146",{"className":"$undefined","style":{},"children":["to"]}],["$","span","code-segement147",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement148",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement149",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement150",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement151",{"className":"$undefined","style":{},"children":["        target "]}],["$","span","code-segement152",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement153",{"className":"$undefined","style":{},"children":[" target"]}],["$","span","code-segement154",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement155",{"className":"$undefined","style":{},"children":["to"]}],["$","span","code-segement156",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement157",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement158",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement159",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement160",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement161",{"className":"token","style":{"color":"#a04900"},"children":["break"]}],["$","span","code-segement162",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement164",{"className":"$undefined","style":{},"children":["    sample_input "]}],["$","span","code-segement165",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement166",{"className":"$undefined","style":{},"children":[" data"]}],["$","span","code-segement167",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement168",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement169",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement170",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement171",{"className":"$undefined","style":{},"children":["unsqueeze"]}],["$","span","code-segement172",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement173",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement174",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement175",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement177",{"className":"$undefined","style":{},"children":["    onnx_model "]}],["$","span","code-segement178",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement179",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement180",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement181",{"className":"$undefined","style":{},"children":["onnx"]}],["$","span","code-segement182",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement183",{"className":"$undefined","style":{},"children":["dynamo_export"]}],["$","span","code-segement184",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement185",{"className":"$undefined","style":{},"children":["\\n"]}],["$","span","code-segement186",{"className":"$undefined","style":{},"children":["        torch_model"]}],["$","span","code-segement187",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement188",{"className":"$undefined","style":{},"children":["\\n"]}],"        sample_input\\n",["$","span","code-segement190",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement191",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement192",{"className":"$undefined","style":{},"children":["\\n"]}],"\\n",["$","span","code-segement194",{"className":"$undefined","style":{},"children":["    onnx_model"]}],["$","span","code-segement195",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement196",{"className":"$undefined","style":{},"children":["save"]}],["$","span","code-segement197",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement198",{"className":"$undefined","style":{},"children":["ONNX_MODEL_FILE_PATH"]}],["$","span","code-segement199",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Le","55",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","We load our model similar to how we load it in the ",["$","$Lc","55-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"test.py"}]," file, and convert it to ONNX using ",["$","$L1b","55-link",{"href":"https://pytorch.org/tutorials/beginner/onnx/export_simple_model_to_onnx_tutorial.html","rel":"noopener noreferrer","target":"_blank","color":"primary","underline":"hover","children":"torch.onnx.dynamo_export"}]," and save it in the same directory as our torch model."]}],["$","$Le","56",{"id":"conclusion","variant":"h4","component":"h1","mb":2,"children":["$","strong",null,{"children":"Conclusion"}]}],["$","$Le","57",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","In this small Post, we have trained a Convolutional Neural Network on the MNIST dataset, tested it on custom images, and exported the model to ONNX. It\'s nothing fancy but we\'ll use this model in some of our following tutorials where we build a website in which the user can draw digits and get the model\'s prediction on the image."]}],["$","$Le","58",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","See you next time :)"]}]]}]}]]}]}],"$L20"]}]\n',
      ]);
    </script>
    <script>
      self.__next_f.push([
        1,
        '21:I[3713,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],"default"]\n16:["$","$Lc",null,{"sx":{"width":"100%","display":"flex","flexDirection":"row","justifyContent":"space-between","alignItems":"center"},"children":[["$","$Le",null,{"variant":"p","component":"p","mr":2,"children":"By: Abhilaksh Singh Reen"}],["$","$L21",null,{"socialMediaProfiles":[{"network_name":"LinkedIn","profile_url":"https://www.linkedin.com/in/abhilaksh-singh-837901210/","profile_display_name":"Abhilaksh Singh Reen"},{"network_name":"Twitter","profile_url":"https://x.com/TheVeteran06","profile_display_name":"The Veteran 06"},{"network_name":"GitHub","profile_url":"https://github.com/AbhilakshSinghReen","profile_display_name":"Abhilaksh Singh Reen"}]}]]}]\n',
      ]);
    </script>
    <script>
      self.__next_f.push([
        1,
        '22:I[6652,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],""]\n23:I[6981,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],""]\n24:I[2818,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],""]\n20:["$","$Lc",null,{"mt":5,"mb":5,"pb":2,"sx":{"width":"100%","display":"flex","flexDirection":"column","justifyContent":"flex-start","alignItems":"center"},"children":["$","$L15",null,{"container":true,"spacing":2,"mt":4,"mb":4,"children":[["$","$L15","/ml-ops/tensorflow-training-plus-conversion-to-onnx-and-tfjs",{"item":true,"xs":12,"sm":6,"md":4,"lg":3,"children":["$","$Lf",null,{"href":"/ml-ops/tensorflow-training-plus-conversion-to-onnx-and-tfjs","passHref":true,"style":{"textDecoration":"none"},"children":["$","$L22",null,{"sx":{"width":"100%","height":"100%","boxShadow":"1px 1px 1px 1px \\"#eeeeee\\"","\u0026:hover":{"boxShadow":"3px 3px 3px 3px \\"#eeeeee\\"","cursor":"pointer"}},"children":[["$","$L23",null,{"component":"img","height":"150","image":"/media/images/tensorflow-training-plus-conversion-to-onnx-and-tfjs-thumbnail.jpg","alt":"Training a CNN in TensorFlow and Exporting it to ONNX and TFJS","sx":{"objectFit":"cover"}}],["$","$L24",null,{"children":[["$","$Le",null,{"gutterBottom":true,"variant":"h6","component":"',
      ]);
    </script>
    <script>
      self.__next_f.push([
        1,
        'h2","children":[""," ","Training a CNN in TensorFlow and Exporting it to ONNX and TFJS"]}],["$","$Le",null,{"gutterBottom":true,"variant":"p","component":"p","sx":{"overflow":"hidden","textOverflow":"ellipsis","display":"-webkit-box","WebkitLineClamp":"3","WebkitBoxOrient":"vertical"},"children":"Learn how to train a simple CNN in TensorFlow and how to convert it to ONNX or TensorFlow.js for deployment."}],["$","$Lc",null,{"sx":{"width":"100%","display":"flex","flexDirection":"row","justifyContent":"flex-end","alignItems":"center"},"children":["$","$Le",null,{"gutterBottom":true,"variant":"p","component":"p","children":"05m Read"}]}],false]}]]}]}]}]]}]}]\n',
      ]);
    </script>
  </body>
</html>
