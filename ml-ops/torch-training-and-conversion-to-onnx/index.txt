3:I[9275,[],""]
6:I[1343,[],""]
7:I[6871,["98","static/chunks/98-7f6363f9ac68c942.js","748","static/chunks/748-1f14ee6eb3d7029a.js","271","static/chunks/271-37a22bace913f735.js","185","static/chunks/app/layout-08611f287dda1230.js"],"default"]
8:I[5877,["98","static/chunks/98-7f6363f9ac68c942.js","748","static/chunks/748-1f14ee6eb3d7029a.js","271","static/chunks/271-37a22bace913f735.js","185","static/chunks/app/layout-08611f287dda1230.js"],"default"]
9:I[902,["98","static/chunks/98-7f6363f9ac68c942.js","748","static/chunks/748-1f14ee6eb3d7029a.js","271","static/chunks/271-37a22bace913f735.js","185","static/chunks/app/layout-08611f287dda1230.js"],""]
a:I[5218,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],""]
b:I[2324,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],"default"]
c:I[2591,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],""]
d:I[231,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],""]
e:I[3180,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],""]
f:I[3245,["98","static/chunks/98-7f6363f9ac68c942.js","748","static/chunks/748-1f14ee6eb3d7029a.js","271","static/chunks/271-37a22bace913f735.js","185","static/chunks/app/layout-08611f287dda1230.js"],"default"]
4:["categorySlug","ml-ops","d"]
5:["postOrSeriesSlug","torch-training-and-conversion-to-onnx","d"]
0:["WOpoYNfSyePVsNQIvcvfm",[[["",{"children":[["categorySlug","ml-ops","d"],{"children":[["postOrSeriesSlug","torch-training-and-conversion-to-onnx","d"],{"children":["__PAGE__?{\"categorySlug\":\"ml-ops\",\"postOrSeriesSlug\":\"torch-training-and-conversion-to-onnx\"}",{}]}]}]},"$undefined","$undefined",true],["",{"children":[["categorySlug","ml-ops","d"],{"children":[["postOrSeriesSlug","torch-training-and-conversion-to-onnx","d"],{"children":["__PAGE__",{},[["$L1","$L2"],null],null]},["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","$4","children","$5","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}],null]},["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","$4","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}],null]},[["$","html",null,{"lang":"en","suppressHydrationWarning":true,"children":["$","body",null,{"className":"__className_d65c78","children":["$","$L7",null,{"children":[["$","$L8",null,{}],["$","$L9",null,{"maxWidth":"lg","children":[["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":["$","$La",null,{"children":[["$","$Lb",null,{"render":false,"targetSiteNavigationState":[],"targetPageNavigationState":[]}],["$","$Lc",null,{"variant":"h4","children":["$","strong",null,{"children":"Not Found"}]}],["$","$Lc",null,{"variant":"h6","mb":3,"children":"Oops! It looks like the page you're looking for does not exist."}],["$","$Ld",null,{"href":"/","children":["$","$Le",null,{"variant":"contained","sx":{"marginRight":5,"marginBottom":1},"children":"Take me Home"}]}]]}],"notFoundStyles":[],"styles":null}],["$","$Lf",null,{}]]}]]}]}]}],null],null],[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/1d4d01086947be98.css","precedence":"next","crossOrigin":"$undefined"}]],"$L10"]]]]
10:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","1",{"charSet":"utf-8"}],["$","link","2",{"rel":"icon","href":"/favicon.ico","type":"image/x-icon","sizes":"16x16"}]]
1:null
11:I[3507,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],""]
13:I[4204,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],"default"]
14:I[1847,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],"default"]
15:I[8125,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],""]
16:I[3578,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],"default"]
17:I[7005,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],""]
18:I[6480,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],"default"]
19:Ta49,from datetime import datetime
from os import makedirs
from os.path import join

import torch
import torch.nn as nn
import torch.optim as optim

from .config import config, models_dir
from .dataset import data_loaders
from .model import CNN


class ModelTrainer:
    def __init__(self):
        self.training_id = "torch---" + datetime.now().strftime("%Y-%m-%d-%H-%M-%S")

        self.device = torch.device("cuda" if torch.cuda.is_available() else "cpu")

        self.model = CNN()
        self.model = self.model.to(self.device)

        self.optimizer = optim.Adam(self.model.parameters(), lr=config['learning_rate'])
        self.loss_fn = nn.CrossEntropyLoss()

        self.models_dir = join(models_dir, self.training_id)
        makedirs(self.models_dir, exist_ok=False)

    def train_single_epoch(self):
        self.model.train()

        for batch_index, (data, target) in enumerate(data_loaders["train"]):
            data = data.to(self.device)
            target = target.to(self.device)

            self.optimizer.zero_grad()

            output = self.model(data)

            loss = self.loss_fn(output, target)
            loss.backward()

            self.optimizer.step()

            if batch_index % config['log_batch_interval'] == 0:
                print(f"    {batch_index} / {len(data_loaders['train'])}")

    def test(self):
        self.model.eval()

        sum_test_loss = 0
        num_correct = 0

        with torch.no_grad():
            for data, target in data_loaders["test"]:
                data = data.to(self.device)
                target = target.to(self.device)

                output = self.model(data)

                sum_test_loss += self.loss_fn(output, target).item()

                prediction = output.argmax(dim=1, keepdim=True)

                num_correct += prediction.eq(target.view_as(prediction)).sum().item()

        average_test_loss = sum_test_loss / len(data_loaders['test'].dataset)
        accuracy = num_correct / len(data_loaders['test'].dataset)

        print(f"    Average loss: {average_test_loss}")
        print(f"    Accuracy: {accuracy}")

    def save_weights(self, file_path):
        torch.save(self.model.state_dict(), file_path)

    def train(self):
        for epoch_index in range(config['training_num_epochs']):
            print(f"Epoch: {epoch_index}")
            self.train_single_epoch()

            model_save_file_path = join(self.models_dir, f"epoch-{epoch_index}.pt")
            self.save_weights(model_save_file_path)

            self.test()


if __name__ == "__main__":
    model_trainer = ModelTrainer()
    model_trainer.train()1a:T433,test_images_dir = path_join(data_dir, "test_images")

test_images_labels_file_path = path_join(data_dir, "test_images_labels.json")
with open(test_images_labels_file_path, 'r') as test_images_labels_file:
    test_images_labels = json_load(test_images_labels_file)

test_images = []
test_labels = []
for image_name in listdir(test_images_dir):
    image_path = path_join(test_images_dir, image_name)
    image = cv2.imread(image_path, cv2.IMREAD_GRAYSCALE)
    test_images.append(image)

    test_labels.append(test_images_labels[image_name])

# Preprocess
for i in range(len(test_images)):
    test_images[i] = preprocessing_transforms(test_images[i])
    test_images[i] = test_images[i].unsqueeze(0)

# Predict
num_correct = 0
for preprocessed_image, label in zip(test_images, test_labels):
    output = model(preprocessed_image)
    prediction = output.argmax(dim=1, keepdim=True)
    prediction = int(prediction)

    num_correct += prediction == label

accuracy = num_correct / len(test_images)
print(f"Correct: {num_correct} / {len(test_images)}, Accuracy: {accuracy}")1b:T9c9,from json import load as json_load
from os import listdir
from os.path import join as path_join

import cv2
import torch
from torchvision import transforms

from .config import data_dir, models_dir
from .dataset import data_loaders
from .model import CNN


# MODEL_WEIGHTS_FILE_PATH = path_join(models_dir, "training_id", "epoch-epoch_numbe")
MODEL_WEIGHTS_FILE_PATH = path_join(models_dir, "torch---2024-04-23-08-25-15", "epoch-9.pt")


if __name__ == "__main__":
    device = torch.device("cuda" if torch.cuda.is_available() else "cpu")

    model = CNN()
    model = model.to(device)

    model.load_state_dict(torch.load(MODEL_WEIGHTS_FILE_PATH, map_location=device))

    model.eval()

    print("Testing on MNIST Test Set")

    num_correct = 0
    with torch.no_grad():
        for data, target in data_loaders["test"]:
            data = data.to(device)
            target = target.to(device)

            output = model(data)

            prediction = output.argmax(dim=1, keepdim=True)

            num_correct += prediction.eq(target.view_as(prediction)).sum().item()

    accuracy = num_correct / len(data_loaders['test'].dataset)
    print(f"    Accuracy: {accuracy}")
    print()

    ### Test on Custom Images
    preprocessing_transforms = transforms.Compose([
        transforms.ToTensor(),
    ])

    # Load Images
    test_images_dir = path_join(data_dir, "test_images")

    test_images_labels_file_path = path_join(data_dir, "test_images_labels.json")
    with open(test_images_labels_file_path, 'r') as test_images_labels_file:
        test_images_labels = json_load(test_images_labels_file)

    test_images = []
    test_labels = []
    for image_name in listdir(test_images_dir):
        image_path = path_join(test_images_dir, image_name)
        image = cv2.imread(image_path, cv2.IMREAD_GRAYSCALE)
        test_images.append(image)

        test_labels.append(test_images_labels[image_name])

    # Preprocess
    for i in range(len(test_images)):
        test_images[i] = preprocessing_transforms(test_images[i])
        test_images[i] = test_images[i].unsqueeze(0)

    # Predict
    num_correct = 0
    for preprocessed_image, label in zip(test_images, test_labels):
        output = model(preprocessed_image)
        prediction = output.argmax(dim=1, keepdim=True)
        prediction = int(prediction)

        num_correct += prediction == label

    accuracy = num_correct / len(test_images)
    print(f"Correct: {num_correct} / {len(test_images)}, Accuracy: {accuracy}")2:["$","$La",null,{"mb":5,"pb":2,"sx":{"width":"100%","display":"flex","flexDirection":"column","justifyContent":"flex-start","alignItems":"flex-start"},"children":[["$","$Lb",null,{"render":true,"targetSiteNavigationState":[{"absoluteSlug":"/ml-ops","title":"ML Ops"},{"absoluteSlug":"/ml-ops/torch-training-and-conversion-to-onnx","title":"Training a CNN in PyTorch and Exporting it to ONNX"}],"targetPageNavigationState":[{"title":"The Code","absoluteSlug":"#the-code"},{"title":"Configuration","absoluteSlug":"#configuration"},{"title":"Loading the Dataset","absoluteSlug":"#loading-the-dataset"},{"title":"The Model","absoluteSlug":"#the-model"},{"title":"Training","absoluteSlug":"#training"},{"title":"Testing","absoluteSlug":"#testing"},{"title":"Testing on MNIST Test Data","absoluteSlug":"#testing-on-mnist-test-data"},{"title":"Testing on Custom Images","absoluteSlug":"#testing-on-custom-images"},{"title":"Conversion to ONNX","absoluteSlug":"#conversion-to-onnx"},{"title":"Conclusion","absoluteSlug":"#conclusion"}]}],["$","$L11",null,{"container":true,"spacing":2,"mb":0,"children":[["$","$L11",null,{"item":true,"xs":12,"sm":12,"md":4,"sx":{"background":"linear-gradient(to right, #eeeeee, #ffffff)","borderRadius":5},"children":["$","$La",null,{"sx":{"width":"100%","height":"100%","display":"flex","flexDirection":"column","justifyContent":"center","alignItems":"flex-start","paddingBottom":2},"children":[["$","$Lc",null,{"gutterBottom":true,"variant":"h5","component":"h1","children":"Training a CNN in PyTorch and Exporting it to ONNX"}],["$","$Lc",null,{"gutterBottom":true,"variant":"p","component":"p","mb":4,"children":"Learn how to train a simple CNN in PyTorch and how to convert it to ONNX for deployment."}],["$","$La",null,{"sx":{"width":"100%","display":"flex","flexDirection":"row","justifyContent":"space-between","alignItems":"center","marginBottom":2},"children":[["$","$Lc",null,{"gutterBottom":true,"variant":"p","component":"p","children":"July 26, 2024"}],["$","$Lc",null,{"gutterBottom":true,"variant":"p","component":"p","children":["07m"," Read"]}]]}],"$L12",false]}]}],["$","$L11",null,{"item":true,"xs":12,"sm":12,"md":8,"children":["$","$La",null,{"sx":{"flex":1,"display":"flex","flexDirection":"column","justifyContent":"center","alignItems":"center","marginRight":2},"children":["$","img",null,{"src":"/media/images/torch-training-and-conversion-to-onnx-thumbnail.jpg","style":{"width":"100%","maxWidth":"75vw","height":"auto","maxHeight":"35vh","objectFit":"cover"}}]}]}]]}],["$","$La",null,{"sx":{"width":"100%"},"children":["$","$L11",null,{"container":true,"spacing":2,"mt":4,"mb":0,"children":[["$","$L11",null,{"item":true,"xs":12,"sm":12,"md":4,"lg":3,"sx":{"background":"linear-gradient(to right, #eeeeee, #ffffff)","borderRadius":5},"children":["$","$La",null,{"sx":{"width":"100%"},"children":[["$","$La",null,{"sx":{"width":"100%","display":{"xs":"block","md":"none"},"marginBottom":2},"children":["$","$L13",null,{"sx":{"width":"100%","marginBottom":2,"boxShadow":3,"backgroundColor":"#ffffff22"},"disableGutters":true,"children":[["$","$L14",null,{"expandIcon":["$","$L15",null,{}],"children":["$","$Lc",null,{"variant":"h6","component":"h6","sx":{"margin":0,"padding":0},"children":"Table of Contents"}]}],["$","$L16",null,{"sx":{"width":"90%","display":"flex","flexDirection":"column","justifyContent":"flex-start","alignItems":"flex-start","marginBottom":2},"children":[["$","a","0",{"href":"#the-code","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","0",{"variant":"p","component":"p","ml":0,"mb":2.5,"sx":{"&:hover":{"color":"blue"}},"children":"The Code"}]}],["$","a","1",{"href":"#configuration","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","1",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"Configuration"}]}],["$","a","2",{"href":"#loading-the-dataset","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","2",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"Loading the Dataset"}]}],["$","a","3",{"href":"#the-model","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","3",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"The Model"}]}],["$","a","4",{"href":"#training","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","4",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"Training"}]}],["$","a","5",{"href":"#testing","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","5",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"Testing"}]}],["$","a","6",{"href":"#testing-on-mnist-test-data","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","6",{"variant":"p","component":"p","ml":2,"mb":1.5,"sx":{"&:hover":{"color":"blue"}},"children":"Testing on MNIST Test Data"}]}],["$","a","7",{"href":"#testing-on-custom-images","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","7",{"variant":"p","component":"p","ml":2,"mb":1.5,"sx":{"&:hover":{"color":"blue"}},"children":"Testing on Custom Images"}]}],["$","a","8",{"href":"#conversion-to-onnx","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","8",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"Conversion to ONNX"}]}],["$","a","9",{"href":"#conclusion","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","9",{"variant":"p","component":"p","ml":0,"mb":2.5,"sx":{"&:hover":{"color":"blue"}},"children":"Conclusion"}]}]]}]]}]}],["$","$La",null,{"sx":{"width":"100%","display":{"xs":"none","md":"block"}},"children":[["$","$Lc",null,{"variant":"h5","component":"h5","sx":{"margin":0,"padding":0},"children":"Table of Contents"}],[["$","a","0",{"href":"#the-code","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","0",{"variant":"p","component":"p","ml":0,"mb":2.5,"sx":{"&:hover":{"color":"blue"}},"children":"The Code"}]}],["$","a","1",{"href":"#configuration","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","1",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"Configuration"}]}],["$","a","2",{"href":"#loading-the-dataset","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","2",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"Loading the Dataset"}]}],["$","a","3",{"href":"#the-model","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","3",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"The Model"}]}],["$","a","4",{"href":"#training","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","4",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"Training"}]}],["$","a","5",{"href":"#testing","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","5",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"Testing"}]}],["$","a","6",{"href":"#testing-on-mnist-test-data","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","6",{"variant":"p","component":"p","ml":2,"mb":1.5,"sx":{"&:hover":{"color":"blue"}},"children":"Testing on MNIST Test Data"}]}],["$","a","7",{"href":"#testing-on-custom-images","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","7",{"variant":"p","component":"p","ml":2,"mb":1.5,"sx":{"&:hover":{"color":"blue"}},"children":"Testing on Custom Images"}]}],["$","a","8",{"href":"#conversion-to-onnx","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","8",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"Conversion to ONNX"}]}],["$","a","9",{"href":"#conclusion","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","9",{"variant":"p","component":"p","ml":0,"mb":2.5,"sx":{"&:hover":{"color":"blue"}},"children":"Conclusion"}]}]]]}]]}]}],["$","$L11",null,{"item":true,"xs":12,"sm":12,"md":8,"lg":9,"sx":{"background":"linear-gradient(to right, #ffffff, #eeeeee)","borderRadius":5},"children":["$","$La",null,{"sx":{"flex":1,"marginRight":2},"children":[["$","$Lc","0",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","In this article, we'll create a very basic CNN using PyTorch that will serve as a baseline for the various deployment methods we'll be going over in future Blog Posts. Today, we'll make a CNN (Convolutional Neural Network) that can recognize handwritten digits (0 to 9) trained using the ",["$","$L17","0-link",{"href":"https://en.wikipedia.org/wiki/MNIST_database","rel":"noopener noreferrer","target":"_blank","color":"primary","underline":"hover","children":"MNIST dataset"}],". We'll also export our model to ",["$","$L17","0-link",{"href":"https://onnx.ai/","rel":"noopener noreferrer","target":"_blank","color":"primary","underline":"hover","children":"ONNX"}],", this way it can be used with any language that has an ",["$","$L17","0-link",{"href":"https://onnxruntime.ai/","rel":"noopener noreferrer","target":"_blank","color":"primary","underline":"hover","children":"ONNX Runtime"}]," available for it (for example JavaScript)."]}],["$","$Lc","1",{"id":"the-code","variant":"h4","component":"h1","mb":2,"children":["$","strong",null,{"children":"The Code"}]}],["$","$Lc","2",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Here's the directory structure of the codebase we'll be creating."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"│   config.yaml\n│   requirements.txt\n│\n├───data\n├───models\n└───src\n    │   config.py\n    │   dataset.py\n    │   model.py\n    │   test.py\n    │   train.py\n    │\n    └───converters\n            converter_onnx.py"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-bash","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"$undefined","style":{},"children":["│   config.yaml\n"]}],"│   requirements.txt\n","│\n","├───data\n","├───models\n","└───src\n","    │   config.py\n","    │   dataset.py\n","    │   model.py\n","    │   test.py\n","    │   train.py\n","    │\n","    └───converters\n","            converter_onnx.py"]]}]}]]}],["$","$Lc","4",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","We have the ",["$","$La","4-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"config"}]," and ",["$","$La","4-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"requirements"}]," files that define our training and testing configuration and the project's required packages respectively."]}],["$","$Lc","5",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","The ",["$","$La","5-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"data"}]," directory will be used to store the dataset that PyTorch will download for us and we'll store our model weights in the ",["$","$La","5-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"models"}]," directory. The ",["$","$La","5-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"src"}]," directory contains our codebase."]}],["$","$Lc","6",{"id":"configuration","variant":"h5","component":"h2","mb":2,"children":["$","strong",null,{"children":"Configuration"}]}],["$","$Lc","7",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Let's create the ",["$","$La","7-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"config.yaml"}]," file to define the training and testing config."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"training_num_epochs: 10\ntraining_save_weights_epoch_interval: 1\ntraining_batch_size: 100\nlearning_rate: 0.001\ntesting_batch_size: 100\nlog_batch_interval: 100"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-yaml","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#005a8e"},"children":["training_num_epochs"]}],["$","span","code-segement1",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement2",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement3",{"className":"token","style":{"color":"#755f00"},"children":["10"]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement5",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement6",{"className":"token","style":{"color":"#005a8e"},"children":["training_save_weights_epoch_interval"]}],["$","span","code-segement7",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement9",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement11",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement12",{"className":"token","style":{"color":"#005a8e"},"children":["training_batch_size"]}],["$","span","code-segement13",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement14",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement15",{"className":"token","style":{"color":"#755f00"},"children":["100"]}],["$","span","code-segement16",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement17",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement18",{"className":"token","style":{"color":"#005a8e"},"children":["learning_rate"]}],["$","span","code-segement19",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement20",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement21",{"className":"token","style":{"color":"#755f00"},"children":["0.001"]}],["$","span","code-segement22",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement23",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement24",{"className":"token","style":{"color":"#005a8e"},"children":["testing_batch_size"]}],["$","span","code-segement25",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement27",{"className":"token","style":{"color":"#755f00"},"children":["100"]}],["$","span","code-segement28",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement29",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement30",{"className":"token","style":{"color":"#005a8e"},"children":["log_batch_interval"]}],["$","span","code-segement31",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement32",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement33",{"className":"token","style":{"color":"#755f00"},"children":["100"]}]]]}]}]]}],["$","$Lc","9",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Next, we create the ",["$","$La","9-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"src/config.py"}]," file that loads this configuration into Python and also defines some directory paths for our convenience."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"from os.path import dirname, join as path_join\nfrom yaml import FullLoader as yaml_FullLoader, load as yaml_load\n\n\nconfig_file_path = path_join(dirname(dirname(__file__)), \"config.yaml\")\nwith open(config_file_path, \"r\") as model_params_file:\n    config = yaml_load(model_params_file, Loader=yaml_FullLoader)\n\nmodels_dir = path_join(dirname(dirname(__file__)), \"models\")\ndata_dir = path_join(dirname(dirname(__file__)), \"data\")"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" os"]}],["$","span","code-segement2",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":["path "]}],["$","span","code-segement4",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement5",{"className":"$undefined","style":{},"children":[" dirname"]}],["$","span","code-segement6",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement7",{"className":"$undefined","style":{},"children":[" join "]}],["$","span","code-segement8",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement9",{"className":"$undefined","style":{},"children":[" path_join\n"]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement11",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement12",{"className":"$undefined","style":{},"children":[" yaml "]}],["$","span","code-segement13",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement14",{"className":"$undefined","style":{},"children":[" FullLoader "]}],["$","span","code-segement15",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement16",{"className":"$undefined","style":{},"children":[" yaml_FullLoader"]}],["$","span","code-segement17",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement18",{"className":"$undefined","style":{},"children":[" load "]}],["$","span","code-segement19",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement20",{"className":"$undefined","style":{},"children":[" yaml_load\n"]}],"\n","\n",["$","span","code-segement23",{"className":"$undefined","style":{},"children":["config_file_path "]}],["$","span","code-segement24",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement25",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement26",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement27",{"className":"$undefined","style":{},"children":["dirname"]}],["$","span","code-segement28",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement29",{"className":"$undefined","style":{},"children":["dirname"]}],["$","span","code-segement30",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement31",{"className":"$undefined","style":{},"children":["__file__"]}],["$","span","code-segement32",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement33",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement34",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement35",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement36",{"className":"token","style":{"color":"#116b00"},"children":["\"config.yaml\""]}],["$","span","code-segement37",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement38",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement39",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement40",{"className":"token","style":{"color":"#a04900"},"children":["with"]}],["$","span","code-segement41",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement42",{"className":"token","style":{"color":"#af00af"},"children":["open"]}],["$","span","code-segement43",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement44",{"className":"$undefined","style":{},"children":["config_file_path"]}],["$","span","code-segement45",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement46",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement47",{"className":"token","style":{"color":"#116b00"},"children":["\"r\""]}],["$","span","code-segement48",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement49",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement50",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement51",{"className":"$undefined","style":{},"children":[" model_params_file"]}],["$","span","code-segement52",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement53",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement54",{"className":"$undefined","style":{},"children":["    config "]}],["$","span","code-segement55",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement56",{"className":"$undefined","style":{},"children":[" yaml_load"]}],["$","span","code-segement57",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement58",{"className":"$undefined","style":{},"children":["model_params_file"]}],["$","span","code-segement59",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement60",{"className":"$undefined","style":{},"children":[" Loader"]}],["$","span","code-segement61",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement62",{"className":"$undefined","style":{},"children":["yaml_FullLoader"]}],["$","span","code-segement63",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement64",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement66",{"className":"$undefined","style":{},"children":["models_dir "]}],["$","span","code-segement67",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement68",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement69",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement70",{"className":"$undefined","style":{},"children":["dirname"]}],["$","span","code-segement71",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement72",{"className":"$undefined","style":{},"children":["dirname"]}],["$","span","code-segement73",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement74",{"className":"$undefined","style":{},"children":["__file__"]}],["$","span","code-segement75",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement76",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement77",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement78",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement79",{"className":"token","style":{"color":"#116b00"},"children":["\"models\""]}],["$","span","code-segement80",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement81",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement82",{"className":"$undefined","style":{},"children":["data_dir "]}],["$","span","code-segement83",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement84",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement85",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement86",{"className":"$undefined","style":{},"children":["dirname"]}],["$","span","code-segement87",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement88",{"className":"$undefined","style":{},"children":["dirname"]}],["$","span","code-segement89",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement90",{"className":"$undefined","style":{},"children":["__file__"]}],["$","span","code-segement91",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement92",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement93",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement94",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement95",{"className":"token","style":{"color":"#116b00"},"children":["\"data\""]}],["$","span","code-segement96",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Lc","11",{"id":"loading-the-dataset","variant":"h5","component":"h2","mb":2,"children":["$","strong",null,{"children":"Loading the Dataset"}]}],["$","$Lc","12",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Inside the ",["$","$La","12-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"src"}]," folder, create a file called ",["$","$La","12-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"dataset.py"}],", in which we will define our data loaders."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"from torch.utils.data import DataLoader\nfrom torchvision.datasets import MNIST\nfrom torchvision.transforms import ToTensor\n\nfrom config import config\n\n\ntrain_data = MNIST(\n    root=\"data\",\n    train=True,\n    transform=ToTensor(),\n    download=True\n)\n\ntest_data = MNIST(\n    root=\"data\",\n    train=False,\n    transform=ToTensor(),\n    download=True\n)\n\ndata_loaders = {\n    \"train\": DataLoader(\n        train_data,\n        batch_size=config['training_batch_size'],\n        shuffle=True,\n        num_workers=1\n    ),\n    \"test\": DataLoader(\n        test_data,\n        batch_size=config['testing_batch_size'],\n        shuffle=True,\n        num_workers=1\n    ),\n}"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement2",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":["utils"]}],["$","span","code-segement4",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement5",{"className":"$undefined","style":{},"children":["data "]}],["$","span","code-segement6",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement7",{"className":"$undefined","style":{},"children":[" DataLoader\n"]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement9",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":[" torchvision"]}],["$","span","code-segement11",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement12",{"className":"$undefined","style":{},"children":["datasets "]}],["$","span","code-segement13",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement14",{"className":"$undefined","style":{},"children":[" MNIST\n"]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement16",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement17",{"className":"$undefined","style":{},"children":[" torchvision"]}],["$","span","code-segement18",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement19",{"className":"$undefined","style":{},"children":["transforms "]}],["$","span","code-segement20",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement21",{"className":"$undefined","style":{},"children":[" ToTensor\n"]}],"\n",["$","span","code-segement23",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement24",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement25",{"className":"$undefined","style":{},"children":[" config "]}],["$","span","code-segement26",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement27",{"className":"$undefined","style":{},"children":[" config\n"]}],"\n","\n",["$","span","code-segement30",{"className":"$undefined","style":{},"children":["train_data "]}],["$","span","code-segement31",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement32",{"className":"$undefined","style":{},"children":[" MNIST"]}],["$","span","code-segement33",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement34",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement35",{"className":"$undefined","style":{},"children":["    root"]}],["$","span","code-segement36",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement37",{"className":"token","style":{"color":"#116b00"},"children":["\"data\""]}],["$","span","code-segement38",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement39",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement40",{"className":"$undefined","style":{},"children":["    train"]}],["$","span","code-segement41",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement42",{"className":"token","style":{"color":"#755f00"},"children":["True"]}],["$","span","code-segement43",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement44",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement45",{"className":"$undefined","style":{},"children":["    transform"]}],["$","span","code-segement46",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement47",{"className":"$undefined","style":{},"children":["ToTensor"]}],["$","span","code-segement48",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement49",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement50",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement51",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement52",{"className":"$undefined","style":{},"children":["    download"]}],["$","span","code-segement53",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement54",{"className":"token","style":{"color":"#755f00"},"children":["True"]}],["$","span","code-segement55",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement56",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement57",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement58",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement60",{"className":"$undefined","style":{},"children":["test_data "]}],["$","span","code-segement61",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement62",{"className":"$undefined","style":{},"children":[" MNIST"]}],["$","span","code-segement63",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement64",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement65",{"className":"$undefined","style":{},"children":["    root"]}],["$","span","code-segement66",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement67",{"className":"token","style":{"color":"#116b00"},"children":["\"data\""]}],["$","span","code-segement68",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement69",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement70",{"className":"$undefined","style":{},"children":["    train"]}],["$","span","code-segement71",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement72",{"className":"token","style":{"color":"#755f00"},"children":["False"]}],["$","span","code-segement73",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement74",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement75",{"className":"$undefined","style":{},"children":["    transform"]}],["$","span","code-segement76",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement77",{"className":"$undefined","style":{},"children":["ToTensor"]}],["$","span","code-segement78",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement79",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement80",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement81",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement82",{"className":"$undefined","style":{},"children":["    download"]}],["$","span","code-segement83",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement84",{"className":"token","style":{"color":"#755f00"},"children":["True"]}],["$","span","code-segement85",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement86",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement87",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement88",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement90",{"className":"$undefined","style":{},"children":["data_loaders "]}],["$","span","code-segement91",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement92",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement93",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement94",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement95",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement96",{"className":"token","style":{"color":"#116b00"},"children":["\"train\""]}],["$","span","code-segement97",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement98",{"className":"$undefined","style":{},"children":[" DataLoader"]}],["$","span","code-segement99",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement100",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement101",{"className":"$undefined","style":{},"children":["        train_data"]}],["$","span","code-segement102",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement103",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement104",{"className":"$undefined","style":{},"children":["        batch_size"]}],["$","span","code-segement105",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement106",{"className":"$undefined","style":{},"children":["config"]}],["$","span","code-segement107",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement108",{"className":"token","style":{"color":"#116b00"},"children":["'training_batch_size'"]}],["$","span","code-segement109",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement110",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement111",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement112",{"className":"$undefined","style":{},"children":["        shuffle"]}],["$","span","code-segement113",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement114",{"className":"token","style":{"color":"#755f00"},"children":["True"]}],["$","span","code-segement115",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement116",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement117",{"className":"$undefined","style":{},"children":["        num_workers"]}],["$","span","code-segement118",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement119",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement120",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement121",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement122",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement123",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement124",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement125",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement126",{"className":"token","style":{"color":"#116b00"},"children":["\"test\""]}],["$","span","code-segement127",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement128",{"className":"$undefined","style":{},"children":[" DataLoader"]}],["$","span","code-segement129",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement130",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement131",{"className":"$undefined","style":{},"children":["        test_data"]}],["$","span","code-segement132",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement133",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement134",{"className":"$undefined","style":{},"children":["        batch_size"]}],["$","span","code-segement135",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement136",{"className":"$undefined","style":{},"children":["config"]}],["$","span","code-segement137",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement138",{"className":"token","style":{"color":"#116b00"},"children":["'testing_batch_size'"]}],["$","span","code-segement139",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement140",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement141",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement142",{"className":"$undefined","style":{},"children":["        shuffle"]}],["$","span","code-segement143",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement144",{"className":"token","style":{"color":"#755f00"},"children":["True"]}],["$","span","code-segement145",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement146",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement147",{"className":"$undefined","style":{},"children":["        num_workers"]}],["$","span","code-segement148",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement149",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement150",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement151",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement152",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement153",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement154",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement155",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement156",{"className":"token","style":{"color":"#111b27"},"children":["}"]}]]]}]}]]}],["$","$Lc","14",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","The ",["$","$La","14-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"torchvision"}]," package allows us easy access to the MNIST dataset using ",["$","$La","14-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"torchvision.datasets.MNIST"}],". We first load the training and testing data, which is determined by the ",["$","$La","14-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"train"}]," parameter passed to the ",["$","$La","14-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"MNIST"}]," constructor. We also call the ",["$","$La","14-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"ToTensor"}]," transform on this data."]}],["$","$Lc","15",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Then, we define our data loaders which are instances of ",["$","$La","15-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"torch.utils.data.DataLoader"}],": one for training and another for testing. Note how the training and testing batch sizes are being loaded from the config."]}],["$","$Lc","16",{"id":"the-model","variant":"h5","component":"h2","mb":2,"children":["$","strong",null,{"children":"The Model"}]}],["$","$Lc","17",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Next up, let's create the architecture of our CNN. In the ",["$","$La","17-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"src"}]," folder, create a new file called ",["$","$La","17-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"model.py"}],"."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"import torch\nimport torch.nn as nn\nimport torch.optim as optim\n\n\nclass CNN(nn.Module):\n    def __init__(self):\n        super(CNN, self).__init__()\n\n        self.conv1 = nn.Conv2d(in_channels=1, out_channels=10, kernel_size=5)\n        self.pool = nn.MaxPool2d(kernel_size=2, stride=2)\n        self.conv2 = nn.Conv2d(in_channels=10, out_channels=20, kernel_size=5)\n        self.dropout = nn.Dropout(p=0.5)\n        self.fc1 = nn.Linear(20 * 4 * 4, 50)\n        self.fc2 = nn.Linear(50, 10)\n\n    def forward(self, x):\n        x = self.pool(torch.relu(self.conv1(x)))\n        x = self.pool(torch.relu(self.conv2(x)))\n        x = self.dropout(x)\n        x = x.view(-1, 20 * 4 * 4)  # Flatten the tensor\n        x = torch.relu(self.fc1(x))\n        x = self.dropout(x)\n        x = self.fc2(x)\n        return torch.softmax(x, dim=1)\n\n# Create an instance of the CNN model\nmodel = CNN()\n\n# Define loss function and optimizer\ncriterion = nn.CrossEntropyLoss()\noptimizer = optim.Adam(model.parameters(), lr=0.001)"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" torch\n"]}],["$","span","code-segement2",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement3",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement5",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement6",{"className":"$undefined","style":{},"children":["nn "]}],["$","span","code-segement7",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":[" nn\n"]}],["$","span","code-segement9",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement10",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement11",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement12",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement13",{"className":"$undefined","style":{},"children":["optim "]}],["$","span","code-segement14",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":[" optim\n"]}],"\n","\n",["$","span","code-segement18",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement19",{"className":"token","style":{"color":"#a04900"},"children":["class"]}],["$","span","code-segement20",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement21",{"className":"token","style":{"color":"#005a8e"},"children":["CNN"]}],["$","span","code-segement22",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement23",{"className":"$undefined","style":{},"children":["nn"]}],["$","span","code-segement24",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement25",{"className":"$undefined","style":{},"children":["Module"]}],["$","span","code-segement26",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement27",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement28",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement29",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement30",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement31",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement32",{"className":"token","style":{"color":"#7c00aa"},"children":["__init__"]}],["$","span","code-segement33",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement34",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement35",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement36",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement37",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement38",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement39",{"className":"token","style":{"color":"#af00af"},"children":["super"]}],["$","span","code-segement40",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement41",{"className":"$undefined","style":{},"children":["CNN"]}],["$","span","code-segement42",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement43",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement44",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement45",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement46",{"className":"$undefined","style":{},"children":["__init__"]}],["$","span","code-segement47",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement48",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement49",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement51",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement52",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement53",{"className":"$undefined","style":{},"children":["conv1 "]}],["$","span","code-segement54",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement55",{"className":"$undefined","style":{},"children":[" nn"]}],["$","span","code-segement56",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement57",{"className":"$undefined","style":{},"children":["Conv2d"]}],["$","span","code-segement58",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement59",{"className":"$undefined","style":{},"children":["in_channels"]}],["$","span","code-segement60",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement61",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement62",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement63",{"className":"$undefined","style":{},"children":[" out_channels"]}],["$","span","code-segement64",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement65",{"className":"token","style":{"color":"#755f00"},"children":["10"]}],["$","span","code-segement66",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement67",{"className":"$undefined","style":{},"children":[" kernel_size"]}],["$","span","code-segement68",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement69",{"className":"token","style":{"color":"#755f00"},"children":["5"]}],["$","span","code-segement70",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement71",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement72",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement73",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement74",{"className":"$undefined","style":{},"children":["pool "]}],["$","span","code-segement75",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement76",{"className":"$undefined","style":{},"children":[" nn"]}],["$","span","code-segement77",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement78",{"className":"$undefined","style":{},"children":["MaxPool2d"]}],["$","span","code-segement79",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement80",{"className":"$undefined","style":{},"children":["kernel_size"]}],["$","span","code-segement81",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement82",{"className":"token","style":{"color":"#755f00"},"children":["2"]}],["$","span","code-segement83",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement84",{"className":"$undefined","style":{},"children":[" stride"]}],["$","span","code-segement85",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement86",{"className":"token","style":{"color":"#755f00"},"children":["2"]}],["$","span","code-segement87",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement88",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement89",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement90",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement91",{"className":"$undefined","style":{},"children":["conv2 "]}],["$","span","code-segement92",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement93",{"className":"$undefined","style":{},"children":[" nn"]}],["$","span","code-segement94",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement95",{"className":"$undefined","style":{},"children":["Conv2d"]}],["$","span","code-segement96",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement97",{"className":"$undefined","style":{},"children":["in_channels"]}],["$","span","code-segement98",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement99",{"className":"token","style":{"color":"#755f00"},"children":["10"]}],["$","span","code-segement100",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement101",{"className":"$undefined","style":{},"children":[" out_channels"]}],["$","span","code-segement102",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement103",{"className":"token","style":{"color":"#755f00"},"children":["20"]}],["$","span","code-segement104",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement105",{"className":"$undefined","style":{},"children":[" kernel_size"]}],["$","span","code-segement106",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement107",{"className":"token","style":{"color":"#755f00"},"children":["5"]}],["$","span","code-segement108",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement109",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement110",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement111",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement112",{"className":"$undefined","style":{},"children":["dropout "]}],["$","span","code-segement113",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement114",{"className":"$undefined","style":{},"children":[" nn"]}],["$","span","code-segement115",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement116",{"className":"$undefined","style":{},"children":["Dropout"]}],["$","span","code-segement117",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement118",{"className":"$undefined","style":{},"children":["p"]}],["$","span","code-segement119",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement120",{"className":"token","style":{"color":"#755f00"},"children":["0.5"]}],["$","span","code-segement121",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement122",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement123",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement124",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement125",{"className":"$undefined","style":{},"children":["fc1 "]}],["$","span","code-segement126",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement127",{"className":"$undefined","style":{},"children":[" nn"]}],["$","span","code-segement128",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement129",{"className":"$undefined","style":{},"children":["Linear"]}],["$","span","code-segement130",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement131",{"className":"token","style":{"color":"#755f00"},"children":["20"]}],["$","span","code-segement132",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement133",{"className":"token","style":{"color":"#a04900"},"children":["*"]}],["$","span","code-segement134",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement135",{"className":"token","style":{"color":"#755f00"},"children":["4"]}],["$","span","code-segement136",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement137",{"className":"token","style":{"color":"#a04900"},"children":["*"]}],["$","span","code-segement138",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement139",{"className":"token","style":{"color":"#755f00"},"children":["4"]}],["$","span","code-segement140",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement141",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement142",{"className":"token","style":{"color":"#755f00"},"children":["50"]}],["$","span","code-segement143",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement144",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement145",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement146",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement147",{"className":"$undefined","style":{},"children":["fc2 "]}],["$","span","code-segement148",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement149",{"className":"$undefined","style":{},"children":[" nn"]}],["$","span","code-segement150",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement151",{"className":"$undefined","style":{},"children":["Linear"]}],["$","span","code-segement152",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement153",{"className":"token","style":{"color":"#755f00"},"children":["50"]}],["$","span","code-segement154",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement155",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement156",{"className":"token","style":{"color":"#755f00"},"children":["10"]}],["$","span","code-segement157",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement158",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement160",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement161",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement162",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement163",{"className":"token","style":{"color":"#7c00aa"},"children":["forward"]}],["$","span","code-segement164",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement165",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement166",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement167",{"className":"$undefined","style":{},"children":[" x"]}],["$","span","code-segement168",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement169",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement170",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement171",{"className":"$undefined","style":{},"children":["        x "]}],["$","span","code-segement172",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement173",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement174",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement175",{"className":"$undefined","style":{},"children":["pool"]}],["$","span","code-segement176",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement177",{"className":"$undefined","style":{},"children":["torch"]}],["$","span","code-segement178",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement179",{"className":"$undefined","style":{},"children":["relu"]}],["$","span","code-segement180",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement181",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement182",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement183",{"className":"$undefined","style":{},"children":["conv1"]}],["$","span","code-segement184",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement185",{"className":"$undefined","style":{},"children":["x"]}],["$","span","code-segement186",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement187",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement188",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement189",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement190",{"className":"$undefined","style":{},"children":["        x "]}],["$","span","code-segement191",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement192",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement193",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement194",{"className":"$undefined","style":{},"children":["pool"]}],["$","span","code-segement195",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement196",{"className":"$undefined","style":{},"children":["torch"]}],["$","span","code-segement197",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement198",{"className":"$undefined","style":{},"children":["relu"]}],["$","span","code-segement199",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement200",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement201",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement202",{"className":"$undefined","style":{},"children":["conv2"]}],["$","span","code-segement203",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement204",{"className":"$undefined","style":{},"children":["x"]}],["$","span","code-segement205",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement206",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement207",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement208",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement209",{"className":"$undefined","style":{},"children":["        x "]}],["$","span","code-segement210",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement211",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement212",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement213",{"className":"$undefined","style":{},"children":["dropout"]}],["$","span","code-segement214",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement215",{"className":"$undefined","style":{},"children":["x"]}],["$","span","code-segement216",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement217",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement218",{"className":"$undefined","style":{},"children":["        x "]}],["$","span","code-segement219",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement220",{"className":"$undefined","style":{},"children":[" x"]}],["$","span","code-segement221",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement222",{"className":"$undefined","style":{},"children":["view"]}],["$","span","code-segement223",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement224",{"className":"token","style":{"color":"#a04900"},"children":["-"]}],["$","span","code-segement225",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement226",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement227",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement228",{"className":"token","style":{"color":"#755f00"},"children":["20"]}],["$","span","code-segement229",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement230",{"className":"token","style":{"color":"#a04900"},"children":["*"]}],["$","span","code-segement231",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement232",{"className":"token","style":{"color":"#755f00"},"children":["4"]}],["$","span","code-segement233",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement234",{"className":"token","style":{"color":"#a04900"},"children":["*"]}],["$","span","code-segement235",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement236",{"className":"token","style":{"color":"#755f00"},"children":["4"]}],["$","span","code-segement237",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement238",{"className":"$undefined","style":{},"children":["  "]}],["$","span","code-segement239",{"className":"token","style":{"color":"#3c526d"},"children":["# Flatten the tensor"]}],["$","span","code-segement240",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement241",{"className":"$undefined","style":{},"children":["        x "]}],["$","span","code-segement242",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement243",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement244",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement245",{"className":"$undefined","style":{},"children":["relu"]}],["$","span","code-segement246",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement247",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement248",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement249",{"className":"$undefined","style":{},"children":["fc1"]}],["$","span","code-segement250",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement251",{"className":"$undefined","style":{},"children":["x"]}],["$","span","code-segement252",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement253",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement254",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement255",{"className":"$undefined","style":{},"children":["        x "]}],["$","span","code-segement256",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement257",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement258",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement259",{"className":"$undefined","style":{},"children":["dropout"]}],["$","span","code-segement260",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement261",{"className":"$undefined","style":{},"children":["x"]}],["$","span","code-segement262",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement263",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement264",{"className":"$undefined","style":{},"children":["        x "]}],["$","span","code-segement265",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement266",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement267",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement268",{"className":"$undefined","style":{},"children":["fc2"]}],["$","span","code-segement269",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement270",{"className":"$undefined","style":{},"children":["x"]}],["$","span","code-segement271",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement272",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement273",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement274",{"className":"token","style":{"color":"#a04900"},"children":["return"]}],["$","span","code-segement275",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement276",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement277",{"className":"$undefined","style":{},"children":["softmax"]}],["$","span","code-segement278",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement279",{"className":"$undefined","style":{},"children":["x"]}],["$","span","code-segement280",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement281",{"className":"$undefined","style":{},"children":[" dim"]}],["$","span","code-segement282",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement283",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement284",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement285",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement287",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement288",{"className":"token","style":{"color":"#3c526d"},"children":["# Create an instance of the CNN model"]}],["$","span","code-segement289",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement290",{"className":"$undefined","style":{},"children":["model "]}],["$","span","code-segement291",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement292",{"className":"$undefined","style":{},"children":[" CNN"]}],["$","span","code-segement293",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement294",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement295",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement297",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement298",{"className":"token","style":{"color":"#3c526d"},"children":["# Define loss function and optimizer"]}],["$","span","code-segement299",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement300",{"className":"$undefined","style":{},"children":["criterion "]}],["$","span","code-segement301",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement302",{"className":"$undefined","style":{},"children":[" nn"]}],["$","span","code-segement303",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement304",{"className":"$undefined","style":{},"children":["CrossEntropyLoss"]}],["$","span","code-segement305",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement306",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement307",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement308",{"className":"$undefined","style":{},"children":["optimizer "]}],["$","span","code-segement309",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement310",{"className":"$undefined","style":{},"children":[" optim"]}],["$","span","code-segement311",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement312",{"className":"$undefined","style":{},"children":["Adam"]}],["$","span","code-segement313",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement314",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement315",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement316",{"className":"$undefined","style":{},"children":["parameters"]}],["$","span","code-segement317",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement318",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement319",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement320",{"className":"$undefined","style":{},"children":[" lr"]}],["$","span","code-segement321",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement322",{"className":"token","style":{"color":"#755f00"},"children":["0.001"]}],["$","span","code-segement323",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Lc","19",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","We create a simple CNN with two convolution, one max pooling, one dropout, and two fully-connected layers. We use ",["$","$L17","19-link",{"href":"https://pytorch.org/docs/stable/generated/torch.nn.CrossEntropyLoss.html","rel":"noopener noreferrer","target":"_blank","color":"primary","underline":"hover","children":"Cross Entropy"}]," as our loss function and the ",["$","$L17","19-link",{"href":"https://pytorch.org/docs/stable/generated/torch.optim.Adam.html","rel":"noopener noreferrer","target":"_blank","color":"primary","underline":"hover","children":"Adam Optimizer"}],"."]}],["$","$Lc","20",{"id":"training","variant":"h5","component":"h2","mb":2,"children":["$","strong",null,{"children":"Training"}]}],["$","$Lc","21",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","In the same directory, create a file called ",["$","$La","21-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"train.py"}],". Calling this file will train our model. Inside this file, we make the required imports and then define a class called ",["$","$La","21-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"ModelTrainer"}],"."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"from datetime import datetime\nfrom os import makedirs\nfrom os.path import join\n\nimport torch\nimport torch.nn as nn\nimport torch.optim as optim\n\nfrom .config import config, models_dir\nfrom .dataset import data_loaders\nfrom .model import CNN\n\n\nclass ModelTrainer:\n    def __init__(self):\n        self.training_id = \"torch---\" + datetime.now().strftime(\"%Y-%m-%d-%H-%M-%S\")\n\n        self.device = torch.device(\"cuda\" if torch.cuda.is_available() else \"cpu\")\n\n        self.model = CNN()\n        self.model = self.model.to(self.device)\n\n        self.optimizer = optim.Adam(self.model.parameters(), lr=config['learning_rate'])\n        self.loss_fn = nn.CrossEntropyLoss()\n\n        self.models_dir = join(models_dir, self.training_id)\n        makedirs(self.models_dir, exist_ok=False)\n\n    def save_weights(self, file_path):\n        torch.save(self.model.state_dict(), file_path)"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" datetime "]}],["$","span","code-segement2",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":[" datetime\n"]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement5",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement6",{"className":"$undefined","style":{},"children":[" os "]}],["$","span","code-segement7",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":[" makedirs\n"]}],["$","span","code-segement9",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement10",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement11",{"className":"$undefined","style":{},"children":[" os"]}],["$","span","code-segement12",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement13",{"className":"$undefined","style":{},"children":["path "]}],["$","span","code-segement14",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":[" join\n"]}],"\n",["$","span","code-segement17",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement18",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement19",{"className":"$undefined","style":{},"children":[" torch\n"]}],["$","span","code-segement20",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement21",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement22",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement23",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement24",{"className":"$undefined","style":{},"children":["nn "]}],["$","span","code-segement25",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":[" nn\n"]}],["$","span","code-segement27",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement28",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement29",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement30",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement31",{"className":"$undefined","style":{},"children":["optim "]}],["$","span","code-segement32",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement33",{"className":"$undefined","style":{},"children":[" optim\n"]}],"\n",["$","span","code-segement35",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement36",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement37",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement38",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement39",{"className":"$undefined","style":{},"children":["config "]}],["$","span","code-segement40",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement41",{"className":"$undefined","style":{},"children":[" config"]}],["$","span","code-segement42",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement43",{"className":"$undefined","style":{},"children":[" models_dir\n"]}],["$","span","code-segement44",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement45",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement46",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement47",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement48",{"className":"$undefined","style":{},"children":["dataset "]}],["$","span","code-segement49",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement50",{"className":"$undefined","style":{},"children":[" data_loaders\n"]}],["$","span","code-segement51",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement52",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement53",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement54",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement55",{"className":"$undefined","style":{},"children":["model "]}],["$","span","code-segement56",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement57",{"className":"$undefined","style":{},"children":[" CNN\n"]}],"\n","\n",["$","span","code-segement60",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement61",{"className":"token","style":{"color":"#a04900"},"children":["class"]}],["$","span","code-segement62",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement63",{"className":"token","style":{"color":"#005a8e"},"children":["ModelTrainer"]}],["$","span","code-segement64",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement65",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement66",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement67",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement68",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement69",{"className":"token","style":{"color":"#7c00aa"},"children":["__init__"]}],["$","span","code-segement70",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement71",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement72",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement73",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement74",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement75",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement76",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement77",{"className":"$undefined","style":{},"children":["training_id "]}],["$","span","code-segement78",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement79",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement80",{"className":"token","style":{"color":"#116b00"},"children":["\"torch---\""]}],["$","span","code-segement81",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement82",{"className":"token","style":{"color":"#a04900"},"children":["+"]}],["$","span","code-segement83",{"className":"$undefined","style":{},"children":[" datetime"]}],["$","span","code-segement84",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement85",{"className":"$undefined","style":{},"children":["now"]}],["$","span","code-segement86",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement87",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement88",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement89",{"className":"$undefined","style":{},"children":["strftime"]}],["$","span","code-segement90",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement91",{"className":"token","style":{"color":"#116b00"},"children":["\"%Y-%m-%d-%H-%M-%S\""]}],["$","span","code-segement92",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement93",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement95",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement96",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement97",{"className":"$undefined","style":{},"children":["device "]}],["$","span","code-segement98",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement99",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement100",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement101",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement102",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement103",{"className":"token","style":{"color":"#116b00"},"children":["\"cuda\""]}],["$","span","code-segement104",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement105",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement106",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement107",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement108",{"className":"$undefined","style":{},"children":["cuda"]}],["$","span","code-segement109",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement110",{"className":"$undefined","style":{},"children":["is_available"]}],["$","span","code-segement111",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement112",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement113",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement114",{"className":"token","style":{"color":"#a04900"},"children":["else"]}],["$","span","code-segement115",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement116",{"className":"token","style":{"color":"#116b00"},"children":["\"cpu\""]}],["$","span","code-segement117",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement118",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement120",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement121",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement122",{"className":"$undefined","style":{},"children":["model "]}],["$","span","code-segement123",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement124",{"className":"$undefined","style":{},"children":[" CNN"]}],["$","span","code-segement125",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement126",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement127",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement128",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement129",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement130",{"className":"$undefined","style":{},"children":["model "]}],["$","span","code-segement131",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement132",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement133",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement134",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement135",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement136",{"className":"$undefined","style":{},"children":["to"]}],["$","span","code-segement137",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement138",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement139",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement140",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement141",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement142",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement144",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement145",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement146",{"className":"$undefined","style":{},"children":["optimizer "]}],["$","span","code-segement147",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement148",{"className":"$undefined","style":{},"children":[" optim"]}],["$","span","code-segement149",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement150",{"className":"$undefined","style":{},"children":["Adam"]}],["$","span","code-segement151",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement152",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement153",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement154",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement155",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement156",{"className":"$undefined","style":{},"children":["parameters"]}],["$","span","code-segement157",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement158",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement159",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement160",{"className":"$undefined","style":{},"children":[" lr"]}],["$","span","code-segement161",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement162",{"className":"$undefined","style":{},"children":["config"]}],["$","span","code-segement163",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement164",{"className":"token","style":{"color":"#116b00"},"children":["'learning_rate'"]}],["$","span","code-segement165",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement166",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement167",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement168",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement169",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement170",{"className":"$undefined","style":{},"children":["loss_fn "]}],["$","span","code-segement171",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement172",{"className":"$undefined","style":{},"children":[" nn"]}],["$","span","code-segement173",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement174",{"className":"$undefined","style":{},"children":["CrossEntropyLoss"]}],["$","span","code-segement175",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement176",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement177",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement179",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement180",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement181",{"className":"$undefined","style":{},"children":["models_dir "]}],["$","span","code-segement182",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement183",{"className":"$undefined","style":{},"children":[" join"]}],["$","span","code-segement184",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement185",{"className":"$undefined","style":{},"children":["models_dir"]}],["$","span","code-segement186",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement187",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement188",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement189",{"className":"$undefined","style":{},"children":["training_id"]}],["$","span","code-segement190",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement191",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement192",{"className":"$undefined","style":{},"children":["        makedirs"]}],["$","span","code-segement193",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement194",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement195",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement196",{"className":"$undefined","style":{},"children":["models_dir"]}],["$","span","code-segement197",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement198",{"className":"$undefined","style":{},"children":[" exist_ok"]}],["$","span","code-segement199",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement200",{"className":"token","style":{"color":"#755f00"},"children":["False"]}],["$","span","code-segement201",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement202",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement204",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement205",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement206",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement207",{"className":"token","style":{"color":"#7c00aa"},"children":["save_weights"]}],["$","span","code-segement208",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement209",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement210",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement211",{"className":"$undefined","style":{},"children":[" file_path"]}],["$","span","code-segement212",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement213",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement214",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement215",{"className":"$undefined","style":{},"children":["        torch"]}],["$","span","code-segement216",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement217",{"className":"$undefined","style":{},"children":["save"]}],["$","span","code-segement218",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement219",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement220",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement221",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement222",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement223",{"className":"$undefined","style":{},"children":["state_dict"]}],["$","span","code-segement224",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement225",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement226",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement227",{"className":"$undefined","style":{},"children":[" file_path"]}],["$","span","code-segement228",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Lc","23",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","In the constructor, we generate a unique training id, instantiate the model, the optimizer, and the loss function. We move the model to our device (CPU/GPU) and make a new directory in our models dir for the particular training id. We also define a function ",["$","$La","23-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"save_weights"}]," that will save our model's weights at the provided file path - we'll use this to save the model weights after every training epoch."]}],["$","$Lc","24",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Speaking of epochs, let's create a function that can train our model for one epoch."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"def train_single_epoch(self):\n    self.model.train()\n\n    for batch_index, (data, target) in enumerate(data_loaders[\"train\"]):\n        data = data.to(self.device)\n        target = target.to(self.device)\n\n        self.optimizer.zero_grad()\n\n        output = self.model(data)\n\n        loss = self.loss_fn(output, target)\n        loss.backward()\n\n        self.optimizer.step()\n\n        if batch_index % config['log_batch_interval'] == 0:\n            print(f\"    {batch_index} / {len(data_loaders['train'])}\")"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement2",{"className":"token","style":{"color":"#7c00aa"},"children":["train_single_epoch"]}],["$","span","code-segement3",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement5",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement6",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement7",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":["    self"]}],["$","span","code-segement9",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement11",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement12",{"className":"$undefined","style":{},"children":["train"]}],["$","span","code-segement13",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement14",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement17",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement18",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement19",{"className":"$undefined","style":{},"children":[" batch_index"]}],["$","span","code-segement20",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement21",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement22",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement23",{"className":"$undefined","style":{},"children":["data"]}],["$","span","code-segement24",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement25",{"className":"$undefined","style":{},"children":[" target"]}],["$","span","code-segement26",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement27",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement28",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement29",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement30",{"className":"token","style":{"color":"#af00af"},"children":["enumerate"]}],["$","span","code-segement31",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement32",{"className":"$undefined","style":{},"children":["data_loaders"]}],["$","span","code-segement33",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement34",{"className":"token","style":{"color":"#116b00"},"children":["\"train\""]}],["$","span","code-segement35",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement36",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement37",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement38",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement39",{"className":"$undefined","style":{},"children":["        data "]}],["$","span","code-segement40",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement41",{"className":"$undefined","style":{},"children":[" data"]}],["$","span","code-segement42",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement43",{"className":"$undefined","style":{},"children":["to"]}],["$","span","code-segement44",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement45",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement46",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement47",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement48",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement49",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement50",{"className":"$undefined","style":{},"children":["        target "]}],["$","span","code-segement51",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement52",{"className":"$undefined","style":{},"children":[" target"]}],["$","span","code-segement53",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement54",{"className":"$undefined","style":{},"children":["to"]}],["$","span","code-segement55",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement56",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement57",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement58",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement59",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement60",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement62",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement63",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement64",{"className":"$undefined","style":{},"children":["optimizer"]}],["$","span","code-segement65",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement66",{"className":"$undefined","style":{},"children":["zero_grad"]}],["$","span","code-segement67",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement68",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement69",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement71",{"className":"$undefined","style":{},"children":["        output "]}],["$","span","code-segement72",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement73",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement74",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement75",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement76",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement77",{"className":"$undefined","style":{},"children":["data"]}],["$","span","code-segement78",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement79",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement81",{"className":"$undefined","style":{},"children":["        loss "]}],["$","span","code-segement82",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement83",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement84",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement85",{"className":"$undefined","style":{},"children":["loss_fn"]}],["$","span","code-segement86",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement87",{"className":"$undefined","style":{},"children":["output"]}],["$","span","code-segement88",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement89",{"className":"$undefined","style":{},"children":[" target"]}],["$","span","code-segement90",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement91",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement92",{"className":"$undefined","style":{},"children":["        loss"]}],["$","span","code-segement93",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement94",{"className":"$undefined","style":{},"children":["backward"]}],["$","span","code-segement95",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement96",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement97",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement99",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement100",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement101",{"className":"$undefined","style":{},"children":["optimizer"]}],["$","span","code-segement102",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement103",{"className":"$undefined","style":{},"children":["step"]}],["$","span","code-segement104",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement105",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement106",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement108",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement109",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement110",{"className":"$undefined","style":{},"children":[" batch_index "]}],["$","span","code-segement111",{"className":"token","style":{"color":"#a04900"},"children":["%"]}],["$","span","code-segement112",{"className":"$undefined","style":{},"children":[" config"]}],["$","span","code-segement113",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement114",{"className":"token","style":{"color":"#116b00"},"children":["'log_batch_interval'"]}],["$","span","code-segement115",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement116",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement117",{"className":"token","style":{"color":"#a04900"},"children":["=="]}],["$","span","code-segement118",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement119",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement120",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement121",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement122",{"className":"$undefined","style":{},"children":["            "]}],["$","span","code-segement123",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement124",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement125",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\"    "]}],["$","span","code-segement126",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement127",{"className":"token string-interpolation interpolation","style":{},"children":["batch_index"]}],["$","span","code-segement128",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement129",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[" / "]}],["$","span","code-segement130",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement131",{"className":"token string-interpolation interpolation","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement132",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement133",{"className":"token string-interpolation interpolation","style":{},"children":["data_loaders"]}],["$","span","code-segement134",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement135",{"className":"token string-interpolation interpolation","style":{"color":"#116b00"},"children":["'train'"]}],["$","span","code-segement136",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement137",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement138",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement139",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["\""]}],["$","span","code-segement140",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Lc","26",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","This is the standard training strategy. The last couple of lines are just for logging the training progress at the specified interval."]}],["$","$Lc","27",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Now, we want to create a function that can test the model on our test data and get us the loss and accuracy."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"def test(self):\n    self.model.eval()\n\n    sum_test_loss = 0\n    num_correct = 0\n\n    with torch.no_grad():\n        for data, target in data_loaders[\"test\"]:\n            data = data.to(self.device)\n            target = target.to(self.device)\n\n            output = self.model(data)\n\n            sum_test_loss += self.loss_fn(output, target).item()\n\n            prediction = output.argmax(dim=1, keepdim=True)\n\n            num_correct += prediction.eq(target.view_as(prediction)).sum().item()\n\n    average_test_loss = sum_test_loss / len(data_loaders['test'].dataset)\n    accuracy = num_correct / len(data_loaders['test'].dataset)\n\n    print(f\"    Average loss: {average_test_loss}\")\n    print(f\"    Accuracy: {accuracy}\")"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement2",{"className":"token","style":{"color":"#7c00aa"},"children":["test"]}],["$","span","code-segement3",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement5",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement6",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement7",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":["    self"]}],["$","span","code-segement9",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement11",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement12",{"className":"token","style":{"color":"#af00af"},"children":["eval"]}],["$","span","code-segement13",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement14",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement17",{"className":"$undefined","style":{},"children":["    sum_test_loss "]}],["$","span","code-segement18",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement19",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement20",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement21",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement22",{"className":"$undefined","style":{},"children":["    num_correct "]}],["$","span","code-segement23",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement24",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement25",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement28",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement29",{"className":"token","style":{"color":"#a04900"},"children":["with"]}],["$","span","code-segement30",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement31",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement32",{"className":"$undefined","style":{},"children":["no_grad"]}],["$","span","code-segement33",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement34",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement35",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement36",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement37",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement38",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement39",{"className":"$undefined","style":{},"children":[" data"]}],["$","span","code-segement40",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement41",{"className":"$undefined","style":{},"children":[" target "]}],["$","span","code-segement42",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement43",{"className":"$undefined","style":{},"children":[" data_loaders"]}],["$","span","code-segement44",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement45",{"className":"token","style":{"color":"#116b00"},"children":["\"test\""]}],["$","span","code-segement46",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement47",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement48",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement49",{"className":"$undefined","style":{},"children":["            data "]}],["$","span","code-segement50",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement51",{"className":"$undefined","style":{},"children":[" data"]}],["$","span","code-segement52",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement53",{"className":"$undefined","style":{},"children":["to"]}],["$","span","code-segement54",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement55",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement56",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement57",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement58",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement59",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement60",{"className":"$undefined","style":{},"children":["            target "]}],["$","span","code-segement61",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement62",{"className":"$undefined","style":{},"children":[" target"]}],["$","span","code-segement63",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement64",{"className":"$undefined","style":{},"children":["to"]}],["$","span","code-segement65",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement66",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement67",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement68",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement69",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement70",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement72",{"className":"$undefined","style":{},"children":["            output "]}],["$","span","code-segement73",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement74",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement75",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement76",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement77",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement78",{"className":"$undefined","style":{},"children":["data"]}],["$","span","code-segement79",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement80",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement82",{"className":"$undefined","style":{},"children":["            sum_test_loss "]}],["$","span","code-segement83",{"className":"token","style":{"color":"#a04900"},"children":["+="]}],["$","span","code-segement84",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement85",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement86",{"className":"$undefined","style":{},"children":["loss_fn"]}],["$","span","code-segement87",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement88",{"className":"$undefined","style":{},"children":["output"]}],["$","span","code-segement89",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement90",{"className":"$undefined","style":{},"children":[" target"]}],["$","span","code-segement91",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement92",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement93",{"className":"$undefined","style":{},"children":["item"]}],["$","span","code-segement94",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement95",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement96",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement98",{"className":"$undefined","style":{},"children":["            prediction "]}],["$","span","code-segement99",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement100",{"className":"$undefined","style":{},"children":[" output"]}],["$","span","code-segement101",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement102",{"className":"$undefined","style":{},"children":["argmax"]}],["$","span","code-segement103",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement104",{"className":"$undefined","style":{},"children":["dim"]}],["$","span","code-segement105",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement106",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement107",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement108",{"className":"$undefined","style":{},"children":[" keepdim"]}],["$","span","code-segement109",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement110",{"className":"token","style":{"color":"#755f00"},"children":["True"]}],["$","span","code-segement111",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement112",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement114",{"className":"$undefined","style":{},"children":["            num_correct "]}],["$","span","code-segement115",{"className":"token","style":{"color":"#a04900"},"children":["+="]}],["$","span","code-segement116",{"className":"$undefined","style":{},"children":[" prediction"]}],["$","span","code-segement117",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement118",{"className":"$undefined","style":{},"children":["eq"]}],["$","span","code-segement119",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement120",{"className":"$undefined","style":{},"children":["target"]}],["$","span","code-segement121",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement122",{"className":"$undefined","style":{},"children":["view_as"]}],["$","span","code-segement123",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement124",{"className":"$undefined","style":{},"children":["prediction"]}],["$","span","code-segement125",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement126",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement127",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement128",{"className":"token","style":{"color":"#af00af"},"children":["sum"]}],["$","span","code-segement129",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement130",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement131",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement132",{"className":"$undefined","style":{},"children":["item"]}],["$","span","code-segement133",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement134",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement135",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement137",{"className":"$undefined","style":{},"children":["    average_test_loss "]}],["$","span","code-segement138",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement139",{"className":"$undefined","style":{},"children":[" sum_test_loss "]}],["$","span","code-segement140",{"className":"token","style":{"color":"#a04900"},"children":["/"]}],["$","span","code-segement141",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement142",{"className":"token","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement143",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement144",{"className":"$undefined","style":{},"children":["data_loaders"]}],["$","span","code-segement145",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement146",{"className":"token","style":{"color":"#116b00"},"children":["'test'"]}],["$","span","code-segement147",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement148",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement149",{"className":"$undefined","style":{},"children":["dataset"]}],["$","span","code-segement150",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement151",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement152",{"className":"$undefined","style":{},"children":["    accuracy "]}],["$","span","code-segement153",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement154",{"className":"$undefined","style":{},"children":[" num_correct "]}],["$","span","code-segement155",{"className":"token","style":{"color":"#a04900"},"children":["/"]}],["$","span","code-segement156",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement157",{"className":"token","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement158",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement159",{"className":"$undefined","style":{},"children":["data_loaders"]}],["$","span","code-segement160",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement161",{"className":"token","style":{"color":"#116b00"},"children":["'test'"]}],["$","span","code-segement162",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement163",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement164",{"className":"$undefined","style":{},"children":["dataset"]}],["$","span","code-segement165",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement166",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement168",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement169",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement170",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement171",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\"    Average loss: "]}],["$","span","code-segement172",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement173",{"className":"token string-interpolation interpolation","style":{},"children":["average_test_loss"]}],["$","span","code-segement174",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement175",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["\""]}],["$","span","code-segement176",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement177",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement178",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement179",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement180",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement181",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\"    Accuracy: "]}],["$","span","code-segement182",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement183",{"className":"token string-interpolation interpolation","style":{},"children":["accuracy"]}],["$","span","code-segement184",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement185",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["\""]}],["$","span","code-segement186",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Lc","29",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","For all the testing samples, we calculate the average loss and the number of predictions the model got correct and then print them to the console."]}],["$","$Lc","30",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","And, finally, we can define our ",["$","$La","30-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"train"}]," function, which just trains our model for the specified number of epochs."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"def train(self):\n    for epoch_index in range(config['training_num_epochs']):\n        print(f\"Epoch: {epoch_index}\")\n        self.train_single_epoch()\n\n        model_save_file_path = join(self.models_dir, f\"epoch-{epoch_index}.pt\")\n        self.save_weights(model_save_file_path)\n\n        self.test()"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement2",{"className":"token","style":{"color":"#7c00aa"},"children":["train"]}],["$","span","code-segement3",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement5",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement6",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement7",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement9",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":[" epoch_index "]}],["$","span","code-segement11",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement12",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement13",{"className":"token","style":{"color":"#af00af"},"children":["range"]}],["$","span","code-segement14",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":["config"]}],["$","span","code-segement16",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement17",{"className":"token","style":{"color":"#116b00"},"children":["'training_num_epochs'"]}],["$","span","code-segement18",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement19",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement20",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement21",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement22",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement23",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement24",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement25",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\"Epoch: "]}],["$","span","code-segement26",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement27",{"className":"token string-interpolation interpolation","style":{},"children":["epoch_index"]}],["$","span","code-segement28",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement29",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["\""]}],["$","span","code-segement30",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement31",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement32",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement33",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement34",{"className":"$undefined","style":{},"children":["train_single_epoch"]}],["$","span","code-segement35",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement36",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement37",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement39",{"className":"$undefined","style":{},"children":["        model_save_file_path "]}],["$","span","code-segement40",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement41",{"className":"$undefined","style":{},"children":[" join"]}],["$","span","code-segement42",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement43",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement44",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement45",{"className":"$undefined","style":{},"children":["models_dir"]}],["$","span","code-segement46",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement47",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement48",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\"epoch-"]}],["$","span","code-segement49",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement50",{"className":"token string-interpolation interpolation","style":{},"children":["epoch_index"]}],["$","span","code-segement51",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement52",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[".pt\""]}],["$","span","code-segement53",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement54",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement55",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement56",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement57",{"className":"$undefined","style":{},"children":["save_weights"]}],["$","span","code-segement58",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement59",{"className":"$undefined","style":{},"children":["model_save_file_path"]}],["$","span","code-segement60",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement61",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement63",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement64",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement65",{"className":"$undefined","style":{},"children":["test"]}],["$","span","code-segement66",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement67",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Lc","32",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Outside the ",["$","$La","32-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"ModelTrainer"}]," class, in the ",["$","$La","32-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"main"}]," block, we can create an instance of the class and call the train function."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"if __name__ == \"__main__\":\n    model_trainer = ModelTrainer()\n    model_trainer.train()"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" __name__ "]}],["$","span","code-segement2",{"className":"token","style":{"color":"#a04900"},"children":["=="]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement4",{"className":"token","style":{"color":"#116b00"},"children":["\"__main__\""]}],["$","span","code-segement5",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement6",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement7",{"className":"$undefined","style":{},"children":["    model_trainer "]}],["$","span","code-segement8",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement9",{"className":"$undefined","style":{},"children":[" ModelTrainer"]}],["$","span","code-segement10",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement11",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement12",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement13",{"className":"$undefined","style":{},"children":["    model_trainer"]}],["$","span","code-segement14",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":["train"]}],["$","span","code-segement16",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement17",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Lc","34",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Here's the entire ",["$","$La","34-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"train.py"}]," file."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"$19"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" datetime "]}],["$","span","code-segement2",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":[" datetime\n"]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement5",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement6",{"className":"$undefined","style":{},"children":[" os "]}],["$","span","code-segement7",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":[" makedirs\n"]}],["$","span","code-segement9",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement10",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement11",{"className":"$undefined","style":{},"children":[" os"]}],["$","span","code-segement12",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement13",{"className":"$undefined","style":{},"children":["path "]}],["$","span","code-segement14",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":[" join\n"]}],"\n",["$","span","code-segement17",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement18",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement19",{"className":"$undefined","style":{},"children":[" torch\n"]}],["$","span","code-segement20",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement21",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement22",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement23",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement24",{"className":"$undefined","style":{},"children":["nn "]}],["$","span","code-segement25",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":[" nn\n"]}],["$","span","code-segement27",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement28",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement29",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement30",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement31",{"className":"$undefined","style":{},"children":["optim "]}],["$","span","code-segement32",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement33",{"className":"$undefined","style":{},"children":[" optim\n"]}],"\n",["$","span","code-segement35",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement36",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement37",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement38",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement39",{"className":"$undefined","style":{},"children":["config "]}],["$","span","code-segement40",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement41",{"className":"$undefined","style":{},"children":[" config"]}],["$","span","code-segement42",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement43",{"className":"$undefined","style":{},"children":[" models_dir\n"]}],["$","span","code-segement44",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement45",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement46",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement47",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement48",{"className":"$undefined","style":{},"children":["dataset "]}],["$","span","code-segement49",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement50",{"className":"$undefined","style":{},"children":[" data_loaders\n"]}],["$","span","code-segement51",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement52",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement53",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement54",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement55",{"className":"$undefined","style":{},"children":["model "]}],["$","span","code-segement56",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement57",{"className":"$undefined","style":{},"children":[" CNN\n"]}],"\n","\n",["$","span","code-segement60",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement61",{"className":"token","style":{"color":"#a04900"},"children":["class"]}],["$","span","code-segement62",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement63",{"className":"token","style":{"color":"#005a8e"},"children":["ModelTrainer"]}],["$","span","code-segement64",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement65",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement66",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement67",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement68",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement69",{"className":"token","style":{"color":"#7c00aa"},"children":["__init__"]}],["$","span","code-segement70",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement71",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement72",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement73",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement74",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement75",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement76",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement77",{"className":"$undefined","style":{},"children":["training_id "]}],["$","span","code-segement78",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement79",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement80",{"className":"token","style":{"color":"#116b00"},"children":["\"torch---\""]}],["$","span","code-segement81",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement82",{"className":"token","style":{"color":"#a04900"},"children":["+"]}],["$","span","code-segement83",{"className":"$undefined","style":{},"children":[" datetime"]}],["$","span","code-segement84",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement85",{"className":"$undefined","style":{},"children":["now"]}],["$","span","code-segement86",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement87",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement88",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement89",{"className":"$undefined","style":{},"children":["strftime"]}],["$","span","code-segement90",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement91",{"className":"token","style":{"color":"#116b00"},"children":["\"%Y-%m-%d-%H-%M-%S\""]}],["$","span","code-segement92",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement93",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement95",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement96",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement97",{"className":"$undefined","style":{},"children":["device "]}],["$","span","code-segement98",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement99",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement100",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement101",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement102",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement103",{"className":"token","style":{"color":"#116b00"},"children":["\"cuda\""]}],["$","span","code-segement104",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement105",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement106",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement107",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement108",{"className":"$undefined","style":{},"children":["cuda"]}],["$","span","code-segement109",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement110",{"className":"$undefined","style":{},"children":["is_available"]}],["$","span","code-segement111",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement112",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement113",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement114",{"className":"token","style":{"color":"#a04900"},"children":["else"]}],["$","span","code-segement115",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement116",{"className":"token","style":{"color":"#116b00"},"children":["\"cpu\""]}],["$","span","code-segement117",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement118",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement120",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement121",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement122",{"className":"$undefined","style":{},"children":["model "]}],["$","span","code-segement123",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement124",{"className":"$undefined","style":{},"children":[" CNN"]}],["$","span","code-segement125",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement126",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement127",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement128",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement129",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement130",{"className":"$undefined","style":{},"children":["model "]}],["$","span","code-segement131",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement132",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement133",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement134",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement135",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement136",{"className":"$undefined","style":{},"children":["to"]}],["$","span","code-segement137",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement138",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement139",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement140",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement141",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement142",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement144",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement145",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement146",{"className":"$undefined","style":{},"children":["optimizer "]}],["$","span","code-segement147",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement148",{"className":"$undefined","style":{},"children":[" optim"]}],["$","span","code-segement149",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement150",{"className":"$undefined","style":{},"children":["Adam"]}],["$","span","code-segement151",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement152",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement153",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement154",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement155",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement156",{"className":"$undefined","style":{},"children":["parameters"]}],["$","span","code-segement157",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement158",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement159",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement160",{"className":"$undefined","style":{},"children":[" lr"]}],["$","span","code-segement161",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement162",{"className":"$undefined","style":{},"children":["config"]}],["$","span","code-segement163",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement164",{"className":"token","style":{"color":"#116b00"},"children":["'learning_rate'"]}],["$","span","code-segement165",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement166",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement167",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement168",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement169",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement170",{"className":"$undefined","style":{},"children":["loss_fn "]}],["$","span","code-segement171",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement172",{"className":"$undefined","style":{},"children":[" nn"]}],["$","span","code-segement173",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement174",{"className":"$undefined","style":{},"children":["CrossEntropyLoss"]}],["$","span","code-segement175",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement176",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement177",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement179",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement180",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement181",{"className":"$undefined","style":{},"children":["models_dir "]}],["$","span","code-segement182",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement183",{"className":"$undefined","style":{},"children":[" join"]}],["$","span","code-segement184",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement185",{"className":"$undefined","style":{},"children":["models_dir"]}],["$","span","code-segement186",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement187",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement188",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement189",{"className":"$undefined","style":{},"children":["training_id"]}],["$","span","code-segement190",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement191",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement192",{"className":"$undefined","style":{},"children":["        makedirs"]}],["$","span","code-segement193",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement194",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement195",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement196",{"className":"$undefined","style":{},"children":["models_dir"]}],["$","span","code-segement197",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement198",{"className":"$undefined","style":{},"children":[" exist_ok"]}],["$","span","code-segement199",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement200",{"className":"token","style":{"color":"#755f00"},"children":["False"]}],["$","span","code-segement201",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement202",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement204",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement205",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement206",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement207",{"className":"token","style":{"color":"#7c00aa"},"children":["train_single_epoch"]}],["$","span","code-segement208",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement209",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement210",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement211",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement212",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement213",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement214",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement215",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement216",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement217",{"className":"$undefined","style":{},"children":["train"]}],["$","span","code-segement218",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement219",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement220",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement222",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement223",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement224",{"className":"$undefined","style":{},"children":[" batch_index"]}],["$","span","code-segement225",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement226",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement227",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement228",{"className":"$undefined","style":{},"children":["data"]}],["$","span","code-segement229",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement230",{"className":"$undefined","style":{},"children":[" target"]}],["$","span","code-segement231",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement232",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement233",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement234",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement235",{"className":"token","style":{"color":"#af00af"},"children":["enumerate"]}],["$","span","code-segement236",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement237",{"className":"$undefined","style":{},"children":["data_loaders"]}],["$","span","code-segement238",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement239",{"className":"token","style":{"color":"#116b00"},"children":["\"train\""]}],["$","span","code-segement240",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement241",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement242",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement243",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement244",{"className":"$undefined","style":{},"children":["            data "]}],["$","span","code-segement245",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement246",{"className":"$undefined","style":{},"children":[" data"]}],["$","span","code-segement247",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement248",{"className":"$undefined","style":{},"children":["to"]}],["$","span","code-segement249",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement250",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement251",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement252",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement253",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement254",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement255",{"className":"$undefined","style":{},"children":["            target "]}],["$","span","code-segement256",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement257",{"className":"$undefined","style":{},"children":[" target"]}],["$","span","code-segement258",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement259",{"className":"$undefined","style":{},"children":["to"]}],["$","span","code-segement260",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement261",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement262",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement263",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement264",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement265",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement267",{"className":"$undefined","style":{},"children":["            self"]}],["$","span","code-segement268",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement269",{"className":"$undefined","style":{},"children":["optimizer"]}],["$","span","code-segement270",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement271",{"className":"$undefined","style":{},"children":["zero_grad"]}],["$","span","code-segement272",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement273",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement274",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement276",{"className":"$undefined","style":{},"children":["            output "]}],["$","span","code-segement277",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement278",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement279",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement280",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement281",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement282",{"className":"$undefined","style":{},"children":["data"]}],["$","span","code-segement283",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement284",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement286",{"className":"$undefined","style":{},"children":["            loss "]}],["$","span","code-segement287",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement288",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement289",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement290",{"className":"$undefined","style":{},"children":["loss_fn"]}],["$","span","code-segement291",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement292",{"className":"$undefined","style":{},"children":["output"]}],["$","span","code-segement293",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement294",{"className":"$undefined","style":{},"children":[" target"]}],["$","span","code-segement295",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement296",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement297",{"className":"$undefined","style":{},"children":["            loss"]}],["$","span","code-segement298",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement299",{"className":"$undefined","style":{},"children":["backward"]}],["$","span","code-segement300",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement301",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement302",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement304",{"className":"$undefined","style":{},"children":["            self"]}],["$","span","code-segement305",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement306",{"className":"$undefined","style":{},"children":["optimizer"]}],["$","span","code-segement307",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement308",{"className":"$undefined","style":{},"children":["step"]}],["$","span","code-segement309",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement310",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement311",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement313",{"className":"$undefined","style":{},"children":["            "]}],["$","span","code-segement314",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement315",{"className":"$undefined","style":{},"children":[" batch_index "]}],["$","span","code-segement316",{"className":"token","style":{"color":"#a04900"},"children":["%"]}],["$","span","code-segement317",{"className":"$undefined","style":{},"children":[" config"]}],["$","span","code-segement318",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement319",{"className":"token","style":{"color":"#116b00"},"children":["'log_batch_interval'"]}],["$","span","code-segement320",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement321",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement322",{"className":"token","style":{"color":"#a04900"},"children":["=="]}],["$","span","code-segement323",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement324",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement325",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement326",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement327",{"className":"$undefined","style":{},"children":["                "]}],["$","span","code-segement328",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement329",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement330",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\"    "]}],["$","span","code-segement331",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement332",{"className":"token string-interpolation interpolation","style":{},"children":["batch_index"]}],["$","span","code-segement333",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement334",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[" / "]}],["$","span","code-segement335",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement336",{"className":"token string-interpolation interpolation","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement337",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement338",{"className":"token string-interpolation interpolation","style":{},"children":["data_loaders"]}],["$","span","code-segement339",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement340",{"className":"token string-interpolation interpolation","style":{"color":"#116b00"},"children":["'train'"]}],["$","span","code-segement341",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement342",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement343",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement344",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["\""]}],["$","span","code-segement345",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement346",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement348",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement349",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement350",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement351",{"className":"token","style":{"color":"#7c00aa"},"children":["test"]}],["$","span","code-segement352",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement353",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement354",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement355",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement356",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement357",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement358",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement359",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement360",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement361",{"className":"token","style":{"color":"#af00af"},"children":["eval"]}],["$","span","code-segement362",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement363",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement364",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement366",{"className":"$undefined","style":{},"children":["        sum_test_loss "]}],["$","span","code-segement367",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement368",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement369",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement370",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement371",{"className":"$undefined","style":{},"children":["        num_correct "]}],["$","span","code-segement372",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement373",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement374",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement375",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement377",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement378",{"className":"token","style":{"color":"#a04900"},"children":["with"]}],["$","span","code-segement379",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement380",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement381",{"className":"$undefined","style":{},"children":["no_grad"]}],["$","span","code-segement382",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement383",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement384",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement385",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement386",{"className":"$undefined","style":{},"children":["            "]}],["$","span","code-segement387",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement388",{"className":"$undefined","style":{},"children":[" data"]}],["$","span","code-segement389",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement390",{"className":"$undefined","style":{},"children":[" target "]}],["$","span","code-segement391",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement392",{"className":"$undefined","style":{},"children":[" data_loaders"]}],["$","span","code-segement393",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement394",{"className":"token","style":{"color":"#116b00"},"children":["\"test\""]}],["$","span","code-segement395",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement396",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement397",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement398",{"className":"$undefined","style":{},"children":["                data "]}],["$","span","code-segement399",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement400",{"className":"$undefined","style":{},"children":[" data"]}],["$","span","code-segement401",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement402",{"className":"$undefined","style":{},"children":["to"]}],["$","span","code-segement403",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement404",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement405",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement406",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement407",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement408",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement409",{"className":"$undefined","style":{},"children":["                target "]}],["$","span","code-segement410",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement411",{"className":"$undefined","style":{},"children":[" target"]}],["$","span","code-segement412",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement413",{"className":"$undefined","style":{},"children":["to"]}],["$","span","code-segement414",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement415",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement416",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement417",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement418",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement419",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement421",{"className":"$undefined","style":{},"children":["                output "]}],["$","span","code-segement422",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement423",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement424",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement425",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement426",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement427",{"className":"$undefined","style":{},"children":["data"]}],["$","span","code-segement428",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement429",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement431",{"className":"$undefined","style":{},"children":["                sum_test_loss "]}],["$","span","code-segement432",{"className":"token","style":{"color":"#a04900"},"children":["+="]}],["$","span","code-segement433",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement434",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement435",{"className":"$undefined","style":{},"children":["loss_fn"]}],["$","span","code-segement436",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement437",{"className":"$undefined","style":{},"children":["output"]}],["$","span","code-segement438",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement439",{"className":"$undefined","style":{},"children":[" target"]}],["$","span","code-segement440",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement441",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement442",{"className":"$undefined","style":{},"children":["item"]}],["$","span","code-segement443",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement444",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement445",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement447",{"className":"$undefined","style":{},"children":["                prediction "]}],["$","span","code-segement448",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement449",{"className":"$undefined","style":{},"children":[" output"]}],["$","span","code-segement450",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement451",{"className":"$undefined","style":{},"children":["argmax"]}],["$","span","code-segement452",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement453",{"className":"$undefined","style":{},"children":["dim"]}],["$","span","code-segement454",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement455",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement456",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement457",{"className":"$undefined","style":{},"children":[" keepdim"]}],["$","span","code-segement458",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement459",{"className":"token","style":{"color":"#755f00"},"children":["True"]}],["$","span","code-segement460",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement461",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement463",{"className":"$undefined","style":{},"children":["                num_correct "]}],["$","span","code-segement464",{"className":"token","style":{"color":"#a04900"},"children":["+="]}],["$","span","code-segement465",{"className":"$undefined","style":{},"children":[" prediction"]}],["$","span","code-segement466",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement467",{"className":"$undefined","style":{},"children":["eq"]}],["$","span","code-segement468",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement469",{"className":"$undefined","style":{},"children":["target"]}],["$","span","code-segement470",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement471",{"className":"$undefined","style":{},"children":["view_as"]}],["$","span","code-segement472",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement473",{"className":"$undefined","style":{},"children":["prediction"]}],["$","span","code-segement474",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement475",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement476",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement477",{"className":"token","style":{"color":"#af00af"},"children":["sum"]}],["$","span","code-segement478",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement479",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement480",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement481",{"className":"$undefined","style":{},"children":["item"]}],["$","span","code-segement482",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement483",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement484",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement486",{"className":"$undefined","style":{},"children":["        average_test_loss "]}],["$","span","code-segement487",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement488",{"className":"$undefined","style":{},"children":[" sum_test_loss "]}],["$","span","code-segement489",{"className":"token","style":{"color":"#a04900"},"children":["/"]}],["$","span","code-segement490",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement491",{"className":"token","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement492",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement493",{"className":"$undefined","style":{},"children":["data_loaders"]}],["$","span","code-segement494",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement495",{"className":"token","style":{"color":"#116b00"},"children":["'test'"]}],["$","span","code-segement496",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement497",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement498",{"className":"$undefined","style":{},"children":["dataset"]}],["$","span","code-segement499",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement500",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement501",{"className":"$undefined","style":{},"children":["        accuracy "]}],["$","span","code-segement502",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement503",{"className":"$undefined","style":{},"children":[" num_correct "]}],["$","span","code-segement504",{"className":"token","style":{"color":"#a04900"},"children":["/"]}],["$","span","code-segement505",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement506",{"className":"token","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement507",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement508",{"className":"$undefined","style":{},"children":["data_loaders"]}],["$","span","code-segement509",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement510",{"className":"token","style":{"color":"#116b00"},"children":["'test'"]}],["$","span","code-segement511",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement512",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement513",{"className":"$undefined","style":{},"children":["dataset"]}],["$","span","code-segement514",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement515",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement517",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement518",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement519",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement520",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\"    Average loss: "]}],["$","span","code-segement521",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement522",{"className":"token string-interpolation interpolation","style":{},"children":["average_test_loss"]}],["$","span","code-segement523",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement524",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["\""]}],["$","span","code-segement525",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement526",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement527",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement528",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement529",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement530",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\"    Accuracy: "]}],["$","span","code-segement531",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement532",{"className":"token string-interpolation interpolation","style":{},"children":["accuracy"]}],["$","span","code-segement533",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement534",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["\""]}],["$","span","code-segement535",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement536",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement538",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement539",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement540",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement541",{"className":"token","style":{"color":"#7c00aa"},"children":["save_weights"]}],["$","span","code-segement542",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement543",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement544",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement545",{"className":"$undefined","style":{},"children":[" file_path"]}],["$","span","code-segement546",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement547",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement548",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement549",{"className":"$undefined","style":{},"children":["        torch"]}],["$","span","code-segement550",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement551",{"className":"$undefined","style":{},"children":["save"]}],["$","span","code-segement552",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement553",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement554",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement555",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement556",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement557",{"className":"$undefined","style":{},"children":["state_dict"]}],["$","span","code-segement558",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement559",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement560",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement561",{"className":"$undefined","style":{},"children":[" file_path"]}],["$","span","code-segement562",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement563",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement565",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement566",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement567",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement568",{"className":"token","style":{"color":"#7c00aa"},"children":["train"]}],["$","span","code-segement569",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement570",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement571",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement572",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement573",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement574",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement575",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement576",{"className":"$undefined","style":{},"children":[" epoch_index "]}],["$","span","code-segement577",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement578",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement579",{"className":"token","style":{"color":"#af00af"},"children":["range"]}],["$","span","code-segement580",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement581",{"className":"$undefined","style":{},"children":["config"]}],["$","span","code-segement582",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement583",{"className":"token","style":{"color":"#116b00"},"children":["'training_num_epochs'"]}],["$","span","code-segement584",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement585",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement586",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement587",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement588",{"className":"$undefined","style":{},"children":["            "]}],["$","span","code-segement589",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement590",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement591",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\"Epoch: "]}],["$","span","code-segement592",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement593",{"className":"token string-interpolation interpolation","style":{},"children":["epoch_index"]}],["$","span","code-segement594",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement595",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["\""]}],["$","span","code-segement596",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement597",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement598",{"className":"$undefined","style":{},"children":["            self"]}],["$","span","code-segement599",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement600",{"className":"$undefined","style":{},"children":["train_single_epoch"]}],["$","span","code-segement601",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement602",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement603",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement605",{"className":"$undefined","style":{},"children":["            model_save_file_path "]}],["$","span","code-segement606",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement607",{"className":"$undefined","style":{},"children":[" join"]}],["$","span","code-segement608",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement609",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement610",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement611",{"className":"$undefined","style":{},"children":["models_dir"]}],["$","span","code-segement612",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement613",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement614",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\"epoch-"]}],["$","span","code-segement615",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement616",{"className":"token string-interpolation interpolation","style":{},"children":["epoch_index"]}],["$","span","code-segement617",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement618",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[".pt\""]}],["$","span","code-segement619",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement620",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement621",{"className":"$undefined","style":{},"children":["            self"]}],["$","span","code-segement622",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement623",{"className":"$undefined","style":{},"children":["save_weights"]}],["$","span","code-segement624",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement625",{"className":"$undefined","style":{},"children":["model_save_file_path"]}],["$","span","code-segement626",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement627",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement629",{"className":"$undefined","style":{},"children":["            self"]}],["$","span","code-segement630",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement631",{"className":"$undefined","style":{},"children":["test"]}],["$","span","code-segement632",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement633",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement634",{"className":"$undefined","style":{},"children":["\n"]}],"\n","\n",["$","span","code-segement637",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement638",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement639",{"className":"$undefined","style":{},"children":[" __name__ "]}],["$","span","code-segement640",{"className":"token","style":{"color":"#a04900"},"children":["=="]}],["$","span","code-segement641",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement642",{"className":"token","style":{"color":"#116b00"},"children":["\"__main__\""]}],["$","span","code-segement643",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement644",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement645",{"className":"$undefined","style":{},"children":["    model_trainer "]}],["$","span","code-segement646",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement647",{"className":"$undefined","style":{},"children":[" ModelTrainer"]}],["$","span","code-segement648",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement649",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement650",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement651",{"className":"$undefined","style":{},"children":["    model_trainer"]}],["$","span","code-segement652",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement653",{"className":"$undefined","style":{},"children":["train"]}],["$","span","code-segement654",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement655",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Lc","36",{"id":"testing","variant":"h5","component":"h2","mb":2,"children":["$","strong",null,{"children":"Testing"}]}],["$","$Lc","37",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Still inside the ",["$","$La","37-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"src"}]," folder, we create another file called ",["$","$La","37-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"test.py"}],". Let's import the required packages and load our model."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"from json import load as json_load\nfrom os import listdir\nfrom os.path import join as path_join\n\nimport cv2\nimport torch\nfrom torchvision import transforms\n\nfrom .config import data_dir, models_dir\nfrom .dataset import data_loaders\nfrom .model import CNN\n\n\n# MODEL_WEIGHTS_FILE_PATH = path_join(models_dir, \"training_id\", \"epoch-epoch_numbe\")\nMODEL_WEIGHTS_FILE_PATH = path_join(models_dir, \"torch---2024-04-23-08-25-15\", \"epoch-9.pt\")\n\n\nif __name__ == \"__main__\":\n    device = torch.device(\"cuda\" if torch.cuda.is_available() else \"cpu\")\n\n    model = CNN()\n    model = model.to(device)\n\n    model.load_state_dict(torch.load(MODEL_WEIGHTS_FILE_PATH, map_location=device))\n\n    model.eval()"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" json "]}],["$","span","code-segement2",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":[" load "]}],["$","span","code-segement4",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement5",{"className":"$undefined","style":{},"children":[" json_load\n"]}],["$","span","code-segement6",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement7",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":[" os "]}],["$","span","code-segement9",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":[" listdir\n"]}],["$","span","code-segement11",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement12",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement13",{"className":"$undefined","style":{},"children":[" os"]}],["$","span","code-segement14",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":["path "]}],["$","span","code-segement16",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement17",{"className":"$undefined","style":{},"children":[" join "]}],["$","span","code-segement18",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement19",{"className":"$undefined","style":{},"children":[" path_join\n"]}],"\n",["$","span","code-segement21",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement22",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement23",{"className":"$undefined","style":{},"children":[" cv2\n"]}],["$","span","code-segement24",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement25",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":[" torch\n"]}],["$","span","code-segement27",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement28",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement29",{"className":"$undefined","style":{},"children":[" torchvision "]}],["$","span","code-segement30",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement31",{"className":"$undefined","style":{},"children":[" transforms\n"]}],"\n",["$","span","code-segement33",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement34",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement35",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement36",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement37",{"className":"$undefined","style":{},"children":["config "]}],["$","span","code-segement38",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement39",{"className":"$undefined","style":{},"children":[" data_dir"]}],["$","span","code-segement40",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement41",{"className":"$undefined","style":{},"children":[" models_dir\n"]}],["$","span","code-segement42",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement43",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement44",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement45",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement46",{"className":"$undefined","style":{},"children":["dataset "]}],["$","span","code-segement47",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement48",{"className":"$undefined","style":{},"children":[" data_loaders\n"]}],["$","span","code-segement49",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement50",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement51",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement52",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement53",{"className":"$undefined","style":{},"children":["model "]}],["$","span","code-segement54",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement55",{"className":"$undefined","style":{},"children":[" CNN\n"]}],"\n","\n",["$","span","code-segement58",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement59",{"className":"token","style":{"color":"#3c526d"},"children":["# MODEL_WEIGHTS_FILE_PATH = path_join(models_dir, \"training_id\", \"epoch-epoch_numbe\")"]}],["$","span","code-segement60",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement61",{"className":"$undefined","style":{},"children":["MODEL_WEIGHTS_FILE_PATH "]}],["$","span","code-segement62",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement63",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement64",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement65",{"className":"$undefined","style":{},"children":["models_dir"]}],["$","span","code-segement66",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement67",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement68",{"className":"token","style":{"color":"#116b00"},"children":["\"torch---2024-04-23-08-25-15\""]}],["$","span","code-segement69",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement70",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement71",{"className":"token","style":{"color":"#116b00"},"children":["\"epoch-9.pt\""]}],["$","span","code-segement72",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement73",{"className":"$undefined","style":{},"children":["\n"]}],"\n","\n",["$","span","code-segement76",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement77",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement78",{"className":"$undefined","style":{},"children":[" __name__ "]}],["$","span","code-segement79",{"className":"token","style":{"color":"#a04900"},"children":["=="]}],["$","span","code-segement80",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement81",{"className":"token","style":{"color":"#116b00"},"children":["\"__main__\""]}],["$","span","code-segement82",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement83",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement84",{"className":"$undefined","style":{},"children":["    device "]}],["$","span","code-segement85",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement86",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement87",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement88",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement89",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement90",{"className":"token","style":{"color":"#116b00"},"children":["\"cuda\""]}],["$","span","code-segement91",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement92",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement93",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement94",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement95",{"className":"$undefined","style":{},"children":["cuda"]}],["$","span","code-segement96",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement97",{"className":"$undefined","style":{},"children":["is_available"]}],["$","span","code-segement98",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement99",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement100",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement101",{"className":"token","style":{"color":"#a04900"},"children":["else"]}],["$","span","code-segement102",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement103",{"className":"token","style":{"color":"#116b00"},"children":["\"cpu\""]}],["$","span","code-segement104",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement105",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement107",{"className":"$undefined","style":{},"children":["    model "]}],["$","span","code-segement108",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement109",{"className":"$undefined","style":{},"children":[" CNN"]}],["$","span","code-segement110",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement111",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement112",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement113",{"className":"$undefined","style":{},"children":["    model "]}],["$","span","code-segement114",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement115",{"className":"$undefined","style":{},"children":[" model"]}],["$","span","code-segement116",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement117",{"className":"$undefined","style":{},"children":["to"]}],["$","span","code-segement118",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement119",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement120",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement121",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement123",{"className":"$undefined","style":{},"children":["    model"]}],["$","span","code-segement124",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement125",{"className":"$undefined","style":{},"children":["load_state_dict"]}],["$","span","code-segement126",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement127",{"className":"$undefined","style":{},"children":["torch"]}],["$","span","code-segement128",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement129",{"className":"$undefined","style":{},"children":["load"]}],["$","span","code-segement130",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement131",{"className":"$undefined","style":{},"children":["MODEL_WEIGHTS_FILE_PATH"]}],["$","span","code-segement132",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement133",{"className":"$undefined","style":{},"children":[" map_location"]}],["$","span","code-segement134",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement135",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement136",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement137",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement138",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement140",{"className":"$undefined","style":{},"children":["    model"]}],["$","span","code-segement141",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement142",{"className":"token","style":{"color":"#af00af"},"children":["eval"]}],["$","span","code-segement143",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement144",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Lc","39",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","We'll first test on data from our test data loader and then on some custom images."]}],["$","$Lc","40",{"id":"testing-on-mnist-test-data","variant":"h6","component":"h3","mb":2,"children":["$","strong",null,{"children":"Testing on MNIST Test Data"}]}],["$","$Lc","41",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","This would be similar to the ",["$","$La","41-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"ModelTrainer.test"}]," function defined in the ",["$","$La","41-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"train.py"}]," file."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"print(\"Testing on MNIST Test Set\")\n\nnum_correct = 0\nwith torch.no_grad():\n    for data, target in data_loaders[\"test\"]:\n        data = data.to(device)\n        target = target.to(device)\n\n        output = model(data)\n\n        prediction = output.argmax(dim=1, keepdim=True)\n\n        num_correct += prediction.eq(target.view_as(prediction)).sum().item()\n\naccuracy = num_correct / len(data_loaders['test'].dataset)\nprint(f\"    Accuracy: {accuracy}\")\nprint()"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement1",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement2",{"className":"token","style":{"color":"#116b00"},"children":["\"Testing on MNIST Test Set\""]}],["$","span","code-segement3",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement6",{"className":"$undefined","style":{},"children":["num_correct "]}],["$","span","code-segement7",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement9",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement11",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement12",{"className":"token","style":{"color":"#a04900"},"children":["with"]}],["$","span","code-segement13",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement14",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":["no_grad"]}],["$","span","code-segement16",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement17",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement18",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement19",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement20",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement21",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement22",{"className":"$undefined","style":{},"children":[" data"]}],["$","span","code-segement23",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement24",{"className":"$undefined","style":{},"children":[" target "]}],["$","span","code-segement25",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":[" data_loaders"]}],["$","span","code-segement27",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement28",{"className":"token","style":{"color":"#116b00"},"children":["\"test\""]}],["$","span","code-segement29",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement30",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement31",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement32",{"className":"$undefined","style":{},"children":["        data "]}],["$","span","code-segement33",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement34",{"className":"$undefined","style":{},"children":[" data"]}],["$","span","code-segement35",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement36",{"className":"$undefined","style":{},"children":["to"]}],["$","span","code-segement37",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement38",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement39",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement40",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement41",{"className":"$undefined","style":{},"children":["        target "]}],["$","span","code-segement42",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement43",{"className":"$undefined","style":{},"children":[" target"]}],["$","span","code-segement44",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement45",{"className":"$undefined","style":{},"children":["to"]}],["$","span","code-segement46",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement47",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement48",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement49",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement51",{"className":"$undefined","style":{},"children":["        output "]}],["$","span","code-segement52",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement53",{"className":"$undefined","style":{},"children":[" model"]}],["$","span","code-segement54",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement55",{"className":"$undefined","style":{},"children":["data"]}],["$","span","code-segement56",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement57",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement59",{"className":"$undefined","style":{},"children":["        prediction "]}],["$","span","code-segement60",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement61",{"className":"$undefined","style":{},"children":[" output"]}],["$","span","code-segement62",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement63",{"className":"$undefined","style":{},"children":["argmax"]}],["$","span","code-segement64",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement65",{"className":"$undefined","style":{},"children":["dim"]}],["$","span","code-segement66",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement67",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement68",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement69",{"className":"$undefined","style":{},"children":[" keepdim"]}],["$","span","code-segement70",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement71",{"className":"token","style":{"color":"#755f00"},"children":["True"]}],["$","span","code-segement72",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement73",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement75",{"className":"$undefined","style":{},"children":["        num_correct "]}],["$","span","code-segement76",{"className":"token","style":{"color":"#a04900"},"children":["+="]}],["$","span","code-segement77",{"className":"$undefined","style":{},"children":[" prediction"]}],["$","span","code-segement78",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement79",{"className":"$undefined","style":{},"children":["eq"]}],["$","span","code-segement80",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement81",{"className":"$undefined","style":{},"children":["target"]}],["$","span","code-segement82",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement83",{"className":"$undefined","style":{},"children":["view_as"]}],["$","span","code-segement84",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement85",{"className":"$undefined","style":{},"children":["prediction"]}],["$","span","code-segement86",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement87",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement88",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement89",{"className":"token","style":{"color":"#af00af"},"children":["sum"]}],["$","span","code-segement90",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement91",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement92",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement93",{"className":"$undefined","style":{},"children":["item"]}],["$","span","code-segement94",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement95",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement96",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement98",{"className":"$undefined","style":{},"children":["accuracy "]}],["$","span","code-segement99",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement100",{"className":"$undefined","style":{},"children":[" num_correct "]}],["$","span","code-segement101",{"className":"token","style":{"color":"#a04900"},"children":["/"]}],["$","span","code-segement102",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement103",{"className":"token","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement104",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement105",{"className":"$undefined","style":{},"children":["data_loaders"]}],["$","span","code-segement106",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement107",{"className":"token","style":{"color":"#116b00"},"children":["'test'"]}],["$","span","code-segement108",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement109",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement110",{"className":"$undefined","style":{},"children":["dataset"]}],["$","span","code-segement111",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement112",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement113",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement114",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement115",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement116",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\"    Accuracy: "]}],["$","span","code-segement117",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement118",{"className":"token string-interpolation interpolation","style":{},"children":["accuracy"]}],["$","span","code-segement119",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement120",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["\""]}],["$","span","code-segement121",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement122",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement123",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement124",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement125",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement126",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Lc","43",{"id":"testing-on-custom-images","variant":"h6","component":"h3","mb":2,"children":["$","strong",null,{"children":"Testing on Custom Images"}]}],["$","$Lc","44",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Inside our ",["$","$La","44-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"data"}]," directory, I have created another folder called ",["$","$La","44-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"test_images"}]," containing some 28x28 pngs with a black background and digits drawn in white. I also have a file called ",["$","$La","44-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"test_images_labels.json"}]," that contains labels for each of the images. Here is the labels file."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"{\n    \"1.png\": 1,\n    \"2.png\": 7,\n    \"3.png\": 2,\n    \"4.png\": 9,\n    \"5.png\": 8,\n    \"6.png\": 5,\n    \"7.png\": 1,\n    \"8.png\": 7,\n    \"9.png\": 1,\n    \"10.png\": 7,\n    \"11.png\": 7,\n    \"12.png\": 0,\n    \"13.png\": 5,\n    \"14.png\": 3,\n    \"15.png\": 2,\n    \"16.png\": 1,\n    \"17.png\": 0,\n    \"18.png\": 8,\n    \"19.png\": 7,\n    \"20.png\": 4\n}"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-json","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement2",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement3",{"className":"token","style":{"color":"#005a8e"},"children":["\"1.png\""]}],["$","span","code-segement4",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement5",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement6",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement7",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement9",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement10",{"className":"token","style":{"color":"#005a8e"},"children":["\"2.png\""]}],["$","span","code-segement11",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement12",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement13",{"className":"token","style":{"color":"#755f00"},"children":["7"]}],["$","span","code-segement14",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement16",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement17",{"className":"token","style":{"color":"#005a8e"},"children":["\"3.png\""]}],["$","span","code-segement18",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement19",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement20",{"className":"token","style":{"color":"#755f00"},"children":["2"]}],["$","span","code-segement21",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement22",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement23",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement24",{"className":"token","style":{"color":"#005a8e"},"children":["\"4.png\""]}],["$","span","code-segement25",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement27",{"className":"token","style":{"color":"#755f00"},"children":["9"]}],["$","span","code-segement28",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement29",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement30",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement31",{"className":"token","style":{"color":"#005a8e"},"children":["\"5.png\""]}],["$","span","code-segement32",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement33",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement34",{"className":"token","style":{"color":"#755f00"},"children":["8"]}],["$","span","code-segement35",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement36",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement37",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement38",{"className":"token","style":{"color":"#005a8e"},"children":["\"6.png\""]}],["$","span","code-segement39",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement40",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement41",{"className":"token","style":{"color":"#755f00"},"children":["5"]}],["$","span","code-segement42",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement43",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement44",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement45",{"className":"token","style":{"color":"#005a8e"},"children":["\"7.png\""]}],["$","span","code-segement46",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement47",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement48",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement49",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement50",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement51",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement52",{"className":"token","style":{"color":"#005a8e"},"children":["\"8.png\""]}],["$","span","code-segement53",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement54",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement55",{"className":"token","style":{"color":"#755f00"},"children":["7"]}],["$","span","code-segement56",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement57",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement58",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement59",{"className":"token","style":{"color":"#005a8e"},"children":["\"9.png\""]}],["$","span","code-segement60",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement61",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement62",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement63",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement64",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement65",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement66",{"className":"token","style":{"color":"#005a8e"},"children":["\"10.png\""]}],["$","span","code-segement67",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement68",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement69",{"className":"token","style":{"color":"#755f00"},"children":["7"]}],["$","span","code-segement70",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement71",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement72",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement73",{"className":"token","style":{"color":"#005a8e"},"children":["\"11.png\""]}],["$","span","code-segement74",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement75",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement76",{"className":"token","style":{"color":"#755f00"},"children":["7"]}],["$","span","code-segement77",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement78",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement79",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement80",{"className":"token","style":{"color":"#005a8e"},"children":["\"12.png\""]}],["$","span","code-segement81",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement82",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement83",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement84",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement85",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement86",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement87",{"className":"token","style":{"color":"#005a8e"},"children":["\"13.png\""]}],["$","span","code-segement88",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement89",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement90",{"className":"token","style":{"color":"#755f00"},"children":["5"]}],["$","span","code-segement91",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement92",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement93",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement94",{"className":"token","style":{"color":"#005a8e"},"children":["\"14.png\""]}],["$","span","code-segement95",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement96",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement97",{"className":"token","style":{"color":"#755f00"},"children":["3"]}],["$","span","code-segement98",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement99",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement100",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement101",{"className":"token","style":{"color":"#005a8e"},"children":["\"15.png\""]}],["$","span","code-segement102",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement103",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement104",{"className":"token","style":{"color":"#755f00"},"children":["2"]}],["$","span","code-segement105",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement106",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement107",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement108",{"className":"token","style":{"color":"#005a8e"},"children":["\"16.png\""]}],["$","span","code-segement109",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement110",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement111",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement112",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement113",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement114",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement115",{"className":"token","style":{"color":"#005a8e"},"children":["\"17.png\""]}],["$","span","code-segement116",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement117",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement118",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement119",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement120",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement121",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement122",{"className":"token","style":{"color":"#005a8e"},"children":["\"18.png\""]}],["$","span","code-segement123",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement124",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement125",{"className":"token","style":{"color":"#755f00"},"children":["8"]}],["$","span","code-segement126",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement127",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement128",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement129",{"className":"token","style":{"color":"#005a8e"},"children":["\"19.png\""]}],["$","span","code-segement130",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement131",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement132",{"className":"token","style":{"color":"#755f00"},"children":["7"]}],["$","span","code-segement133",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement134",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement135",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement136",{"className":"token","style":{"color":"#005a8e"},"children":["\"20.png\""]}],["$","span","code-segement137",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement138",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement139",{"className":"token","style":{"color":"#755f00"},"children":["4"]}],["$","span","code-segement140",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement141",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement142",{"className":"token","style":{"color":"#111b27"},"children":["}"]}]]]}]}]]}],["$","$Lc","46",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","We want to preprocess our testing images exactly in the same way we preprocessed our training data, so we define a set of transforms for the same."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"preprocessing_transforms = transforms.Compose([\n    transforms.ToTensor(),\n])"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"$undefined","style":{},"children":["preprocessing_transforms "]}],["$","span","code-segement1",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement2",{"className":"$undefined","style":{},"children":[" transforms"]}],["$","span","code-segement3",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":["Compose"]}],["$","span","code-segement5",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement6",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement7",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":["    transforms"]}],["$","span","code-segement9",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":["ToTensor"]}],["$","span","code-segement11",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement12",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement13",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement14",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement16",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement17",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Lc","48",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","We can now load the images, get predictions on them, and calculate the accuracy."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"$1a"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"$undefined","style":{},"children":["test_images_dir "]}],["$","span","code-segement1",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement2",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement3",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":["data_dir"]}],["$","span","code-segement5",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement6",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement7",{"className":"token","style":{"color":"#116b00"},"children":["\"test_images\""]}],["$","span","code-segement8",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement9",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement11",{"className":"$undefined","style":{},"children":["test_images_labels_file_path "]}],["$","span","code-segement12",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement13",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement14",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":["data_dir"]}],["$","span","code-segement16",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement17",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement18",{"className":"token","style":{"color":"#116b00"},"children":["\"test_images_labels.json\""]}],["$","span","code-segement19",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement20",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement21",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement22",{"className":"token","style":{"color":"#a04900"},"children":["with"]}],["$","span","code-segement23",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement24",{"className":"token","style":{"color":"#af00af"},"children":["open"]}],["$","span","code-segement25",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":["test_images_labels_file_path"]}],["$","span","code-segement27",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement28",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement29",{"className":"token","style":{"color":"#116b00"},"children":["'r'"]}],["$","span","code-segement30",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement31",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement32",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement33",{"className":"$undefined","style":{},"children":[" test_images_labels_file"]}],["$","span","code-segement34",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement35",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement36",{"className":"$undefined","style":{},"children":["    test_images_labels "]}],["$","span","code-segement37",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement38",{"className":"$undefined","style":{},"children":[" json_load"]}],["$","span","code-segement39",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement40",{"className":"$undefined","style":{},"children":["test_images_labels_file"]}],["$","span","code-segement41",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement42",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement44",{"className":"$undefined","style":{},"children":["test_images "]}],["$","span","code-segement45",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement46",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement47",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement48",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement49",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement50",{"className":"$undefined","style":{},"children":["test_labels "]}],["$","span","code-segement51",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement52",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement53",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement54",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement55",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement56",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement57",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement58",{"className":"$undefined","style":{},"children":[" image_name "]}],["$","span","code-segement59",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement60",{"className":"$undefined","style":{},"children":[" listdir"]}],["$","span","code-segement61",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement62",{"className":"$undefined","style":{},"children":["test_images_dir"]}],["$","span","code-segement63",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement64",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement65",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement66",{"className":"$undefined","style":{},"children":["    image_path "]}],["$","span","code-segement67",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement68",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement69",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement70",{"className":"$undefined","style":{},"children":["test_images_dir"]}],["$","span","code-segement71",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement72",{"className":"$undefined","style":{},"children":[" image_name"]}],["$","span","code-segement73",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement74",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement75",{"className":"$undefined","style":{},"children":["    image "]}],["$","span","code-segement76",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement77",{"className":"$undefined","style":{},"children":[" cv2"]}],["$","span","code-segement78",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement79",{"className":"$undefined","style":{},"children":["imread"]}],["$","span","code-segement80",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement81",{"className":"$undefined","style":{},"children":["image_path"]}],["$","span","code-segement82",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement83",{"className":"$undefined","style":{},"children":[" cv2"]}],["$","span","code-segement84",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement85",{"className":"$undefined","style":{},"children":["IMREAD_GRAYSCALE"]}],["$","span","code-segement86",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement87",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement88",{"className":"$undefined","style":{},"children":["    test_images"]}],["$","span","code-segement89",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement90",{"className":"$undefined","style":{},"children":["append"]}],["$","span","code-segement91",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement92",{"className":"$undefined","style":{},"children":["image"]}],["$","span","code-segement93",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement94",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement96",{"className":"$undefined","style":{},"children":["    test_labels"]}],["$","span","code-segement97",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement98",{"className":"$undefined","style":{},"children":["append"]}],["$","span","code-segement99",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement100",{"className":"$undefined","style":{},"children":["test_images_labels"]}],["$","span","code-segement101",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement102",{"className":"$undefined","style":{},"children":["image_name"]}],["$","span","code-segement103",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement104",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement105",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement107",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement108",{"className":"token","style":{"color":"#3c526d"},"children":["# Preprocess"]}],["$","span","code-segement109",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement110",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement111",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement112",{"className":"$undefined","style":{},"children":[" i "]}],["$","span","code-segement113",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement114",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement115",{"className":"token","style":{"color":"#af00af"},"children":["range"]}],["$","span","code-segement116",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement117",{"className":"token","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement118",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement119",{"className":"$undefined","style":{},"children":["test_images"]}],["$","span","code-segement120",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement121",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement122",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement123",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement124",{"className":"$undefined","style":{},"children":["    test_images"]}],["$","span","code-segement125",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement126",{"className":"$undefined","style":{},"children":["i"]}],["$","span","code-segement127",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement128",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement129",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement130",{"className":"$undefined","style":{},"children":[" preprocessing_transforms"]}],["$","span","code-segement131",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement132",{"className":"$undefined","style":{},"children":["test_images"]}],["$","span","code-segement133",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement134",{"className":"$undefined","style":{},"children":["i"]}],["$","span","code-segement135",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement136",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement137",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement138",{"className":"$undefined","style":{},"children":["    test_images"]}],["$","span","code-segement139",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement140",{"className":"$undefined","style":{},"children":["i"]}],["$","span","code-segement141",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement142",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement143",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement144",{"className":"$undefined","style":{},"children":[" test_images"]}],["$","span","code-segement145",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement146",{"className":"$undefined","style":{},"children":["i"]}],["$","span","code-segement147",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement148",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement149",{"className":"$undefined","style":{},"children":["unsqueeze"]}],["$","span","code-segement150",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement151",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement152",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement153",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement155",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement156",{"className":"token","style":{"color":"#3c526d"},"children":["# Predict"]}],["$","span","code-segement157",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement158",{"className":"$undefined","style":{},"children":["num_correct "]}],["$","span","code-segement159",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement160",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement161",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement162",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement163",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement164",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement165",{"className":"$undefined","style":{},"children":[" preprocessed_image"]}],["$","span","code-segement166",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement167",{"className":"$undefined","style":{},"children":[" label "]}],["$","span","code-segement168",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement169",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement170",{"className":"token","style":{"color":"#af00af"},"children":["zip"]}],["$","span","code-segement171",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement172",{"className":"$undefined","style":{},"children":["test_images"]}],["$","span","code-segement173",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement174",{"className":"$undefined","style":{},"children":[" test_labels"]}],["$","span","code-segement175",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement176",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement177",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement178",{"className":"$undefined","style":{},"children":["    output "]}],["$","span","code-segement179",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement180",{"className":"$undefined","style":{},"children":[" model"]}],["$","span","code-segement181",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement182",{"className":"$undefined","style":{},"children":["preprocessed_image"]}],["$","span","code-segement183",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement184",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement185",{"className":"$undefined","style":{},"children":["    prediction "]}],["$","span","code-segement186",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement187",{"className":"$undefined","style":{},"children":[" output"]}],["$","span","code-segement188",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement189",{"className":"$undefined","style":{},"children":["argmax"]}],["$","span","code-segement190",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement191",{"className":"$undefined","style":{},"children":["dim"]}],["$","span","code-segement192",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement193",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement194",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement195",{"className":"$undefined","style":{},"children":[" keepdim"]}],["$","span","code-segement196",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement197",{"className":"token","style":{"color":"#755f00"},"children":["True"]}],["$","span","code-segement198",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement199",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement200",{"className":"$undefined","style":{},"children":["    prediction "]}],["$","span","code-segement201",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement202",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement203",{"className":"token","style":{"color":"#af00af"},"children":["int"]}],["$","span","code-segement204",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement205",{"className":"$undefined","style":{},"children":["prediction"]}],["$","span","code-segement206",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement207",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement209",{"className":"$undefined","style":{},"children":["    num_correct "]}],["$","span","code-segement210",{"className":"token","style":{"color":"#a04900"},"children":["+="]}],["$","span","code-segement211",{"className":"$undefined","style":{},"children":[" prediction "]}],["$","span","code-segement212",{"className":"token","style":{"color":"#a04900"},"children":["=="]}],["$","span","code-segement213",{"className":"$undefined","style":{},"children":[" label\n"]}],"\n",["$","span","code-segement215",{"className":"$undefined","style":{},"children":["accuracy "]}],["$","span","code-segement216",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement217",{"className":"$undefined","style":{},"children":[" num_correct "]}],["$","span","code-segement218",{"className":"token","style":{"color":"#a04900"},"children":["/"]}],["$","span","code-segement219",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement220",{"className":"token","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement221",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement222",{"className":"$undefined","style":{},"children":["test_images"]}],["$","span","code-segement223",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement224",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement225",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement226",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement227",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement228",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\"Correct: "]}],["$","span","code-segement229",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement230",{"className":"token string-interpolation interpolation","style":{},"children":["num_correct"]}],["$","span","code-segement231",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement232",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[" / "]}],["$","span","code-segement233",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement234",{"className":"token string-interpolation interpolation","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement235",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement236",{"className":"token string-interpolation interpolation","style":{},"children":["test_images"]}],["$","span","code-segement237",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement238",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement239",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[", Accuracy: "]}],["$","span","code-segement240",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement241",{"className":"token string-interpolation interpolation","style":{},"children":["accuracy"]}],["$","span","code-segement242",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement243",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["\""]}],["$","span","code-segement244",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Lc","50",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Here's the entire ",["$","$La","50-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"src/test.py"}]," file."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"$1b"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" json "]}],["$","span","code-segement2",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":[" load "]}],["$","span","code-segement4",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement5",{"className":"$undefined","style":{},"children":[" json_load\n"]}],["$","span","code-segement6",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement7",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":[" os "]}],["$","span","code-segement9",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":[" listdir\n"]}],["$","span","code-segement11",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement12",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement13",{"className":"$undefined","style":{},"children":[" os"]}],["$","span","code-segement14",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":["path "]}],["$","span","code-segement16",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement17",{"className":"$undefined","style":{},"children":[" join "]}],["$","span","code-segement18",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement19",{"className":"$undefined","style":{},"children":[" path_join\n"]}],"\n",["$","span","code-segement21",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement22",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement23",{"className":"$undefined","style":{},"children":[" cv2\n"]}],["$","span","code-segement24",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement25",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":[" torch\n"]}],["$","span","code-segement27",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement28",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement29",{"className":"$undefined","style":{},"children":[" torchvision "]}],["$","span","code-segement30",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement31",{"className":"$undefined","style":{},"children":[" transforms\n"]}],"\n",["$","span","code-segement33",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement34",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement35",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement36",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement37",{"className":"$undefined","style":{},"children":["config "]}],["$","span","code-segement38",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement39",{"className":"$undefined","style":{},"children":[" data_dir"]}],["$","span","code-segement40",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement41",{"className":"$undefined","style":{},"children":[" models_dir\n"]}],["$","span","code-segement42",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement43",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement44",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement45",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement46",{"className":"$undefined","style":{},"children":["dataset "]}],["$","span","code-segement47",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement48",{"className":"$undefined","style":{},"children":[" data_loaders\n"]}],["$","span","code-segement49",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement50",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement51",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement52",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement53",{"className":"$undefined","style":{},"children":["model "]}],["$","span","code-segement54",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement55",{"className":"$undefined","style":{},"children":[" CNN\n"]}],"\n","\n",["$","span","code-segement58",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement59",{"className":"token","style":{"color":"#3c526d"},"children":["# MODEL_WEIGHTS_FILE_PATH = path_join(models_dir, \"training_id\", \"epoch-epoch_numbe\")"]}],["$","span","code-segement60",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement61",{"className":"$undefined","style":{},"children":["MODEL_WEIGHTS_FILE_PATH "]}],["$","span","code-segement62",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement63",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement64",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement65",{"className":"$undefined","style":{},"children":["models_dir"]}],["$","span","code-segement66",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement67",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement68",{"className":"token","style":{"color":"#116b00"},"children":["\"torch---2024-04-23-08-25-15\""]}],["$","span","code-segement69",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement70",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement71",{"className":"token","style":{"color":"#116b00"},"children":["\"epoch-9.pt\""]}],["$","span","code-segement72",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement73",{"className":"$undefined","style":{},"children":["\n"]}],"\n","\n",["$","span","code-segement76",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement77",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement78",{"className":"$undefined","style":{},"children":[" __name__ "]}],["$","span","code-segement79",{"className":"token","style":{"color":"#a04900"},"children":["=="]}],["$","span","code-segement80",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement81",{"className":"token","style":{"color":"#116b00"},"children":["\"__main__\""]}],["$","span","code-segement82",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement83",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement84",{"className":"$undefined","style":{},"children":["    device "]}],["$","span","code-segement85",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement86",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement87",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement88",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement89",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement90",{"className":"token","style":{"color":"#116b00"},"children":["\"cuda\""]}],["$","span","code-segement91",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement92",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement93",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement94",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement95",{"className":"$undefined","style":{},"children":["cuda"]}],["$","span","code-segement96",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement97",{"className":"$undefined","style":{},"children":["is_available"]}],["$","span","code-segement98",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement99",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement100",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement101",{"className":"token","style":{"color":"#a04900"},"children":["else"]}],["$","span","code-segement102",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement103",{"className":"token","style":{"color":"#116b00"},"children":["\"cpu\""]}],["$","span","code-segement104",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement105",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement107",{"className":"$undefined","style":{},"children":["    model "]}],["$","span","code-segement108",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement109",{"className":"$undefined","style":{},"children":[" CNN"]}],["$","span","code-segement110",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement111",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement112",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement113",{"className":"$undefined","style":{},"children":["    model "]}],["$","span","code-segement114",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement115",{"className":"$undefined","style":{},"children":[" model"]}],["$","span","code-segement116",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement117",{"className":"$undefined","style":{},"children":["to"]}],["$","span","code-segement118",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement119",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement120",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement121",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement123",{"className":"$undefined","style":{},"children":["    model"]}],["$","span","code-segement124",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement125",{"className":"$undefined","style":{},"children":["load_state_dict"]}],["$","span","code-segement126",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement127",{"className":"$undefined","style":{},"children":["torch"]}],["$","span","code-segement128",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement129",{"className":"$undefined","style":{},"children":["load"]}],["$","span","code-segement130",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement131",{"className":"$undefined","style":{},"children":["MODEL_WEIGHTS_FILE_PATH"]}],["$","span","code-segement132",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement133",{"className":"$undefined","style":{},"children":[" map_location"]}],["$","span","code-segement134",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement135",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement136",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement137",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement138",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement140",{"className":"$undefined","style":{},"children":["    model"]}],["$","span","code-segement141",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement142",{"className":"token","style":{"color":"#af00af"},"children":["eval"]}],["$","span","code-segement143",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement144",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement145",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement147",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement148",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement149",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement150",{"className":"token","style":{"color":"#116b00"},"children":["\"Testing on MNIST Test Set\""]}],["$","span","code-segement151",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement152",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement154",{"className":"$undefined","style":{},"children":["    num_correct "]}],["$","span","code-segement155",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement156",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement157",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement158",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement159",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement160",{"className":"token","style":{"color":"#a04900"},"children":["with"]}],["$","span","code-segement161",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement162",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement163",{"className":"$undefined","style":{},"children":["no_grad"]}],["$","span","code-segement164",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement165",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement166",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement167",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement168",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement169",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement170",{"className":"$undefined","style":{},"children":[" data"]}],["$","span","code-segement171",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement172",{"className":"$undefined","style":{},"children":[" target "]}],["$","span","code-segement173",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement174",{"className":"$undefined","style":{},"children":[" data_loaders"]}],["$","span","code-segement175",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement176",{"className":"token","style":{"color":"#116b00"},"children":["\"test\""]}],["$","span","code-segement177",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement178",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement179",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement180",{"className":"$undefined","style":{},"children":["            data "]}],["$","span","code-segement181",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement182",{"className":"$undefined","style":{},"children":[" data"]}],["$","span","code-segement183",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement184",{"className":"$undefined","style":{},"children":["to"]}],["$","span","code-segement185",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement186",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement187",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement188",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement189",{"className":"$undefined","style":{},"children":["            target "]}],["$","span","code-segement190",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement191",{"className":"$undefined","style":{},"children":[" target"]}],["$","span","code-segement192",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement193",{"className":"$undefined","style":{},"children":["to"]}],["$","span","code-segement194",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement195",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement196",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement197",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement199",{"className":"$undefined","style":{},"children":["            output "]}],["$","span","code-segement200",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement201",{"className":"$undefined","style":{},"children":[" model"]}],["$","span","code-segement202",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement203",{"className":"$undefined","style":{},"children":["data"]}],["$","span","code-segement204",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement205",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement207",{"className":"$undefined","style":{},"children":["            prediction "]}],["$","span","code-segement208",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement209",{"className":"$undefined","style":{},"children":[" output"]}],["$","span","code-segement210",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement211",{"className":"$undefined","style":{},"children":["argmax"]}],["$","span","code-segement212",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement213",{"className":"$undefined","style":{},"children":["dim"]}],["$","span","code-segement214",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement215",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement216",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement217",{"className":"$undefined","style":{},"children":[" keepdim"]}],["$","span","code-segement218",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement219",{"className":"token","style":{"color":"#755f00"},"children":["True"]}],["$","span","code-segement220",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement221",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement223",{"className":"$undefined","style":{},"children":["            num_correct "]}],["$","span","code-segement224",{"className":"token","style":{"color":"#a04900"},"children":["+="]}],["$","span","code-segement225",{"className":"$undefined","style":{},"children":[" prediction"]}],["$","span","code-segement226",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement227",{"className":"$undefined","style":{},"children":["eq"]}],["$","span","code-segement228",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement229",{"className":"$undefined","style":{},"children":["target"]}],["$","span","code-segement230",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement231",{"className":"$undefined","style":{},"children":["view_as"]}],["$","span","code-segement232",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement233",{"className":"$undefined","style":{},"children":["prediction"]}],["$","span","code-segement234",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement235",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement236",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement237",{"className":"token","style":{"color":"#af00af"},"children":["sum"]}],["$","span","code-segement238",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement239",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement240",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement241",{"className":"$undefined","style":{},"children":["item"]}],["$","span","code-segement242",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement243",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement244",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement246",{"className":"$undefined","style":{},"children":["    accuracy "]}],["$","span","code-segement247",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement248",{"className":"$undefined","style":{},"children":[" num_correct "]}],["$","span","code-segement249",{"className":"token","style":{"color":"#a04900"},"children":["/"]}],["$","span","code-segement250",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement251",{"className":"token","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement252",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement253",{"className":"$undefined","style":{},"children":["data_loaders"]}],["$","span","code-segement254",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement255",{"className":"token","style":{"color":"#116b00"},"children":["'test'"]}],["$","span","code-segement256",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement257",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement258",{"className":"$undefined","style":{},"children":["dataset"]}],["$","span","code-segement259",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement260",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement261",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement262",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement263",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement264",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\"    Accuracy: "]}],["$","span","code-segement265",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement266",{"className":"token string-interpolation interpolation","style":{},"children":["accuracy"]}],["$","span","code-segement267",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement268",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["\""]}],["$","span","code-segement269",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement270",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement271",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement272",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement273",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement274",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement275",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement277",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement278",{"className":"token","style":{"color":"#3c526d"},"children":["### Test on Custom Images"]}],["$","span","code-segement279",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement280",{"className":"$undefined","style":{},"children":["    preprocessing_transforms "]}],["$","span","code-segement281",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement282",{"className":"$undefined","style":{},"children":[" transforms"]}],["$","span","code-segement283",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement284",{"className":"$undefined","style":{},"children":["Compose"]}],["$","span","code-segement285",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement286",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement287",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement288",{"className":"$undefined","style":{},"children":["        transforms"]}],["$","span","code-segement289",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement290",{"className":"$undefined","style":{},"children":["ToTensor"]}],["$","span","code-segement291",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement292",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement293",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement294",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement295",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement296",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement297",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement298",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement300",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement301",{"className":"token","style":{"color":"#3c526d"},"children":["# Load Images"]}],["$","span","code-segement302",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement303",{"className":"$undefined","style":{},"children":["    test_images_dir "]}],["$","span","code-segement304",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement305",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement306",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement307",{"className":"$undefined","style":{},"children":["data_dir"]}],["$","span","code-segement308",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement309",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement310",{"className":"token","style":{"color":"#116b00"},"children":["\"test_images\""]}],["$","span","code-segement311",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement312",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement314",{"className":"$undefined","style":{},"children":["    test_images_labels_file_path "]}],["$","span","code-segement315",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement316",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement317",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement318",{"className":"$undefined","style":{},"children":["data_dir"]}],["$","span","code-segement319",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement320",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement321",{"className":"token","style":{"color":"#116b00"},"children":["\"test_images_labels.json\""]}],["$","span","code-segement322",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement323",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement324",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement325",{"className":"token","style":{"color":"#a04900"},"children":["with"]}],["$","span","code-segement326",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement327",{"className":"token","style":{"color":"#af00af"},"children":["open"]}],["$","span","code-segement328",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement329",{"className":"$undefined","style":{},"children":["test_images_labels_file_path"]}],["$","span","code-segement330",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement331",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement332",{"className":"token","style":{"color":"#116b00"},"children":["'r'"]}],["$","span","code-segement333",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement334",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement335",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement336",{"className":"$undefined","style":{},"children":[" test_images_labels_file"]}],["$","span","code-segement337",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement338",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement339",{"className":"$undefined","style":{},"children":["        test_images_labels "]}],["$","span","code-segement340",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement341",{"className":"$undefined","style":{},"children":[" json_load"]}],["$","span","code-segement342",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement343",{"className":"$undefined","style":{},"children":["test_images_labels_file"]}],["$","span","code-segement344",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement345",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement347",{"className":"$undefined","style":{},"children":["    test_images "]}],["$","span","code-segement348",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement349",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement350",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement351",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement352",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement353",{"className":"$undefined","style":{},"children":["    test_labels "]}],["$","span","code-segement354",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement355",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement356",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement357",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement358",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement359",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement360",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement361",{"className":"$undefined","style":{},"children":[" image_name "]}],["$","span","code-segement362",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement363",{"className":"$undefined","style":{},"children":[" listdir"]}],["$","span","code-segement364",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement365",{"className":"$undefined","style":{},"children":["test_images_dir"]}],["$","span","code-segement366",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement367",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement368",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement369",{"className":"$undefined","style":{},"children":["        image_path "]}],["$","span","code-segement370",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement371",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement372",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement373",{"className":"$undefined","style":{},"children":["test_images_dir"]}],["$","span","code-segement374",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement375",{"className":"$undefined","style":{},"children":[" image_name"]}],["$","span","code-segement376",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement377",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement378",{"className":"$undefined","style":{},"children":["        image "]}],["$","span","code-segement379",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement380",{"className":"$undefined","style":{},"children":[" cv2"]}],["$","span","code-segement381",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement382",{"className":"$undefined","style":{},"children":["imread"]}],["$","span","code-segement383",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement384",{"className":"$undefined","style":{},"children":["image_path"]}],["$","span","code-segement385",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement386",{"className":"$undefined","style":{},"children":[" cv2"]}],["$","span","code-segement387",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement388",{"className":"$undefined","style":{},"children":["IMREAD_GRAYSCALE"]}],["$","span","code-segement389",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement390",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement391",{"className":"$undefined","style":{},"children":["        test_images"]}],["$","span","code-segement392",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement393",{"className":"$undefined","style":{},"children":["append"]}],["$","span","code-segement394",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement395",{"className":"$undefined","style":{},"children":["image"]}],["$","span","code-segement396",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement397",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement399",{"className":"$undefined","style":{},"children":["        test_labels"]}],["$","span","code-segement400",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement401",{"className":"$undefined","style":{},"children":["append"]}],["$","span","code-segement402",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement403",{"className":"$undefined","style":{},"children":["test_images_labels"]}],["$","span","code-segement404",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement405",{"className":"$undefined","style":{},"children":["image_name"]}],["$","span","code-segement406",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement407",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement408",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement410",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement411",{"className":"token","style":{"color":"#3c526d"},"children":["# Preprocess"]}],["$","span","code-segement412",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement413",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement414",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement415",{"className":"$undefined","style":{},"children":[" i "]}],["$","span","code-segement416",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement417",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement418",{"className":"token","style":{"color":"#af00af"},"children":["range"]}],["$","span","code-segement419",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement420",{"className":"token","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement421",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement422",{"className":"$undefined","style":{},"children":["test_images"]}],["$","span","code-segement423",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement424",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement425",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement426",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement427",{"className":"$undefined","style":{},"children":["        test_images"]}],["$","span","code-segement428",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement429",{"className":"$undefined","style":{},"children":["i"]}],["$","span","code-segement430",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement431",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement432",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement433",{"className":"$undefined","style":{},"children":[" preprocessing_transforms"]}],["$","span","code-segement434",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement435",{"className":"$undefined","style":{},"children":["test_images"]}],["$","span","code-segement436",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement437",{"className":"$undefined","style":{},"children":["i"]}],["$","span","code-segement438",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement439",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement440",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement441",{"className":"$undefined","style":{},"children":["        test_images"]}],["$","span","code-segement442",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement443",{"className":"$undefined","style":{},"children":["i"]}],["$","span","code-segement444",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement445",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement446",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement447",{"className":"$undefined","style":{},"children":[" test_images"]}],["$","span","code-segement448",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement449",{"className":"$undefined","style":{},"children":["i"]}],["$","span","code-segement450",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement451",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement452",{"className":"$undefined","style":{},"children":["unsqueeze"]}],["$","span","code-segement453",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement454",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement455",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement456",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement458",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement459",{"className":"token","style":{"color":"#3c526d"},"children":["# Predict"]}],["$","span","code-segement460",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement461",{"className":"$undefined","style":{},"children":["    num_correct "]}],["$","span","code-segement462",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement463",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement464",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement465",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement466",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement467",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement468",{"className":"$undefined","style":{},"children":[" preprocessed_image"]}],["$","span","code-segement469",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement470",{"className":"$undefined","style":{},"children":[" label "]}],["$","span","code-segement471",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement472",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement473",{"className":"token","style":{"color":"#af00af"},"children":["zip"]}],["$","span","code-segement474",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement475",{"className":"$undefined","style":{},"children":["test_images"]}],["$","span","code-segement476",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement477",{"className":"$undefined","style":{},"children":[" test_labels"]}],["$","span","code-segement478",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement479",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement480",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement481",{"className":"$undefined","style":{},"children":["        output "]}],["$","span","code-segement482",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement483",{"className":"$undefined","style":{},"children":[" model"]}],["$","span","code-segement484",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement485",{"className":"$undefined","style":{},"children":["preprocessed_image"]}],["$","span","code-segement486",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement487",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement488",{"className":"$undefined","style":{},"children":["        prediction "]}],["$","span","code-segement489",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement490",{"className":"$undefined","style":{},"children":[" output"]}],["$","span","code-segement491",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement492",{"className":"$undefined","style":{},"children":["argmax"]}],["$","span","code-segement493",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement494",{"className":"$undefined","style":{},"children":["dim"]}],["$","span","code-segement495",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement496",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement497",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement498",{"className":"$undefined","style":{},"children":[" keepdim"]}],["$","span","code-segement499",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement500",{"className":"token","style":{"color":"#755f00"},"children":["True"]}],["$","span","code-segement501",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement502",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement503",{"className":"$undefined","style":{},"children":["        prediction "]}],["$","span","code-segement504",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement505",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement506",{"className":"token","style":{"color":"#af00af"},"children":["int"]}],["$","span","code-segement507",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement508",{"className":"$undefined","style":{},"children":["prediction"]}],["$","span","code-segement509",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement510",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement512",{"className":"$undefined","style":{},"children":["        num_correct "]}],["$","span","code-segement513",{"className":"token","style":{"color":"#a04900"},"children":["+="]}],["$","span","code-segement514",{"className":"$undefined","style":{},"children":[" prediction "]}],["$","span","code-segement515",{"className":"token","style":{"color":"#a04900"},"children":["=="]}],["$","span","code-segement516",{"className":"$undefined","style":{},"children":[" label\n"]}],"\n",["$","span","code-segement518",{"className":"$undefined","style":{},"children":["    accuracy "]}],["$","span","code-segement519",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement520",{"className":"$undefined","style":{},"children":[" num_correct "]}],["$","span","code-segement521",{"className":"token","style":{"color":"#a04900"},"children":["/"]}],["$","span","code-segement522",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement523",{"className":"token","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement524",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement525",{"className":"$undefined","style":{},"children":["test_images"]}],["$","span","code-segement526",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement527",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement528",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement529",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement530",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement531",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\"Correct: "]}],["$","span","code-segement532",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement533",{"className":"token string-interpolation interpolation","style":{},"children":["num_correct"]}],["$","span","code-segement534",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement535",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[" / "]}],["$","span","code-segement536",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement537",{"className":"token string-interpolation interpolation","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement538",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement539",{"className":"token string-interpolation interpolation","style":{},"children":["test_images"]}],["$","span","code-segement540",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement541",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement542",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[", Accuracy: "]}],["$","span","code-segement543",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement544",{"className":"token string-interpolation interpolation","style":{},"children":["accuracy"]}],["$","span","code-segement545",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement546",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["\""]}],["$","span","code-segement547",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Lc","52",{"id":"conversion-to-onnx","variant":"h5","component":"h2","mb":2,"children":["$","strong",null,{"children":"Conversion to ONNX"}]}],["$","$Lc","53",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Inside the ",["$","$La","53-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"src"}]," folder, create another folder called ",["$","$La","53-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"converters"}]," and in it create a file called ",["$","$La","53-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"converter_onnx.py"}],"."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"from os.path import dirname, join as path_join\n\nimport torch\n\nfrom ..config import models_dir\nfrom ..dataset import data_loaders\nfrom ..model import CNN\n\n\n# MODEL_WEIGHTS_FILE_PATH = path_join(models_dir, \"training_id\", \"epoch-epoch_numbe\")\nMODEL_WEIGHTS_FILE_PATH = path_join(models_dir, \"torch---2024-04-23-08-25-15\", \"epoch-9.pt\")\nONNX_MODEL_FILE_PATH = path_join(dirname(MODEL_WEIGHTS_FILE_PATH), \"model.onnx\")\n\n\nif __name__ == \"__main__\":\n    device = torch.device(\"cpu\")\n\n    torch_model = CNN()\n    torch_model = torch_model.to(device)\n\n    torch_model.load_state_dict(torch.load(MODEL_WEIGHTS_FILE_PATH, map_location=device))\n\n    torch_model.eval()\n\n    for data, target in data_loaders[\"test\"]:\n        data = data.to(device)\n        target = target.to(device)\n        break\n\n    sample_input = data[0].unsqueeze(0)\n\n    onnx_model = torch.onnx.dynamo_export(\n        torch_model,\n        sample_input\n    )\n\n    onnx_model.save(ONNX_MODEL_FILE_PATH)"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" os"]}],["$","span","code-segement2",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":["path "]}],["$","span","code-segement4",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement5",{"className":"$undefined","style":{},"children":[" dirname"]}],["$","span","code-segement6",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement7",{"className":"$undefined","style":{},"children":[" join "]}],["$","span","code-segement8",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement9",{"className":"$undefined","style":{},"children":[" path_join\n"]}],"\n",["$","span","code-segement11",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement12",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement13",{"className":"$undefined","style":{},"children":[" torch\n"]}],"\n",["$","span","code-segement15",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement16",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement17",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement18",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement19",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement20",{"className":"$undefined","style":{},"children":["config "]}],["$","span","code-segement21",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement22",{"className":"$undefined","style":{},"children":[" models_dir\n"]}],["$","span","code-segement23",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement24",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement25",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement26",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement27",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement28",{"className":"$undefined","style":{},"children":["dataset "]}],["$","span","code-segement29",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement30",{"className":"$undefined","style":{},"children":[" data_loaders\n"]}],["$","span","code-segement31",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement32",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement33",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement34",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement35",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement36",{"className":"$undefined","style":{},"children":["model "]}],["$","span","code-segement37",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement38",{"className":"$undefined","style":{},"children":[" CNN\n"]}],"\n","\n",["$","span","code-segement41",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement42",{"className":"token","style":{"color":"#3c526d"},"children":["# MODEL_WEIGHTS_FILE_PATH = path_join(models_dir, \"training_id\", \"epoch-epoch_numbe\")"]}],["$","span","code-segement43",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement44",{"className":"$undefined","style":{},"children":["MODEL_WEIGHTS_FILE_PATH "]}],["$","span","code-segement45",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement46",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement47",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement48",{"className":"$undefined","style":{},"children":["models_dir"]}],["$","span","code-segement49",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement50",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement51",{"className":"token","style":{"color":"#116b00"},"children":["\"torch---2024-04-23-08-25-15\""]}],["$","span","code-segement52",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement53",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement54",{"className":"token","style":{"color":"#116b00"},"children":["\"epoch-9.pt\""]}],["$","span","code-segement55",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement56",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement57",{"className":"$undefined","style":{},"children":["ONNX_MODEL_FILE_PATH "]}],["$","span","code-segement58",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement59",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement60",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement61",{"className":"$undefined","style":{},"children":["dirname"]}],["$","span","code-segement62",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement63",{"className":"$undefined","style":{},"children":["MODEL_WEIGHTS_FILE_PATH"]}],["$","span","code-segement64",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement65",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement66",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement67",{"className":"token","style":{"color":"#116b00"},"children":["\"model.onnx\""]}],["$","span","code-segement68",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement69",{"className":"$undefined","style":{},"children":["\n"]}],"\n","\n",["$","span","code-segement72",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement73",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement74",{"className":"$undefined","style":{},"children":[" __name__ "]}],["$","span","code-segement75",{"className":"token","style":{"color":"#a04900"},"children":["=="]}],["$","span","code-segement76",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement77",{"className":"token","style":{"color":"#116b00"},"children":["\"__main__\""]}],["$","span","code-segement78",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement79",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement80",{"className":"$undefined","style":{},"children":["    device "]}],["$","span","code-segement81",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement82",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement83",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement84",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement85",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement86",{"className":"token","style":{"color":"#116b00"},"children":["\"cpu\""]}],["$","span","code-segement87",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement88",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement90",{"className":"$undefined","style":{},"children":["    torch_model "]}],["$","span","code-segement91",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement92",{"className":"$undefined","style":{},"children":[" CNN"]}],["$","span","code-segement93",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement94",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement95",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement96",{"className":"$undefined","style":{},"children":["    torch_model "]}],["$","span","code-segement97",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement98",{"className":"$undefined","style":{},"children":[" torch_model"]}],["$","span","code-segement99",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement100",{"className":"$undefined","style":{},"children":["to"]}],["$","span","code-segement101",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement102",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement103",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement104",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement106",{"className":"$undefined","style":{},"children":["    torch_model"]}],["$","span","code-segement107",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement108",{"className":"$undefined","style":{},"children":["load_state_dict"]}],["$","span","code-segement109",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement110",{"className":"$undefined","style":{},"children":["torch"]}],["$","span","code-segement111",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement112",{"className":"$undefined","style":{},"children":["load"]}],["$","span","code-segement113",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement114",{"className":"$undefined","style":{},"children":["MODEL_WEIGHTS_FILE_PATH"]}],["$","span","code-segement115",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement116",{"className":"$undefined","style":{},"children":[" map_location"]}],["$","span","code-segement117",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement118",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement119",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement120",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement121",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement123",{"className":"$undefined","style":{},"children":["    torch_model"]}],["$","span","code-segement124",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement125",{"className":"token","style":{"color":"#af00af"},"children":["eval"]}],["$","span","code-segement126",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement127",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement128",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement130",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement131",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement132",{"className":"$undefined","style":{},"children":[" data"]}],["$","span","code-segement133",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement134",{"className":"$undefined","style":{},"children":[" target "]}],["$","span","code-segement135",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement136",{"className":"$undefined","style":{},"children":[" data_loaders"]}],["$","span","code-segement137",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement138",{"className":"token","style":{"color":"#116b00"},"children":["\"test\""]}],["$","span","code-segement139",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement140",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement141",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement142",{"className":"$undefined","style":{},"children":["        data "]}],["$","span","code-segement143",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement144",{"className":"$undefined","style":{},"children":[" data"]}],["$","span","code-segement145",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement146",{"className":"$undefined","style":{},"children":["to"]}],["$","span","code-segement147",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement148",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement149",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement150",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement151",{"className":"$undefined","style":{},"children":["        target "]}],["$","span","code-segement152",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement153",{"className":"$undefined","style":{},"children":[" target"]}],["$","span","code-segement154",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement155",{"className":"$undefined","style":{},"children":["to"]}],["$","span","code-segement156",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement157",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement158",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement159",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement160",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement161",{"className":"token","style":{"color":"#a04900"},"children":["break"]}],["$","span","code-segement162",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement164",{"className":"$undefined","style":{},"children":["    sample_input "]}],["$","span","code-segement165",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement166",{"className":"$undefined","style":{},"children":[" data"]}],["$","span","code-segement167",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement168",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement169",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement170",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement171",{"className":"$undefined","style":{},"children":["unsqueeze"]}],["$","span","code-segement172",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement173",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement174",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement175",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement177",{"className":"$undefined","style":{},"children":["    onnx_model "]}],["$","span","code-segement178",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement179",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement180",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement181",{"className":"$undefined","style":{},"children":["onnx"]}],["$","span","code-segement182",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement183",{"className":"$undefined","style":{},"children":["dynamo_export"]}],["$","span","code-segement184",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement185",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement186",{"className":"$undefined","style":{},"children":["        torch_model"]}],["$","span","code-segement187",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement188",{"className":"$undefined","style":{},"children":["\n"]}],"        sample_input\n",["$","span","code-segement190",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement191",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement192",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement194",{"className":"$undefined","style":{},"children":["    onnx_model"]}],["$","span","code-segement195",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement196",{"className":"$undefined","style":{},"children":["save"]}],["$","span","code-segement197",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement198",{"className":"$undefined","style":{},"children":["ONNX_MODEL_FILE_PATH"]}],["$","span","code-segement199",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Lc","55",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","We load our model similar to how we load it in the ",["$","$La","55-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"test.py"}]," file, and convert it to ONNX using ",["$","$L17","55-link",{"href":"https://pytorch.org/tutorials/beginner/onnx/export_simple_model_to_onnx_tutorial.html","rel":"noopener noreferrer","target":"_blank","color":"primary","underline":"hover","children":"torch.onnx.dynamo_export"}]," and save it in the same directory as our torch model."]}],["$","$Lc","56",{"id":"conclusion","variant":"h4","component":"h1","mb":2,"children":["$","strong",null,{"children":"Conclusion"}]}],["$","$Lc","57",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","In this small Post, we have trained a Convolutional Neural Network on the MNIST dataset, tested it on custom images, and exported the model to ONNX. It's nothing fancy but we'll use this model in some of our following tutorials where we build a website in which the user can draw digits and get the model's prediction on the image."]}],["$","$Lc","58",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","See you next time :)"]}]]}]}]]}]}],"$L1c"]}]
1d:I[3713,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],"default"]
12:["$","$La",null,{"sx":{"width":"100%","display":"flex","flexDirection":"row","justifyContent":"space-between","alignItems":"center"},"children":[["$","$Lc",null,{"variant":"p","component":"p","mr":2,"children":"By: Abhilaksh Singh Reen"}],["$","$L1d",null,{"socialMediaProfiles":[{"network_name":"LinkedIn","profile_url":"https://www.linkedin.com/in/abhilaksh-singh-837901210/","profile_display_name":"Abhilaksh Singh Reen"},{"network_name":"Twitter","profile_url":"https://x.com/TheVeteran06","profile_display_name":"The Veteran 06"},{"network_name":"GitHub","profile_url":"https://github.com/AbhilakshSinghReen","profile_display_name":"Abhilaksh Singh Reen"}]}]]}]
1e:I[6652,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],""]
1f:I[6981,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],""]
20:I[2818,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],""]
1c:["$","$La",null,{"mt":5,"mb":5,"pb":2,"sx":{"width":"100%","display":"flex","flexDirection":"column","justifyContent":"flex-start","alignItems":"center"},"children":["$","$L11",null,{"container":true,"spacing":2,"mt":4,"mb":4,"children":[["$","$L11","/ml-ops/tensorflow-training-plus-conversion-to-onnx-and-tfjs",{"item":true,"xs":12,"sm":6,"md":4,"lg":3,"children":["$","$Ld",null,{"href":"/ml-ops/tensorflow-training-plus-conversion-to-onnx-and-tfjs","passHref":true,"style":{"textDecoration":"none"},"children":["$","$L1e",null,{"sx":{"width":"100%","height":"100%","boxShadow":"1px 1px 1px 1px \"#eeeeee\"","&:hover":{"boxShadow":"3px 3px 3px 3px \"#eeeeee\"","cursor":"pointer"}},"children":[["$","$L1f",null,{"component":"img","height":"150","image":"/media/images/tensorflow-training-plus-conversion-to-onnx-and-tfjs-thumbnail.jpg","alt":"Training a CNN in TensorFlow and Exporting it to ONNX and TFJS","sx":{"objectFit":"cover"}}],["$","$L20",null,{"children":[["$","$Lc",null,{"gutterBottom":true,"variant":"h6","component":"h2","children":[""," ","Training a CNN in TensorFlow and Exporting it to ONNX and TFJS"]}],["$","$Lc",null,{"gutterBottom":true,"variant":"p","component":"p","sx":{"overflow":"hidden","textOverflow":"ellipsis","display":"-webkit-box","WebkitLineClamp":"3","WebkitBoxOrient":"vertical"},"children":"Learn how to train a simple CNN in TensorFlow and how to convert it to ONNX or TensorFlow.js for deployment."}],["$","$La",null,{"sx":{"width":"100%","display":"flex","flexDirection":"row","justifyContent":"flex-end","alignItems":"center"},"children":["$","$Lc",null,{"gutterBottom":true,"variant":"p","component":"p","children":"05m Read"}]}],false]}]]}]}]}]]}]}]
