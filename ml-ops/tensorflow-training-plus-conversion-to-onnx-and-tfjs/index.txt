3:I[9275,[],""]
6:I[1343,[],""]
7:I[6871,["98","static/chunks/98-7f6363f9ac68c942.js","748","static/chunks/748-1f14ee6eb3d7029a.js","271","static/chunks/271-37a22bace913f735.js","185","static/chunks/app/layout-08611f287dda1230.js"],"default"]
8:I[5877,["98","static/chunks/98-7f6363f9ac68c942.js","748","static/chunks/748-1f14ee6eb3d7029a.js","271","static/chunks/271-37a22bace913f735.js","185","static/chunks/app/layout-08611f287dda1230.js"],"default"]
9:I[902,["98","static/chunks/98-7f6363f9ac68c942.js","748","static/chunks/748-1f14ee6eb3d7029a.js","271","static/chunks/271-37a22bace913f735.js","185","static/chunks/app/layout-08611f287dda1230.js"],""]
a:I[5218,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],""]
b:I[2324,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],"default"]
c:I[2591,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],""]
d:I[231,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],""]
e:I[3180,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],""]
f:I[3245,["98","static/chunks/98-7f6363f9ac68c942.js","748","static/chunks/748-1f14ee6eb3d7029a.js","271","static/chunks/271-37a22bace913f735.js","185","static/chunks/app/layout-08611f287dda1230.js"],"default"]
4:["categorySlug","ml-ops","d"]
5:["postOrSeriesSlug","tensorflow-training-plus-conversion-to-onnx-and-tfjs","d"]
0:["VvaX91qL0y6klITKNgfgL",[[["",{"children":[["categorySlug","ml-ops","d"],{"children":[["postOrSeriesSlug","tensorflow-training-plus-conversion-to-onnx-and-tfjs","d"],{"children":["__PAGE__?{\"categorySlug\":\"ml-ops\",\"postOrSeriesSlug\":\"tensorflow-training-plus-conversion-to-onnx-and-tfjs\"}",{}]}]}]},"$undefined","$undefined",true],["",{"children":[["categorySlug","ml-ops","d"],{"children":[["postOrSeriesSlug","tensorflow-training-plus-conversion-to-onnx-and-tfjs","d"],{"children":["__PAGE__",{},[["$L1","$L2"],null],null]},["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","$4","children","$5","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}],null]},["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","$4","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}],null]},[["$","html",null,{"lang":"en","suppressHydrationWarning":true,"children":["$","body",null,{"className":"__className_d65c78","children":["$","$L7",null,{"children":[["$","$L8",null,{}],["$","$L9",null,{"maxWidth":"lg","children":[["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":["$","$La",null,{"children":[["$","$Lb",null,{"render":false,"targetSiteNavigationState":[],"targetPageNavigationState":[]}],["$","$Lc",null,{"variant":"h4","children":["$","strong",null,{"children":"Not Found"}]}],["$","$Lc",null,{"variant":"h6","mb":3,"children":"Oops! It looks like the page you're looking for does not exist."}],["$","$Ld",null,{"href":"/","children":["$","$Le",null,{"variant":"contained","sx":{"marginRight":5,"marginBottom":1},"children":"Take me Home"}]}]]}],"notFoundStyles":[],"styles":null}],["$","$Lf",null,{}]]}]]}]}]}],null],null],[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/1d4d01086947be98.css","precedence":"next","crossOrigin":"$undefined"}]],"$L10"]]]]
10:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","1",{"charSet":"utf-8"}],["$","link","2",{"rel":"icon","href":"/favicon.ico","type":"image/x-icon","sizes":"16x16"}]]
1:null
11:I[3507,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],""]
13:I[4204,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],"default"]
14:I[1847,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],"default"]
15:I[8125,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],""]
16:I[3578,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],"default"]
17:I[7005,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],""]
18:I[6480,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],"default"]
19:T773,from json import load as json_load
from os import listdir
from os.path import join as path_join

import cv2
import numpy as np

from .config import models_dir, data_dir
from .dataset import data_loaders
from .model import CNN

from tensorflow.keras.utils import normalize


MODEL_WEIGHTS_FILE_PATH = path_join(models_dir, "training_id", "epoch-epoch_number")


if __name__ == "__main__":
    model = CNN()
    model.load_weights(MODEL_WEIGHTS_FILE_PATH)

    ### Test on MNIST Test Data
    x_test, y_test = data_loaders['test']
    loss, accuracy = model.evaluate(x_test, y_test)

    print("Testing on MNIST Test Set")
    print(f"Loss: {loss}, Accuracy: {accuracy}")
    print()

    ### Test on Custom Images
    # Load Images
    test_images_dir = path_join(data_dir, "test_images")

    test_images_labels_file_path = path_join(data_dir, "test_images_labels.json")
    with open(test_images_labels_file_path, 'r') as test_images_labels_file:
        test_images_labels = json_load(test_images_labels_file)

    test_images = []
    test_labels = []
    for image_name in listdir(test_images_dir):
        image_path = path_join(test_images_dir, image_name)
        image = cv2.imread(image_path, cv2.IMREAD_GRAYSCALE)
        test_images.append(image)

        test_labels.append(test_images_labels[image_name])

    # Preprocess
    for i in range(len(test_images)):
        test_images[i] = np.array([test_images[i]])
        test_images[i] = normalize(test_images[i], axis=1)

    # Predict
    num_correct = 0
    for image, label in zip(test_images, test_labels):
        prediction = model.predict(image, verbose=None)
        predicted_label = int(np.argmax(prediction))

        # print(f"{predicted_label} : {label}")
        num_correct += predicted_label == label

    accuracy = num_correct / len(test_images)
    print(f"Correct: {num_correct} / {len(test_images)}, Accuracy: {accuracy}")2:["$","$La",null,{"mb":5,"pb":2,"sx":{"width":"100%","display":"flex","flexDirection":"column","justifyContent":"flex-start","alignItems":"flex-start"},"children":[["$","$Lb",null,{"render":true,"targetSiteNavigationState":[{"absoluteSlug":"/ml-ops","title":"ML Ops"},{"absoluteSlug":"/ml-ops/tensorflow-training-plus-conversion-to-onnx-and-tfjs","title":"Training a CNN in TensorFlow and Exporting it to ONNX and TFJS"}],"targetPageNavigationState":[{"title":"The Code","absoluteSlug":"#the-code"},{"title":"Configuration","absoluteSlug":"#configuration"},{"title":"The Dataset and Data Loaders","absoluteSlug":"#the-dataset-and-data-loaders"},{"title":"The Model","absoluteSlug":"#the-model"},{"title":"Training","absoluteSlug":"#training"},{"title":"Callbacks","absoluteSlug":"#callbacks"},{"title":"Training File","absoluteSlug":"#training-file"},{"title":"Testing","absoluteSlug":"#testing"},{"title":"Conversion to ONNX","absoluteSlug":"#conversion-to-onnx"},{"title":"Conversion to TensorFlow JS","absoluteSlug":"#conversion-to-tensorflow-js"},{"title":"Conclusion","absoluteSlug":"#conclusion"}]}],["$","$L11",null,{"container":true,"spacing":2,"mb":0,"children":[["$","$L11",null,{"item":true,"xs":12,"sm":12,"md":4,"sx":{"background":"linear-gradient(to right, #eeeeee, #ffffff)","borderRadius":5},"children":["$","$La",null,{"sx":{"width":"100%","height":"100%","display":"flex","flexDirection":"column","justifyContent":"center","alignItems":"flex-start","paddingBottom":2},"children":[["$","$Lc",null,{"gutterBottom":true,"variant":"h5","component":"h1","children":"Training a CNN in TensorFlow and Exporting it to ONNX and TFJS"}],["$","$Lc",null,{"gutterBottom":true,"variant":"p","component":"p","mb":4,"children":"Learn how to train a simple CNN in TensorFlow and how to convert it to ONNX or TensorFlow.js for deployment."}],["$","$La",null,{"sx":{"width":"100%","display":"flex","flexDirection":"row","justifyContent":"space-between","alignItems":"center","marginBottom":2},"children":[["$","$Lc",null,{"gutterBottom":true,"variant":"p","component":"p","children":"July 26, 2024"}],["$","$Lc",null,{"gutterBottom":true,"variant":"p","component":"p","children":["05m"," Read"]}]]}],"$L12",false]}]}],["$","$L11",null,{"item":true,"xs":12,"sm":12,"md":8,"children":["$","$La",null,{"sx":{"flex":1,"display":"flex","flexDirection":"column","justifyContent":"center","alignItems":"center","marginRight":2},"children":["$","img",null,{"src":"/media/images/tensorflow-training-plus-conversion-to-onnx-and-tfjs-thumbnail.jpg","style":{"width":"100%","maxWidth":"75vw","height":"auto","maxHeight":"35vh","objectFit":"cover"}}]}]}]]}],["$","$La",null,{"sx":{"width":"100%"},"children":["$","$L11",null,{"container":true,"spacing":2,"mt":4,"mb":0,"children":[["$","$L11",null,{"item":true,"xs":12,"sm":12,"md":4,"lg":3,"sx":{"background":"linear-gradient(to right, #eeeeee, #ffffff)","borderRadius":5},"children":["$","$La",null,{"sx":{"width":"100%"},"children":[["$","$La",null,{"sx":{"width":"100%","display":{"xs":"block","md":"none"},"marginBottom":2},"children":["$","$L13",null,{"sx":{"width":"100%","marginBottom":2,"boxShadow":3,"backgroundColor":"#ffffff22"},"disableGutters":true,"children":[["$","$L14",null,{"expandIcon":["$","$L15",null,{}],"children":["$","$Lc",null,{"variant":"h6","component":"h6","sx":{"margin":0,"padding":0},"children":"Table of Contents"}]}],["$","$L16",null,{"sx":{"width":"90%","display":"flex","flexDirection":"column","justifyContent":"flex-start","alignItems":"flex-start","marginBottom":2},"children":[["$","a","0",{"href":"#the-code","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","0",{"variant":"p","component":"p","ml":0,"mb":2.5,"sx":{"&:hover":{"color":"blue"}},"children":"The Code"}]}],["$","a","1",{"href":"#configuration","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","1",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"Configuration"}]}],["$","a","2",{"href":"#the-dataset-and-data-loaders","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","2",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"The Dataset and Data Loaders"}]}],["$","a","3",{"href":"#the-model","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","3",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"The Model"}]}],["$","a","4",{"href":"#training","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","4",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"Training"}]}],["$","a","5",{"href":"#callbacks","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","5",{"variant":"p","component":"p","ml":2,"mb":1.5,"sx":{"&:hover":{"color":"blue"}},"children":"Callbacks"}]}],["$","a","6",{"href":"#training-file","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","6",{"variant":"p","component":"p","ml":2,"mb":1.5,"sx":{"&:hover":{"color":"blue"}},"children":"Training File"}]}],["$","a","7",{"href":"#testing","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","7",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"Testing"}]}],["$","a","8",{"href":"#conversion-to-onnx","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","8",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"Conversion to ONNX"}]}],["$","a","9",{"href":"#conversion-to-tensorflow-js","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","9",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"Conversion to TensorFlow JS"}]}],["$","a","10",{"href":"#conclusion","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","10",{"variant":"p","component":"p","ml":0,"mb":2.5,"sx":{"&:hover":{"color":"blue"}},"children":"Conclusion"}]}]]}]]}]}],["$","$La",null,{"sx":{"width":"100%","display":{"xs":"none","md":"block"}},"children":[["$","$Lc",null,{"variant":"h5","component":"h5","sx":{"margin":0,"padding":0},"children":"Table of Contents"}],[["$","a","0",{"href":"#the-code","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","0",{"variant":"p","component":"p","ml":0,"mb":2.5,"sx":{"&:hover":{"color":"blue"}},"children":"The Code"}]}],["$","a","1",{"href":"#configuration","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","1",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"Configuration"}]}],["$","a","2",{"href":"#the-dataset-and-data-loaders","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","2",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"The Dataset and Data Loaders"}]}],["$","a","3",{"href":"#the-model","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","3",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"The Model"}]}],["$","a","4",{"href":"#training","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","4",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"Training"}]}],["$","a","5",{"href":"#callbacks","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","5",{"variant":"p","component":"p","ml":2,"mb":1.5,"sx":{"&:hover":{"color":"blue"}},"children":"Callbacks"}]}],["$","a","6",{"href":"#training-file","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","6",{"variant":"p","component":"p","ml":2,"mb":1.5,"sx":{"&:hover":{"color":"blue"}},"children":"Training File"}]}],["$","a","7",{"href":"#testing","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","7",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"Testing"}]}],["$","a","8",{"href":"#conversion-to-onnx","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","8",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"Conversion to ONNX"}]}],["$","a","9",{"href":"#conversion-to-tensorflow-js","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","9",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"Conversion to TensorFlow JS"}]}],["$","a","10",{"href":"#conclusion","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","10",{"variant":"p","component":"p","ml":0,"mb":2.5,"sx":{"&:hover":{"color":"blue"}},"children":"Conclusion"}]}]]]}]]}]}],["$","$L11",null,{"item":true,"xs":12,"sm":12,"md":8,"lg":9,"sx":{"background":"linear-gradient(to right, #ffffff, #eeeeee)","borderRadius":5},"children":["$","$La",null,{"sx":{"flex":1,"marginRight":2},"children":[["$","$Lc","0",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Today, we'll be creating a Convolutional Neural Network in TensorFlow that can classify handwritten digits. It's nothing fancy, but we'll be exporting our model to ",["$","$L17","0-link",{"href":"https://onnx.ai/","rel":"noopener noreferrer","target":"_blank","color":"primary","underline":"hover","children":"ONNX"}]," and ",["$","$L17","0-link",{"href":"https://www.tensorflow.org/js","rel":"noopener noreferrer","target":"_blank","color":"primary","underline":"hover","children":"TensorFlow.js"}]," and use it down the line in multiple other deployment tutorials."]}],["$","$Lc","1",{"id":"the-code","variant":"h4","component":"h1","mb":2,"children":["$","strong",null,{"children":"The Code"}]}],["$","$Lc","2",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","In our codebase, we'll have files for loading the data, defining the model, testing, and training (plus callbacks), configuration, and conversions to ONNX and TFJS. The directory structure of our project will look something like the following:"]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"│   config.yaml\n│   requirements.txt\n│\n├───data\n├───models\n└───src\n    │   callbacks.py\n    │   config.py\n    │   dataset.py\n    │   model.py\n    │   test.py\n    │   train.py\n    │   __init__.py\n    │\n    └───converters\n            converter_onnx.py\n            converter_tfjs.py"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-bash","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"$undefined","style":{},"children":["│   config.yaml\n"]}],"│   requirements.txt\n","│\n","├───data\n","├───models\n","└───src\n","    │   callbacks.py\n","    │   config.py\n","    │   dataset.py\n","    │   model.py\n","    │   test.py\n","    │   train.py\n","    │   __init__.py\n","    │\n","    └───converters\n","            converter_onnx.py\n","            converter_tfjs.py"]]}]}]]}],["$","$Lc","4",{"id":"configuration","variant":"h5","component":"h2","mb":2,"children":["$","strong",null,{"children":"Configuration"}]}],["$","$Lc","5",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Inside the project directory, we'll create a new file called ",["$","$La","5-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"config.yaml"}]," to store our training configuration. Right now, we'll just store the number of epochs."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"training_num_epochs: 10"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-yaml","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#005a8e"},"children":["training_num_epochs"]}],["$","span","code-segement1",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement2",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement3",{"className":"token","style":{"color":"#755f00"},"children":["10"]}]]]}]}]]}],["$","$Lc","7",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Next, we'll create a folder called ",["$","$La","7-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"src"}]," and inside it create a file called ",["$","$La","7-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"config.py"}]," that will load the YAML config into Python and also contain some directory paths that are needed during training and testing."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"from os.path import dirname, join as path_join\nfrom yaml import FullLoader as yaml_FullLoader, load as yaml_load\n\n\nconfig_file_path = path_join(dirname(dirname(__file__)), \"config.yaml\")\nwith open(config_file_path, \"r\") as model_params_file:\n    config = yaml_load(model_params_file, Loader=yaml_FullLoader)\n\nmodels_dir = path_join(dirname(dirname(__file__)), \"models\")\ndata_dir = path_join(dirname(dirname(__file__)), \"data\")"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" os"]}],["$","span","code-segement2",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":["path "]}],["$","span","code-segement4",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement5",{"className":"$undefined","style":{},"children":[" dirname"]}],["$","span","code-segement6",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement7",{"className":"$undefined","style":{},"children":[" join "]}],["$","span","code-segement8",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement9",{"className":"$undefined","style":{},"children":[" path_join\n"]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement11",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement12",{"className":"$undefined","style":{},"children":[" yaml "]}],["$","span","code-segement13",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement14",{"className":"$undefined","style":{},"children":[" FullLoader "]}],["$","span","code-segement15",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement16",{"className":"$undefined","style":{},"children":[" yaml_FullLoader"]}],["$","span","code-segement17",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement18",{"className":"$undefined","style":{},"children":[" load "]}],["$","span","code-segement19",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement20",{"className":"$undefined","style":{},"children":[" yaml_load\n"]}],"\n","\n",["$","span","code-segement23",{"className":"$undefined","style":{},"children":["config_file_path "]}],["$","span","code-segement24",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement25",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement26",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement27",{"className":"$undefined","style":{},"children":["dirname"]}],["$","span","code-segement28",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement29",{"className":"$undefined","style":{},"children":["dirname"]}],["$","span","code-segement30",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement31",{"className":"$undefined","style":{},"children":["__file__"]}],["$","span","code-segement32",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement33",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement34",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement35",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement36",{"className":"token","style":{"color":"#116b00"},"children":["\"config.yaml\""]}],["$","span","code-segement37",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement38",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement39",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement40",{"className":"token","style":{"color":"#a04900"},"children":["with"]}],["$","span","code-segement41",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement42",{"className":"token","style":{"color":"#af00af"},"children":["open"]}],["$","span","code-segement43",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement44",{"className":"$undefined","style":{},"children":["config_file_path"]}],["$","span","code-segement45",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement46",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement47",{"className":"token","style":{"color":"#116b00"},"children":["\"r\""]}],["$","span","code-segement48",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement49",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement50",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement51",{"className":"$undefined","style":{},"children":[" model_params_file"]}],["$","span","code-segement52",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement53",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement54",{"className":"$undefined","style":{},"children":["    config "]}],["$","span","code-segement55",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement56",{"className":"$undefined","style":{},"children":[" yaml_load"]}],["$","span","code-segement57",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement58",{"className":"$undefined","style":{},"children":["model_params_file"]}],["$","span","code-segement59",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement60",{"className":"$undefined","style":{},"children":[" Loader"]}],["$","span","code-segement61",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement62",{"className":"$undefined","style":{},"children":["yaml_FullLoader"]}],["$","span","code-segement63",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement64",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement66",{"className":"$undefined","style":{},"children":["models_dir "]}],["$","span","code-segement67",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement68",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement69",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement70",{"className":"$undefined","style":{},"children":["dirname"]}],["$","span","code-segement71",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement72",{"className":"$undefined","style":{},"children":["dirname"]}],["$","span","code-segement73",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement74",{"className":"$undefined","style":{},"children":["__file__"]}],["$","span","code-segement75",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement76",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement77",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement78",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement79",{"className":"token","style":{"color":"#116b00"},"children":["\"models\""]}],["$","span","code-segement80",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement81",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement82",{"className":"$undefined","style":{},"children":["data_dir "]}],["$","span","code-segement83",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement84",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement85",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement86",{"className":"$undefined","style":{},"children":["dirname"]}],["$","span","code-segement87",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement88",{"className":"$undefined","style":{},"children":["dirname"]}],["$","span","code-segement89",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement90",{"className":"$undefined","style":{},"children":["__file__"]}],["$","span","code-segement91",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement92",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement93",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement94",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement95",{"className":"token","style":{"color":"#116b00"},"children":["\"data\""]}],["$","span","code-segement96",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Lc","9",{"id":"the-dataset-and-data-loaders","variant":"h5","component":"h2","mb":2,"children":["$","strong",null,{"children":"The Dataset and Data Loaders"}]}],["$","$Lc","10",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","In the ",["$","$La","10-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"src"}]," folder, we create a new file called ",["$","$La","10-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"dataset.py"}],"."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"from tensorflow.keras.datasets import mnist\nfrom tensorflow.keras.utils import normalize\n\n\n(x_train, y_train), (x_test, y_test) = mnist.load_data()\n\nx_train = normalize(x_train, axis=1)\nx_test = normalize(x_test, axis=1)\n\n# x_train = x_train / 255\n# x_test = x_test / 255\n\n\ndata_loaders = {\n    \"train\": [x_train, y_train],\n    \"test\": [x_test, y_test],\n}"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" tensorflow"]}],["$","span","code-segement2",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":["keras"]}],["$","span","code-segement4",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement5",{"className":"$undefined","style":{},"children":["datasets "]}],["$","span","code-segement6",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement7",{"className":"$undefined","style":{},"children":[" mnist\n"]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement9",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":[" tensorflow"]}],["$","span","code-segement11",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement12",{"className":"$undefined","style":{},"children":["keras"]}],["$","span","code-segement13",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement14",{"className":"$undefined","style":{},"children":["utils "]}],["$","span","code-segement15",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement16",{"className":"$undefined","style":{},"children":[" normalize\n"]}],"\n","\n",["$","span","code-segement19",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement20",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement21",{"className":"$undefined","style":{},"children":["x_train"]}],["$","span","code-segement22",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement23",{"className":"$undefined","style":{},"children":[" y_train"]}],["$","span","code-segement24",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement25",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement27",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement28",{"className":"$undefined","style":{},"children":["x_test"]}],["$","span","code-segement29",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement30",{"className":"$undefined","style":{},"children":[" y_test"]}],["$","span","code-segement31",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement32",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement33",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement34",{"className":"$undefined","style":{},"children":[" mnist"]}],["$","span","code-segement35",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement36",{"className":"$undefined","style":{},"children":["load_data"]}],["$","span","code-segement37",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement38",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement39",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement41",{"className":"$undefined","style":{},"children":["x_train "]}],["$","span","code-segement42",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement43",{"className":"$undefined","style":{},"children":[" normalize"]}],["$","span","code-segement44",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement45",{"className":"$undefined","style":{},"children":["x_train"]}],["$","span","code-segement46",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement47",{"className":"$undefined","style":{},"children":[" axis"]}],["$","span","code-segement48",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement49",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement50",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement51",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement52",{"className":"$undefined","style":{},"children":["x_test "]}],["$","span","code-segement53",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement54",{"className":"$undefined","style":{},"children":[" normalize"]}],["$","span","code-segement55",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement56",{"className":"$undefined","style":{},"children":["x_test"]}],["$","span","code-segement57",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement58",{"className":"$undefined","style":{},"children":[" axis"]}],["$","span","code-segement59",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement60",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement61",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement62",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement64",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement65",{"className":"token","style":{"color":"#3c526d"},"children":["# x_train = x_train / 255"]}],["$","span","code-segement66",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement67",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement68",{"className":"token","style":{"color":"#3c526d"},"children":["# x_test = x_test / 255"]}],["$","span","code-segement69",{"className":"$undefined","style":{},"children":["\n"]}],"\n","\n",["$","span","code-segement72",{"className":"$undefined","style":{},"children":["data_loaders "]}],["$","span","code-segement73",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement74",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement75",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement76",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement77",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement78",{"className":"token","style":{"color":"#116b00"},"children":["\"train\""]}],["$","span","code-segement79",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement80",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement81",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement82",{"className":"$undefined","style":{},"children":["x_train"]}],["$","span","code-segement83",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement84",{"className":"$undefined","style":{},"children":[" y_train"]}],["$","span","code-segement85",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement86",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement87",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement88",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement89",{"className":"token","style":{"color":"#116b00"},"children":["\"test\""]}],["$","span","code-segement90",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement91",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement92",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement93",{"className":"$undefined","style":{},"children":["x_test"]}],["$","span","code-segement94",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement95",{"className":"$undefined","style":{},"children":[" y_test"]}],["$","span","code-segement96",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement97",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement98",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement99",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement100",{"className":"token","style":{"color":"#111b27"},"children":["}"]}]]]}]}]]}],["$","$Lc","12",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Note that instead of using ",["$","$La","12-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"tensorflow.keras.utils.normalize"}],", we can also normalize our images by dividing the pixel values by 255. This will convert values from 0-255 to 0-1. The downside of using ",["$","$La","12-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"tensorflow.keras.utils.normalize"}]," is that during testing, we would need to have TensorFlow as a dependency to preprocess our input images in the same way as we did during training. So, alternatively, we can ourselves divide the pixel values by 255 to perform the normalization. ",["$","$La","12-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"tensorflow.keras.utils.normalize"}]," is definitely more robust. Later on, we'll see how we can create a custom implementation of the function."]}],["$","$Lc","13",{"id":"the-model","variant":"h5","component":"h2","mb":2,"children":["$","strong",null,{"children":"The Model"}]}],["$","$Lc","14",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Inside the ",["$","$La","14-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"src"}]," directory, we create the ",["$","$La","14-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"model.py"}]," file that defines our TF model."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"from keras import optimizers\nfrom keras.layers import Conv2D, MaxPooling2D, Dropout, Flatten, Dense\nfrom keras.models import Sequential\n\n\nclass CNN(Sequential):\n    def __init__(self):\n        super().__init__()\n\n        self.add(Conv2D(10, kernel_size=5, input_shape=(28, 28, 1)))\n        self.add(MaxPooling2D(pool_size=(2, 2)))\n        self.add(Conv2D(20, kernel_size=5))\n        self.add(MaxPooling2D(pool_size=(2, 2)))\n        self.add(Dropout(0.5))\n        self.add(Flatten())\n        self.add(Dense(50, activation='relu'))\n        self.add(Dropout(0.5))\n        self.add(Dense(10, activation='softmax'))\n\n        self.optimizer = optimizers.Adam(learning_rate=0.001)\n        self.compile(optimizer=self.optimizer, loss='sparse_categorical_crossentropy', metrics=['accuracy'])"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" keras "]}],["$","span","code-segement2",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":[" optimizers\n"]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement5",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement6",{"className":"$undefined","style":{},"children":[" keras"]}],["$","span","code-segement7",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":["layers "]}],["$","span","code-segement9",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":[" Conv2D"]}],["$","span","code-segement11",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement12",{"className":"$undefined","style":{},"children":[" MaxPooling2D"]}],["$","span","code-segement13",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement14",{"className":"$undefined","style":{},"children":[" Dropout"]}],["$","span","code-segement15",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement16",{"className":"$undefined","style":{},"children":[" Flatten"]}],["$","span","code-segement17",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement18",{"className":"$undefined","style":{},"children":[" Dense\n"]}],["$","span","code-segement19",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement20",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement21",{"className":"$undefined","style":{},"children":[" keras"]}],["$","span","code-segement22",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement23",{"className":"$undefined","style":{},"children":["models "]}],["$","span","code-segement24",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement25",{"className":"$undefined","style":{},"children":[" Sequential\n"]}],"\n","\n",["$","span","code-segement28",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement29",{"className":"token","style":{"color":"#a04900"},"children":["class"]}],["$","span","code-segement30",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement31",{"className":"token","style":{"color":"#005a8e"},"children":["CNN"]}],["$","span","code-segement32",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement33",{"className":"$undefined","style":{},"children":["Sequential"]}],["$","span","code-segement34",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement35",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement36",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement37",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement38",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement39",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement40",{"className":"token","style":{"color":"#7c00aa"},"children":["__init__"]}],["$","span","code-segement41",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement42",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement43",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement44",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement45",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement46",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement47",{"className":"token","style":{"color":"#af00af"},"children":["super"]}],["$","span","code-segement48",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement49",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement50",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement51",{"className":"$undefined","style":{},"children":["__init__"]}],["$","span","code-segement52",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement53",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement54",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement56",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement57",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement58",{"className":"$undefined","style":{},"children":["add"]}],["$","span","code-segement59",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement60",{"className":"$undefined","style":{},"children":["Conv2D"]}],["$","span","code-segement61",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement62",{"className":"token","style":{"color":"#755f00"},"children":["10"]}],["$","span","code-segement63",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement64",{"className":"$undefined","style":{},"children":[" kernel_size"]}],["$","span","code-segement65",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement66",{"className":"token","style":{"color":"#755f00"},"children":["5"]}],["$","span","code-segement67",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement68",{"className":"$undefined","style":{},"children":[" input_shape"]}],["$","span","code-segement69",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement70",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement71",{"className":"token","style":{"color":"#755f00"},"children":["28"]}],["$","span","code-segement72",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement73",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement74",{"className":"token","style":{"color":"#755f00"},"children":["28"]}],["$","span","code-segement75",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement76",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement77",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement78",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement79",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement80",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement81",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement82",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement83",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement84",{"className":"$undefined","style":{},"children":["add"]}],["$","span","code-segement85",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement86",{"className":"$undefined","style":{},"children":["MaxPooling2D"]}],["$","span","code-segement87",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement88",{"className":"$undefined","style":{},"children":["pool_size"]}],["$","span","code-segement89",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement90",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement91",{"className":"token","style":{"color":"#755f00"},"children":["2"]}],["$","span","code-segement92",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement93",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement94",{"className":"token","style":{"color":"#755f00"},"children":["2"]}],["$","span","code-segement95",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement96",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement97",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement98",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement99",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement100",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement101",{"className":"$undefined","style":{},"children":["add"]}],["$","span","code-segement102",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement103",{"className":"$undefined","style":{},"children":["Conv2D"]}],["$","span","code-segement104",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement105",{"className":"token","style":{"color":"#755f00"},"children":["20"]}],["$","span","code-segement106",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement107",{"className":"$undefined","style":{},"children":[" kernel_size"]}],["$","span","code-segement108",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement109",{"className":"token","style":{"color":"#755f00"},"children":["5"]}],["$","span","code-segement110",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement111",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement112",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement113",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement114",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement115",{"className":"$undefined","style":{},"children":["add"]}],["$","span","code-segement116",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement117",{"className":"$undefined","style":{},"children":["MaxPooling2D"]}],["$","span","code-segement118",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement119",{"className":"$undefined","style":{},"children":["pool_size"]}],["$","span","code-segement120",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement121",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement122",{"className":"token","style":{"color":"#755f00"},"children":["2"]}],["$","span","code-segement123",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement124",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement125",{"className":"token","style":{"color":"#755f00"},"children":["2"]}],["$","span","code-segement126",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement127",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement128",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement129",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement130",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement131",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement132",{"className":"$undefined","style":{},"children":["add"]}],["$","span","code-segement133",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement134",{"className":"$undefined","style":{},"children":["Dropout"]}],["$","span","code-segement135",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement136",{"className":"token","style":{"color":"#755f00"},"children":["0.5"]}],["$","span","code-segement137",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement138",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement139",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement140",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement141",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement142",{"className":"$undefined","style":{},"children":["add"]}],["$","span","code-segement143",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement144",{"className":"$undefined","style":{},"children":["Flatten"]}],["$","span","code-segement145",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement146",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement147",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement148",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement149",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement150",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement151",{"className":"$undefined","style":{},"children":["add"]}],["$","span","code-segement152",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement153",{"className":"$undefined","style":{},"children":["Dense"]}],["$","span","code-segement154",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement155",{"className":"token","style":{"color":"#755f00"},"children":["50"]}],["$","span","code-segement156",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement157",{"className":"$undefined","style":{},"children":[" activation"]}],["$","span","code-segement158",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement159",{"className":"token","style":{"color":"#116b00"},"children":["'relu'"]}],["$","span","code-segement160",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement161",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement162",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement163",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement164",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement165",{"className":"$undefined","style":{},"children":["add"]}],["$","span","code-segement166",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement167",{"className":"$undefined","style":{},"children":["Dropout"]}],["$","span","code-segement168",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement169",{"className":"token","style":{"color":"#755f00"},"children":["0.5"]}],["$","span","code-segement170",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement171",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement172",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement173",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement174",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement175",{"className":"$undefined","style":{},"children":["add"]}],["$","span","code-segement176",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement177",{"className":"$undefined","style":{},"children":["Dense"]}],["$","span","code-segement178",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement179",{"className":"token","style":{"color":"#755f00"},"children":["10"]}],["$","span","code-segement180",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement181",{"className":"$undefined","style":{},"children":[" activation"]}],["$","span","code-segement182",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement183",{"className":"token","style":{"color":"#116b00"},"children":["'softmax'"]}],["$","span","code-segement184",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement185",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement186",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement188",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement189",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement190",{"className":"$undefined","style":{},"children":["optimizer "]}],["$","span","code-segement191",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement192",{"className":"$undefined","style":{},"children":[" optimizers"]}],["$","span","code-segement193",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement194",{"className":"$undefined","style":{},"children":["Adam"]}],["$","span","code-segement195",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement196",{"className":"$undefined","style":{},"children":["learning_rate"]}],["$","span","code-segement197",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement198",{"className":"token","style":{"color":"#755f00"},"children":["0.001"]}],["$","span","code-segement199",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement200",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement201",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement202",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement203",{"className":"token","style":{"color":"#af00af"},"children":["compile"]}],["$","span","code-segement204",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement205",{"className":"$undefined","style":{},"children":["optimizer"]}],["$","span","code-segement206",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement207",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement208",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement209",{"className":"$undefined","style":{},"children":["optimizer"]}],["$","span","code-segement210",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement211",{"className":"$undefined","style":{},"children":[" loss"]}],["$","span","code-segement212",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement213",{"className":"token","style":{"color":"#116b00"},"children":["'sparse_categorical_crossentropy'"]}],["$","span","code-segement214",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement215",{"className":"$undefined","style":{},"children":[" metrics"]}],["$","span","code-segement216",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement217",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement218",{"className":"token","style":{"color":"#116b00"},"children":["'accuracy'"]}],["$","span","code-segement219",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement220",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Lc","16",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Defining the model as a custom class (like ",["$","$La","16-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"CNN"}],") may result in an ",["$","$La","16-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"Unknown Layer"}]," error when we load the model later on for testing, or when we load the model in TensorFlow JS. Alternatively, the model can be defined like this:"]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"model = Sequential()\nmodel.add(Conv2D(10, kernel_size=5, input_shape=(28, 28, 1)))\nmodel.add(MaxPooling2D(pool_size=(2, 2)))\nmodel.add(Conv2D(20, kernel_size=5))\nmodel.add(MaxPooling2D(pool_size=(2, 2)))\nmodel.add(Dropout(0.5))\nmodel.add(Flatten())\nmodel.add(Dense(50, activation='relu'))\nmodel.add(Dropout(0.5))\nmodel.add(Dense(10, activation='softmax'))\n\noptimizer = optimizers.Adam(learning_rate=0.001)\nmodel.compile(optimizer=optimizer, loss='sparse_categorical_crossentropy', metrics=['accuracy'])"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"$undefined","style":{},"children":["model "]}],["$","span","code-segement1",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement2",{"className":"$undefined","style":{},"children":[" Sequential"]}],["$","span","code-segement3",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement4",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement5",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement6",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement7",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":["add"]}],["$","span","code-segement9",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":["Conv2D"]}],["$","span","code-segement11",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement12",{"className":"token","style":{"color":"#755f00"},"children":["10"]}],["$","span","code-segement13",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement14",{"className":"$undefined","style":{},"children":[" kernel_size"]}],["$","span","code-segement15",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement16",{"className":"token","style":{"color":"#755f00"},"children":["5"]}],["$","span","code-segement17",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement18",{"className":"$undefined","style":{},"children":[" input_shape"]}],["$","span","code-segement19",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement20",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement21",{"className":"token","style":{"color":"#755f00"},"children":["28"]}],["$","span","code-segement22",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement23",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement24",{"className":"token","style":{"color":"#755f00"},"children":["28"]}],["$","span","code-segement25",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement27",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement28",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement29",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement30",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement31",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement32",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement33",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement34",{"className":"$undefined","style":{},"children":["add"]}],["$","span","code-segement35",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement36",{"className":"$undefined","style":{},"children":["MaxPooling2D"]}],["$","span","code-segement37",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement38",{"className":"$undefined","style":{},"children":["pool_size"]}],["$","span","code-segement39",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement40",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement41",{"className":"token","style":{"color":"#755f00"},"children":["2"]}],["$","span","code-segement42",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement43",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement44",{"className":"token","style":{"color":"#755f00"},"children":["2"]}],["$","span","code-segement45",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement46",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement47",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement48",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement49",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement50",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement51",{"className":"$undefined","style":{},"children":["add"]}],["$","span","code-segement52",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement53",{"className":"$undefined","style":{},"children":["Conv2D"]}],["$","span","code-segement54",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement55",{"className":"token","style":{"color":"#755f00"},"children":["20"]}],["$","span","code-segement56",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement57",{"className":"$undefined","style":{},"children":[" kernel_size"]}],["$","span","code-segement58",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement59",{"className":"token","style":{"color":"#755f00"},"children":["5"]}],["$","span","code-segement60",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement61",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement62",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement63",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement64",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement65",{"className":"$undefined","style":{},"children":["add"]}],["$","span","code-segement66",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement67",{"className":"$undefined","style":{},"children":["MaxPooling2D"]}],["$","span","code-segement68",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement69",{"className":"$undefined","style":{},"children":["pool_size"]}],["$","span","code-segement70",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement71",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement72",{"className":"token","style":{"color":"#755f00"},"children":["2"]}],["$","span","code-segement73",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement74",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement75",{"className":"token","style":{"color":"#755f00"},"children":["2"]}],["$","span","code-segement76",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement77",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement78",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement79",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement80",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement81",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement82",{"className":"$undefined","style":{},"children":["add"]}],["$","span","code-segement83",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement84",{"className":"$undefined","style":{},"children":["Dropout"]}],["$","span","code-segement85",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement86",{"className":"token","style":{"color":"#755f00"},"children":["0.5"]}],["$","span","code-segement87",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement88",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement89",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement90",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement91",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement92",{"className":"$undefined","style":{},"children":["add"]}],["$","span","code-segement93",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement94",{"className":"$undefined","style":{},"children":["Flatten"]}],["$","span","code-segement95",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement96",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement97",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement98",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement99",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement100",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement101",{"className":"$undefined","style":{},"children":["add"]}],["$","span","code-segement102",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement103",{"className":"$undefined","style":{},"children":["Dense"]}],["$","span","code-segement104",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement105",{"className":"token","style":{"color":"#755f00"},"children":["50"]}],["$","span","code-segement106",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement107",{"className":"$undefined","style":{},"children":[" activation"]}],["$","span","code-segement108",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement109",{"className":"token","style":{"color":"#116b00"},"children":["'relu'"]}],["$","span","code-segement110",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement111",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement112",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement113",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement114",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement115",{"className":"$undefined","style":{},"children":["add"]}],["$","span","code-segement116",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement117",{"className":"$undefined","style":{},"children":["Dropout"]}],["$","span","code-segement118",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement119",{"className":"token","style":{"color":"#755f00"},"children":["0.5"]}],["$","span","code-segement120",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement121",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement122",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement123",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement124",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement125",{"className":"$undefined","style":{},"children":["add"]}],["$","span","code-segement126",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement127",{"className":"$undefined","style":{},"children":["Dense"]}],["$","span","code-segement128",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement129",{"className":"token","style":{"color":"#755f00"},"children":["10"]}],["$","span","code-segement130",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement131",{"className":"$undefined","style":{},"children":[" activation"]}],["$","span","code-segement132",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement133",{"className":"token","style":{"color":"#116b00"},"children":["'softmax'"]}],["$","span","code-segement134",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement135",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement136",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement138",{"className":"$undefined","style":{},"children":["optimizer "]}],["$","span","code-segement139",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement140",{"className":"$undefined","style":{},"children":[" optimizers"]}],["$","span","code-segement141",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement142",{"className":"$undefined","style":{},"children":["Adam"]}],["$","span","code-segement143",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement144",{"className":"$undefined","style":{},"children":["learning_rate"]}],["$","span","code-segement145",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement146",{"className":"token","style":{"color":"#755f00"},"children":["0.001"]}],["$","span","code-segement147",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement148",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement149",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement150",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement151",{"className":"token","style":{"color":"#af00af"},"children":["compile"]}],["$","span","code-segement152",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement153",{"className":"$undefined","style":{},"children":["optimizer"]}],["$","span","code-segement154",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement155",{"className":"$undefined","style":{},"children":["optimizer"]}],["$","span","code-segement156",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement157",{"className":"$undefined","style":{},"children":[" loss"]}],["$","span","code-segement158",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement159",{"className":"token","style":{"color":"#116b00"},"children":["'sparse_categorical_crossentropy'"]}],["$","span","code-segement160",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement161",{"className":"$undefined","style":{},"children":[" metrics"]}],["$","span","code-segement162",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement163",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement164",{"className":"token","style":{"color":"#116b00"},"children":["'accuracy'"]}],["$","span","code-segement165",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement166",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Lc","18",{"id":"training","variant":"h5","component":"h2","mb":2,"children":["$","strong",null,{"children":"Training"}]}],["$","$Lc","19",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","In Keras, while training our model, we can pass callbacks to the ",["$","$La","19-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"model.fit"}]," function. A callback is an object that can define functions that get called on certain events during the training process."]}],["$","$Lc","20",{"id":"callbacks","variant":"h6","component":"h3","mb":2,"children":["$","strong",null,{"children":"Callbacks"}]}],["$","$Lc","21",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Inside the ",["$","$La","21-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"src"}]," directory, we create a file called ",["$","$La","21-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"callbacks.py"}],"."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"from os.path import join as path_join\n\nfrom keras import callbacks\n\n\nclass SaveModelPerEpochCallback(callbacks.Callback):\n    def __init__(self, models_save_dir):\n        super().__init__()\n        self.models_save_dir = models_save_dir\n\n    def on_epoch_end(self, epoch, logs=None):\n        model_save_file_path = path_join(self.models_save_dir, f\"epoch-{epoch}.h5\")\n        self.model.save_weights(model_save_file_path, save_format=\"h5\")"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" os"]}],["$","span","code-segement2",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":["path "]}],["$","span","code-segement4",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement5",{"className":"$undefined","style":{},"children":[" join "]}],["$","span","code-segement6",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement7",{"className":"$undefined","style":{},"children":[" path_join\n"]}],"\n",["$","span","code-segement9",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement10",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement11",{"className":"$undefined","style":{},"children":[" keras "]}],["$","span","code-segement12",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement13",{"className":"$undefined","style":{},"children":[" callbacks\n"]}],"\n","\n",["$","span","code-segement16",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement17",{"className":"token","style":{"color":"#a04900"},"children":["class"]}],["$","span","code-segement18",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement19",{"className":"token","style":{"color":"#005a8e"},"children":["SaveModelPerEpochCallback"]}],["$","span","code-segement20",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement21",{"className":"$undefined","style":{},"children":["callbacks"]}],["$","span","code-segement22",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement23",{"className":"$undefined","style":{},"children":["Callback"]}],["$","span","code-segement24",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement25",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement27",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement28",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement29",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement30",{"className":"token","style":{"color":"#7c00aa"},"children":["__init__"]}],["$","span","code-segement31",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement32",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement33",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement34",{"className":"$undefined","style":{},"children":[" models_save_dir"]}],["$","span","code-segement35",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement36",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement37",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement38",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement39",{"className":"token","style":{"color":"#af00af"},"children":["super"]}],["$","span","code-segement40",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement41",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement42",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement43",{"className":"$undefined","style":{},"children":["__init__"]}],["$","span","code-segement44",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement45",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement46",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement47",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement48",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement49",{"className":"$undefined","style":{},"children":["models_save_dir "]}],["$","span","code-segement50",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement51",{"className":"$undefined","style":{},"children":[" models_save_dir\n"]}],"\n",["$","span","code-segement53",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement54",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement55",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement56",{"className":"token","style":{"color":"#7c00aa"},"children":["on_epoch_end"]}],["$","span","code-segement57",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement58",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement59",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement60",{"className":"$undefined","style":{},"children":[" epoch"]}],["$","span","code-segement61",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement62",{"className":"$undefined","style":{},"children":[" logs"]}],["$","span","code-segement63",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement64",{"className":"token","style":{"color":"#755f00"},"children":["None"]}],["$","span","code-segement65",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement66",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement67",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement68",{"className":"$undefined","style":{},"children":["        model_save_file_path "]}],["$","span","code-segement69",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement70",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement71",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement72",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement73",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement74",{"className":"$undefined","style":{},"children":["models_save_dir"]}],["$","span","code-segement75",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement76",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement77",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\"epoch-"]}],["$","span","code-segement78",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement79",{"className":"token string-interpolation interpolation","style":{},"children":["epoch"]}],["$","span","code-segement80",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement81",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[".h5\""]}],["$","span","code-segement82",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement83",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement84",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement85",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement86",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement87",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement88",{"className":"$undefined","style":{},"children":["save_weights"]}],["$","span","code-segement89",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement90",{"className":"$undefined","style":{},"children":["model_save_file_path"]}],["$","span","code-segement91",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement92",{"className":"$undefined","style":{},"children":[" save_format"]}],["$","span","code-segement93",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement94",{"className":"token","style":{"color":"#116b00"},"children":["\"h5\""]}],["$","span","code-segement95",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Lc","23",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Here, we've defined a class that inherits from ",["$","$La","23-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"keras.callbacks.Callback"}]," and a function inside it that will be called at the end of every epoch. In this function, we just save the model weights."]}],["$","$Lc","24",{"id":"training-file","variant":"h6","component":"h3","mb":2,"children":["$","strong",null,{"children":"Training File"}]}],["$","$Lc","25",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","In the same directory, create a file called ",["$","$La","25-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"train.py"}],"."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"from datetime import datetime\nfrom os import makedirs\nfrom os.path import join as path_join\n\nfrom .callbacks import SaveModelPerEpochCallback\nfrom .config import config, models_dir\nfrom .dataset import data_loaders\nfrom .model import CNN\n\n\ndef train(models_save_dir, num_epochs):\n    model = CNN()\n\n    x_train, y_train = data_loaders['train']\n\n    save_model_per_epoch_callback = SaveModelPerEpochCallback(models_save_dir)\n\n    model.fit(x_train, y_train, epochs=num_epochs, callbacks=[save_model_per_epoch_callback])\n\n\nif __name__ == \"__main__\":\n    training_id = \"tensorflow---\" + datetime.now().strftime(\"%Y-%m-%d-%H-%M-%S\")\n    models_save_dir = path_join(models_dir, training_id)\n    makedirs(models_save_dir)\n\n    train(models_save_dir, config['training_num_epochs'])"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" datetime "]}],["$","span","code-segement2",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":[" datetime\n"]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement5",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement6",{"className":"$undefined","style":{},"children":[" os "]}],["$","span","code-segement7",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":[" makedirs\n"]}],["$","span","code-segement9",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement10",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement11",{"className":"$undefined","style":{},"children":[" os"]}],["$","span","code-segement12",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement13",{"className":"$undefined","style":{},"children":["path "]}],["$","span","code-segement14",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":[" join "]}],["$","span","code-segement16",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement17",{"className":"$undefined","style":{},"children":[" path_join\n"]}],"\n",["$","span","code-segement19",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement20",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement21",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement22",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement23",{"className":"$undefined","style":{},"children":["callbacks "]}],["$","span","code-segement24",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement25",{"className":"$undefined","style":{},"children":[" SaveModelPerEpochCallback\n"]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement27",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement28",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement29",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement30",{"className":"$undefined","style":{},"children":["config "]}],["$","span","code-segement31",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement32",{"className":"$undefined","style":{},"children":[" config"]}],["$","span","code-segement33",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement34",{"className":"$undefined","style":{},"children":[" models_dir\n"]}],["$","span","code-segement35",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement36",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement37",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement38",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement39",{"className":"$undefined","style":{},"children":["dataset "]}],["$","span","code-segement40",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement41",{"className":"$undefined","style":{},"children":[" data_loaders\n"]}],["$","span","code-segement42",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement43",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement44",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement45",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement46",{"className":"$undefined","style":{},"children":["model "]}],["$","span","code-segement47",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement48",{"className":"$undefined","style":{},"children":[" CNN\n"]}],"\n","\n",["$","span","code-segement51",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement52",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement53",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement54",{"className":"token","style":{"color":"#7c00aa"},"children":["train"]}],["$","span","code-segement55",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement56",{"className":"$undefined","style":{},"children":["models_save_dir"]}],["$","span","code-segement57",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement58",{"className":"$undefined","style":{},"children":[" num_epochs"]}],["$","span","code-segement59",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement60",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement61",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement62",{"className":"$undefined","style":{},"children":["    model "]}],["$","span","code-segement63",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement64",{"className":"$undefined","style":{},"children":[" CNN"]}],["$","span","code-segement65",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement66",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement67",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement69",{"className":"$undefined","style":{},"children":["    x_train"]}],["$","span","code-segement70",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement71",{"className":"$undefined","style":{},"children":[" y_train "]}],["$","span","code-segement72",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement73",{"className":"$undefined","style":{},"children":[" data_loaders"]}],["$","span","code-segement74",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement75",{"className":"token","style":{"color":"#116b00"},"children":["'train'"]}],["$","span","code-segement76",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement77",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement79",{"className":"$undefined","style":{},"children":["    save_model_per_epoch_callback "]}],["$","span","code-segement80",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement81",{"className":"$undefined","style":{},"children":[" SaveModelPerEpochCallback"]}],["$","span","code-segement82",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement83",{"className":"$undefined","style":{},"children":["models_save_dir"]}],["$","span","code-segement84",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement85",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement87",{"className":"$undefined","style":{},"children":["    model"]}],["$","span","code-segement88",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement89",{"className":"$undefined","style":{},"children":["fit"]}],["$","span","code-segement90",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement91",{"className":"$undefined","style":{},"children":["x_train"]}],["$","span","code-segement92",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement93",{"className":"$undefined","style":{},"children":[" y_train"]}],["$","span","code-segement94",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement95",{"className":"$undefined","style":{},"children":[" epochs"]}],["$","span","code-segement96",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement97",{"className":"$undefined","style":{},"children":["num_epochs"]}],["$","span","code-segement98",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement99",{"className":"$undefined","style":{},"children":[" callbacks"]}],["$","span","code-segement100",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement101",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement102",{"className":"$undefined","style":{},"children":["save_model_per_epoch_callback"]}],["$","span","code-segement103",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement104",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement105",{"className":"$undefined","style":{},"children":["\n"]}],"\n","\n",["$","span","code-segement108",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement109",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement110",{"className":"$undefined","style":{},"children":[" __name__ "]}],["$","span","code-segement111",{"className":"token","style":{"color":"#a04900"},"children":["=="]}],["$","span","code-segement112",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement113",{"className":"token","style":{"color":"#116b00"},"children":["\"__main__\""]}],["$","span","code-segement114",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement115",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement116",{"className":"$undefined","style":{},"children":["    training_id "]}],["$","span","code-segement117",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement118",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement119",{"className":"token","style":{"color":"#116b00"},"children":["\"tensorflow---\""]}],["$","span","code-segement120",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement121",{"className":"token","style":{"color":"#a04900"},"children":["+"]}],["$","span","code-segement122",{"className":"$undefined","style":{},"children":[" datetime"]}],["$","span","code-segement123",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement124",{"className":"$undefined","style":{},"children":["now"]}],["$","span","code-segement125",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement126",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement127",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement128",{"className":"$undefined","style":{},"children":["strftime"]}],["$","span","code-segement129",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement130",{"className":"token","style":{"color":"#116b00"},"children":["\"%Y-%m-%d-%H-%M-%S\""]}],["$","span","code-segement131",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement132",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement133",{"className":"$undefined","style":{},"children":["    models_save_dir "]}],["$","span","code-segement134",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement135",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement136",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement137",{"className":"$undefined","style":{},"children":["models_dir"]}],["$","span","code-segement138",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement139",{"className":"$undefined","style":{},"children":[" training_id"]}],["$","span","code-segement140",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement141",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement142",{"className":"$undefined","style":{},"children":["    makedirs"]}],["$","span","code-segement143",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement144",{"className":"$undefined","style":{},"children":["models_save_dir"]}],["$","span","code-segement145",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement146",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement148",{"className":"$undefined","style":{},"children":["    train"]}],["$","span","code-segement149",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement150",{"className":"$undefined","style":{},"children":["models_save_dir"]}],["$","span","code-segement151",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement152",{"className":"$undefined","style":{},"children":[" config"]}],["$","span","code-segement153",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement154",{"className":"token","style":{"color":"#116b00"},"children":["'training_num_epochs'"]}],["$","span","code-segement155",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement156",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Lc","27",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Training in Keras is much simpler than training in PyTorch. We have to just call the ",["$","$La","27-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"model.fit"}]," function with our training data and labels, the number of epochs, and optionally, the callbacks."]}],["$","$Lc","28",{"id":"testing","variant":"h5","component":"h2","mb":2,"children":["$","strong",null,{"children":"Testing"}]}],["$","$Lc","29",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Inside the ",["$","$La","29-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"src"}]," folder, we create one more file called ",["$","$La","29-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"test.py"}],". In this file, we first test on our test set, which has been loaded from our data loader. After that, we test by loading custom images and labels from the data directory. Inside the data directory, create a new folder called ",["$","$La","29-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"test_images"}]," and place some 28x28 handwritten digit images inside it. The images should have a black background and a white foreground. In the data directory, create a file called ",["$","$La","29-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"test_images_labels.json"}]," to store the ground truth labels corresponding to the test images. Here's an example of the file ",["$","$La","29-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"data/test_images_labels.json"}],"."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"{\n    \"1.png\": 1,\n    \"2.png\": 7,\n    \"3.png\": 2,\n    \"4.png\": 9,\n    \"5.png\": 8,\n    \"6.png\": 5,\n    \"7.png\": 1,\n    \"8.png\": 7,\n    \"9.png\": 1,\n    \"10.png\": 7,\n    \"11.png\": 7,\n    \"12.png\": 0,\n    \"13.png\": 5,\n    \"14.png\": 3,\n    \"15.png\": 2,\n    \"16.png\": 1,\n    \"17.png\": 0,\n    \"18.png\": 8,\n    \"19.png\": 7,\n    \"20.png\": 4\n}"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-json","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement2",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement3",{"className":"token","style":{"color":"#005a8e"},"children":["\"1.png\""]}],["$","span","code-segement4",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement5",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement6",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement7",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement9",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement10",{"className":"token","style":{"color":"#005a8e"},"children":["\"2.png\""]}],["$","span","code-segement11",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement12",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement13",{"className":"token","style":{"color":"#755f00"},"children":["7"]}],["$","span","code-segement14",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement16",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement17",{"className":"token","style":{"color":"#005a8e"},"children":["\"3.png\""]}],["$","span","code-segement18",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement19",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement20",{"className":"token","style":{"color":"#755f00"},"children":["2"]}],["$","span","code-segement21",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement22",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement23",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement24",{"className":"token","style":{"color":"#005a8e"},"children":["\"4.png\""]}],["$","span","code-segement25",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement27",{"className":"token","style":{"color":"#755f00"},"children":["9"]}],["$","span","code-segement28",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement29",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement30",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement31",{"className":"token","style":{"color":"#005a8e"},"children":["\"5.png\""]}],["$","span","code-segement32",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement33",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement34",{"className":"token","style":{"color":"#755f00"},"children":["8"]}],["$","span","code-segement35",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement36",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement37",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement38",{"className":"token","style":{"color":"#005a8e"},"children":["\"6.png\""]}],["$","span","code-segement39",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement40",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement41",{"className":"token","style":{"color":"#755f00"},"children":["5"]}],["$","span","code-segement42",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement43",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement44",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement45",{"className":"token","style":{"color":"#005a8e"},"children":["\"7.png\""]}],["$","span","code-segement46",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement47",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement48",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement49",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement50",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement51",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement52",{"className":"token","style":{"color":"#005a8e"},"children":["\"8.png\""]}],["$","span","code-segement53",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement54",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement55",{"className":"token","style":{"color":"#755f00"},"children":["7"]}],["$","span","code-segement56",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement57",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement58",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement59",{"className":"token","style":{"color":"#005a8e"},"children":["\"9.png\""]}],["$","span","code-segement60",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement61",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement62",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement63",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement64",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement65",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement66",{"className":"token","style":{"color":"#005a8e"},"children":["\"10.png\""]}],["$","span","code-segement67",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement68",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement69",{"className":"token","style":{"color":"#755f00"},"children":["7"]}],["$","span","code-segement70",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement71",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement72",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement73",{"className":"token","style":{"color":"#005a8e"},"children":["\"11.png\""]}],["$","span","code-segement74",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement75",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement76",{"className":"token","style":{"color":"#755f00"},"children":["7"]}],["$","span","code-segement77",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement78",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement79",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement80",{"className":"token","style":{"color":"#005a8e"},"children":["\"12.png\""]}],["$","span","code-segement81",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement82",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement83",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement84",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement85",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement86",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement87",{"className":"token","style":{"color":"#005a8e"},"children":["\"13.png\""]}],["$","span","code-segement88",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement89",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement90",{"className":"token","style":{"color":"#755f00"},"children":["5"]}],["$","span","code-segement91",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement92",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement93",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement94",{"className":"token","style":{"color":"#005a8e"},"children":["\"14.png\""]}],["$","span","code-segement95",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement96",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement97",{"className":"token","style":{"color":"#755f00"},"children":["3"]}],["$","span","code-segement98",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement99",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement100",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement101",{"className":"token","style":{"color":"#005a8e"},"children":["\"15.png\""]}],["$","span","code-segement102",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement103",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement104",{"className":"token","style":{"color":"#755f00"},"children":["2"]}],["$","span","code-segement105",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement106",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement107",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement108",{"className":"token","style":{"color":"#005a8e"},"children":["\"16.png\""]}],["$","span","code-segement109",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement110",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement111",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement112",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement113",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement114",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement115",{"className":"token","style":{"color":"#005a8e"},"children":["\"17.png\""]}],["$","span","code-segement116",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement117",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement118",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement119",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement120",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement121",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement122",{"className":"token","style":{"color":"#005a8e"},"children":["\"18.png\""]}],["$","span","code-segement123",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement124",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement125",{"className":"token","style":{"color":"#755f00"},"children":["8"]}],["$","span","code-segement126",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement127",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement128",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement129",{"className":"token","style":{"color":"#005a8e"},"children":["\"19.png\""]}],["$","span","code-segement130",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement131",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement132",{"className":"token","style":{"color":"#755f00"},"children":["7"]}],["$","span","code-segement133",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement134",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement135",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement136",{"className":"token","style":{"color":"#005a8e"},"children":["\"20.png\""]}],["$","span","code-segement137",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement138",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement139",{"className":"token","style":{"color":"#755f00"},"children":["4"]}],["$","span","code-segement140",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement141",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement142",{"className":"token","style":{"color":"#111b27"},"children":["}"]}]]]}]}]]}],["$","$Lc","31",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","And here's the entire ",["$","$La","31-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"src/test.py"}],"."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"$19"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" json "]}],["$","span","code-segement2",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":[" load "]}],["$","span","code-segement4",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement5",{"className":"$undefined","style":{},"children":[" json_load\n"]}],["$","span","code-segement6",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement7",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":[" os "]}],["$","span","code-segement9",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":[" listdir\n"]}],["$","span","code-segement11",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement12",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement13",{"className":"$undefined","style":{},"children":[" os"]}],["$","span","code-segement14",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":["path "]}],["$","span","code-segement16",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement17",{"className":"$undefined","style":{},"children":[" join "]}],["$","span","code-segement18",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement19",{"className":"$undefined","style":{},"children":[" path_join\n"]}],"\n",["$","span","code-segement21",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement22",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement23",{"className":"$undefined","style":{},"children":[" cv2\n"]}],["$","span","code-segement24",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement25",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":[" numpy "]}],["$","span","code-segement27",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement28",{"className":"$undefined","style":{},"children":[" np\n"]}],"\n",["$","span","code-segement30",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement31",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement32",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement33",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement34",{"className":"$undefined","style":{},"children":["config "]}],["$","span","code-segement35",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement36",{"className":"$undefined","style":{},"children":[" models_dir"]}],["$","span","code-segement37",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement38",{"className":"$undefined","style":{},"children":[" data_dir\n"]}],["$","span","code-segement39",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement40",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement41",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement42",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement43",{"className":"$undefined","style":{},"children":["dataset "]}],["$","span","code-segement44",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement45",{"className":"$undefined","style":{},"children":[" data_loaders\n"]}],["$","span","code-segement46",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement47",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement48",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement49",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement50",{"className":"$undefined","style":{},"children":["model "]}],["$","span","code-segement51",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement52",{"className":"$undefined","style":{},"children":[" CNN\n"]}],"\n",["$","span","code-segement54",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement55",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement56",{"className":"$undefined","style":{},"children":[" tensorflow"]}],["$","span","code-segement57",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement58",{"className":"$undefined","style":{},"children":["keras"]}],["$","span","code-segement59",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement60",{"className":"$undefined","style":{},"children":["utils "]}],["$","span","code-segement61",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement62",{"className":"$undefined","style":{},"children":[" normalize\n"]}],"\n","\n",["$","span","code-segement65",{"className":"$undefined","style":{},"children":["MODEL_WEIGHTS_FILE_PATH "]}],["$","span","code-segement66",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement67",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement68",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement69",{"className":"$undefined","style":{},"children":["models_dir"]}],["$","span","code-segement70",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement71",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement72",{"className":"token","style":{"color":"#116b00"},"children":["\"training_id\""]}],["$","span","code-segement73",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement74",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement75",{"className":"token","style":{"color":"#116b00"},"children":["\"epoch-epoch_number\""]}],["$","span","code-segement76",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement77",{"className":"$undefined","style":{},"children":["\n"]}],"\n","\n",["$","span","code-segement80",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement81",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement82",{"className":"$undefined","style":{},"children":[" __name__ "]}],["$","span","code-segement83",{"className":"token","style":{"color":"#a04900"},"children":["=="]}],["$","span","code-segement84",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement85",{"className":"token","style":{"color":"#116b00"},"children":["\"__main__\""]}],["$","span","code-segement86",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement87",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement88",{"className":"$undefined","style":{},"children":["    model "]}],["$","span","code-segement89",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement90",{"className":"$undefined","style":{},"children":[" CNN"]}],["$","span","code-segement91",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement92",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement93",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement94",{"className":"$undefined","style":{},"children":["    model"]}],["$","span","code-segement95",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement96",{"className":"$undefined","style":{},"children":["load_weights"]}],["$","span","code-segement97",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement98",{"className":"$undefined","style":{},"children":["MODEL_WEIGHTS_FILE_PATH"]}],["$","span","code-segement99",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement100",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement102",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement103",{"className":"token","style":{"color":"#3c526d"},"children":["### Test on MNIST Test Data"]}],["$","span","code-segement104",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement105",{"className":"$undefined","style":{},"children":["    x_test"]}],["$","span","code-segement106",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement107",{"className":"$undefined","style":{},"children":[" y_test "]}],["$","span","code-segement108",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement109",{"className":"$undefined","style":{},"children":[" data_loaders"]}],["$","span","code-segement110",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement111",{"className":"token","style":{"color":"#116b00"},"children":["'test'"]}],["$","span","code-segement112",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement113",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement114",{"className":"$undefined","style":{},"children":["    loss"]}],["$","span","code-segement115",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement116",{"className":"$undefined","style":{},"children":[" accuracy "]}],["$","span","code-segement117",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement118",{"className":"$undefined","style":{},"children":[" model"]}],["$","span","code-segement119",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement120",{"className":"$undefined","style":{},"children":["evaluate"]}],["$","span","code-segement121",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement122",{"className":"$undefined","style":{},"children":["x_test"]}],["$","span","code-segement123",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement124",{"className":"$undefined","style":{},"children":[" y_test"]}],["$","span","code-segement125",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement126",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement128",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement129",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement130",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement131",{"className":"token","style":{"color":"#116b00"},"children":["\"Testing on MNIST Test Set\""]}],["$","span","code-segement132",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement133",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement134",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement135",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement136",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement137",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\"Loss: "]}],["$","span","code-segement138",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement139",{"className":"token string-interpolation interpolation","style":{},"children":["loss"]}],["$","span","code-segement140",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement141",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[", Accuracy: "]}],["$","span","code-segement142",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement143",{"className":"token string-interpolation interpolation","style":{},"children":["accuracy"]}],["$","span","code-segement144",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement145",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["\""]}],["$","span","code-segement146",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement147",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement148",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement149",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement150",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement151",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement152",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement154",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement155",{"className":"token","style":{"color":"#3c526d"},"children":["### Test on Custom Images"]}],["$","span","code-segement156",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement157",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement158",{"className":"token","style":{"color":"#3c526d"},"children":["# Load Images"]}],["$","span","code-segement159",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement160",{"className":"$undefined","style":{},"children":["    test_images_dir "]}],["$","span","code-segement161",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement162",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement163",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement164",{"className":"$undefined","style":{},"children":["data_dir"]}],["$","span","code-segement165",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement166",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement167",{"className":"token","style":{"color":"#116b00"},"children":["\"test_images\""]}],["$","span","code-segement168",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement169",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement171",{"className":"$undefined","style":{},"children":["    test_images_labels_file_path "]}],["$","span","code-segement172",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement173",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement174",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement175",{"className":"$undefined","style":{},"children":["data_dir"]}],["$","span","code-segement176",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement177",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement178",{"className":"token","style":{"color":"#116b00"},"children":["\"test_images_labels.json\""]}],["$","span","code-segement179",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement180",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement181",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement182",{"className":"token","style":{"color":"#a04900"},"children":["with"]}],["$","span","code-segement183",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement184",{"className":"token","style":{"color":"#af00af"},"children":["open"]}],["$","span","code-segement185",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement186",{"className":"$undefined","style":{},"children":["test_images_labels_file_path"]}],["$","span","code-segement187",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement188",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement189",{"className":"token","style":{"color":"#116b00"},"children":["'r'"]}],["$","span","code-segement190",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement191",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement192",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement193",{"className":"$undefined","style":{},"children":[" test_images_labels_file"]}],["$","span","code-segement194",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement195",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement196",{"className":"$undefined","style":{},"children":["        test_images_labels "]}],["$","span","code-segement197",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement198",{"className":"$undefined","style":{},"children":[" json_load"]}],["$","span","code-segement199",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement200",{"className":"$undefined","style":{},"children":["test_images_labels_file"]}],["$","span","code-segement201",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement202",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement204",{"className":"$undefined","style":{},"children":["    test_images "]}],["$","span","code-segement205",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement206",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement207",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement208",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement209",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement210",{"className":"$undefined","style":{},"children":["    test_labels "]}],["$","span","code-segement211",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement212",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement213",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement214",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement215",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement216",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement217",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement218",{"className":"$undefined","style":{},"children":[" image_name "]}],["$","span","code-segement219",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement220",{"className":"$undefined","style":{},"children":[" listdir"]}],["$","span","code-segement221",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement222",{"className":"$undefined","style":{},"children":["test_images_dir"]}],["$","span","code-segement223",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement224",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement225",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement226",{"className":"$undefined","style":{},"children":["        image_path "]}],["$","span","code-segement227",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement228",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement229",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement230",{"className":"$undefined","style":{},"children":["test_images_dir"]}],["$","span","code-segement231",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement232",{"className":"$undefined","style":{},"children":[" image_name"]}],["$","span","code-segement233",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement234",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement235",{"className":"$undefined","style":{},"children":["        image "]}],["$","span","code-segement236",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement237",{"className":"$undefined","style":{},"children":[" cv2"]}],["$","span","code-segement238",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement239",{"className":"$undefined","style":{},"children":["imread"]}],["$","span","code-segement240",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement241",{"className":"$undefined","style":{},"children":["image_path"]}],["$","span","code-segement242",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement243",{"className":"$undefined","style":{},"children":[" cv2"]}],["$","span","code-segement244",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement245",{"className":"$undefined","style":{},"children":["IMREAD_GRAYSCALE"]}],["$","span","code-segement246",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement247",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement248",{"className":"$undefined","style":{},"children":["        test_images"]}],["$","span","code-segement249",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement250",{"className":"$undefined","style":{},"children":["append"]}],["$","span","code-segement251",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement252",{"className":"$undefined","style":{},"children":["image"]}],["$","span","code-segement253",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement254",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement256",{"className":"$undefined","style":{},"children":["        test_labels"]}],["$","span","code-segement257",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement258",{"className":"$undefined","style":{},"children":["append"]}],["$","span","code-segement259",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement260",{"className":"$undefined","style":{},"children":["test_images_labels"]}],["$","span","code-segement261",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement262",{"className":"$undefined","style":{},"children":["image_name"]}],["$","span","code-segement263",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement264",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement265",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement267",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement268",{"className":"token","style":{"color":"#3c526d"},"children":["# Preprocess"]}],["$","span","code-segement269",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement270",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement271",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement272",{"className":"$undefined","style":{},"children":[" i "]}],["$","span","code-segement273",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement274",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement275",{"className":"token","style":{"color":"#af00af"},"children":["range"]}],["$","span","code-segement276",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement277",{"className":"token","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement278",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement279",{"className":"$undefined","style":{},"children":["test_images"]}],["$","span","code-segement280",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement281",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement282",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement283",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement284",{"className":"$undefined","style":{},"children":["        test_images"]}],["$","span","code-segement285",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement286",{"className":"$undefined","style":{},"children":["i"]}],["$","span","code-segement287",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement288",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement289",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement290",{"className":"$undefined","style":{},"children":[" np"]}],["$","span","code-segement291",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement292",{"className":"$undefined","style":{},"children":["array"]}],["$","span","code-segement293",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement294",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement295",{"className":"$undefined","style":{},"children":["test_images"]}],["$","span","code-segement296",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement297",{"className":"$undefined","style":{},"children":["i"]}],["$","span","code-segement298",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement299",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement300",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement301",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement302",{"className":"$undefined","style":{},"children":["        test_images"]}],["$","span","code-segement303",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement304",{"className":"$undefined","style":{},"children":["i"]}],["$","span","code-segement305",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement306",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement307",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement308",{"className":"$undefined","style":{},"children":[" normalize"]}],["$","span","code-segement309",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement310",{"className":"$undefined","style":{},"children":["test_images"]}],["$","span","code-segement311",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement312",{"className":"$undefined","style":{},"children":["i"]}],["$","span","code-segement313",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement314",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement315",{"className":"$undefined","style":{},"children":[" axis"]}],["$","span","code-segement316",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement317",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement318",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement319",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement321",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement322",{"className":"token","style":{"color":"#3c526d"},"children":["# Predict"]}],["$","span","code-segement323",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement324",{"className":"$undefined","style":{},"children":["    num_correct "]}],["$","span","code-segement325",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement326",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement327",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement328",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement329",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement330",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement331",{"className":"$undefined","style":{},"children":[" image"]}],["$","span","code-segement332",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement333",{"className":"$undefined","style":{},"children":[" label "]}],["$","span","code-segement334",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement335",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement336",{"className":"token","style":{"color":"#af00af"},"children":["zip"]}],["$","span","code-segement337",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement338",{"className":"$undefined","style":{},"children":["test_images"]}],["$","span","code-segement339",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement340",{"className":"$undefined","style":{},"children":[" test_labels"]}],["$","span","code-segement341",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement342",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement343",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement344",{"className":"$undefined","style":{},"children":["        prediction "]}],["$","span","code-segement345",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement346",{"className":"$undefined","style":{},"children":[" model"]}],["$","span","code-segement347",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement348",{"className":"$undefined","style":{},"children":["predict"]}],["$","span","code-segement349",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement350",{"className":"$undefined","style":{},"children":["image"]}],["$","span","code-segement351",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement352",{"className":"$undefined","style":{},"children":[" verbose"]}],["$","span","code-segement353",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement354",{"className":"token","style":{"color":"#755f00"},"children":["None"]}],["$","span","code-segement355",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement356",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement357",{"className":"$undefined","style":{},"children":["        predicted_label "]}],["$","span","code-segement358",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement359",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement360",{"className":"token","style":{"color":"#af00af"},"children":["int"]}],["$","span","code-segement361",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement362",{"className":"$undefined","style":{},"children":["np"]}],["$","span","code-segement363",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement364",{"className":"$undefined","style":{},"children":["argmax"]}],["$","span","code-segement365",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement366",{"className":"$undefined","style":{},"children":["prediction"]}],["$","span","code-segement367",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement368",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement369",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement371",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement372",{"className":"token","style":{"color":"#3c526d"},"children":["# print(f\"{predicted_label} : {label}\")"]}],["$","span","code-segement373",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement374",{"className":"$undefined","style":{},"children":["        num_correct "]}],["$","span","code-segement375",{"className":"token","style":{"color":"#a04900"},"children":["+="]}],["$","span","code-segement376",{"className":"$undefined","style":{},"children":[" predicted_label "]}],["$","span","code-segement377",{"className":"token","style":{"color":"#a04900"},"children":["=="]}],["$","span","code-segement378",{"className":"$undefined","style":{},"children":[" label\n"]}],"\n",["$","span","code-segement380",{"className":"$undefined","style":{},"children":["    accuracy "]}],["$","span","code-segement381",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement382",{"className":"$undefined","style":{},"children":[" num_correct "]}],["$","span","code-segement383",{"className":"token","style":{"color":"#a04900"},"children":["/"]}],["$","span","code-segement384",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement385",{"className":"token","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement386",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement387",{"className":"$undefined","style":{},"children":["test_images"]}],["$","span","code-segement388",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement389",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement390",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement391",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement392",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement393",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\"Correct: "]}],["$","span","code-segement394",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement395",{"className":"token string-interpolation interpolation","style":{},"children":["num_correct"]}],["$","span","code-segement396",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement397",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[" / "]}],["$","span","code-segement398",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement399",{"className":"token string-interpolation interpolation","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement400",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement401",{"className":"token string-interpolation interpolation","style":{},"children":["test_images"]}],["$","span","code-segement402",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement403",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement404",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[", Accuracy: "]}],["$","span","code-segement405",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement406",{"className":"token string-interpolation interpolation","style":{},"children":["accuracy"]}],["$","span","code-segement407",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement408",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["\""]}],["$","span","code-segement409",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Lc","33",{"id":"conversion-to-onnx","variant":"h5","component":"h2","mb":2,"children":["$","strong",null,{"children":"Conversion to ONNX"}]}],["$","$Lc","34",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","In the ",["$","$La","34-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"src"}]," directory, create another directory called ",["$","$La","34-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"converters"}],", and in it create a file called ",["$","$La","34-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"converter_onnx.py"}],"."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"from os.path import dirname, join as path_join\n\nimport onnx\nimport tf2onnx\n\nfrom ..config import models_dir\nfrom ..model import CNN\n\n\nMODEL_WEIGHTS_FILE_PATH = path_join(models_dir, \"training_id\", \"epoch-epoch_number\")\nONNX_MODEL_FILE_PATH = path_join(dirname(MODEL_WEIGHTS_FILE_PATH), \"model.onnx\")\n\n\nif __name__ == \"__main__\":\n    keras_model = CNN()\n    keras_model.load_weights(MODEL_WEIGHTS_FILE_PATH)\n\n    onnx_model, _ = tf2onnx.convert.from_keras(keras_model)\n\n    onnx.save(onnx_model, ONNX_MODEL_FILE_PATH)\n    print(f\"ONNX model saved at: {ONNX_MODEL_FILE_PATH}\")"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" os"]}],["$","span","code-segement2",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":["path "]}],["$","span","code-segement4",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement5",{"className":"$undefined","style":{},"children":[" dirname"]}],["$","span","code-segement6",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement7",{"className":"$undefined","style":{},"children":[" join "]}],["$","span","code-segement8",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement9",{"className":"$undefined","style":{},"children":[" path_join\n"]}],"\n",["$","span","code-segement11",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement12",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement13",{"className":"$undefined","style":{},"children":[" onnx\n"]}],["$","span","code-segement14",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement15",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement16",{"className":"$undefined","style":{},"children":[" tf2onnx\n"]}],"\n",["$","span","code-segement18",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement19",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement20",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement21",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement22",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement23",{"className":"$undefined","style":{},"children":["config "]}],["$","span","code-segement24",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement25",{"className":"$undefined","style":{},"children":[" models_dir\n"]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement27",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement28",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement29",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement30",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement31",{"className":"$undefined","style":{},"children":["model "]}],["$","span","code-segement32",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement33",{"className":"$undefined","style":{},"children":[" CNN\n"]}],"\n","\n",["$","span","code-segement36",{"className":"$undefined","style":{},"children":["MODEL_WEIGHTS_FILE_PATH "]}],["$","span","code-segement37",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement38",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement39",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement40",{"className":"$undefined","style":{},"children":["models_dir"]}],["$","span","code-segement41",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement42",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement43",{"className":"token","style":{"color":"#116b00"},"children":["\"training_id\""]}],["$","span","code-segement44",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement45",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement46",{"className":"token","style":{"color":"#116b00"},"children":["\"epoch-epoch_number\""]}],["$","span","code-segement47",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement48",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement49",{"className":"$undefined","style":{},"children":["ONNX_MODEL_FILE_PATH "]}],["$","span","code-segement50",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement51",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement52",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement53",{"className":"$undefined","style":{},"children":["dirname"]}],["$","span","code-segement54",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement55",{"className":"$undefined","style":{},"children":["MODEL_WEIGHTS_FILE_PATH"]}],["$","span","code-segement56",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement57",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement58",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement59",{"className":"token","style":{"color":"#116b00"},"children":["\"model.onnx\""]}],["$","span","code-segement60",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement61",{"className":"$undefined","style":{},"children":["\n"]}],"\n","\n",["$","span","code-segement64",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement65",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement66",{"className":"$undefined","style":{},"children":[" __name__ "]}],["$","span","code-segement67",{"className":"token","style":{"color":"#a04900"},"children":["=="]}],["$","span","code-segement68",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement69",{"className":"token","style":{"color":"#116b00"},"children":["\"__main__\""]}],["$","span","code-segement70",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement71",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement72",{"className":"$undefined","style":{},"children":["    keras_model "]}],["$","span","code-segement73",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement74",{"className":"$undefined","style":{},"children":[" CNN"]}],["$","span","code-segement75",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement76",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement77",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement78",{"className":"$undefined","style":{},"children":["    keras_model"]}],["$","span","code-segement79",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement80",{"className":"$undefined","style":{},"children":["load_weights"]}],["$","span","code-segement81",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement82",{"className":"$undefined","style":{},"children":["MODEL_WEIGHTS_FILE_PATH"]}],["$","span","code-segement83",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement84",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement86",{"className":"$undefined","style":{},"children":["    onnx_model"]}],["$","span","code-segement87",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement88",{"className":"$undefined","style":{},"children":[" _ "]}],["$","span","code-segement89",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement90",{"className":"$undefined","style":{},"children":[" tf2onnx"]}],["$","span","code-segement91",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement92",{"className":"$undefined","style":{},"children":["convert"]}],["$","span","code-segement93",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement94",{"className":"$undefined","style":{},"children":["from_keras"]}],["$","span","code-segement95",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement96",{"className":"$undefined","style":{},"children":["keras_model"]}],["$","span","code-segement97",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement98",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement100",{"className":"$undefined","style":{},"children":["    onnx"]}],["$","span","code-segement101",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement102",{"className":"$undefined","style":{},"children":["save"]}],["$","span","code-segement103",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement104",{"className":"$undefined","style":{},"children":["onnx_model"]}],["$","span","code-segement105",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement106",{"className":"$undefined","style":{},"children":[" ONNX_MODEL_FILE_PATH"]}],["$","span","code-segement107",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement108",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement109",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement110",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement111",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement112",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\"ONNX model saved at: "]}],["$","span","code-segement113",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement114",{"className":"token string-interpolation interpolation","style":{},"children":["ONNX_MODEL_FILE_PATH"]}],["$","span","code-segement115",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement116",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["\""]}],["$","span","code-segement117",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Lc","36",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","We initialize our model and load its weights from the disk. The Keras to ONNX conversion is handled by the ",["$","$L17","36-link",{"href":"https://pypi.org/project/tf2onnx","rel":"noopener noreferrer","target":"_blank","color":"primary","underline":"hover","children":"tf2onnx"}]," package. To save the onnx model to the disk, we use ",["$","$La","36-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"onnx.save"}],"."]}],["$","$Lc","37",{"id":"conversion-to-tensorflow-js","variant":"h5","component":"h2","mb":2,"children":["$","strong",null,{"children":"Conversion to TensorFlow JS"}]}],["$","$Lc","38",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Create a new file at ",["$","$La","38-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"src/converters/converter_tfjs.py"}],"."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"from os.path import dirname, join as path_join\n\nfrom tensorflowjs import converters\n\nfrom ..config import models_dir\nfrom ..model import CNN\n\n\nMODEL_WEIGHTS_FILE_PATH = path_join(models_dir, \"tensorflow---2024-04-21-22-04-45\", \"epoch-9.h5\")\nTFJS_MODEL_FILE_PATH = path_join(dirname(MODEL_WEIGHTS_FILE_PATH), \"model-tfjs\")\n\n\nif __name__ == \"__main__\":\n    keras_model = CNN()\n    keras_model.load_weights(MODEL_WEIGHTS_FILE_PATH)\n\n    converters.save_keras_model(keras_model, TFJS_MODEL_FILE_PATH)\n    print(f\"TensorFlow JS model saved at: {TFJS_MODEL_FILE_PATH}\")"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" os"]}],["$","span","code-segement2",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":["path "]}],["$","span","code-segement4",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement5",{"className":"$undefined","style":{},"children":[" dirname"]}],["$","span","code-segement6",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement7",{"className":"$undefined","style":{},"children":[" join "]}],["$","span","code-segement8",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement9",{"className":"$undefined","style":{},"children":[" path_join\n"]}],"\n",["$","span","code-segement11",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement12",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement13",{"className":"$undefined","style":{},"children":[" tensorflowjs "]}],["$","span","code-segement14",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":[" converters\n"]}],"\n",["$","span","code-segement17",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement18",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement19",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement20",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement21",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement22",{"className":"$undefined","style":{},"children":["config "]}],["$","span","code-segement23",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement24",{"className":"$undefined","style":{},"children":[" models_dir\n"]}],["$","span","code-segement25",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement26",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement27",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement28",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement29",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement30",{"className":"$undefined","style":{},"children":["model "]}],["$","span","code-segement31",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement32",{"className":"$undefined","style":{},"children":[" CNN\n"]}],"\n","\n",["$","span","code-segement35",{"className":"$undefined","style":{},"children":["MODEL_WEIGHTS_FILE_PATH "]}],["$","span","code-segement36",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement37",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement38",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement39",{"className":"$undefined","style":{},"children":["models_dir"]}],["$","span","code-segement40",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement41",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement42",{"className":"token","style":{"color":"#116b00"},"children":["\"tensorflow---2024-04-21-22-04-45\""]}],["$","span","code-segement43",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement44",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement45",{"className":"token","style":{"color":"#116b00"},"children":["\"epoch-9.h5\""]}],["$","span","code-segement46",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement47",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement48",{"className":"$undefined","style":{},"children":["TFJS_MODEL_FILE_PATH "]}],["$","span","code-segement49",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement50",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement51",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement52",{"className":"$undefined","style":{},"children":["dirname"]}],["$","span","code-segement53",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement54",{"className":"$undefined","style":{},"children":["MODEL_WEIGHTS_FILE_PATH"]}],["$","span","code-segement55",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement56",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement57",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement58",{"className":"token","style":{"color":"#116b00"},"children":["\"model-tfjs\""]}],["$","span","code-segement59",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement60",{"className":"$undefined","style":{},"children":["\n"]}],"\n","\n",["$","span","code-segement63",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement64",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement65",{"className":"$undefined","style":{},"children":[" __name__ "]}],["$","span","code-segement66",{"className":"token","style":{"color":"#a04900"},"children":["=="]}],["$","span","code-segement67",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement68",{"className":"token","style":{"color":"#116b00"},"children":["\"__main__\""]}],["$","span","code-segement69",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement70",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement71",{"className":"$undefined","style":{},"children":["    keras_model "]}],["$","span","code-segement72",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement73",{"className":"$undefined","style":{},"children":[" CNN"]}],["$","span","code-segement74",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement75",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement76",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement77",{"className":"$undefined","style":{},"children":["    keras_model"]}],["$","span","code-segement78",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement79",{"className":"$undefined","style":{},"children":["load_weights"]}],["$","span","code-segement80",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement81",{"className":"$undefined","style":{},"children":["MODEL_WEIGHTS_FILE_PATH"]}],["$","span","code-segement82",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement83",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement85",{"className":"$undefined","style":{},"children":["    converters"]}],["$","span","code-segement86",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement87",{"className":"$undefined","style":{},"children":["save_keras_model"]}],["$","span","code-segement88",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement89",{"className":"$undefined","style":{},"children":["keras_model"]}],["$","span","code-segement90",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement91",{"className":"$undefined","style":{},"children":[" TFJS_MODEL_FILE_PATH"]}],["$","span","code-segement92",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement93",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement94",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement95",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement96",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement97",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\"TensorFlow JS model saved at: "]}],["$","span","code-segement98",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement99",{"className":"token string-interpolation interpolation","style":{},"children":["TFJS_MODEL_FILE_PATH"]}],["$","span","code-segement100",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement101",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["\""]}],["$","span","code-segement102",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Lc","40",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","",["$","$La","40-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"tensorflowjs.converters"}]," has the ",["$","$La","40-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"save_keras_model"}]," function that can simply convert the TensorFlow model to TensorFlow JS."]}],["$","$Lc","41",{"id":"conclusion","variant":"h4","component":"h1","mb":2,"children":["$","strong",null,{"children":"Conclusion"}]}],["$","$Lc","42",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Today we've learned how to make a CNN in TensorFlow (Keras) that can recognize handwritten digits (nothing new) and converter our model to ONNX and TensorFlow JS (still nothing new). This Post intends to serve as a baseline for future Posts in which we'll be deploying our ONNX and TFJS models - both on the Backend as well as the Frontend."]}],["$","$Lc","43",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","See you next time :)"]}]]}]}]]}]}],"$L1a"]}]
1b:I[3713,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],"default"]
12:["$","$La",null,{"sx":{"width":"100%","display":"flex","flexDirection":"row","justifyContent":"space-between","alignItems":"center"},"children":[["$","$Lc",null,{"variant":"p","component":"p","mr":2,"children":"By: Abhilaksh Singh Reen"}],["$","$L1b",null,{"socialMediaProfiles":[{"network_name":"LinkedIn","profile_url":"https://www.linkedin.com/in/abhilaksh-singh-837901210/","profile_display_name":"Abhilaksh Singh Reen"},{"network_name":"Twitter","profile_url":"https://x.com/TheVeteran06","profile_display_name":"The Veteran 06"},{"network_name":"GitHub","profile_url":"https://github.com/AbhilakshSinghReen","profile_display_name":"Abhilaksh Singh Reen"}]}]]}]
1c:I[6652,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],""]
1d:I[6981,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],""]
1e:I[2818,["98","static/chunks/98-7f6363f9ac68c942.js","134","static/chunks/134-9729e0afcc6dfdfe.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-e5dcfc2304d91b2f.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js"],""]
1a:["$","$La",null,{"mt":5,"mb":5,"pb":2,"sx":{"width":"100%","display":"flex","flexDirection":"column","justifyContent":"flex-start","alignItems":"center"},"children":["$","$L11",null,{"container":true,"spacing":2,"mt":4,"mb":4,"children":[["$","$L11","/ml-ops/ml-inference-on-backend-vs-frontend",{"item":true,"xs":12,"sm":6,"md":4,"lg":3,"children":["$","$Ld",null,{"href":"/ml-ops/ml-inference-on-backend-vs-frontend","passHref":true,"style":{"textDecoration":"none"},"children":["$","$L1c",null,{"sx":{"width":"100%","height":"100%","boxShadow":"1px 1px 1px 1px \"#eeeeee\"","&:hover":{"boxShadow":"3px 3px 3px 3px \"#eeeeee\"","cursor":"pointer"}},"children":[["$","$L1d",null,{"component":"img","height":"150","image":"/media/images/ml-inference-on-backend-vs-frontend-thumbnail.jpg","alt":"ML Inference on Backend vs Frontend","sx":{"objectFit":"cover"}}],["$","$L1e",null,{"children":[["$","$Lc",null,{"gutterBottom":true,"variant":"h6","component":"h2","children":[""," ","ML Inference on Backend vs Frontend"]}],["$","$Lc",null,{"gutterBottom":true,"variant":"p","component":"p","sx":{"overflow":"hidden","textOverflow":"ellipsis","display":"-webkit-box","WebkitLineClamp":"3","WebkitBoxOrient":"vertical"},"children":"A comparison of ML inference speed and memory consumption across various batch sizes on both GPU and CPU."}],["$","$La",null,{"sx":{"width":"100%","display":"flex","flexDirection":"row","justifyContent":"flex-end","alignItems":"center"},"children":["$","$Lc",null,{"gutterBottom":true,"variant":"p","component":"p","children":"05m Read"}]}],false]}]]}]}]}]]}]}]
