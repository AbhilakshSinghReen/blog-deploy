3:I[9275,[],""]
6:I[1343,[],""]
7:I[6871,["98","static/chunks/98-98337b3bb708bd24.js","748","static/chunks/748-1f14ee6eb3d7029a.js","271","static/chunks/271-37a22bace913f735.js","185","static/chunks/app/layout-08611f287dda1230.js"],"default"]
8:I[5877,["98","static/chunks/98-98337b3bb708bd24.js","748","static/chunks/748-1f14ee6eb3d7029a.js","271","static/chunks/271-37a22bace913f735.js","185","static/chunks/app/layout-08611f287dda1230.js"],"default"]
9:I[902,["98","static/chunks/98-98337b3bb708bd24.js","748","static/chunks/748-1f14ee6eb3d7029a.js","271","static/chunks/271-37a22bace913f735.js","185","static/chunks/app/layout-08611f287dda1230.js"],""]
a:I[5218,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],""]
b:I[2324,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],"default"]
c:I[2591,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],""]
d:I[231,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],""]
e:I[3180,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],""]
f:I[3245,["98","static/chunks/98-98337b3bb708bd24.js","748","static/chunks/748-1f14ee6eb3d7029a.js","271","static/chunks/271-37a22bace913f735.js","185","static/chunks/app/layout-08611f287dda1230.js"],"default"]
4:["categorySlug","ml-ops","d"]
5:["postOrSeriesSlug","node-express-onnx-backend","d"]
0:["hQwECBHV9o0WmX2S0pG39",[[["",{"children":[["categorySlug","ml-ops","d"],{"children":[["postOrSeriesSlug","node-express-onnx-backend","d"],{"children":["__PAGE__?{\"categorySlug\":\"ml-ops\",\"postOrSeriesSlug\":\"node-express-onnx-backend\"}",{}]}]}]},"$undefined","$undefined",true],["",{"children":[["categorySlug","ml-ops","d"],{"children":[["postOrSeriesSlug","node-express-onnx-backend","d"],{"children":["__PAGE__",{},[["$L1","$L2"],null],null]},["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","$4","children","$5","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}],null]},["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","$4","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}],null]},[["$","html",null,{"lang":"en","suppressHydrationWarning":true,"children":["$","body",null,{"className":"__className_d65c78","children":["$","$L7",null,{"children":[["$","$L8",null,{}],["$","$L9",null,{"maxWidth":"lg","children":[["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":["$","$La",null,{"children":[["$","$Lb",null,{"render":false,"targetSiteNavigationState":[],"targetPageNavigationState":[]}],["$","$Lc",null,{"variant":"h4","children":["$","strong",null,{"children":"Not Found"}]}],["$","$Lc",null,{"variant":"h6","mb":3,"children":"Oops! It looks like the page you're looking for does not exist."}],["$","$Ld",null,{"href":"/","children":["$","$Le",null,{"variant":"contained","sx":{"marginRight":5,"marginBottom":1},"children":"Take me Home"}]}]]}],"notFoundStyles":[],"styles":null}],["$","$Lf",null,{}]]}]]}]}]}],null],null],[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/1d4d01086947be98.css","precedence":"next","crossOrigin":"$undefined"}]],"$L10"]]]]
10:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","1",{"charSet":"utf-8"}],["$","link","2",{"rel":"icon","href":"/favicon.ico","type":"image/x-icon","sizes":"16x16"}]]
1:null
11:I[3507,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],""]
13:I[4204,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],"default"]
14:I[1847,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],"default"]
15:I[8125,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],""]
16:I[3578,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],"default"]
17:I[7005,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],""]
18:I[6480,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],"default"]
19:T64c,const fs = require("fs").promises;
const path = require("path");

const express = require("express");
const multer = require("multer");
const ort = require("onnxruntime-node");

const { modelsDir } = require("./config");
const { loadImageAsUint8Array, imageArrayToTensor } = require("./imageProcessing");
const { softmax, indexMax } = require("./mathUtils");

const PORT = process.env.PORT || 8000;

// const modelPath = path.join(modelsDir, "trainingId", "model.onnx")
const modelPath = path.join(modelsDir, "torch---2024-04-23-08-25-15", "model.onnx");

const app = express();
const multipartMiddleware = multer({ dest: "cache/" });

async function startServer() {
  const ortSession = await ort.InferenceSession.create(modelPath);

  app.post("/api/run-inference", multipartMiddleware.single("file"), async (req, res) => {
    if (!req.file) {
      return res.status(400).send("No file uploaded.");
    }

    const imagePath = req.file.path;

    const imageArr = await loadImageAsUint8Array(imagePath);
    const imageTensor = imageArrayToTensor(imageArr);

    const feeds = {
      [ortSession.inputNames[0]]: imageTensor,
    };

    const outputData = await ortSession.run(feeds);
    const output = outputData[ortSession.outputNames[0]];

    const outputSoftmax = softmax(Array.prototype.slice.call(output.data));
    const outputClass = indexMax(outputSoftmax);

    await fs.unlink(imagePath);

    res.status(200);
    res.send({
      predicted_label: outputClass,
    });
  });

  app.listen(PORT, () => {
    console.log(`Server is running on http://localhost:${PORT}`);
  });
}

startServer();2:["$","$La",null,{"mb":5,"pb":2,"sx":{"width":"100%","display":"flex","flexDirection":"column","justifyContent":"flex-start","alignItems":"flex-start"},"children":[["$","$Lb",null,{"render":true,"targetSiteNavigationState":[{"absoluteSlug":"/ml-ops","title":"ML Ops"},{"absoluteSlug":"/ml-ops/node-express-onnx-backend","title":"Express.js API for Inference using an ONNX Model"}],"targetPageNavigationState":[{"title":"Server Setup","absoluteSlug":"#server-setup"},{"title":"Config","absoluteSlug":"#config"},{"title":"ORT Session and Server Initialization","absoluteSlug":"#ort-session-and-server-initialization"},{"title":"Math Utils","absoluteSlug":"#math-utils"},{"title":"Image Processing","absoluteSlug":"#image-processing"},{"title":"Input Shape","absoluteSlug":"#input-shape"},{"title":"Inference","absoluteSlug":"#inference"},{"title":"Conclusion","absoluteSlug":"#conclusion"}]}],["$","$L11",null,{"container":true,"spacing":2,"mb":0,"children":[["$","$L11",null,{"item":true,"xs":12,"sm":12,"md":4,"sx":{"background":"linear-gradient(to right, #eeeeee, #ffffff)","borderRadius":5},"children":["$","$La",null,{"sx":{"width":"100%","height":"100%","display":"flex","flexDirection":"column","justifyContent":"center","alignItems":"flex-start","paddingBottom":2},"children":[["$","$Lc",null,{"gutterBottom":true,"variant":"h5","component":"h1","children":"Express.js API for Inference using an ONNX Model"}],["$","$Lc",null,{"gutterBottom":true,"variant":"p","component":"p","mb":4,"children":"Deploying an ONNX Model using Express.js."}],["$","$La",null,{"sx":{"width":"100%","display":"flex","flexDirection":"row","justifyContent":"space-between","alignItems":"center","marginBottom":2},"children":[["$","$Lc",null,{"gutterBottom":true,"variant":"p","component":"p","children":"July 17, 2024"}],["$","$Lc",null,{"gutterBottom":true,"variant":"p","component":"p","children":["08m"," Read"]}]]}],"$L12",false]}]}],["$","$L11",null,{"item":true,"xs":12,"sm":12,"md":8,"children":["$","$La",null,{"sx":{"flex":1,"display":"flex","flexDirection":"column","justifyContent":"center","alignItems":"center","marginRight":2},"children":["$","img",null,{"src":"/media/images/node-express-onnx-backend-thumbnail.jpg","style":{"width":"100%","maxWidth":"75vw","height":"auto","maxHeight":"35vh","objectFit":"cover"}}]}]}]]}],["$","$La",null,{"sx":{"width":"100%"},"children":["$","$L11",null,{"container":true,"spacing":2,"mt":4,"mb":0,"children":[["$","$L11",null,{"item":true,"xs":12,"sm":12,"md":4,"lg":3,"sx":{"background":"linear-gradient(to right, #eeeeee, #ffffff)","borderRadius":5},"children":["$","$La",null,{"sx":{"width":"100%"},"children":[["$","$La",null,{"sx":{"width":"100%","display":{"xs":"block","md":"none"},"marginBottom":2},"children":["$","$L13",null,{"sx":{"width":"100%","marginBottom":2,"boxShadow":3,"backgroundColor":"#ffffff22"},"disableGutters":true,"children":[["$","$L14",null,{"expandIcon":["$","$L15",null,{}],"children":["$","$Lc",null,{"variant":"h6","component":"h6","sx":{"margin":0,"padding":0},"children":"Table of Contents"}]}],["$","$L16",null,{"sx":{"width":"90%","display":"flex","flexDirection":"column","justifyContent":"flex-start","alignItems":"flex-start","marginBottom":2},"children":[["$","a","0",{"href":"#server-setup","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","0",{"variant":"p","component":"p","ml":0,"mb":2.5,"sx":{"&:hover":{"color":"blue"}},"children":"Server Setup"}]}],["$","a","1",{"href":"#config","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","1",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"Config"}]}],["$","a","2",{"href":"#ort-session-and-server-initialization","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","2",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"ORT Session and Server Initialization"}]}],["$","a","3",{"href":"#math-utils","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","3",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"Math Utils"}]}],["$","a","4",{"href":"#image-processing","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","4",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"Image Processing"}]}],["$","a","5",{"href":"#input-shape","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","5",{"variant":"p","component":"p","ml":2,"mb":1.5,"sx":{"&:hover":{"color":"blue"}},"children":"Input Shape"}]}],["$","a","6",{"href":"#inference","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","6",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"Inference"}]}],["$","a","7",{"href":"#conclusion","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","7",{"variant":"p","component":"p","ml":0,"mb":2.5,"sx":{"&:hover":{"color":"blue"}},"children":"Conclusion"}]}]]}]]}]}],["$","$La",null,{"sx":{"width":"100%","display":{"xs":"none","md":"block"}},"children":[["$","$Lc",null,{"variant":"h5","component":"h5","sx":{"margin":0,"padding":0},"children":"Table of Contents"}],[["$","a","0",{"href":"#server-setup","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","0",{"variant":"p","component":"p","ml":0,"mb":2.5,"sx":{"&:hover":{"color":"blue"}},"children":"Server Setup"}]}],["$","a","1",{"href":"#config","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","1",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"Config"}]}],["$","a","2",{"href":"#ort-session-and-server-initialization","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","2",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"ORT Session and Server Initialization"}]}],["$","a","3",{"href":"#math-utils","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","3",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"Math Utils"}]}],["$","a","4",{"href":"#image-processing","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","4",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"Image Processing"}]}],["$","a","5",{"href":"#input-shape","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","5",{"variant":"p","component":"p","ml":2,"mb":1.5,"sx":{"&:hover":{"color":"blue"}},"children":"Input Shape"}]}],["$","a","6",{"href":"#inference","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","6",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"Inference"}]}],["$","a","7",{"href":"#conclusion","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","7",{"variant":"p","component":"p","ml":0,"mb":2.5,"sx":{"&:hover":{"color":"blue"}},"children":"Conclusion"}]}]]]}]]}]}],["$","$L11",null,{"item":true,"xs":12,"sm":12,"md":8,"lg":9,"sx":{"background":"linear-gradient(to right, #ffffff, #eeeeee)","borderRadius":5},"children":["$","$La",null,{"sx":{"flex":1,"marginRight":2},"children":[["$","$Lc","0",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","In today's Article, we'll deploy the ",["$","$L17","0-link",{"href":"https://onnx.ai/","rel":"noopener noreferrer","target":"_blank","color":"primary","underline":"hover","children":"ONNX"}]," model we created (and exported) in ",["$","$L17","0-link",{"href":"/ml-ops/torch-training-and-conversion-to-onnx","color":"primary","underline":"hover","children":"a previous Post"}]," on an ",["$","$L17","0-link",{"href":"https://expressjs.com","rel":"noopener noreferrer","target":"_blank","color":"primary","underline":"hover","children":"Express.js"}]," server."]}],["$","$Lc","1",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","The GitHub repository for this codebase can be found ",["$","$L17","1-link",{"href":"https://github.com/AbhilakshSinghReen/drawn-digit-recognition/tree/main/backends/express-onnx","rel":"noopener noreferrer","target":"_blank","color":"primary","underline":"hover","children":"here"}],"."]}],["$","$Lc","2",{"id":"server-setup","variant":"h4","component":"h1","mb":2,"children":["$","strong",null,{"children":"Server Setup"}]}],["$","$Lc","3",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Let's create a new node project and install some dependencies."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"npm init -y\nnpm install express multer onnxruntime-node sharp"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-bash","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#7c00aa"},"children":["npm"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" init -y\n"]}],["$","span","code-segement2",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement3",{"className":"token","style":{"color":"#7c00aa"},"children":["npm"]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement5",{"className":"token","style":{"color":"#7c00aa"},"children":["install"]}],["$","span","code-segement6",{"className":"$undefined","style":{},"children":[" express multer onnxruntime-node sharp"]}]]]}]}]]}],["$","$Lc","5",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","",["$","$La","5-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"express"}]," is our web server, ",["$","$La","5-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"multer"}]," is for handling ",["$","$La","5-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"multipart/form-data"}],", ",["$","$La","5-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"onnxruntime-node"}]," allows us to run inference operations on ONNX models, and ",["$","$La","5-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"sharp"}]," is an image processing library for Node."]}],["$","$Lc","6",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Inside the project's root directory, create a new folder called ",["$","$La","6-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"src"}],". The final folder structure will look something like the following:"]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"│   package-lock.json\n│   package.json\n│\n├───models\n└───src\n        config.js\n        imageProcessing.js\n        mathUtils.js\n        server.js"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-bash","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"$undefined","style":{},"children":["│   package-lock.json\n"]}],"│   package.json\n","│\n","├───models\n","└───src\n","        config.js\n","        imageProcessing.js\n","        mathUtils.js\n","        server.js"]]}]}]]}],["$","$Lc","8",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Of course, we haven't created any of those files in the ",["$","$La","8-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"src"}]," folder yet."]}],["$","$Lc","9",{"id":"config","variant":"h5","component":"h2","mb":2,"children":["$","strong",null,{"children":"Config"}]}],["$","$Lc","10",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Create the file ",["$","$La","10-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"src/config.js"}],":"]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"const path = require('path');\n\nconst modelsDir = path.join(__dirname, '..', 'models');\n\nmodule.exports = {modelsDir}"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-javascript","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" path "]}],["$","span","code-segement2",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement4",{"className":"token","style":{"color":"#7c00aa"},"children":["require"]}],["$","span","code-segement5",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement6",{"className":"token","style":{"color":"#116b00"},"children":["'path'"]}],["$","span","code-segement7",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement8",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement9",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement11",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement12",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement13",{"className":"$undefined","style":{},"children":[" modelsDir "]}],["$","span","code-segement14",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":[" path"]}],["$","span","code-segement16",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement17",{"className":"token method","style":{"color":"#005a8e"},"children":["join"]}],["$","span","code-segement18",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement19",{"className":"$undefined","style":{},"children":["__dirname"]}],["$","span","code-segement20",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement21",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement22",{"className":"token","style":{"color":"#116b00"},"children":["'..'"]}],["$","span","code-segement23",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement24",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement25",{"className":"token","style":{"color":"#116b00"},"children":["'models'"]}],["$","span","code-segement26",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement27",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement28",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement30",{"className":"$undefined","style":{},"children":["module"]}],["$","span","code-segement31",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement32",{"className":"token","style":{"color":"#005a8e"},"children":["exports"]}],["$","span","code-segement33",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement34",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement35",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement36",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement37",{"className":"$undefined","style":{},"children":["modelsDir"]}],["$","span","code-segement38",{"className":"token","style":{"color":"#111b27"},"children":["}"]}]]]}]}]]}],["$","$Lc","12",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Here, we've just defined a variable to store the path to our ",["$","$La","12-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"models"}]," directory."]}],["$","$Lc","13",{"id":"ort-session-and-server-initialization","variant":"h5","component":"h2","mb":2,"children":["$","strong",null,{"children":"ORT Session and Server Initialization"}]}],["$","$Lc","14",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Next, in the ",["$","$La","14-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"src"}]," folder, create a file called ",["$","$La","14-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"server.js"}],"."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"const fs = require(\"fs\").promises;\nconst path = require(\"path\");\n\nconst express = require(\"express\");\nconst multer = require(\"multer\");\nconst ort = require(\"onnxruntime-node\");\n\nconst { modelsDir } = require(\"./config\");\n\nconst PORT = process.env.PORT || 8000;\n\n// const modelPath = path.join(modelsDir, \"trainingId\", \"model.onnx\")\nconst modelPath = path.join(modelsDir, \"torch---2024-04-23-08-25-15\", \"model.onnx\");\n\nconst app = express();\nconst multipartMiddleware = multer({ dest: \"cache/\" });\n\nasync function startServer() {\n  const ortSession = await ort.InferenceSession.create(modelPath);\n\n  app.post(\"/api/run-inference\", multipartMiddleware.single(\"file\"), async (req, res) => {\n    res.status(200);\n    res.send({\n      predicted_label: 0,\n    });\n  });\n\n  app.listen(PORT, () => {\n    console.log(`Server is running on http://localhost:${PORT}`);\n  });\n}\n\nstartServer();"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-javascript","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" fs "]}],["$","span","code-segement2",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement4",{"className":"token","style":{"color":"#7c00aa"},"children":["require"]}],["$","span","code-segement5",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement6",{"className":"token","style":{"color":"#116b00"},"children":["\"fs\""]}],["$","span","code-segement7",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement8",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement9",{"className":"token","style":{"color":"#005a8e"},"children":["promises"]}],["$","span","code-segement10",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement11",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement12",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement13",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement14",{"className":"$undefined","style":{},"children":[" path "]}],["$","span","code-segement15",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement16",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement17",{"className":"token","style":{"color":"#7c00aa"},"children":["require"]}],["$","span","code-segement18",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement19",{"className":"token","style":{"color":"#116b00"},"children":["\"path\""]}],["$","span","code-segement20",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement21",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement22",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement24",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement25",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":[" express "]}],["$","span","code-segement27",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement28",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement29",{"className":"token","style":{"color":"#7c00aa"},"children":["require"]}],["$","span","code-segement30",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement31",{"className":"token","style":{"color":"#116b00"},"children":["\"express\""]}],["$","span","code-segement32",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement33",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement34",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement35",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement36",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement37",{"className":"$undefined","style":{},"children":[" multer "]}],["$","span","code-segement38",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement39",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement40",{"className":"token","style":{"color":"#7c00aa"},"children":["require"]}],["$","span","code-segement41",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement42",{"className":"token","style":{"color":"#116b00"},"children":["\"multer\""]}],["$","span","code-segement43",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement44",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement45",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement46",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement47",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement48",{"className":"$undefined","style":{},"children":[" ort "]}],["$","span","code-segement49",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement50",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement51",{"className":"token","style":{"color":"#7c00aa"},"children":["require"]}],["$","span","code-segement52",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement53",{"className":"token","style":{"color":"#116b00"},"children":["\"onnxruntime-node\""]}],["$","span","code-segement54",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement55",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement56",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement58",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement59",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement60",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement61",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement62",{"className":"$undefined","style":{},"children":[" modelsDir "]}],["$","span","code-segement63",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement64",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement65",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement66",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement67",{"className":"token","style":{"color":"#7c00aa"},"children":["require"]}],["$","span","code-segement68",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement69",{"className":"token","style":{"color":"#116b00"},"children":["\"./config\""]}],["$","span","code-segement70",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement71",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement72",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement74",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement75",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement76",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement77",{"className":"token","style":{"color":"#755f00"},"children":["PORT"]}],["$","span","code-segement78",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement79",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement80",{"className":"$undefined","style":{},"children":[" process"]}],["$","span","code-segement81",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement82",{"className":"token","style":{"color":"#005a8e"},"children":["env"]}],["$","span","code-segement83",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement84",{"className":"token","style":{"color":"#755f00"},"children":["PORT"]}],["$","span","code-segement85",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement86",{"className":"token","style":{"color":"#a04900"},"children":["||"]}],["$","span","code-segement87",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement88",{"className":"token","style":{"color":"#755f00"},"children":["8000"]}],["$","span","code-segement89",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement90",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement92",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement93",{"className":"token","style":{"color":"#3c526d"},"children":["// const modelPath = path.join(modelsDir, \"trainingId\", \"model.onnx\")"]}],["$","span","code-segement94",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement95",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement96",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement97",{"className":"$undefined","style":{},"children":[" modelPath "]}],["$","span","code-segement98",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement99",{"className":"$undefined","style":{},"children":[" path"]}],["$","span","code-segement100",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement101",{"className":"token method","style":{"color":"#005a8e"},"children":["join"]}],["$","span","code-segement102",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement103",{"className":"$undefined","style":{},"children":["modelsDir"]}],["$","span","code-segement104",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement105",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement106",{"className":"token","style":{"color":"#116b00"},"children":["\"torch---2024-04-23-08-25-15\""]}],["$","span","code-segement107",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement108",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement109",{"className":"token","style":{"color":"#116b00"},"children":["\"model.onnx\""]}],["$","span","code-segement110",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement111",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement112",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement114",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement115",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement116",{"className":"$undefined","style":{},"children":[" app "]}],["$","span","code-segement117",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement118",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement119",{"className":"token","style":{"color":"#7c00aa"},"children":["express"]}],["$","span","code-segement120",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement121",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement122",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement123",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement124",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement125",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement126",{"className":"$undefined","style":{},"children":[" multipartMiddleware "]}],["$","span","code-segement127",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement128",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement129",{"className":"token","style":{"color":"#7c00aa"},"children":["multer"]}],["$","span","code-segement130",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement131",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement132",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement133",{"className":"token literal-property","style":{"color":"#005a8e"},"children":["dest"]}],["$","span","code-segement134",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement135",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement136",{"className":"token","style":{"color":"#116b00"},"children":["\"cache/\""]}],["$","span","code-segement137",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement138",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement139",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement140",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement141",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement143",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement144",{"className":"token","style":{"color":"#a04900"},"children":["async"]}],["$","span","code-segement145",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement146",{"className":"token","style":{"color":"#a04900"},"children":["function"]}],["$","span","code-segement147",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement148",{"className":"token","style":{"color":"#7c00aa"},"children":["startServer"]}],["$","span","code-segement149",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement150",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement151",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement152",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement153",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement154",{"className":"$undefined","style":{},"children":["  "]}],["$","span","code-segement155",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement156",{"className":"$undefined","style":{},"children":[" ortSession "]}],["$","span","code-segement157",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement158",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement159",{"className":"token control-flow","style":{"color":"#a04900"},"children":["await"]}],["$","span","code-segement160",{"className":"$undefined","style":{},"children":[" ort"]}],["$","span","code-segement161",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement162",{"className":"token maybe-class-name","style":{"color":"#005a8e"},"children":["InferenceSession"]}],["$","span","code-segement163",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement164",{"className":"token method","style":{"color":"#005a8e"},"children":["create"]}],["$","span","code-segement165",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement166",{"className":"$undefined","style":{},"children":["modelPath"]}],["$","span","code-segement167",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement168",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement169",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement171",{"className":"$undefined","style":{},"children":["  app"]}],["$","span","code-segement172",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement173",{"className":"token method","style":{"color":"#005a8e"},"children":["post"]}],["$","span","code-segement174",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement175",{"className":"token","style":{"color":"#116b00"},"children":["\"/api/run-inference\""]}],["$","span","code-segement176",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement177",{"className":"$undefined","style":{},"children":[" multipartMiddleware"]}],["$","span","code-segement178",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement179",{"className":"token method","style":{"color":"#005a8e"},"children":["single"]}],["$","span","code-segement180",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement181",{"className":"token","style":{"color":"#116b00"},"children":["\"file\""]}],["$","span","code-segement182",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement183",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement184",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement185",{"className":"token","style":{"color":"#a04900"},"children":["async"]}],["$","span","code-segement186",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement187",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement188",{"className":"token","style":{"color":"#005a8e"},"children":["req"]}],["$","span","code-segement189",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement190",{"className":"token","style":{"color":"#005a8e"},"children":[" res"]}],["$","span","code-segement191",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement192",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement193",{"className":"token arrow","style":{"color":"#a04900"},"children":["=>"]}],["$","span","code-segement194",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement195",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement196",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement197",{"className":"$undefined","style":{},"children":["    res"]}],["$","span","code-segement198",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement199",{"className":"token method","style":{"color":"#005a8e"},"children":["status"]}],["$","span","code-segement200",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement201",{"className":"token","style":{"color":"#755f00"},"children":["200"]}],["$","span","code-segement202",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement203",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement204",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement205",{"className":"$undefined","style":{},"children":["    res"]}],["$","span","code-segement206",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement207",{"className":"token method","style":{"color":"#005a8e"},"children":["send"]}],["$","span","code-segement208",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement209",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement210",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement211",{"className":"$undefined","style":{},"children":["      "]}],["$","span","code-segement212",{"className":"token literal-property","style":{"color":"#005a8e"},"children":["predicted_label"]}],["$","span","code-segement213",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement214",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement215",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement216",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement217",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement218",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement219",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement220",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement221",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement222",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement223",{"className":"$undefined","style":{},"children":["  "]}],["$","span","code-segement224",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement225",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement226",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement227",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement229",{"className":"$undefined","style":{},"children":["  app"]}],["$","span","code-segement230",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement231",{"className":"token method","style":{"color":"#005a8e"},"children":["listen"]}],["$","span","code-segement232",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement233",{"className":"token","style":{"color":"#755f00"},"children":["PORT"]}],["$","span","code-segement234",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement235",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement236",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement237",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement238",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement239",{"className":"token arrow","style":{"color":"#a04900"},"children":["=>"]}],["$","span","code-segement240",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement241",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement242",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement243",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement244",{"className":"token console","style":{"color":"#005a8e"},"children":["console"]}],["$","span","code-segement245",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement246",{"className":"token method","style":{"color":"#005a8e"},"children":["log"]}],["$","span","code-segement247",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement248",{"className":"token template-string template-punctuation","style":{"color":"#116b00"},"children":["`"]}],["$","span","code-segement249",{"className":"token template-string","style":{"color":"#116b00"},"children":["Server is running on http://localhost:"]}],["$","span","code-segement250",{"className":"token template-string interpolation interpolation-punctuation","style":{"color":"#111b27"},"children":["$${"]}],["$","span","code-segement251",{"className":"token template-string interpolation","style":{"color":"#755f00"},"children":["PORT"]}],["$","span","code-segement252",{"className":"token template-string interpolation interpolation-punctuation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement253",{"className":"token template-string template-punctuation","style":{"color":"#116b00"},"children":["`"]}],["$","span","code-segement254",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement255",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement256",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement257",{"className":"$undefined","style":{},"children":["  "]}],["$","span","code-segement258",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement259",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement260",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement261",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement262",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement263",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement264",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement266",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement267",{"className":"token","style":{"color":"#7c00aa"},"children":["startServer"]}],["$","span","code-segement268",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement269",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement270",{"className":"token","style":{"color":"#111b27"},"children":[";"]}]]]}]}]]}],["$","$Lc","16",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","We have to create an async function to create the ",["$","$La","16-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"InferenceSession"}]," because that is an async operation that needs to be awaited and Node does not support top-level await. After that, we define our inference endpoint and set the server to listen at the specified port."]}],["$","$Lc","17",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Before we can move on with writing our inference logic, we'll need some helper functions to preprocess our image and postprocess the model's output."]}],["$","$Lc","18",{"id":"math-utils","variant":"h5","component":"h2","mb":2,"children":["$","strong",null,{"children":"Math Utils"}]}],["$","$Lc","19",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Let's work on the ",["$","$La","19-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"src/mathUtils.js"}]," file next."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"function softmax(resultArray) {\n  const largestNumber = Math.max(...resultArray);\n\n  const sumOfExp = resultArray\n    .map((resultItem) => Math.exp(resultItem - largestNumber))\n    .reduce((prevNumber, currentNumber) => prevNumber + currentNumber);\n\n  return resultArray.map((resultValue, index) => {\n    return Math.exp(resultValue - largestNumber) / sumOfExp;\n  });\n}\n\nfunction indexMax(arr) {\n  if (arr.length === 0) {\n    return -1;\n  }\n\n  let max = arr[0];\n  let maxIndex = 0;\n\n  for (let i = 1; i < arr.length; i++) {\n    if (arr[i] > max) {\n      maxIndex = i;\n      max = arr[i];\n    }\n  }\n\n  return maxIndex;\n}\n\nmodule.exports = { softmax, indexMax };"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-javascript","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["function"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement2",{"className":"token","style":{"color":"#7c00aa"},"children":["softmax"]}],["$","span","code-segement3",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement4",{"className":"token","style":{"color":"#005a8e"},"children":["resultArray"]}],["$","span","code-segement5",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement6",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement7",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement9",{"className":"$undefined","style":{},"children":["  "]}],["$","span","code-segement10",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement11",{"className":"$undefined","style":{},"children":[" largestNumber "]}],["$","span","code-segement12",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement13",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement14",{"className":"token known-class-name","style":{"color":"#005a8e"},"children":["Math"]}],["$","span","code-segement15",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement16",{"className":"token method","style":{"color":"#005a8e"},"children":["max"]}],["$","span","code-segement17",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement18",{"className":"token spread","style":{"color":"#a04900"},"children":["..."]}],["$","span","code-segement19",{"className":"$undefined","style":{},"children":["resultArray"]}],["$","span","code-segement20",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement21",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement22",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement24",{"className":"$undefined","style":{},"children":["  "]}],["$","span","code-segement25",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":[" sumOfExp "]}],["$","span","code-segement27",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement28",{"className":"$undefined","style":{},"children":[" resultArray\n"]}],["$","span","code-segement29",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement30",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement31",{"className":"token method","style":{"color":"#005a8e"},"children":["map"]}],["$","span","code-segement32",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement33",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement34",{"className":"token","style":{"color":"#005a8e"},"children":["resultItem"]}],["$","span","code-segement35",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement36",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement37",{"className":"token arrow","style":{"color":"#a04900"},"children":["=>"]}],["$","span","code-segement38",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement39",{"className":"token known-class-name","style":{"color":"#005a8e"},"children":["Math"]}],["$","span","code-segement40",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement41",{"className":"token method","style":{"color":"#005a8e"},"children":["exp"]}],["$","span","code-segement42",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement43",{"className":"$undefined","style":{},"children":["resultItem "]}],["$","span","code-segement44",{"className":"token","style":{"color":"#a04900"},"children":["-"]}],["$","span","code-segement45",{"className":"$undefined","style":{},"children":[" largestNumber"]}],["$","span","code-segement46",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement47",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement48",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement49",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement50",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement51",{"className":"token method","style":{"color":"#005a8e"},"children":["reduce"]}],["$","span","code-segement52",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement53",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement54",{"className":"token","style":{"color":"#005a8e"},"children":["prevNumber"]}],["$","span","code-segement55",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement56",{"className":"token","style":{"color":"#005a8e"},"children":[" currentNumber"]}],["$","span","code-segement57",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement58",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement59",{"className":"token arrow","style":{"color":"#a04900"},"children":["=>"]}],["$","span","code-segement60",{"className":"$undefined","style":{},"children":[" prevNumber "]}],["$","span","code-segement61",{"className":"token","style":{"color":"#a04900"},"children":["+"]}],["$","span","code-segement62",{"className":"$undefined","style":{},"children":[" currentNumber"]}],["$","span","code-segement63",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement64",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement65",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement67",{"className":"$undefined","style":{},"children":["  "]}],["$","span","code-segement68",{"className":"token control-flow","style":{"color":"#a04900"},"children":["return"]}],["$","span","code-segement69",{"className":"$undefined","style":{},"children":[" resultArray"]}],["$","span","code-segement70",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement71",{"className":"token method","style":{"color":"#005a8e"},"children":["map"]}],["$","span","code-segement72",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement73",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement74",{"className":"token","style":{"color":"#005a8e"},"children":["resultValue"]}],["$","span","code-segement75",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement76",{"className":"token","style":{"color":"#005a8e"},"children":[" index"]}],["$","span","code-segement77",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement78",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement79",{"className":"token arrow","style":{"color":"#a04900"},"children":["=>"]}],["$","span","code-segement80",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement81",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement82",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement83",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement84",{"className":"token control-flow","style":{"color":"#a04900"},"children":["return"]}],["$","span","code-segement85",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement86",{"className":"token known-class-name","style":{"color":"#005a8e"},"children":["Math"]}],["$","span","code-segement87",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement88",{"className":"token method","style":{"color":"#005a8e"},"children":["exp"]}],["$","span","code-segement89",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement90",{"className":"$undefined","style":{},"children":["resultValue "]}],["$","span","code-segement91",{"className":"token","style":{"color":"#a04900"},"children":["-"]}],["$","span","code-segement92",{"className":"$undefined","style":{},"children":[" largestNumber"]}],["$","span","code-segement93",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement94",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement95",{"className":"token","style":{"color":"#a04900"},"children":["/"]}],["$","span","code-segement96",{"className":"$undefined","style":{},"children":[" sumOfExp"]}],["$","span","code-segement97",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement98",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement99",{"className":"$undefined","style":{},"children":["  "]}],["$","span","code-segement100",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement101",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement102",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement103",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement104",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement105",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement106",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement108",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement109",{"className":"token","style":{"color":"#a04900"},"children":["function"]}],["$","span","code-segement110",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement111",{"className":"token","style":{"color":"#7c00aa"},"children":["indexMax"]}],["$","span","code-segement112",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement113",{"className":"token","style":{"color":"#005a8e"},"children":["arr"]}],["$","span","code-segement114",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement115",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement116",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement117",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement118",{"className":"$undefined","style":{},"children":["  "]}],["$","span","code-segement119",{"className":"token control-flow","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement120",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement121",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement122",{"className":"$undefined","style":{},"children":["arr"]}],["$","span","code-segement123",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement124",{"className":"token","style":{"color":"#005a8e"},"children":["length"]}],["$","span","code-segement125",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement126",{"className":"token","style":{"color":"#a04900"},"children":["==="]}],["$","span","code-segement127",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement128",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement129",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement130",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement131",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement132",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement133",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement134",{"className":"token control-flow","style":{"color":"#a04900"},"children":["return"]}],["$","span","code-segement135",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement136",{"className":"token","style":{"color":"#a04900"},"children":["-"]}],["$","span","code-segement137",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement138",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement139",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement140",{"className":"$undefined","style":{},"children":["  "]}],["$","span","code-segement141",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement142",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement144",{"className":"$undefined","style":{},"children":["  "]}],["$","span","code-segement145",{"className":"token","style":{"color":"#a04900"},"children":["let"]}],["$","span","code-segement146",{"className":"$undefined","style":{},"children":[" max "]}],["$","span","code-segement147",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement148",{"className":"$undefined","style":{},"children":[" arr"]}],["$","span","code-segement149",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement150",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement151",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement152",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement153",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement154",{"className":"$undefined","style":{},"children":["  "]}],["$","span","code-segement155",{"className":"token","style":{"color":"#a04900"},"children":["let"]}],["$","span","code-segement156",{"className":"$undefined","style":{},"children":[" maxIndex "]}],["$","span","code-segement157",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement158",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement159",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement160",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement161",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement163",{"className":"$undefined","style":{},"children":["  "]}],["$","span","code-segement164",{"className":"token control-flow","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement165",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement166",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement167",{"className":"token","style":{"color":"#a04900"},"children":["let"]}],["$","span","code-segement168",{"className":"$undefined","style":{},"children":[" i "]}],["$","span","code-segement169",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement170",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement171",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement172",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement173",{"className":"$undefined","style":{},"children":[" i "]}],["$","span","code-segement174",{"className":"token","style":{"color":"#a04900"},"children":["<"]}],["$","span","code-segement175",{"className":"$undefined","style":{},"children":[" arr"]}],["$","span","code-segement176",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement177",{"className":"token","style":{"color":"#005a8e"},"children":["length"]}],["$","span","code-segement178",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement179",{"className":"$undefined","style":{},"children":[" i"]}],["$","span","code-segement180",{"className":"token","style":{"color":"#a04900"},"children":["++"]}],["$","span","code-segement181",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement182",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement183",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement184",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement185",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement186",{"className":"token control-flow","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement187",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement188",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement189",{"className":"$undefined","style":{},"children":["arr"]}],["$","span","code-segement190",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement191",{"className":"$undefined","style":{},"children":["i"]}],["$","span","code-segement192",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement193",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement194",{"className":"token","style":{"color":"#a04900"},"children":[">"]}],["$","span","code-segement195",{"className":"$undefined","style":{},"children":[" max"]}],["$","span","code-segement196",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement197",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement198",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement199",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement200",{"className":"$undefined","style":{},"children":["      maxIndex "]}],["$","span","code-segement201",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement202",{"className":"$undefined","style":{},"children":[" i"]}],["$","span","code-segement203",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement204",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement205",{"className":"$undefined","style":{},"children":["      max "]}],["$","span","code-segement206",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement207",{"className":"$undefined","style":{},"children":[" arr"]}],["$","span","code-segement208",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement209",{"className":"$undefined","style":{},"children":["i"]}],["$","span","code-segement210",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement211",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement212",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement213",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement214",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement215",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement216",{"className":"$undefined","style":{},"children":["  "]}],["$","span","code-segement217",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement218",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement220",{"className":"$undefined","style":{},"children":["  "]}],["$","span","code-segement221",{"className":"token control-flow","style":{"color":"#a04900"},"children":["return"]}],["$","span","code-segement222",{"className":"$undefined","style":{},"children":[" maxIndex"]}],["$","span","code-segement223",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement224",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement225",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement226",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement227",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement229",{"className":"$undefined","style":{},"children":["module"]}],["$","span","code-segement230",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement231",{"className":"token","style":{"color":"#005a8e"},"children":["exports"]}],["$","span","code-segement232",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement233",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement234",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement235",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement236",{"className":"$undefined","style":{},"children":[" softmax"]}],["$","span","code-segement237",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement238",{"className":"$undefined","style":{},"children":[" indexMax "]}],["$","span","code-segement239",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement240",{"className":"token","style":{"color":"#111b27"},"children":[";"]}]]]}]}]]}],["$","$Lc","21",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","We have a function called ",["$","$La","21-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"softmax"}]," that serves as a replacement for ",["$","$L17","21-link",{"href":"https://pytorch.org/docs/stable/generated/torch.nn.Softmax.html","rel":"noopener noreferrer","target":"_blank","color":"primary","underline":"hover","children":"torch.nn.Softmax"}]," and another function that's a DIY equivalent of ",["$","$L17","21-link",{"href":"https://numpy.org/doc/stable/reference/generated/numpy.argmax.html","rel":"noopener noreferrer","target":"_blank","color":"primary","underline":"hover","children":"numpy.argmax"}],"."]}],["$","$Lc","22",{"id":"image-processing","variant":"h5","component":"h2","mb":2,"children":["$","strong",null,{"children":"Image Processing"}]}],["$","$Lc","23",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","In the ",["$","$La","23-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"src"}]," directory, create a file called ",["$","$La","23-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"imageProcessing.js"}],"."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"const ort = require(\"onnxruntime-node\");\nconst sharp = require(\"sharp\");\n\nconst inputImageShape = [28, 28];\nconst inputShape = [1, 1, 28, 28];\n\nasync function loadImageAsUint8Array(imagePath) {\n  const image = sharp(imagePath).resize(inputImageShape[0], inputImageShape[1]).greyscale();\n  const rawImage = image.raw();\n  const imageBuffer = await rawImage.toBuffer();\n\n  const imageUint8Array = new Uint8Array(imageBuffer);\n  return imageUint8Array;\n}\n\nfunction imageArrayToTensor(imageUint8Array) {\n  let tensorValues = new Float32Array(imageUint8Array.length);\n\n  for (let i = 0; i < imageUint8Array.length; i++) {\n    tensorValues[i] = imageUint8Array[i] / 255;\n  }\n\n  const imageTensor = new ort.Tensor(\"float32\", tensorValues, inputShape);\n  return imageTensor;\n}\n\nmodule.exports = { loadImageAsUint8Array, imageArrayToTensor };"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-javascript","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" ort "]}],["$","span","code-segement2",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement4",{"className":"token","style":{"color":"#7c00aa"},"children":["require"]}],["$","span","code-segement5",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement6",{"className":"token","style":{"color":"#116b00"},"children":["\"onnxruntime-node\""]}],["$","span","code-segement7",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement8",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement9",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement11",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement12",{"className":"$undefined","style":{},"children":[" sharp "]}],["$","span","code-segement13",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement14",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement15",{"className":"token","style":{"color":"#7c00aa"},"children":["require"]}],["$","span","code-segement16",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement17",{"className":"token","style":{"color":"#116b00"},"children":["\"sharp\""]}],["$","span","code-segement18",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement19",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement20",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement22",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement23",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement24",{"className":"$undefined","style":{},"children":[" inputImageShape "]}],["$","span","code-segement25",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement27",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement28",{"className":"token","style":{"color":"#755f00"},"children":["28"]}],["$","span","code-segement29",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement30",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement31",{"className":"token","style":{"color":"#755f00"},"children":["28"]}],["$","span","code-segement32",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement33",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement34",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement35",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement36",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement37",{"className":"$undefined","style":{},"children":[" inputShape "]}],["$","span","code-segement38",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement39",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement40",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement41",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement42",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement43",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement44",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement45",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement46",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement47",{"className":"token","style":{"color":"#755f00"},"children":["28"]}],["$","span","code-segement48",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement49",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement50",{"className":"token","style":{"color":"#755f00"},"children":["28"]}],["$","span","code-segement51",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement52",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement53",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement55",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement56",{"className":"token","style":{"color":"#a04900"},"children":["async"]}],["$","span","code-segement57",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement58",{"className":"token","style":{"color":"#a04900"},"children":["function"]}],["$","span","code-segement59",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement60",{"className":"token","style":{"color":"#7c00aa"},"children":["loadImageAsUint8Array"]}],["$","span","code-segement61",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement62",{"className":"token","style":{"color":"#005a8e"},"children":["imagePath"]}],["$","span","code-segement63",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement64",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement65",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement66",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement67",{"className":"$undefined","style":{},"children":["  "]}],["$","span","code-segement68",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement69",{"className":"$undefined","style":{},"children":[" image "]}],["$","span","code-segement70",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement71",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement72",{"className":"token","style":{"color":"#7c00aa"},"children":["sharp"]}],["$","span","code-segement73",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement74",{"className":"$undefined","style":{},"children":["imagePath"]}],["$","span","code-segement75",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement76",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement77",{"className":"token method","style":{"color":"#005a8e"},"children":["resize"]}],["$","span","code-segement78",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement79",{"className":"$undefined","style":{},"children":["inputImageShape"]}],["$","span","code-segement80",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement81",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement82",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement83",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement84",{"className":"$undefined","style":{},"children":[" inputImageShape"]}],["$","span","code-segement85",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement86",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement87",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement88",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement89",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement90",{"className":"token method","style":{"color":"#005a8e"},"children":["greyscale"]}],["$","span","code-segement91",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement92",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement93",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement94",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement95",{"className":"$undefined","style":{},"children":["  "]}],["$","span","code-segement96",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement97",{"className":"$undefined","style":{},"children":[" rawImage "]}],["$","span","code-segement98",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement99",{"className":"$undefined","style":{},"children":[" image"]}],["$","span","code-segement100",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement101",{"className":"token method","style":{"color":"#005a8e"},"children":["raw"]}],["$","span","code-segement102",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement103",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement104",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement105",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement106",{"className":"$undefined","style":{},"children":["  "]}],["$","span","code-segement107",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement108",{"className":"$undefined","style":{},"children":[" imageBuffer "]}],["$","span","code-segement109",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement110",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement111",{"className":"token control-flow","style":{"color":"#a04900"},"children":["await"]}],["$","span","code-segement112",{"className":"$undefined","style":{},"children":[" rawImage"]}],["$","span","code-segement113",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement114",{"className":"token method","style":{"color":"#005a8e"},"children":["toBuffer"]}],["$","span","code-segement115",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement116",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement117",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement118",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement120",{"className":"$undefined","style":{},"children":["  "]}],["$","span","code-segement121",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement122",{"className":"$undefined","style":{},"children":[" imageUint8Array "]}],["$","span","code-segement123",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement124",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement125",{"className":"token","style":{"color":"#a04900"},"children":["new"]}],["$","span","code-segement126",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement127",{"className":"token","style":{"color":"#005a8e"},"children":["Uint8Array"]}],["$","span","code-segement128",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement129",{"className":"$undefined","style":{},"children":["imageBuffer"]}],["$","span","code-segement130",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement131",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement132",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement133",{"className":"$undefined","style":{},"children":["  "]}],["$","span","code-segement134",{"className":"token control-flow","style":{"color":"#a04900"},"children":["return"]}],["$","span","code-segement135",{"className":"$undefined","style":{},"children":[" imageUint8Array"]}],["$","span","code-segement136",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement137",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement138",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement139",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement140",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement142",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement143",{"className":"token","style":{"color":"#a04900"},"children":["function"]}],["$","span","code-segement144",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement145",{"className":"token","style":{"color":"#7c00aa"},"children":["imageArrayToTensor"]}],["$","span","code-segement146",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement147",{"className":"token","style":{"color":"#005a8e"},"children":["imageUint8Array"]}],["$","span","code-segement148",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement149",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement150",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement151",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement152",{"className":"$undefined","style":{},"children":["  "]}],["$","span","code-segement153",{"className":"token","style":{"color":"#a04900"},"children":["let"]}],["$","span","code-segement154",{"className":"$undefined","style":{},"children":[" tensorValues "]}],["$","span","code-segement155",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement156",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement157",{"className":"token","style":{"color":"#a04900"},"children":["new"]}],["$","span","code-segement158",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement159",{"className":"token","style":{"color":"#005a8e"},"children":["Float32Array"]}],["$","span","code-segement160",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement161",{"className":"$undefined","style":{},"children":["imageUint8Array"]}],["$","span","code-segement162",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement163",{"className":"token","style":{"color":"#005a8e"},"children":["length"]}],["$","span","code-segement164",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement165",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement166",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement168",{"className":"$undefined","style":{},"children":["  "]}],["$","span","code-segement169",{"className":"token control-flow","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement170",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement171",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement172",{"className":"token","style":{"color":"#a04900"},"children":["let"]}],["$","span","code-segement173",{"className":"$undefined","style":{},"children":[" i "]}],["$","span","code-segement174",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement175",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement176",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement177",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement178",{"className":"$undefined","style":{},"children":[" i "]}],["$","span","code-segement179",{"className":"token","style":{"color":"#a04900"},"children":["<"]}],["$","span","code-segement180",{"className":"$undefined","style":{},"children":[" imageUint8Array"]}],["$","span","code-segement181",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement182",{"className":"token","style":{"color":"#005a8e"},"children":["length"]}],["$","span","code-segement183",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement184",{"className":"$undefined","style":{},"children":[" i"]}],["$","span","code-segement185",{"className":"token","style":{"color":"#a04900"},"children":["++"]}],["$","span","code-segement186",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement187",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement188",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement189",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement190",{"className":"$undefined","style":{},"children":["    tensorValues"]}],["$","span","code-segement191",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement192",{"className":"$undefined","style":{},"children":["i"]}],["$","span","code-segement193",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement194",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement195",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement196",{"className":"$undefined","style":{},"children":[" imageUint8Array"]}],["$","span","code-segement197",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement198",{"className":"$undefined","style":{},"children":["i"]}],["$","span","code-segement199",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement200",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement201",{"className":"token","style":{"color":"#a04900"},"children":["/"]}],["$","span","code-segement202",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement203",{"className":"token","style":{"color":"#755f00"},"children":["255"]}],["$","span","code-segement204",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement205",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement206",{"className":"$undefined","style":{},"children":["  "]}],["$","span","code-segement207",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement208",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement210",{"className":"$undefined","style":{},"children":["  "]}],["$","span","code-segement211",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement212",{"className":"$undefined","style":{},"children":[" imageTensor "]}],["$","span","code-segement213",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement214",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement215",{"className":"token","style":{"color":"#a04900"},"children":["new"]}],["$","span","code-segement216",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement217",{"className":"token","style":{"color":"#005a8e"},"children":["ort"]}],["$","span","code-segement218",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement219",{"className":"token","style":{"color":"#005a8e"},"children":["Tensor"]}],["$","span","code-segement220",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement221",{"className":"token","style":{"color":"#116b00"},"children":["\"float32\""]}],["$","span","code-segement222",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement223",{"className":"$undefined","style":{},"children":[" tensorValues"]}],["$","span","code-segement224",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement225",{"className":"$undefined","style":{},"children":[" inputShape"]}],["$","span","code-segement226",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement227",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement228",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement229",{"className":"$undefined","style":{},"children":["  "]}],["$","span","code-segement230",{"className":"token control-flow","style":{"color":"#a04900"},"children":["return"]}],["$","span","code-segement231",{"className":"$undefined","style":{},"children":[" imageTensor"]}],["$","span","code-segement232",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement233",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement234",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement235",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement236",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement238",{"className":"$undefined","style":{},"children":["module"]}],["$","span","code-segement239",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement240",{"className":"token","style":{"color":"#005a8e"},"children":["exports"]}],["$","span","code-segement241",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement242",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement243",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement244",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement245",{"className":"$undefined","style":{},"children":[" loadImageAsUint8Array"]}],["$","span","code-segement246",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement247",{"className":"$undefined","style":{},"children":[" imageArrayToTensor "]}],["$","span","code-segement248",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement249",{"className":"token","style":{"color":"#111b27"},"children":[";"]}]]]}]}]]}],["$","$Lc","25",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Here we have two helper functions. One loads an image from a path, resizes it to 28x28, makes it greyscale, and puts it into a Uint8 Array. The other function converts that array to a Tensor of ",["$","$La","25-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"inputShape"}],"."]}],["$","$Lc","26",{"id":"input-shape","variant":"h6","component":"h3","mb":2,"children":["$","strong",null,{"children":"Input Shape"}]}],["$","$Lc","27",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","But, how did we get the input shape? Well, since we trained the model ourselves, we kinda know what shape it's expecting the input to be in. But, what if we had to find out? To do so, we can use a tool like ",["$","$L17","27-link",{"href":"https://netron.app/","rel":"noopener noreferrer","target":"_blank","color":"primary","underline":"hover","children":"Netron"}]," to visualize our ONNX model. If we open up the model in Netron, we see that the input it wants in of the shape (1x1x28x28) and that's the shape we want our image tensor to be."]}],["$","$La","28",{"sx":{"width":"100%","display":"flex","flexDirection":"column","justifyContent":"center","alignItems":"center","marginBottom":2},"children":["$","img",null,{"src":"/media/images/torch-mnist-onnx-model-in-netron-start.jpg","style":{"width":"100%","maxWidth":"75vw","height":"auto","maxHeight":"35vh","objectFit":"cover"}}]}],["$","$Lc","29",{"id":"inference","variant":"h5","component":"h2","mb":2,"children":["$","strong",null,{"children":"Inference"}]}],["$","$Lc","30",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Let's head back to ",["$","$La","30-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"src/server.js"}],". First, we'll import the four functions we just created from their respective files."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"const { loadImageAsUint8Array, imageArrayToTensor } = require(\"./imageProcessing\");\nconst { softmax, indexMax } = require(\"./mathUtils\");"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-javascript","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement2",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":[" loadImageAsUint8Array"]}],["$","span","code-segement4",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement5",{"className":"$undefined","style":{},"children":[" imageArrayToTensor "]}],["$","span","code-segement6",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement7",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement8",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement9",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement10",{"className":"token","style":{"color":"#7c00aa"},"children":["require"]}],["$","span","code-segement11",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement12",{"className":"token","style":{"color":"#116b00"},"children":["\"./imageProcessing\""]}],["$","span","code-segement13",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement14",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement16",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement17",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement18",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement19",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement20",{"className":"$undefined","style":{},"children":[" softmax"]}],["$","span","code-segement21",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement22",{"className":"$undefined","style":{},"children":[" indexMax "]}],["$","span","code-segement23",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement24",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement25",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement27",{"className":"token","style":{"color":"#7c00aa"},"children":["require"]}],["$","span","code-segement28",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement29",{"className":"token","style":{"color":"#116b00"},"children":["\"./mathUtils\""]}],["$","span","code-segement30",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement31",{"className":"token","style":{"color":"#111b27"},"children":[";"]}]]]}]}]]}],["$","$Lc","32",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Now, in our route handler, we can write the inferencing logic."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"app.post(\"/api/run-inference\", multipartMiddleware.single(\"file\"), async (req, res) => {\nif (!req.file) {\n  return res.status(400).send(\"No file uploaded.\");\n}\n\nconst imagePath = req.file.path;\n\nconst imageArr = await loadImageAsUint8Array(imagePath);\nconst imageTensor = imageArrayToTensor(imageArr);\n\nconst feeds = {\n  [ortSession.inputNames[0]]: imageTensor,\n};\n\nconst outputData = await ortSession.run(feeds);\nconst output = outputData[ortSession.outputNames[0]];\n\nconst outputSoftmax = softmax(Array.prototype.slice.call(output.data));\nconst outputClass = indexMax(outputSoftmax);\n\nawait fs.unlink(imagePath);\n\nres.status(200);\nres.send({\n  predicted_label: outputClass,\n});\n});"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-javascript","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"$undefined","style":{},"children":["app"]}],["$","span","code-segement1",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement2",{"className":"token method","style":{"color":"#005a8e"},"children":["post"]}],["$","span","code-segement3",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement4",{"className":"token","style":{"color":"#116b00"},"children":["\"/api/run-inference\""]}],["$","span","code-segement5",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement6",{"className":"$undefined","style":{},"children":[" multipartMiddleware"]}],["$","span","code-segement7",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement8",{"className":"token method","style":{"color":"#005a8e"},"children":["single"]}],["$","span","code-segement9",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement10",{"className":"token","style":{"color":"#116b00"},"children":["\"file\""]}],["$","span","code-segement11",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement12",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement13",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement14",{"className":"token","style":{"color":"#a04900"},"children":["async"]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement16",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement17",{"className":"token","style":{"color":"#005a8e"},"children":["req"]}],["$","span","code-segement18",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement19",{"className":"token","style":{"color":"#005a8e"},"children":[" res"]}],["$","span","code-segement20",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement21",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement22",{"className":"token arrow","style":{"color":"#a04900"},"children":["=>"]}],["$","span","code-segement23",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement24",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement25",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement27",{"className":"token control-flow","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement28",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement29",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement30",{"className":"token","style":{"color":"#a04900"},"children":["!"]}],["$","span","code-segement31",{"className":"$undefined","style":{},"children":["req"]}],["$","span","code-segement32",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement33",{"className":"token","style":{"color":"#005a8e"},"children":["file"]}],["$","span","code-segement34",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement35",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement36",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement37",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement38",{"className":"$undefined","style":{},"children":["  "]}],["$","span","code-segement39",{"className":"token control-flow","style":{"color":"#a04900"},"children":["return"]}],["$","span","code-segement40",{"className":"$undefined","style":{},"children":[" res"]}],["$","span","code-segement41",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement42",{"className":"token method","style":{"color":"#005a8e"},"children":["status"]}],["$","span","code-segement43",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement44",{"className":"token","style":{"color":"#755f00"},"children":["400"]}],["$","span","code-segement45",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement46",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement47",{"className":"token method","style":{"color":"#005a8e"},"children":["send"]}],["$","span","code-segement48",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement49",{"className":"token","style":{"color":"#116b00"},"children":["\"No file uploaded.\""]}],["$","span","code-segement50",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement51",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement52",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement53",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement54",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement55",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement57",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement58",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement59",{"className":"$undefined","style":{},"children":[" imagePath "]}],["$","span","code-segement60",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement61",{"className":"$undefined","style":{},"children":[" req"]}],["$","span","code-segement62",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement63",{"className":"token","style":{"color":"#005a8e"},"children":["file"]}],["$","span","code-segement64",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement65",{"className":"token","style":{"color":"#005a8e"},"children":["path"]}],["$","span","code-segement66",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement67",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement69",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement70",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement71",{"className":"$undefined","style":{},"children":[" imageArr "]}],["$","span","code-segement72",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement73",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement74",{"className":"token control-flow","style":{"color":"#a04900"},"children":["await"]}],["$","span","code-segement75",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement76",{"className":"token","style":{"color":"#7c00aa"},"children":["loadImageAsUint8Array"]}],["$","span","code-segement77",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement78",{"className":"$undefined","style":{},"children":["imagePath"]}],["$","span","code-segement79",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement80",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement81",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement82",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement83",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement84",{"className":"$undefined","style":{},"children":[" imageTensor "]}],["$","span","code-segement85",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement86",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement87",{"className":"token","style":{"color":"#7c00aa"},"children":["imageArrayToTensor"]}],["$","span","code-segement88",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement89",{"className":"$undefined","style":{},"children":["imageArr"]}],["$","span","code-segement90",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement91",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement92",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement94",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement95",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement96",{"className":"$undefined","style":{},"children":[" feeds "]}],["$","span","code-segement97",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement98",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement99",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement100",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement101",{"className":"$undefined","style":{},"children":["  "]}],["$","span","code-segement102",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement103",{"className":"$undefined","style":{},"children":["ortSession"]}],["$","span","code-segement104",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement105",{"className":"token","style":{"color":"#005a8e"},"children":["inputNames"]}],["$","span","code-segement106",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement107",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement108",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement109",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement110",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement111",{"className":"$undefined","style":{},"children":[" imageTensor"]}],["$","span","code-segement112",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement113",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement114",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement115",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement116",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement117",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement119",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement120",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement121",{"className":"$undefined","style":{},"children":[" outputData "]}],["$","span","code-segement122",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement123",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement124",{"className":"token control-flow","style":{"color":"#a04900"},"children":["await"]}],["$","span","code-segement125",{"className":"$undefined","style":{},"children":[" ortSession"]}],["$","span","code-segement126",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement127",{"className":"token method","style":{"color":"#005a8e"},"children":["run"]}],["$","span","code-segement128",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement129",{"className":"$undefined","style":{},"children":["feeds"]}],["$","span","code-segement130",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement131",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement132",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement133",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement134",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement135",{"className":"$undefined","style":{},"children":[" output "]}],["$","span","code-segement136",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement137",{"className":"$undefined","style":{},"children":[" outputData"]}],["$","span","code-segement138",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement139",{"className":"$undefined","style":{},"children":["ortSession"]}],["$","span","code-segement140",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement141",{"className":"token","style":{"color":"#005a8e"},"children":["outputNames"]}],["$","span","code-segement142",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement143",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement144",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement145",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement146",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement147",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement149",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement150",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement151",{"className":"$undefined","style":{},"children":[" outputSoftmax "]}],["$","span","code-segement152",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement153",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement154",{"className":"token","style":{"color":"#7c00aa"},"children":["softmax"]}],["$","span","code-segement155",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement156",{"className":"token","style":{"color":"#005a8e"},"children":["Array"]}],["$","span","code-segement157",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement158",{"className":"token","style":{"color":"#005a8e"},"children":["prototype"]}],["$","span","code-segement159",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement160",{"className":"token method","style":{"color":"#005a8e"},"children":["slice"]}],["$","span","code-segement161",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement162",{"className":"token method","style":{"color":"#005a8e"},"children":["call"]}],["$","span","code-segement163",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement164",{"className":"$undefined","style":{},"children":["output"]}],["$","span","code-segement165",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement166",{"className":"token","style":{"color":"#005a8e"},"children":["data"]}],["$","span","code-segement167",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement168",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement169",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement170",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement171",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement172",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement173",{"className":"$undefined","style":{},"children":[" outputClass "]}],["$","span","code-segement174",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement175",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement176",{"className":"token","style":{"color":"#7c00aa"},"children":["indexMax"]}],["$","span","code-segement177",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement178",{"className":"$undefined","style":{},"children":["outputSoftmax"]}],["$","span","code-segement179",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement180",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement181",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement183",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement184",{"className":"token control-flow","style":{"color":"#a04900"},"children":["await"]}],["$","span","code-segement185",{"className":"$undefined","style":{},"children":[" fs"]}],["$","span","code-segement186",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement187",{"className":"token method","style":{"color":"#005a8e"},"children":["unlink"]}],["$","span","code-segement188",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement189",{"className":"$undefined","style":{},"children":["imagePath"]}],["$","span","code-segement190",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement191",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement192",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement194",{"className":"$undefined","style":{},"children":["res"]}],["$","span","code-segement195",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement196",{"className":"token method","style":{"color":"#005a8e"},"children":["status"]}],["$","span","code-segement197",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement198",{"className":"token","style":{"color":"#755f00"},"children":["200"]}],["$","span","code-segement199",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement200",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement201",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement202",{"className":"$undefined","style":{},"children":["res"]}],["$","span","code-segement203",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement204",{"className":"token method","style":{"color":"#005a8e"},"children":["send"]}],["$","span","code-segement205",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement206",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement207",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement208",{"className":"$undefined","style":{},"children":["  "]}],["$","span","code-segement209",{"className":"token literal-property","style":{"color":"#005a8e"},"children":["predicted_label"]}],["$","span","code-segement210",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement211",{"className":"$undefined","style":{},"children":[" outputClass"]}],["$","span","code-segement212",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement213",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement214",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement215",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement216",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement217",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement218",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement219",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement220",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement221",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement222",{"className":"token","style":{"color":"#111b27"},"children":[";"]}]]]}]}]]}],["$","$Lc","34",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","We load the image as a Uint8 Array and then convert it to a tensor. Then, we construct the ",["$","$La","34-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"feeds"}]," we'll pass to our session, the output of which first goes through our DIY softmax and then our DIY argmax. Since the output classes are only from 0-9, the output of the argmax is the prediction label. We delete the image from the cache folder and then return the prediction in a JSON response."]}],["$","$Lc","35",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Here's the entire ",["$","$La","35-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"server.js"}]," file."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"$19"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-javascript","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" fs "]}],["$","span","code-segement2",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement4",{"className":"token","style":{"color":"#7c00aa"},"children":["require"]}],["$","span","code-segement5",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement6",{"className":"token","style":{"color":"#116b00"},"children":["\"fs\""]}],["$","span","code-segement7",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement8",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement9",{"className":"token","style":{"color":"#005a8e"},"children":["promises"]}],["$","span","code-segement10",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement11",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement12",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement13",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement14",{"className":"$undefined","style":{},"children":[" path "]}],["$","span","code-segement15",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement16",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement17",{"className":"token","style":{"color":"#7c00aa"},"children":["require"]}],["$","span","code-segement18",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement19",{"className":"token","style":{"color":"#116b00"},"children":["\"path\""]}],["$","span","code-segement20",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement21",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement22",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement24",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement25",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":[" express "]}],["$","span","code-segement27",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement28",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement29",{"className":"token","style":{"color":"#7c00aa"},"children":["require"]}],["$","span","code-segement30",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement31",{"className":"token","style":{"color":"#116b00"},"children":["\"express\""]}],["$","span","code-segement32",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement33",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement34",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement35",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement36",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement37",{"className":"$undefined","style":{},"children":[" multer "]}],["$","span","code-segement38",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement39",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement40",{"className":"token","style":{"color":"#7c00aa"},"children":["require"]}],["$","span","code-segement41",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement42",{"className":"token","style":{"color":"#116b00"},"children":["\"multer\""]}],["$","span","code-segement43",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement44",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement45",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement46",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement47",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement48",{"className":"$undefined","style":{},"children":[" ort "]}],["$","span","code-segement49",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement50",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement51",{"className":"token","style":{"color":"#7c00aa"},"children":["require"]}],["$","span","code-segement52",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement53",{"className":"token","style":{"color":"#116b00"},"children":["\"onnxruntime-node\""]}],["$","span","code-segement54",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement55",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement56",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement58",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement59",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement60",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement61",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement62",{"className":"$undefined","style":{},"children":[" modelsDir "]}],["$","span","code-segement63",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement64",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement65",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement66",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement67",{"className":"token","style":{"color":"#7c00aa"},"children":["require"]}],["$","span","code-segement68",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement69",{"className":"token","style":{"color":"#116b00"},"children":["\"./config\""]}],["$","span","code-segement70",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement71",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement72",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement73",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement74",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement75",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement76",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement77",{"className":"$undefined","style":{},"children":[" loadImageAsUint8Array"]}],["$","span","code-segement78",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement79",{"className":"$undefined","style":{},"children":[" imageArrayToTensor "]}],["$","span","code-segement80",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement81",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement82",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement83",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement84",{"className":"token","style":{"color":"#7c00aa"},"children":["require"]}],["$","span","code-segement85",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement86",{"className":"token","style":{"color":"#116b00"},"children":["\"./imageProcessing\""]}],["$","span","code-segement87",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement88",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement89",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement90",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement91",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement92",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement93",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement94",{"className":"$undefined","style":{},"children":[" softmax"]}],["$","span","code-segement95",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement96",{"className":"$undefined","style":{},"children":[" indexMax "]}],["$","span","code-segement97",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement98",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement99",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement100",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement101",{"className":"token","style":{"color":"#7c00aa"},"children":["require"]}],["$","span","code-segement102",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement103",{"className":"token","style":{"color":"#116b00"},"children":["\"./mathUtils\""]}],["$","span","code-segement104",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement105",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement106",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement108",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement109",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement110",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement111",{"className":"token","style":{"color":"#755f00"},"children":["PORT"]}],["$","span","code-segement112",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement113",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement114",{"className":"$undefined","style":{},"children":[" process"]}],["$","span","code-segement115",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement116",{"className":"token","style":{"color":"#005a8e"},"children":["env"]}],["$","span","code-segement117",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement118",{"className":"token","style":{"color":"#755f00"},"children":["PORT"]}],["$","span","code-segement119",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement120",{"className":"token","style":{"color":"#a04900"},"children":["||"]}],["$","span","code-segement121",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement122",{"className":"token","style":{"color":"#755f00"},"children":["8000"]}],["$","span","code-segement123",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement124",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement126",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement127",{"className":"token","style":{"color":"#3c526d"},"children":["// const modelPath = path.join(modelsDir, \"trainingId\", \"model.onnx\")"]}],["$","span","code-segement128",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement129",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement130",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement131",{"className":"$undefined","style":{},"children":[" modelPath "]}],["$","span","code-segement132",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement133",{"className":"$undefined","style":{},"children":[" path"]}],["$","span","code-segement134",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement135",{"className":"token method","style":{"color":"#005a8e"},"children":["join"]}],["$","span","code-segement136",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement137",{"className":"$undefined","style":{},"children":["modelsDir"]}],["$","span","code-segement138",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement139",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement140",{"className":"token","style":{"color":"#116b00"},"children":["\"torch---2024-04-23-08-25-15\""]}],["$","span","code-segement141",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement142",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement143",{"className":"token","style":{"color":"#116b00"},"children":["\"model.onnx\""]}],["$","span","code-segement144",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement145",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement146",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement148",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement149",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement150",{"className":"$undefined","style":{},"children":[" app "]}],["$","span","code-segement151",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement152",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement153",{"className":"token","style":{"color":"#7c00aa"},"children":["express"]}],["$","span","code-segement154",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement155",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement156",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement157",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement158",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement159",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement160",{"className":"$undefined","style":{},"children":[" multipartMiddleware "]}],["$","span","code-segement161",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement162",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement163",{"className":"token","style":{"color":"#7c00aa"},"children":["multer"]}],["$","span","code-segement164",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement165",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement166",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement167",{"className":"token literal-property","style":{"color":"#005a8e"},"children":["dest"]}],["$","span","code-segement168",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement169",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement170",{"className":"token","style":{"color":"#116b00"},"children":["\"cache/\""]}],["$","span","code-segement171",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement172",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement173",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement174",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement175",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement177",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement178",{"className":"token","style":{"color":"#a04900"},"children":["async"]}],["$","span","code-segement179",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement180",{"className":"token","style":{"color":"#a04900"},"children":["function"]}],["$","span","code-segement181",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement182",{"className":"token","style":{"color":"#7c00aa"},"children":["startServer"]}],["$","span","code-segement183",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement184",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement185",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement186",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement187",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement188",{"className":"$undefined","style":{},"children":["  "]}],["$","span","code-segement189",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement190",{"className":"$undefined","style":{},"children":[" ortSession "]}],["$","span","code-segement191",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement192",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement193",{"className":"token control-flow","style":{"color":"#a04900"},"children":["await"]}],["$","span","code-segement194",{"className":"$undefined","style":{},"children":[" ort"]}],["$","span","code-segement195",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement196",{"className":"token maybe-class-name","style":{"color":"#005a8e"},"children":["InferenceSession"]}],["$","span","code-segement197",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement198",{"className":"token method","style":{"color":"#005a8e"},"children":["create"]}],["$","span","code-segement199",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement200",{"className":"$undefined","style":{},"children":["modelPath"]}],["$","span","code-segement201",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement202",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement203",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement205",{"className":"$undefined","style":{},"children":["  app"]}],["$","span","code-segement206",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement207",{"className":"token method","style":{"color":"#005a8e"},"children":["post"]}],["$","span","code-segement208",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement209",{"className":"token","style":{"color":"#116b00"},"children":["\"/api/run-inference\""]}],["$","span","code-segement210",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement211",{"className":"$undefined","style":{},"children":[" multipartMiddleware"]}],["$","span","code-segement212",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement213",{"className":"token method","style":{"color":"#005a8e"},"children":["single"]}],["$","span","code-segement214",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement215",{"className":"token","style":{"color":"#116b00"},"children":["\"file\""]}],["$","span","code-segement216",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement217",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement218",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement219",{"className":"token","style":{"color":"#a04900"},"children":["async"]}],["$","span","code-segement220",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement221",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement222",{"className":"token","style":{"color":"#005a8e"},"children":["req"]}],["$","span","code-segement223",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement224",{"className":"token","style":{"color":"#005a8e"},"children":[" res"]}],["$","span","code-segement225",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement226",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement227",{"className":"token arrow","style":{"color":"#a04900"},"children":["=>"]}],["$","span","code-segement228",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement229",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement230",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement231",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement232",{"className":"token control-flow","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement233",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement234",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement235",{"className":"token","style":{"color":"#a04900"},"children":["!"]}],["$","span","code-segement236",{"className":"$undefined","style":{},"children":["req"]}],["$","span","code-segement237",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement238",{"className":"token","style":{"color":"#005a8e"},"children":["file"]}],["$","span","code-segement239",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement240",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement241",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement242",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement243",{"className":"$undefined","style":{},"children":["      "]}],["$","span","code-segement244",{"className":"token control-flow","style":{"color":"#a04900"},"children":["return"]}],["$","span","code-segement245",{"className":"$undefined","style":{},"children":[" res"]}],["$","span","code-segement246",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement247",{"className":"token method","style":{"color":"#005a8e"},"children":["status"]}],["$","span","code-segement248",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement249",{"className":"token","style":{"color":"#755f00"},"children":["400"]}],["$","span","code-segement250",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement251",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement252",{"className":"token method","style":{"color":"#005a8e"},"children":["send"]}],["$","span","code-segement253",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement254",{"className":"token","style":{"color":"#116b00"},"children":["\"No file uploaded.\""]}],["$","span","code-segement255",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement256",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement257",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement258",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement259",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement260",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement262",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement263",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement264",{"className":"$undefined","style":{},"children":[" imagePath "]}],["$","span","code-segement265",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement266",{"className":"$undefined","style":{},"children":[" req"]}],["$","span","code-segement267",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement268",{"className":"token","style":{"color":"#005a8e"},"children":["file"]}],["$","span","code-segement269",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement270",{"className":"token","style":{"color":"#005a8e"},"children":["path"]}],["$","span","code-segement271",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement272",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement274",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement275",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement276",{"className":"$undefined","style":{},"children":[" imageArr "]}],["$","span","code-segement277",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement278",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement279",{"className":"token control-flow","style":{"color":"#a04900"},"children":["await"]}],["$","span","code-segement280",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement281",{"className":"token","style":{"color":"#7c00aa"},"children":["loadImageAsUint8Array"]}],["$","span","code-segement282",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement283",{"className":"$undefined","style":{},"children":["imagePath"]}],["$","span","code-segement284",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement285",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement286",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement287",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement288",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement289",{"className":"$undefined","style":{},"children":[" imageTensor "]}],["$","span","code-segement290",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement291",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement292",{"className":"token","style":{"color":"#7c00aa"},"children":["imageArrayToTensor"]}],["$","span","code-segement293",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement294",{"className":"$undefined","style":{},"children":["imageArr"]}],["$","span","code-segement295",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement296",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement297",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement299",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement300",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement301",{"className":"$undefined","style":{},"children":[" feeds "]}],["$","span","code-segement302",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement303",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement304",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement305",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement306",{"className":"$undefined","style":{},"children":["      "]}],["$","span","code-segement307",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement308",{"className":"$undefined","style":{},"children":["ortSession"]}],["$","span","code-segement309",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement310",{"className":"token","style":{"color":"#005a8e"},"children":["inputNames"]}],["$","span","code-segement311",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement312",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement313",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement314",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement315",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement316",{"className":"$undefined","style":{},"children":[" imageTensor"]}],["$","span","code-segement317",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement318",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement319",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement320",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement321",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement322",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement324",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement325",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement326",{"className":"$undefined","style":{},"children":[" outputData "]}],["$","span","code-segement327",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement328",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement329",{"className":"token control-flow","style":{"color":"#a04900"},"children":["await"]}],["$","span","code-segement330",{"className":"$undefined","style":{},"children":[" ortSession"]}],["$","span","code-segement331",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement332",{"className":"token method","style":{"color":"#005a8e"},"children":["run"]}],["$","span","code-segement333",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement334",{"className":"$undefined","style":{},"children":["feeds"]}],["$","span","code-segement335",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement336",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement337",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement338",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement339",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement340",{"className":"$undefined","style":{},"children":[" output "]}],["$","span","code-segement341",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement342",{"className":"$undefined","style":{},"children":[" outputData"]}],["$","span","code-segement343",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement344",{"className":"$undefined","style":{},"children":["ortSession"]}],["$","span","code-segement345",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement346",{"className":"token","style":{"color":"#005a8e"},"children":["outputNames"]}],["$","span","code-segement347",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement348",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement349",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement350",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement351",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement352",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement354",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement355",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement356",{"className":"$undefined","style":{},"children":[" outputSoftmax "]}],["$","span","code-segement357",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement358",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement359",{"className":"token","style":{"color":"#7c00aa"},"children":["softmax"]}],["$","span","code-segement360",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement361",{"className":"token","style":{"color":"#005a8e"},"children":["Array"]}],["$","span","code-segement362",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement363",{"className":"token","style":{"color":"#005a8e"},"children":["prototype"]}],["$","span","code-segement364",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement365",{"className":"token method","style":{"color":"#005a8e"},"children":["slice"]}],["$","span","code-segement366",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement367",{"className":"token method","style":{"color":"#005a8e"},"children":["call"]}],["$","span","code-segement368",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement369",{"className":"$undefined","style":{},"children":["output"]}],["$","span","code-segement370",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement371",{"className":"token","style":{"color":"#005a8e"},"children":["data"]}],["$","span","code-segement372",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement373",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement374",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement375",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement376",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement377",{"className":"token","style":{"color":"#a04900"},"children":["const"]}],["$","span","code-segement378",{"className":"$undefined","style":{},"children":[" outputClass "]}],["$","span","code-segement379",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement380",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement381",{"className":"token","style":{"color":"#7c00aa"},"children":["indexMax"]}],["$","span","code-segement382",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement383",{"className":"$undefined","style":{},"children":["outputSoftmax"]}],["$","span","code-segement384",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement385",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement386",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement388",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement389",{"className":"token control-flow","style":{"color":"#a04900"},"children":["await"]}],["$","span","code-segement390",{"className":"$undefined","style":{},"children":[" fs"]}],["$","span","code-segement391",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement392",{"className":"token method","style":{"color":"#005a8e"},"children":["unlink"]}],["$","span","code-segement393",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement394",{"className":"$undefined","style":{},"children":["imagePath"]}],["$","span","code-segement395",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement396",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement397",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement399",{"className":"$undefined","style":{},"children":["    res"]}],["$","span","code-segement400",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement401",{"className":"token method","style":{"color":"#005a8e"},"children":["status"]}],["$","span","code-segement402",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement403",{"className":"token","style":{"color":"#755f00"},"children":["200"]}],["$","span","code-segement404",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement405",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement406",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement407",{"className":"$undefined","style":{},"children":["    res"]}],["$","span","code-segement408",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement409",{"className":"token method","style":{"color":"#005a8e"},"children":["send"]}],["$","span","code-segement410",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement411",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement412",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement413",{"className":"$undefined","style":{},"children":["      "]}],["$","span","code-segement414",{"className":"token literal-property","style":{"color":"#005a8e"},"children":["predicted_label"]}],["$","span","code-segement415",{"className":"token","style":{"color":"#a04900"},"children":[":"]}],["$","span","code-segement416",{"className":"$undefined","style":{},"children":[" outputClass"]}],["$","span","code-segement417",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement418",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement419",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement420",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement421",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement422",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement423",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement424",{"className":"$undefined","style":{},"children":["  "]}],["$","span","code-segement425",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement426",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement427",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement428",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement430",{"className":"$undefined","style":{},"children":["  app"]}],["$","span","code-segement431",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement432",{"className":"token method","style":{"color":"#005a8e"},"children":["listen"]}],["$","span","code-segement433",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement434",{"className":"token","style":{"color":"#755f00"},"children":["PORT"]}],["$","span","code-segement435",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement436",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement437",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement438",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement439",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement440",{"className":"token arrow","style":{"color":"#a04900"},"children":["=>"]}],["$","span","code-segement441",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement442",{"className":"token","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement443",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement444",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement445",{"className":"token console","style":{"color":"#005a8e"},"children":["console"]}],["$","span","code-segement446",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement447",{"className":"token method","style":{"color":"#005a8e"},"children":["log"]}],["$","span","code-segement448",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement449",{"className":"token template-string template-punctuation","style":{"color":"#116b00"},"children":["`"]}],["$","span","code-segement450",{"className":"token template-string","style":{"color":"#116b00"},"children":["Server is running on http://localhost:"]}],["$","span","code-segement451",{"className":"token template-string interpolation interpolation-punctuation","style":{"color":"#111b27"},"children":["$${"]}],["$","span","code-segement452",{"className":"token template-string interpolation","style":{"color":"#755f00"},"children":["PORT"]}],["$","span","code-segement453",{"className":"token template-string interpolation interpolation-punctuation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement454",{"className":"token template-string template-punctuation","style":{"color":"#116b00"},"children":["`"]}],["$","span","code-segement455",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement456",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement457",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement458",{"className":"$undefined","style":{},"children":["  "]}],["$","span","code-segement459",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement460",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement461",{"className":"token","style":{"color":"#111b27"},"children":[";"]}],["$","span","code-segement462",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement463",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement464",{"className":"token","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement465",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement467",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement468",{"className":"token","style":{"color":"#7c00aa"},"children":["startServer"]}],["$","span","code-segement469",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement470",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement471",{"className":"token","style":{"color":"#111b27"},"children":[";"]}]]]}]}]]}],["$","$Lc","37",{"id":"conclusion","variant":"h4","component":"h1","mb":2,"children":["$","strong",null,{"children":"Conclusion"}]}],["$","$Lc","38",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Previously, we had learned how to convert models to ONNX, and today, we found out how to run one of those converted models in Node.js using the ONNX Runtime. For inference purposes, ONNX is a fast and robust solution. If we wanna make use of machine learning in our Node.js application, we don't have to create a separate API in Python and call that from our app, we can now run the inference in Node itself."]}],["$","$Lc","39",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","See you next time :)"]}]]}]}]]}]}],"$L1a"]}]
1b:I[3713,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],"default"]
12:["$","$La",null,{"sx":{"width":"100%","display":"flex","flexDirection":"row","justifyContent":"space-between","alignItems":"center"},"children":[["$","$Lc",null,{"variant":"p","component":"p","mr":2,"children":"By: Abhilaksh Singh Reen"}],["$","$L1b",null,{"socialMediaProfiles":[{"network_name":"LinkedIn","profile_url":"https://www.linkedin.com/in/abhilaksh-singh-837901210/","profile_display_name":"Abhilaksh Singh Reen"},{"network_name":"Twitter","profile_url":"https://x.com/TheVeteran06","profile_display_name":"The Veteran 06"},{"network_name":"GitHub","profile_url":"https://github.com/AbhilakshSinghReen","profile_display_name":"Abhilaksh Singh Reen"}]}]]}]
1c:I[6652,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],""]
1d:I[6981,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],""]
1e:I[2818,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],""]
1a:["$","$La",null,{"mt":5,"mb":5,"pb":2,"sx":{"width":"100%","display":"flex","flexDirection":"column","justifyContent":"flex-start","alignItems":"center"},"children":["$","$L11",null,{"container":true,"spacing":2,"mt":4,"mb":4,"children":[["$","$L11","/ml-ops/ml-inference-on-backend-vs-frontend",{"item":true,"xs":12,"sm":6,"md":4,"lg":3,"children":["$","$Ld",null,{"href":"/ml-ops/ml-inference-on-backend-vs-frontend","passHref":true,"style":{"textDecoration":"none"},"children":["$","$L1c",null,{"sx":{"width":"100%","height":"100%","boxShadow":"1px 1px 1px 1px \"#eeeeee\"","&:hover":{"boxShadow":"3px 3px 3px 3px \"#eeeeee\"","cursor":"pointer"}},"children":[["$","$L1d",null,{"component":"img","height":"150","image":"/media/images/ml-inference-on-backend-vs-frontend-thumbnail.jpg","alt":"ML Inference on Backend vs Frontend","sx":{"objectFit":"cover"}}],["$","$L1e",null,{"children":[["$","$Lc",null,{"gutterBottom":true,"variant":"h6","component":"h2","children":[""," ","ML Inference on Backend vs Frontend"]}],["$","$Lc",null,{"gutterBottom":true,"variant":"p","component":"p","sx":{"overflow":"hidden","textOverflow":"ellipsis","display":"-webkit-box","WebkitLineClamp":"3","WebkitBoxOrient":"vertical"},"children":"A comparison of ML inference speed and memory consumption across various batch sizes on both GPU and CPU."}],["$","$La",null,{"sx":{"width":"100%","display":"flex","flexDirection":"row","justifyContent":"flex-end","alignItems":"center"},"children":["$","$Lc",null,{"gutterBottom":true,"variant":"p","component":"p","children":"05m Read"}]}],false]}]]}]}]}]]}]}]
