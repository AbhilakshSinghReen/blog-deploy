3:I[9275,[],""]
6:I[1343,[],""]
7:I[6871,["98","static/chunks/98-98337b3bb708bd24.js","748","static/chunks/748-1f14ee6eb3d7029a.js","271","static/chunks/271-37a22bace913f735.js","185","static/chunks/app/layout-08611f287dda1230.js"],"default"]
8:I[5877,["98","static/chunks/98-98337b3bb708bd24.js","748","static/chunks/748-1f14ee6eb3d7029a.js","271","static/chunks/271-37a22bace913f735.js","185","static/chunks/app/layout-08611f287dda1230.js"],"default"]
9:I[902,["98","static/chunks/98-98337b3bb708bd24.js","748","static/chunks/748-1f14ee6eb3d7029a.js","271","static/chunks/271-37a22bace913f735.js","185","static/chunks/app/layout-08611f287dda1230.js"],""]
a:I[5218,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],""]
b:I[2324,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],"default"]
c:I[2591,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],""]
d:I[231,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],""]
e:I[3180,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],""]
f:I[3245,["98","static/chunks/98-98337b3bb708bd24.js","748","static/chunks/748-1f14ee6eb3d7029a.js","271","static/chunks/271-37a22bace913f735.js","185","static/chunks/app/layout-08611f287dda1230.js"],"default"]
4:["categorySlug","ml-ops","d"]
5:["postOrSeriesSlug","gpu-vs-cpu-performance-for-ml-inference-workflows","d"]
0:["hQwECBHV9o0WmX2S0pG39",[[["",{"children":[["categorySlug","ml-ops","d"],{"children":[["postOrSeriesSlug","gpu-vs-cpu-performance-for-ml-inference-workflows","d"],{"children":["__PAGE__?{\"categorySlug\":\"ml-ops\",\"postOrSeriesSlug\":\"gpu-vs-cpu-performance-for-ml-inference-workflows\"}",{}]}]}]},"$undefined","$undefined",true],["",{"children":[["categorySlug","ml-ops","d"],{"children":[["postOrSeriesSlug","gpu-vs-cpu-performance-for-ml-inference-workflows","d"],{"children":["__PAGE__",{},[["$L1","$L2"],null],null]},["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","$4","children","$5","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}],null]},["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","$4","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","styles":null}],null]},[["$","html",null,{"lang":"en","suppressHydrationWarning":true,"children":["$","body",null,{"className":"__className_d65c78","children":["$","$L7",null,{"children":[["$","$L8",null,{}],["$","$L9",null,{"maxWidth":"lg","children":[["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L6",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":["$","$La",null,{"children":[["$","$Lb",null,{"render":false,"targetSiteNavigationState":[],"targetPageNavigationState":[]}],["$","$Lc",null,{"variant":"h4","children":["$","strong",null,{"children":"Not Found"}]}],["$","$Lc",null,{"variant":"h6","mb":3,"children":"Oops! It looks like the page you're looking for does not exist."}],["$","$Ld",null,{"href":"/","children":["$","$Le",null,{"variant":"contained","sx":{"marginRight":5,"marginBottom":1},"children":"Take me Home"}]}]]}],"notFoundStyles":[],"styles":null}],["$","$Lf",null,{}]]}]]}]}]}],null],null],[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/1d4d01086947be98.css","precedence":"next","crossOrigin":"$undefined"}]],"$L10"]]]]
10:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","1",{"charSet":"utf-8"}],["$","link","2",{"rel":"icon","href":"/favicon.ico","type":"image/x-icon","sizes":"16x16"}]]
1:null
11:I[3507,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],""]
13:I[4204,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],"default"]
14:I[1847,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],"default"]
15:I[8125,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],""]
16:I[3578,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],"default"]
17:I[7005,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],""]
18:I[6480,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],"default"]
1b:I[9355,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],""]
1c:I[8888,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],""]
1d:I[3037,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],""]
1e:I[7842,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],""]
1f:I[9697,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],""]
20:I[4775,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],""]
19:T7f5,from segmentation_models_pytorch import UnetPlusPlus
import torch
import torch.nn.functional as F
from torchvision import transforms


class Model:
    def __init__(self, weights_path, use_cuda=False):
        self.using_cuda = use_cuda and torch.cuda.is_available()
        self.device = torch.device("cuda") if self.using_cuda else torch.device("cpu")
        self.dtype = torch.cuda.FloatTensor if self.using_cuda else torch.Tensor

        self.model = UnetPlusPlus(
            encoder_name="resnet34",
            encoder_depth=4,
            encoder_weights="imagenet",
            decoder_channels=(256, 128, 64, 32),
            in_channels=1,
            classes=1,
            activation=None,
            aux_params=None
        )

        self.model = self.model.to(self.device)
        self.model.load_state_dict(torch.load(weights_path, map_location=self.device))

        self.preprocessing_transform = transforms.Compose([
            transforms.ToTensor(),
            transforms.Resize(size=(256, 256))
        ])

        if use_cuda and not self.using_cuda:
            print("CUDA is not available to Torch, using CPU instead.")

    def preprocess(self, images):
        transformed_images = torch.stack([self.preprocessing_transform(image) for image in images])
        transformed_images = transformed_images.type(self.dtype)

        batched_images = transformed_images.to(self.device)

        return batched_images

    def postprocess(self, output, output_size=(256, 256)):
        output = output[0]
        output = output.ge(0.5)
        output = F.interpolate(output.unsqueeze(0).unsqueeze(0).float(), size=output_size, mode="nearest")
        output = output.bool().squeeze(0).squeeze(0)

        if self.using_cuda:
            output = output.cpu()

        output = output.numpy()

        return output

    def forward(self, preprocessed_images):
        output = self.model.forward(preprocessed_images)
        output = torch.sigmoid(output)
        output = output.detach()

        return output1a:T5f9,from os import listdir
from os.path import join as path_join
from time import time

import cv2
import numpy as np

from config import inputs_dir, outputs_dir, weights_dir
from model import Model


if __name__ == "__main__":
    test_images = []
    all_image_names = listdir(inputs_dir)
    for i, image_name in enumerate(all_image_names):
        image = cv2.imread(path_join(inputs_dir, image_name), cv2.IMREAD_GRAYSCALE)
        test_images.append(image)

        if (i + 1) % 500 == 0:
            print(f"Loaded images: {i} / {len(all_image_names)}")

        if (i + 1) % 50 == 0:
            break
    print("Images loaded.")

    model = Model(path_join(weights_dir, "weights_001.pt"), use_cuda=False)
    print("Model loaded.")

    start_time = time()

    outputs = []
    for i, test_image in enumerate(test_images):
        preprocessed_image = model.preprocess([test_image])
        output = model.forward(preprocessed_image)
        output = output.detach()
        outputs.append(output)

    end_time = time()
    time_elapsed = end_time - start_time
    print(
        f"Num images: {len(test_images)}, "
        f"Batch size: {1}, "
        f"Time taken: {time_elapsed} s, "
        f"Time taken per image: {1000 * time_elapsed / len(test_images)} ms"
    )

    for output in outputs:
        boolean_array = model.postprocess(output[0], (512, 512))
        binary_image = boolean_array.astype(np.uint8) * 255
        file_path = path_join(outputs_dir, f"{i}.png")
        cv2.imwrite(file_path, binary_image)21:T6ef,from os import listdir
from os.path import join as path_join
from time import time

import cv2
import numpy as np

from config import inputs_dir, outputs_dir, weights_dir
from model import Model


if __name__ == "__main__":
    test_images = [cv2.imread(path_join(inputs_dir, image_name), cv2.IMREAD_GRAYSCALE) for image_name in listdir(inputs_dir)]
    print("Images loaded.")

    model = Model(path_join(weights_dir, "weights_001.pt"), use_cuda=True)
    print("Model loaded.")

    for batch_size in [1, 2, 4, 8, 16, 32]: #, 64, 128, 256]:
        test_batches = [test_images[i:i+batch_size] for i in range(0, len(test_images), batch_size)]
        outputs = []

        start_time = time()
        preprocessed_batches = [model.preprocess(batch) for batch in test_batches]

        for i, preprocessed_batch in enumerate(preprocessed_batches):
            output = model.forward(preprocessed_batch)
            output = output.detach()
            outputs.append(output)

            if (i + 1) % 25 == 0:
                print(f"Processed: {i} / {len(preprocessed_batches)}")

        end_time = time()
        time_elapsed = end_time - start_time

        print(
            f"Num images: {len(test_images)}, "
            f"Batch size: {batch_size}, "
            f"Time taken: {time_elapsed} s, "
            f"Time taken per image: {1000 * time_elapsed / len(test_images)} ms"
        )

        for i, output in enumerate(outputs):
            for j, single_output in enumerate(output):
                boolean_array = model.postprocess(single_output, (512, 512))
                binary_image = boolean_array.astype(np.uint8) * 255
                file_path = path_join(outputs_dir, f"{i * batch_size + j}.png")
                cv2.imwrite(file_path, binary_image)2:["$","$La",null,{"mb":5,"pb":2,"sx":{"width":"100%","display":"flex","flexDirection":"column","justifyContent":"flex-start","alignItems":"flex-start"},"children":[["$","$Lb",null,{"render":true,"targetSiteNavigationState":[{"absoluteSlug":"/ml-ops","title":"ML Ops"},{"absoluteSlug":"/ml-ops/gpu-vs-cpu-performance-for-ml-inference-workflows","title":"ML Inference Performance on GPU and CPU across different batch sizes."}],"targetPageNavigationState":[{"title":"The Model","absoluteSlug":"#the-model"},{"title":"CPU and GPU","absoluteSlug":"#cpu-and-gpu"},{"title":"Testing Code","absoluteSlug":"#testing-code"},{"title":"CPU Inference","absoluteSlug":"#cpu-inference"},{"title":"GPU Inference","absoluteSlug":"#gpu-inference"},{"title":"Batched GPU Inference","absoluteSlug":"#batched-gpu-inference"},{"title":"Batched CPU Inference: Any Good?","absoluteSlug":"#batched-cpu-inference:-any-good?"},{"title":"Model Dependence","absoluteSlug":"#model-dependence"},{"title":"Conclusion","absoluteSlug":"#conclusion"}]}],["$","$L11",null,{"container":true,"spacing":2,"mb":0,"children":[["$","$L11",null,{"item":true,"xs":12,"sm":12,"md":4,"sx":{"background":"linear-gradient(to right, #eeeeee, #ffffff)","borderRadius":5},"children":["$","$La",null,{"sx":{"width":"100%","height":"100%","display":"flex","flexDirection":"column","justifyContent":"center","alignItems":"flex-start","paddingBottom":2},"children":[["$","$Lc",null,{"gutterBottom":true,"variant":"h5","component":"h1","children":"ML Inference Performance on GPU and CPU across different batch sizes."}],["$","$Lc",null,{"gutterBottom":true,"variant":"p","component":"p","mb":4,"children":"A comparison of ML inference speed and memory consumption across various batch sizes on both GPU and CPU."}],["$","$La",null,{"sx":{"width":"100%","display":"flex","flexDirection":"row","justifyContent":"space-between","alignItems":"center","marginBottom":2},"children":[["$","$Lc",null,{"gutterBottom":true,"variant":"p","component":"p","children":"June 09, 2024"}],["$","$Lc",null,{"gutterBottom":true,"variant":"p","component":"p","children":["08m"," Read"]}]]}],"$L12",false]}]}],["$","$L11",null,{"item":true,"xs":12,"sm":12,"md":8,"children":["$","$La",null,{"sx":{"flex":1,"display":"flex","flexDirection":"column","justifyContent":"center","alignItems":"center","marginRight":2},"children":["$","img",null,{"src":"/media/images/gpu-vs-cpu-performance-for-ml-inference-workflows-thumbnail.jpg","style":{"width":"100%","maxWidth":"75vw","height":"auto","maxHeight":"35vh","objectFit":"cover"}}]}]}]]}],["$","$La",null,{"sx":{"width":"100%"},"children":["$","$L11",null,{"container":true,"spacing":2,"mt":4,"mb":0,"children":[["$","$L11",null,{"item":true,"xs":12,"sm":12,"md":4,"lg":3,"sx":{"background":"linear-gradient(to right, #eeeeee, #ffffff)","borderRadius":5},"children":["$","$La",null,{"sx":{"width":"100%"},"children":[["$","$La",null,{"sx":{"width":"100%","display":{"xs":"block","md":"none"},"marginBottom":2},"children":["$","$L13",null,{"sx":{"width":"100%","marginBottom":2,"boxShadow":3,"backgroundColor":"#ffffff22"},"disableGutters":true,"children":[["$","$L14",null,{"expandIcon":["$","$L15",null,{}],"children":["$","$Lc",null,{"variant":"h6","component":"h6","sx":{"margin":0,"padding":0},"children":"Table of Contents"}]}],["$","$L16",null,{"sx":{"width":"90%","display":"flex","flexDirection":"column","justifyContent":"flex-start","alignItems":"flex-start","marginBottom":2},"children":[["$","a","0",{"href":"#the-model","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","0",{"variant":"p","component":"p","ml":0,"mb":2.5,"sx":{"&:hover":{"color":"blue"}},"children":"The Model"}]}],["$","a","1",{"href":"#cpu-and-gpu","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","1",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"CPU and GPU"}]}],["$","a","2",{"href":"#testing-code","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","2",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"Testing Code"}]}],["$","a","3",{"href":"#cpu-inference","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","3",{"variant":"p","component":"p","ml":0,"mb":2.5,"sx":{"&:hover":{"color":"blue"}},"children":"CPU Inference"}]}],["$","a","4",{"href":"#gpu-inference","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","4",{"variant":"p","component":"p","ml":0,"mb":2.5,"sx":{"&:hover":{"color":"blue"}},"children":"GPU Inference"}]}],["$","a","5",{"href":"#batched-gpu-inference","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","5",{"variant":"p","component":"p","ml":0,"mb":2.5,"sx":{"&:hover":{"color":"blue"}},"children":"Batched GPU Inference"}]}],["$","a","6",{"href":"#batched-cpu-inference:-any-good?","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","6",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"Batched CPU Inference: Any Good?"}]}],["$","a","7",{"href":"#model-dependence","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","7",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"Model Dependence"}]}],["$","a","8",{"href":"#conclusion","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","8",{"variant":"p","component":"p","ml":0,"mb":2.5,"sx":{"&:hover":{"color":"blue"}},"children":"Conclusion"}]}]]}]]}]}],["$","$La",null,{"sx":{"width":"100%","display":{"xs":"none","md":"block"}},"children":[["$","$Lc",null,{"variant":"h5","component":"h5","sx":{"margin":0,"padding":0},"children":"Table of Contents"}],[["$","a","0",{"href":"#the-model","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","0",{"variant":"p","component":"p","ml":0,"mb":2.5,"sx":{"&:hover":{"color":"blue"}},"children":"The Model"}]}],["$","a","1",{"href":"#cpu-and-gpu","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","1",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"CPU and GPU"}]}],["$","a","2",{"href":"#testing-code","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","2",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"Testing Code"}]}],["$","a","3",{"href":"#cpu-inference","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","3",{"variant":"p","component":"p","ml":0,"mb":2.5,"sx":{"&:hover":{"color":"blue"}},"children":"CPU Inference"}]}],["$","a","4",{"href":"#gpu-inference","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","4",{"variant":"p","component":"p","ml":0,"mb":2.5,"sx":{"&:hover":{"color":"blue"}},"children":"GPU Inference"}]}],["$","a","5",{"href":"#batched-gpu-inference","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","5",{"variant":"p","component":"p","ml":0,"mb":2.5,"sx":{"&:hover":{"color":"blue"}},"children":"Batched GPU Inference"}]}],["$","a","6",{"href":"#batched-cpu-inference:-any-good?","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","6",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"Batched CPU Inference: Any Good?"}]}],["$","a","7",{"href":"#model-dependence","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","7",{"variant":"p","component":"p","ml":1,"mb":2,"sx":{"&:hover":{"color":"blue"}},"children":"Model Dependence"}]}],["$","a","8",{"href":"#conclusion","style":{"textDecoration":"none","color":"inherit","&:visited":{"textDecoration":"none","color":"inherit"}},"children":["$","$Lc","8",{"variant":"p","component":"p","ml":0,"mb":2.5,"sx":{"&:hover":{"color":"blue"}},"children":"Conclusion"}]}]]]}]]}]}],["$","$L11",null,{"item":true,"xs":12,"sm":12,"md":8,"lg":9,"sx":{"background":"linear-gradient(to right, #ffffff, #eeeeee)","borderRadius":5},"children":["$","$La",null,{"sx":{"flex":1,"marginRight":2},"children":[["$","$Lc","0",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","When deploying your ML model to production, it is important to get the inference process running as fast as possible. GPUs are efficient at parallel processing. In today's article, we compare the inference speeds of running a PyTorch model on a CPU and a GPU. We also test how processing more images in parallel, as batches, on GPU affects the speed."]}],["$","$Lc","1",{"id":"the-model","variant":"h4","component":"h1","mb":2,"children":["$","strong",null,{"children":"The Model"}]}],["$","$Lc","2",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Inside the project directory, let's create a folder called ",["$","$La","2-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"src"}],". Inside this folder, create a new file called ",["$","$La","2-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"model.py"}],". Here, we'll define a very simple model based on the ",["$","$La","2-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"UNet++"}]," architecture. For this, we'll use the ",["$","$L17","2-link",{"href":"https://pypi.org/project/segmentation-models-pytorch/0.0.3/","rel":"noopener noreferrer","target":"_blank","color":"primary","underline":"hover","children":"segmentation_models_pytorch"}]," package. Inside the file, we create a class called ",["$","$La","2-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"Model"}]," that has 4 main functions:"]}],["$","$Lc","3",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","1. ",["$","$La","3-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"__init__"}],": initializes the model, loads the weights, and creates the preprocessing transform."]}],["$","$Lc","4",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","1. ",["$","$La","4-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"preprocess"}],": takes a list of images and returns a batch that can be passed to the ",["$","$La","4-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"forward"}]," function."]}],["$","$Lc","5",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","1. ",["$","$La","5-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"postprocess"}],": takes a single model output and returns an image with an option to resize the image."]}],["$","$Lc","6",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","1. ",["$","$La","6-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"forward"}],": the function used for inference."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"$19"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" segmentation_models_pytorch "]}],["$","span","code-segement2",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":[" UnetPlusPlus\n"]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement5",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement6",{"className":"$undefined","style":{},"children":[" torch\n"]}],["$","span","code-segement7",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement8",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement9",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement10",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement11",{"className":"$undefined","style":{},"children":["nn"]}],["$","span","code-segement12",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement13",{"className":"$undefined","style":{},"children":["functional "]}],["$","span","code-segement14",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":[" F\n"]}],["$","span","code-segement16",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement17",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement18",{"className":"$undefined","style":{},"children":[" torchvision "]}],["$","span","code-segement19",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement20",{"className":"$undefined","style":{},"children":[" transforms\n"]}],"\n","\n",["$","span","code-segement23",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement24",{"className":"token","style":{"color":"#a04900"},"children":["class"]}],["$","span","code-segement25",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement26",{"className":"token","style":{"color":"#005a8e"},"children":["Model"]}],["$","span","code-segement27",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement28",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement29",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement30",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement31",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement32",{"className":"token","style":{"color":"#7c00aa"},"children":["__init__"]}],["$","span","code-segement33",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement34",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement35",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement36",{"className":"$undefined","style":{},"children":[" weights_path"]}],["$","span","code-segement37",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement38",{"className":"$undefined","style":{},"children":[" use_cuda"]}],["$","span","code-segement39",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement40",{"className":"token","style":{"color":"#755f00"},"children":["False"]}],["$","span","code-segement41",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement42",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement43",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement44",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement45",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement46",{"className":"$undefined","style":{},"children":["using_cuda "]}],["$","span","code-segement47",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement48",{"className":"$undefined","style":{},"children":[" use_cuda "]}],["$","span","code-segement49",{"className":"token","style":{"color":"#a04900"},"children":["and"]}],["$","span","code-segement50",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement51",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement52",{"className":"$undefined","style":{},"children":["cuda"]}],["$","span","code-segement53",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement54",{"className":"$undefined","style":{},"children":["is_available"]}],["$","span","code-segement55",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement56",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement57",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement58",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement59",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement60",{"className":"$undefined","style":{},"children":["device "]}],["$","span","code-segement61",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement62",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement63",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement64",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement65",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement66",{"className":"token","style":{"color":"#116b00"},"children":["\"cuda\""]}],["$","span","code-segement67",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement68",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement69",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement70",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement71",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement72",{"className":"$undefined","style":{},"children":["using_cuda "]}],["$","span","code-segement73",{"className":"token","style":{"color":"#a04900"},"children":["else"]}],["$","span","code-segement74",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement75",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement76",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement77",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement78",{"className":"token","style":{"color":"#116b00"},"children":["\"cpu\""]}],["$","span","code-segement79",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement80",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement81",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement82",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement83",{"className":"$undefined","style":{},"children":["dtype "]}],["$","span","code-segement84",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement85",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement86",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement87",{"className":"$undefined","style":{},"children":["cuda"]}],["$","span","code-segement88",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement89",{"className":"$undefined","style":{},"children":["FloatTensor "]}],["$","span","code-segement90",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement91",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement92",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement93",{"className":"$undefined","style":{},"children":["using_cuda "]}],["$","span","code-segement94",{"className":"token","style":{"color":"#a04900"},"children":["else"]}],["$","span","code-segement95",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement96",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement97",{"className":"$undefined","style":{},"children":["Tensor\n"]}],"\n",["$","span","code-segement99",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement100",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement101",{"className":"$undefined","style":{},"children":["model "]}],["$","span","code-segement102",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement103",{"className":"$undefined","style":{},"children":[" UnetPlusPlus"]}],["$","span","code-segement104",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement105",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement106",{"className":"$undefined","style":{},"children":["            encoder_name"]}],["$","span","code-segement107",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement108",{"className":"token","style":{"color":"#116b00"},"children":["\"resnet34\""]}],["$","span","code-segement109",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement110",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement111",{"className":"$undefined","style":{},"children":["            encoder_depth"]}],["$","span","code-segement112",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement113",{"className":"token","style":{"color":"#755f00"},"children":["4"]}],["$","span","code-segement114",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement115",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement116",{"className":"$undefined","style":{},"children":["            encoder_weights"]}],["$","span","code-segement117",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement118",{"className":"token","style":{"color":"#116b00"},"children":["\"imagenet\""]}],["$","span","code-segement119",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement120",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement121",{"className":"$undefined","style":{},"children":["            decoder_channels"]}],["$","span","code-segement122",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement123",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement124",{"className":"token","style":{"color":"#755f00"},"children":["256"]}],["$","span","code-segement125",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement126",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement127",{"className":"token","style":{"color":"#755f00"},"children":["128"]}],["$","span","code-segement128",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement129",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement130",{"className":"token","style":{"color":"#755f00"},"children":["64"]}],["$","span","code-segement131",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement132",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement133",{"className":"token","style":{"color":"#755f00"},"children":["32"]}],["$","span","code-segement134",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement135",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement136",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement137",{"className":"$undefined","style":{},"children":["            in_channels"]}],["$","span","code-segement138",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement139",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement140",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement141",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement142",{"className":"$undefined","style":{},"children":["            classes"]}],["$","span","code-segement143",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement144",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement145",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement146",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement147",{"className":"$undefined","style":{},"children":["            activation"]}],["$","span","code-segement148",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement149",{"className":"token","style":{"color":"#755f00"},"children":["None"]}],["$","span","code-segement150",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement151",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement152",{"className":"$undefined","style":{},"children":["            aux_params"]}],["$","span","code-segement153",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement154",{"className":"token","style":{"color":"#755f00"},"children":["None"]}],["$","span","code-segement155",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement156",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement157",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement158",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement160",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement161",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement162",{"className":"$undefined","style":{},"children":["model "]}],["$","span","code-segement163",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement164",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement165",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement166",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement167",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement168",{"className":"$undefined","style":{},"children":["to"]}],["$","span","code-segement169",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement170",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement171",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement172",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement173",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement174",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement175",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement176",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement177",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement178",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement179",{"className":"$undefined","style":{},"children":["load_state_dict"]}],["$","span","code-segement180",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement181",{"className":"$undefined","style":{},"children":["torch"]}],["$","span","code-segement182",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement183",{"className":"$undefined","style":{},"children":["load"]}],["$","span","code-segement184",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement185",{"className":"$undefined","style":{},"children":["weights_path"]}],["$","span","code-segement186",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement187",{"className":"$undefined","style":{},"children":[" map_location"]}],["$","span","code-segement188",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement189",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement190",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement191",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement192",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement193",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement194",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement196",{"className":"$undefined","style":{},"children":["        self"]}],["$","span","code-segement197",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement198",{"className":"$undefined","style":{},"children":["preprocessing_transform "]}],["$","span","code-segement199",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement200",{"className":"$undefined","style":{},"children":[" transforms"]}],["$","span","code-segement201",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement202",{"className":"$undefined","style":{},"children":["Compose"]}],["$","span","code-segement203",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement204",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement205",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement206",{"className":"$undefined","style":{},"children":["            transforms"]}],["$","span","code-segement207",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement208",{"className":"$undefined","style":{},"children":["ToTensor"]}],["$","span","code-segement209",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement210",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement211",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement212",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement213",{"className":"$undefined","style":{},"children":["            transforms"]}],["$","span","code-segement214",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement215",{"className":"$undefined","style":{},"children":["Resize"]}],["$","span","code-segement216",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement217",{"className":"$undefined","style":{},"children":["size"]}],["$","span","code-segement218",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement219",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement220",{"className":"token","style":{"color":"#755f00"},"children":["256"]}],["$","span","code-segement221",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement222",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement223",{"className":"token","style":{"color":"#755f00"},"children":["256"]}],["$","span","code-segement224",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement225",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement226",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement227",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement228",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement229",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement230",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement232",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement233",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement234",{"className":"$undefined","style":{},"children":[" use_cuda "]}],["$","span","code-segement235",{"className":"token","style":{"color":"#a04900"},"children":["and"]}],["$","span","code-segement236",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement237",{"className":"token","style":{"color":"#a04900"},"children":["not"]}],["$","span","code-segement238",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement239",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement240",{"className":"$undefined","style":{},"children":["using_cuda"]}],["$","span","code-segement241",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement242",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement243",{"className":"$undefined","style":{},"children":["            "]}],["$","span","code-segement244",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement245",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement246",{"className":"token","style":{"color":"#116b00"},"children":["\"CUDA is not available to Torch, using CPU instead.\""]}],["$","span","code-segement247",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement248",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement250",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement251",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement252",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement253",{"className":"token","style":{"color":"#7c00aa"},"children":["preprocess"]}],["$","span","code-segement254",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement255",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement256",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement257",{"className":"$undefined","style":{},"children":[" images"]}],["$","span","code-segement258",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement259",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement260",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement261",{"className":"$undefined","style":{},"children":["        transformed_images "]}],["$","span","code-segement262",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement263",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement264",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement265",{"className":"$undefined","style":{},"children":["stack"]}],["$","span","code-segement266",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement267",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement268",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement269",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement270",{"className":"$undefined","style":{},"children":["preprocessing_transform"]}],["$","span","code-segement271",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement272",{"className":"$undefined","style":{},"children":["image"]}],["$","span","code-segement273",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement274",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement275",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement276",{"className":"$undefined","style":{},"children":[" image "]}],["$","span","code-segement277",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement278",{"className":"$undefined","style":{},"children":[" images"]}],["$","span","code-segement279",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement280",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement281",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement282",{"className":"$undefined","style":{},"children":["        transformed_images "]}],["$","span","code-segement283",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement284",{"className":"$undefined","style":{},"children":[" transformed_images"]}],["$","span","code-segement285",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement286",{"className":"token","style":{"color":"#af00af"},"children":["type"]}],["$","span","code-segement287",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement288",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement289",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement290",{"className":"$undefined","style":{},"children":["dtype"]}],["$","span","code-segement291",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement292",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement294",{"className":"$undefined","style":{},"children":["        batched_images "]}],["$","span","code-segement295",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement296",{"className":"$undefined","style":{},"children":[" transformed_images"]}],["$","span","code-segement297",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement298",{"className":"$undefined","style":{},"children":["to"]}],["$","span","code-segement299",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement300",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement301",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement302",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement303",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement304",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement306",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement307",{"className":"token","style":{"color":"#a04900"},"children":["return"]}],["$","span","code-segement308",{"className":"$undefined","style":{},"children":[" batched_images\n"]}],"\n",["$","span","code-segement310",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement311",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement312",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement313",{"className":"token","style":{"color":"#7c00aa"},"children":["postprocess"]}],["$","span","code-segement314",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement315",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement316",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement317",{"className":"$undefined","style":{},"children":[" output"]}],["$","span","code-segement318",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement319",{"className":"$undefined","style":{},"children":[" output_size"]}],["$","span","code-segement320",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement321",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement322",{"className":"token","style":{"color":"#755f00"},"children":["256"]}],["$","span","code-segement323",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement324",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement325",{"className":"token","style":{"color":"#755f00"},"children":["256"]}],["$","span","code-segement326",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement327",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement328",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement329",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement330",{"className":"$undefined","style":{},"children":["        output "]}],["$","span","code-segement331",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement332",{"className":"$undefined","style":{},"children":[" output"]}],["$","span","code-segement333",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement334",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement335",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement336",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement337",{"className":"$undefined","style":{},"children":["        output "]}],["$","span","code-segement338",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement339",{"className":"$undefined","style":{},"children":[" output"]}],["$","span","code-segement340",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement341",{"className":"$undefined","style":{},"children":["ge"]}],["$","span","code-segement342",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement343",{"className":"token","style":{"color":"#755f00"},"children":["0.5"]}],["$","span","code-segement344",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement345",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement346",{"className":"$undefined","style":{},"children":["        output "]}],["$","span","code-segement347",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement348",{"className":"$undefined","style":{},"children":[" F"]}],["$","span","code-segement349",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement350",{"className":"$undefined","style":{},"children":["interpolate"]}],["$","span","code-segement351",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement352",{"className":"$undefined","style":{},"children":["output"]}],["$","span","code-segement353",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement354",{"className":"$undefined","style":{},"children":["unsqueeze"]}],["$","span","code-segement355",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement356",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement357",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement358",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement359",{"className":"$undefined","style":{},"children":["unsqueeze"]}],["$","span","code-segement360",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement361",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement362",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement363",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement364",{"className":"token","style":{"color":"#af00af"},"children":["float"]}],["$","span","code-segement365",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement366",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement367",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement368",{"className":"$undefined","style":{},"children":[" size"]}],["$","span","code-segement369",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement370",{"className":"$undefined","style":{},"children":["output_size"]}],["$","span","code-segement371",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement372",{"className":"$undefined","style":{},"children":[" mode"]}],["$","span","code-segement373",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement374",{"className":"token","style":{"color":"#116b00"},"children":["\"nearest\""]}],["$","span","code-segement375",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement376",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement377",{"className":"$undefined","style":{},"children":["        output "]}],["$","span","code-segement378",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement379",{"className":"$undefined","style":{},"children":[" output"]}],["$","span","code-segement380",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement381",{"className":"token","style":{"color":"#af00af"},"children":["bool"]}],["$","span","code-segement382",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement383",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement384",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement385",{"className":"$undefined","style":{},"children":["squeeze"]}],["$","span","code-segement386",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement387",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement388",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement389",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement390",{"className":"$undefined","style":{},"children":["squeeze"]}],["$","span","code-segement391",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement392",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement393",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement394",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement396",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement397",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement398",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement399",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement400",{"className":"$undefined","style":{},"children":["using_cuda"]}],["$","span","code-segement401",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement402",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement403",{"className":"$undefined","style":{},"children":["            output "]}],["$","span","code-segement404",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement405",{"className":"$undefined","style":{},"children":[" output"]}],["$","span","code-segement406",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement407",{"className":"$undefined","style":{},"children":["cpu"]}],["$","span","code-segement408",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement409",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement410",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement412",{"className":"$undefined","style":{},"children":["        output "]}],["$","span","code-segement413",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement414",{"className":"$undefined","style":{},"children":[" output"]}],["$","span","code-segement415",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement416",{"className":"$undefined","style":{},"children":["numpy"]}],["$","span","code-segement417",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement418",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement419",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement421",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement422",{"className":"token","style":{"color":"#a04900"},"children":["return"]}],["$","span","code-segement423",{"className":"$undefined","style":{},"children":[" output\n"]}],"\n",["$","span","code-segement425",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement426",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement427",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement428",{"className":"token","style":{"color":"#7c00aa"},"children":["forward"]}],["$","span","code-segement429",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement430",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement431",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement432",{"className":"$undefined","style":{},"children":[" preprocessed_images"]}],["$","span","code-segement433",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement434",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement435",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement436",{"className":"$undefined","style":{},"children":["        output "]}],["$","span","code-segement437",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement438",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement439",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement440",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement441",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement442",{"className":"$undefined","style":{},"children":["forward"]}],["$","span","code-segement443",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement444",{"className":"$undefined","style":{},"children":["preprocessed_images"]}],["$","span","code-segement445",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement446",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement447",{"className":"$undefined","style":{},"children":["        output "]}],["$","span","code-segement448",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement449",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement450",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement451",{"className":"$undefined","style":{},"children":["sigmoid"]}],["$","span","code-segement452",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement453",{"className":"$undefined","style":{},"children":["output"]}],["$","span","code-segement454",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement455",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement456",{"className":"$undefined","style":{},"children":["        output "]}],["$","span","code-segement457",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement458",{"className":"$undefined","style":{},"children":[" output"]}],["$","span","code-segement459",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement460",{"className":"$undefined","style":{},"children":["detach"]}],["$","span","code-segement461",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement462",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement463",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement465",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement466",{"className":"token","style":{"color":"#a04900"},"children":["return"]}],["$","span","code-segement467",{"className":"$undefined","style":{},"children":[" output"]}]]]}]}]]}],["$","$Lc","8",{"id":"cpu-and-gpu","variant":"h5","component":"h2","mb":2,"children":["$","strong",null,{"children":"CPU and GPU"}]}],["$","$Lc","9",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","In the following three lines, define ",["$","$La","9-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"self.device"}]," and ",["$","$La","9-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"self.dtype"}]," based on whether the constructor was called with the instruction to use CUDA and if CUDA is actually available to torch."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"self.using_cuda = use_cuda and torch.cuda.is_available()\nself.device = torch.device(\"cuda\") if self.using_cuda else torch.device(\"cpu\")\nself.dtype = torch.cuda.FloatTensor if self.using_cuda else torch.Tensor"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement1",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement2",{"className":"$undefined","style":{},"children":["using_cuda "]}],["$","span","code-segement3",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":[" use_cuda "]}],["$","span","code-segement5",{"className":"token","style":{"color":"#a04900"},"children":["and"]}],["$","span","code-segement6",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement7",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":["cuda"]}],["$","span","code-segement9",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":["is_available"]}],["$","span","code-segement11",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement12",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement13",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement14",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement15",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement16",{"className":"$undefined","style":{},"children":["device "]}],["$","span","code-segement17",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement18",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement19",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement20",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement21",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement22",{"className":"token","style":{"color":"#116b00"},"children":["\"cuda\""]}],["$","span","code-segement23",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement24",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement25",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement27",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement28",{"className":"$undefined","style":{},"children":["using_cuda "]}],["$","span","code-segement29",{"className":"token","style":{"color":"#a04900"},"children":["else"]}],["$","span","code-segement30",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement31",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement32",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement33",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement34",{"className":"token","style":{"color":"#116b00"},"children":["\"cpu\""]}],["$","span","code-segement35",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement36",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement37",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement38",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement39",{"className":"$undefined","style":{},"children":["dtype "]}],["$","span","code-segement40",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement41",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement42",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement43",{"className":"$undefined","style":{},"children":["cuda"]}],["$","span","code-segement44",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement45",{"className":"$undefined","style":{},"children":["FloatTensor "]}],["$","span","code-segement46",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement47",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement48",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement49",{"className":"$undefined","style":{},"children":["using_cuda "]}],["$","span","code-segement50",{"className":"token","style":{"color":"#a04900"},"children":["else"]}],["$","span","code-segement51",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement52",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement53",{"className":"$undefined","style":{},"children":["Tensor"]}]]]}]}]]}],["$","$Lc","11",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","We load the model to the ",["$","$La","11-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"device"}],"."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"self.model = self.model.to(self.device)\nself.model.load_state_dict(torch.load(weights_path, map_location=self.device))"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement1",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement2",{"className":"$undefined","style":{},"children":["model "]}],["$","span","code-segement3",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":[" self"]}],["$","span","code-segement5",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement6",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement7",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":["to"]}],["$","span","code-segement9",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement11",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement12",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement13",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement14",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement16",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement17",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement18",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement19",{"className":"$undefined","style":{},"children":["load_state_dict"]}],["$","span","code-segement20",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement21",{"className":"$undefined","style":{},"children":["torch"]}],["$","span","code-segement22",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement23",{"className":"$undefined","style":{},"children":["load"]}],["$","span","code-segement24",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement25",{"className":"$undefined","style":{},"children":["weights_path"]}],["$","span","code-segement26",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement27",{"className":"$undefined","style":{},"children":[" map_location"]}],["$","span","code-segement28",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement29",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement30",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement31",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement32",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement33",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Lc","13",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","And, in the preprocessing function, we transfer our batched images to the device as well."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"batched_images = transformed_images.to(self.device)"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"$undefined","style":{},"children":["batched_images "]}],["$","span","code-segement1",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement2",{"className":"$undefined","style":{},"children":[" transformed_images"]}],["$","span","code-segement3",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":["to"]}],["$","span","code-segement5",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement6",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement7",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement9",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Lc","15",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","In the src directory, we'll make another file ",["$","$La","15-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"config.py"}]," to store the directories we will be using for testing."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"from os.path import dirname, join as path_join\n\n\ninputs_dir = path_join(dirname(dirname(__file__)), \"inputs\")\nweights_dir = path_join(dirname(dirname(__file__)), \"weights\")\noutputs_dir = path_join(dirname(dirname(__file__)), \"outputs\")"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" os"]}],["$","span","code-segement2",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":["path "]}],["$","span","code-segement4",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement5",{"className":"$undefined","style":{},"children":[" dirname"]}],["$","span","code-segement6",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement7",{"className":"$undefined","style":{},"children":[" join "]}],["$","span","code-segement8",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement9",{"className":"$undefined","style":{},"children":[" path_join\n"]}],"\n","\n",["$","span","code-segement12",{"className":"$undefined","style":{},"children":["inputs_dir "]}],["$","span","code-segement13",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement14",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement15",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement16",{"className":"$undefined","style":{},"children":["dirname"]}],["$","span","code-segement17",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement18",{"className":"$undefined","style":{},"children":["dirname"]}],["$","span","code-segement19",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement20",{"className":"$undefined","style":{},"children":["__file__"]}],["$","span","code-segement21",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement22",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement23",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement24",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement25",{"className":"token","style":{"color":"#116b00"},"children":["\"inputs\""]}],["$","span","code-segement26",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement27",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement28",{"className":"$undefined","style":{},"children":["weights_dir "]}],["$","span","code-segement29",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement30",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement31",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement32",{"className":"$undefined","style":{},"children":["dirname"]}],["$","span","code-segement33",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement34",{"className":"$undefined","style":{},"children":["dirname"]}],["$","span","code-segement35",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement36",{"className":"$undefined","style":{},"children":["__file__"]}],["$","span","code-segement37",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement38",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement39",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement40",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement41",{"className":"token","style":{"color":"#116b00"},"children":["\"weights\""]}],["$","span","code-segement42",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement43",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement44",{"className":"$undefined","style":{},"children":["outputs_dir "]}],["$","span","code-segement45",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement46",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement47",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement48",{"className":"$undefined","style":{},"children":["dirname"]}],["$","span","code-segement49",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement50",{"className":"$undefined","style":{},"children":["dirname"]}],["$","span","code-segement51",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement52",{"className":"$undefined","style":{},"children":["__file__"]}],["$","span","code-segement53",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement54",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement55",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement56",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement57",{"className":"token","style":{"color":"#116b00"},"children":["\"outputs\""]}],["$","span","code-segement58",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Lc","17",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Let us also create these three folders, here is what the project's directory structure should look like after doing so."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"inputs\n       sample_image.png\n\noutputs\n       sample_mask.png\n\nsrc\n       config.py\n       model.py\n       test.py\n\nweights\n        weights_001.pt"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-bash","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"$undefined","style":{},"children":["inputs\n"]}],"       sample_image.png\n","\n","outputs\n","       sample_mask.png\n","\n","src\n","       config.py\n","       model.py\n","       test.py\n","\n","weights\n","        weights_001.pt"]]}]}]]}],["$","$Lc","19",{"id":"testing-code","variant":"h5","component":"h2","mb":2,"children":["$","strong",null,{"children":"Testing Code"}]}],["$","$Lc","20",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Let's work on the ",["$","$La","20-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"src/test.py"}]," file. Our input images are located in the ",["$","$La","20-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"inputs"}]," folder and model weights are in the ",["$","$La","20-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"weights"}]," folder."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"from os import listdir\nfrom os.path import join as path_join\nfrom time import time\n\nimport cv2\nimport numpy as np\n\nfrom config import inputs_dir, outputs_dir, weights_dir\nfrom model import Model\n\n\nif __name__ == \"__main__\":\n    test_images = [cv2.imread(path_join(inputs_dir, image_name), cv2.IMREAD_GRAYSCALE) for image_name in listdir(inputs_dir)]\n    print(\"Images loaded.\")\n\n    model = Model(path_join(weights_dir, \"weights_001.pt\"))\n    print(\"Model loaded.\")"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" os "]}],["$","span","code-segement2",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":[" listdir\n"]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement5",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement6",{"className":"$undefined","style":{},"children":[" os"]}],["$","span","code-segement7",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":["path "]}],["$","span","code-segement9",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":[" join "]}],["$","span","code-segement11",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement12",{"className":"$undefined","style":{},"children":[" path_join\n"]}],["$","span","code-segement13",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement14",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":[" time "]}],["$","span","code-segement16",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement17",{"className":"$undefined","style":{},"children":[" time\n"]}],"\n",["$","span","code-segement19",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement20",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement21",{"className":"$undefined","style":{},"children":[" cv2\n"]}],["$","span","code-segement22",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement23",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement24",{"className":"$undefined","style":{},"children":[" numpy "]}],["$","span","code-segement25",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":[" np\n"]}],"\n",["$","span","code-segement28",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement29",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement30",{"className":"$undefined","style":{},"children":[" config "]}],["$","span","code-segement31",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement32",{"className":"$undefined","style":{},"children":[" inputs_dir"]}],["$","span","code-segement33",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement34",{"className":"$undefined","style":{},"children":[" outputs_dir"]}],["$","span","code-segement35",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement36",{"className":"$undefined","style":{},"children":[" weights_dir\n"]}],["$","span","code-segement37",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement38",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement39",{"className":"$undefined","style":{},"children":[" model "]}],["$","span","code-segement40",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement41",{"className":"$undefined","style":{},"children":[" Model\n"]}],"\n","\n",["$","span","code-segement44",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement45",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement46",{"className":"$undefined","style":{},"children":[" __name__ "]}],["$","span","code-segement47",{"className":"token","style":{"color":"#a04900"},"children":["=="]}],["$","span","code-segement48",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement49",{"className":"token","style":{"color":"#116b00"},"children":["\"__main__\""]}],["$","span","code-segement50",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement51",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement52",{"className":"$undefined","style":{},"children":["    test_images "]}],["$","span","code-segement53",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement54",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement55",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement56",{"className":"$undefined","style":{},"children":["cv2"]}],["$","span","code-segement57",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement58",{"className":"$undefined","style":{},"children":["imread"]}],["$","span","code-segement59",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement60",{"className":"$undefined","style":{},"children":["path_join"]}],["$","span","code-segement61",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement62",{"className":"$undefined","style":{},"children":["inputs_dir"]}],["$","span","code-segement63",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement64",{"className":"$undefined","style":{},"children":[" image_name"]}],["$","span","code-segement65",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement66",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement67",{"className":"$undefined","style":{},"children":[" cv2"]}],["$","span","code-segement68",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement69",{"className":"$undefined","style":{},"children":["IMREAD_GRAYSCALE"]}],["$","span","code-segement70",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement71",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement72",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement73",{"className":"$undefined","style":{},"children":[" image_name "]}],["$","span","code-segement74",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement75",{"className":"$undefined","style":{},"children":[" listdir"]}],["$","span","code-segement76",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement77",{"className":"$undefined","style":{},"children":["inputs_dir"]}],["$","span","code-segement78",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement79",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement80",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement81",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement82",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement83",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement84",{"className":"token","style":{"color":"#116b00"},"children":["\"Images loaded.\""]}],["$","span","code-segement85",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement86",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement88",{"className":"$undefined","style":{},"children":["    model "]}],["$","span","code-segement89",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement90",{"className":"$undefined","style":{},"children":[" Model"]}],["$","span","code-segement91",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement92",{"className":"$undefined","style":{},"children":["path_join"]}],["$","span","code-segement93",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement94",{"className":"$undefined","style":{},"children":["weights_dir"]}],["$","span","code-segement95",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement96",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement97",{"className":"token","style":{"color":"#116b00"},"children":["\"weights_001.pt\""]}],["$","span","code-segement98",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement99",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement100",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement101",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement102",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement103",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement104",{"className":"token","style":{"color":"#116b00"},"children":["\"Model loaded.\""]}],["$","span","code-segement105",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Lc","22",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Next, we can iterate over each of the test images, preprocess them, run a forward pass, postprocess, and save the output."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"start_time = time()\n\noutputs = []\nfor i, test_image in enumerate(test_images):\n    preprocessed_image = model.preprocess([test_image])\n    output = model.forward(preprocessed_image)\n    output = output.detach()\n    outputs.append(output)\n\nend_time = time()\ntime_elapsed = end_time - start_time\nprint(\n    f\"Num images: {len(test_images)}, \"\n    f\"Batch size: {1}, \"\n    f\"Time taken: {time_elapsed} s, \"\n    f\"Time taken per image: {1000 * time_elapsed / len(test_images)} ms\"\n)\n\nfor output in outputs:\n    boolean_array = model.postprocess(output[0], (512, 512))\n    binary_image = boolean_array.astype(np.uint8) * 255\n    file_path = path_join(outputs_dir, f\"{i}.png\")\n    cv2.imwrite(file_path, binary_image)"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"$undefined","style":{},"children":["start_time "]}],["$","span","code-segement1",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement2",{"className":"$undefined","style":{},"children":[" time"]}],["$","span","code-segement3",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement4",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement5",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement7",{"className":"$undefined","style":{},"children":["outputs "]}],["$","span","code-segement8",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement9",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement10",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement11",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement12",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement13",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement14",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":[" i"]}],["$","span","code-segement16",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement17",{"className":"$undefined","style":{},"children":[" test_image "]}],["$","span","code-segement18",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement19",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement20",{"className":"token","style":{"color":"#af00af"},"children":["enumerate"]}],["$","span","code-segement21",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement22",{"className":"$undefined","style":{},"children":["test_images"]}],["$","span","code-segement23",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement24",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement25",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":["    preprocessed_image "]}],["$","span","code-segement27",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement28",{"className":"$undefined","style":{},"children":[" model"]}],["$","span","code-segement29",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement30",{"className":"$undefined","style":{},"children":["preprocess"]}],["$","span","code-segement31",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement32",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement33",{"className":"$undefined","style":{},"children":["test_image"]}],["$","span","code-segement34",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement35",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement36",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement37",{"className":"$undefined","style":{},"children":["    output "]}],["$","span","code-segement38",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement39",{"className":"$undefined","style":{},"children":[" model"]}],["$","span","code-segement40",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement41",{"className":"$undefined","style":{},"children":["forward"]}],["$","span","code-segement42",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement43",{"className":"$undefined","style":{},"children":["preprocessed_image"]}],["$","span","code-segement44",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement45",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement46",{"className":"$undefined","style":{},"children":["    output "]}],["$","span","code-segement47",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement48",{"className":"$undefined","style":{},"children":[" output"]}],["$","span","code-segement49",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement50",{"className":"$undefined","style":{},"children":["detach"]}],["$","span","code-segement51",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement52",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement53",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement54",{"className":"$undefined","style":{},"children":["    outputs"]}],["$","span","code-segement55",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement56",{"className":"$undefined","style":{},"children":["append"]}],["$","span","code-segement57",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement58",{"className":"$undefined","style":{},"children":["output"]}],["$","span","code-segement59",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement60",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement62",{"className":"$undefined","style":{},"children":["end_time "]}],["$","span","code-segement63",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement64",{"className":"$undefined","style":{},"children":[" time"]}],["$","span","code-segement65",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement66",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement67",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement68",{"className":"$undefined","style":{},"children":["time_elapsed "]}],["$","span","code-segement69",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement70",{"className":"$undefined","style":{},"children":[" end_time "]}],["$","span","code-segement71",{"className":"token","style":{"color":"#a04900"},"children":["-"]}],["$","span","code-segement72",{"className":"$undefined","style":{},"children":[" start_time\n"]}],["$","span","code-segement73",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement74",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement75",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement76",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement77",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement78",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\"Num images: "]}],["$","span","code-segement79",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement80",{"className":"token string-interpolation interpolation","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement81",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement82",{"className":"token string-interpolation interpolation","style":{},"children":["test_images"]}],["$","span","code-segement83",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement84",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement85",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[", \""]}],["$","span","code-segement86",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement87",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement88",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\"Batch size: "]}],["$","span","code-segement89",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement90",{"className":"token string-interpolation interpolation","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement91",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement92",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[", \""]}],["$","span","code-segement93",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement94",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement95",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\"Time taken: "]}],["$","span","code-segement96",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement97",{"className":"token string-interpolation interpolation","style":{},"children":["time_elapsed"]}],["$","span","code-segement98",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement99",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[" s, \""]}],["$","span","code-segement100",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement101",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement102",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\"Time taken per image: "]}],["$","span","code-segement103",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement104",{"className":"token string-interpolation interpolation","style":{"color":"#755f00"},"children":["1000"]}],["$","span","code-segement105",{"className":"token string-interpolation interpolation","style":{},"children":[" "]}],["$","span","code-segement106",{"className":"token string-interpolation interpolation","style":{"color":"#a04900"},"children":["*"]}],["$","span","code-segement107",{"className":"token string-interpolation interpolation","style":{},"children":[" time_elapsed "]}],["$","span","code-segement108",{"className":"token string-interpolation interpolation","style":{"color":"#a04900"},"children":["/"]}],["$","span","code-segement109",{"className":"token string-interpolation interpolation","style":{},"children":[" "]}],["$","span","code-segement110",{"className":"token string-interpolation interpolation","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement111",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement112",{"className":"token string-interpolation interpolation","style":{},"children":["test_images"]}],["$","span","code-segement113",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement114",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement115",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[" ms\""]}],["$","span","code-segement116",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement117",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement118",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement119",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement121",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement122",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement123",{"className":"$undefined","style":{},"children":[" output "]}],["$","span","code-segement124",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement125",{"className":"$undefined","style":{},"children":[" outputs"]}],["$","span","code-segement126",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement127",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement128",{"className":"$undefined","style":{},"children":["    boolean_array "]}],["$","span","code-segement129",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement130",{"className":"$undefined","style":{},"children":[" model"]}],["$","span","code-segement131",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement132",{"className":"$undefined","style":{},"children":["postprocess"]}],["$","span","code-segement133",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement134",{"className":"$undefined","style":{},"children":["output"]}],["$","span","code-segement135",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement136",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement137",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement138",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement139",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement140",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement141",{"className":"token","style":{"color":"#755f00"},"children":["512"]}],["$","span","code-segement142",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement143",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement144",{"className":"token","style":{"color":"#755f00"},"children":["512"]}],["$","span","code-segement145",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement146",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement147",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement148",{"className":"$undefined","style":{},"children":["    binary_image "]}],["$","span","code-segement149",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement150",{"className":"$undefined","style":{},"children":[" boolean_array"]}],["$","span","code-segement151",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement152",{"className":"$undefined","style":{},"children":["astype"]}],["$","span","code-segement153",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement154",{"className":"$undefined","style":{},"children":["np"]}],["$","span","code-segement155",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement156",{"className":"$undefined","style":{},"children":["uint8"]}],["$","span","code-segement157",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement158",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement159",{"className":"token","style":{"color":"#a04900"},"children":["*"]}],["$","span","code-segement160",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement161",{"className":"token","style":{"color":"#755f00"},"children":["255"]}],["$","span","code-segement162",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement163",{"className":"$undefined","style":{},"children":["    file_path "]}],["$","span","code-segement164",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement165",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement166",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement167",{"className":"$undefined","style":{},"children":["outputs_dir"]}],["$","span","code-segement168",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement169",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement170",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\""]}],["$","span","code-segement171",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement172",{"className":"token string-interpolation interpolation","style":{},"children":["i"]}],["$","span","code-segement173",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement174",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[".png\""]}],["$","span","code-segement175",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement176",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement177",{"className":"$undefined","style":{},"children":["    cv2"]}],["$","span","code-segement178",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement179",{"className":"$undefined","style":{},"children":["imwrite"]}],["$","span","code-segement180",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement181",{"className":"$undefined","style":{},"children":["file_path"]}],["$","span","code-segement182",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement183",{"className":"$undefined","style":{},"children":[" binary_image"]}],["$","span","code-segement184",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Lc","24",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Here's the entire ",["$","$La","24-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"test.py"}]," file:"]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"$1a"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" os "]}],["$","span","code-segement2",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":[" listdir\n"]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement5",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement6",{"className":"$undefined","style":{},"children":[" os"]}],["$","span","code-segement7",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":["path "]}],["$","span","code-segement9",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":[" join "]}],["$","span","code-segement11",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement12",{"className":"$undefined","style":{},"children":[" path_join\n"]}],["$","span","code-segement13",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement14",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":[" time "]}],["$","span","code-segement16",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement17",{"className":"$undefined","style":{},"children":[" time\n"]}],"\n",["$","span","code-segement19",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement20",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement21",{"className":"$undefined","style":{},"children":[" cv2\n"]}],["$","span","code-segement22",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement23",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement24",{"className":"$undefined","style":{},"children":[" numpy "]}],["$","span","code-segement25",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":[" np\n"]}],"\n",["$","span","code-segement28",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement29",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement30",{"className":"$undefined","style":{},"children":[" config "]}],["$","span","code-segement31",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement32",{"className":"$undefined","style":{},"children":[" inputs_dir"]}],["$","span","code-segement33",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement34",{"className":"$undefined","style":{},"children":[" outputs_dir"]}],["$","span","code-segement35",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement36",{"className":"$undefined","style":{},"children":[" weights_dir\n"]}],["$","span","code-segement37",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement38",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement39",{"className":"$undefined","style":{},"children":[" model "]}],["$","span","code-segement40",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement41",{"className":"$undefined","style":{},"children":[" Model\n"]}],"\n","\n",["$","span","code-segement44",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement45",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement46",{"className":"$undefined","style":{},"children":[" __name__ "]}],["$","span","code-segement47",{"className":"token","style":{"color":"#a04900"},"children":["=="]}],["$","span","code-segement48",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement49",{"className":"token","style":{"color":"#116b00"},"children":["\"__main__\""]}],["$","span","code-segement50",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement51",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement52",{"className":"$undefined","style":{},"children":["    test_images "]}],["$","span","code-segement53",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement54",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement55",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement56",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement57",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement58",{"className":"$undefined","style":{},"children":["    all_image_names "]}],["$","span","code-segement59",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement60",{"className":"$undefined","style":{},"children":[" listdir"]}],["$","span","code-segement61",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement62",{"className":"$undefined","style":{},"children":["inputs_dir"]}],["$","span","code-segement63",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement64",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement65",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement66",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement67",{"className":"$undefined","style":{},"children":[" i"]}],["$","span","code-segement68",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement69",{"className":"$undefined","style":{},"children":[" image_name "]}],["$","span","code-segement70",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement71",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement72",{"className":"token","style":{"color":"#af00af"},"children":["enumerate"]}],["$","span","code-segement73",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement74",{"className":"$undefined","style":{},"children":["all_image_names"]}],["$","span","code-segement75",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement76",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement77",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement78",{"className":"$undefined","style":{},"children":["        image "]}],["$","span","code-segement79",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement80",{"className":"$undefined","style":{},"children":[" cv2"]}],["$","span","code-segement81",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement82",{"className":"$undefined","style":{},"children":["imread"]}],["$","span","code-segement83",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement84",{"className":"$undefined","style":{},"children":["path_join"]}],["$","span","code-segement85",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement86",{"className":"$undefined","style":{},"children":["inputs_dir"]}],["$","span","code-segement87",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement88",{"className":"$undefined","style":{},"children":[" image_name"]}],["$","span","code-segement89",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement90",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement91",{"className":"$undefined","style":{},"children":[" cv2"]}],["$","span","code-segement92",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement93",{"className":"$undefined","style":{},"children":["IMREAD_GRAYSCALE"]}],["$","span","code-segement94",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement95",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement96",{"className":"$undefined","style":{},"children":["        test_images"]}],["$","span","code-segement97",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement98",{"className":"$undefined","style":{},"children":["append"]}],["$","span","code-segement99",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement100",{"className":"$undefined","style":{},"children":["image"]}],["$","span","code-segement101",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement102",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement104",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement105",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement106",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement107",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement108",{"className":"$undefined","style":{},"children":["i "]}],["$","span","code-segement109",{"className":"token","style":{"color":"#a04900"},"children":["+"]}],["$","span","code-segement110",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement111",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement112",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement113",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement114",{"className":"token","style":{"color":"#a04900"},"children":["%"]}],["$","span","code-segement115",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement116",{"className":"token","style":{"color":"#755f00"},"children":["500"]}],["$","span","code-segement117",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement118",{"className":"token","style":{"color":"#a04900"},"children":["=="]}],["$","span","code-segement119",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement120",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement121",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement122",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement123",{"className":"$undefined","style":{},"children":["            "]}],["$","span","code-segement124",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement125",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement126",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\"Loaded images: "]}],["$","span","code-segement127",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement128",{"className":"token string-interpolation interpolation","style":{},"children":["i"]}],["$","span","code-segement129",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement130",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[" / "]}],["$","span","code-segement131",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement132",{"className":"token string-interpolation interpolation","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement133",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement134",{"className":"token string-interpolation interpolation","style":{},"children":["all_image_names"]}],["$","span","code-segement135",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement136",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement137",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["\""]}],["$","span","code-segement138",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement139",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement141",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement142",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement143",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement144",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement145",{"className":"$undefined","style":{},"children":["i "]}],["$","span","code-segement146",{"className":"token","style":{"color":"#a04900"},"children":["+"]}],["$","span","code-segement147",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement148",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement149",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement150",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement151",{"className":"token","style":{"color":"#a04900"},"children":["%"]}],["$","span","code-segement152",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement153",{"className":"token","style":{"color":"#755f00"},"children":["50"]}],["$","span","code-segement154",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement155",{"className":"token","style":{"color":"#a04900"},"children":["=="]}],["$","span","code-segement156",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement157",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement158",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement159",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement160",{"className":"$undefined","style":{},"children":["            "]}],["$","span","code-segement161",{"className":"token","style":{"color":"#a04900"},"children":["break"]}],["$","span","code-segement162",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement163",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement164",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement165",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement166",{"className":"token","style":{"color":"#116b00"},"children":["\"Images loaded.\""]}],["$","span","code-segement167",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement168",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement170",{"className":"$undefined","style":{},"children":["    model "]}],["$","span","code-segement171",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement172",{"className":"$undefined","style":{},"children":[" Model"]}],["$","span","code-segement173",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement174",{"className":"$undefined","style":{},"children":["path_join"]}],["$","span","code-segement175",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement176",{"className":"$undefined","style":{},"children":["weights_dir"]}],["$","span","code-segement177",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement178",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement179",{"className":"token","style":{"color":"#116b00"},"children":["\"weights_001.pt\""]}],["$","span","code-segement180",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement181",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement182",{"className":"$undefined","style":{},"children":[" use_cuda"]}],["$","span","code-segement183",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement184",{"className":"token","style":{"color":"#755f00"},"children":["False"]}],["$","span","code-segement185",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement186",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement187",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement188",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement189",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement190",{"className":"token","style":{"color":"#116b00"},"children":["\"Model loaded.\""]}],["$","span","code-segement191",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement192",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement194",{"className":"$undefined","style":{},"children":["    start_time "]}],["$","span","code-segement195",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement196",{"className":"$undefined","style":{},"children":[" time"]}],["$","span","code-segement197",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement198",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement199",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement201",{"className":"$undefined","style":{},"children":["    outputs "]}],["$","span","code-segement202",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement203",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement204",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement205",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement206",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement207",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement208",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement209",{"className":"$undefined","style":{},"children":[" i"]}],["$","span","code-segement210",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement211",{"className":"$undefined","style":{},"children":[" test_image "]}],["$","span","code-segement212",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement213",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement214",{"className":"token","style":{"color":"#af00af"},"children":["enumerate"]}],["$","span","code-segement215",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement216",{"className":"$undefined","style":{},"children":["test_images"]}],["$","span","code-segement217",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement218",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement219",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement220",{"className":"$undefined","style":{},"children":["        preprocessed_image "]}],["$","span","code-segement221",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement222",{"className":"$undefined","style":{},"children":[" model"]}],["$","span","code-segement223",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement224",{"className":"$undefined","style":{},"children":["preprocess"]}],["$","span","code-segement225",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement226",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement227",{"className":"$undefined","style":{},"children":["test_image"]}],["$","span","code-segement228",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement229",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement230",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement231",{"className":"$undefined","style":{},"children":["        output "]}],["$","span","code-segement232",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement233",{"className":"$undefined","style":{},"children":[" model"]}],["$","span","code-segement234",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement235",{"className":"$undefined","style":{},"children":["forward"]}],["$","span","code-segement236",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement237",{"className":"$undefined","style":{},"children":["preprocessed_image"]}],["$","span","code-segement238",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement239",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement240",{"className":"$undefined","style":{},"children":["        output "]}],["$","span","code-segement241",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement242",{"className":"$undefined","style":{},"children":[" output"]}],["$","span","code-segement243",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement244",{"className":"$undefined","style":{},"children":["detach"]}],["$","span","code-segement245",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement246",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement247",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement248",{"className":"$undefined","style":{},"children":["        outputs"]}],["$","span","code-segement249",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement250",{"className":"$undefined","style":{},"children":["append"]}],["$","span","code-segement251",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement252",{"className":"$undefined","style":{},"children":["output"]}],["$","span","code-segement253",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement254",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement256",{"className":"$undefined","style":{},"children":["    end_time "]}],["$","span","code-segement257",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement258",{"className":"$undefined","style":{},"children":[" time"]}],["$","span","code-segement259",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement260",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement261",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement262",{"className":"$undefined","style":{},"children":["    time_elapsed "]}],["$","span","code-segement263",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement264",{"className":"$undefined","style":{},"children":[" end_time "]}],["$","span","code-segement265",{"className":"token","style":{"color":"#a04900"},"children":["-"]}],["$","span","code-segement266",{"className":"$undefined","style":{},"children":[" start_time\n"]}],["$","span","code-segement267",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement268",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement269",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement270",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement271",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement272",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\"Num images: "]}],["$","span","code-segement273",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement274",{"className":"token string-interpolation interpolation","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement275",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement276",{"className":"token string-interpolation interpolation","style":{},"children":["test_images"]}],["$","span","code-segement277",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement278",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement279",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[", \""]}],["$","span","code-segement280",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement281",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement282",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\"Batch size: "]}],["$","span","code-segement283",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement284",{"className":"token string-interpolation interpolation","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement285",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement286",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[", \""]}],["$","span","code-segement287",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement288",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement289",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\"Time taken: "]}],["$","span","code-segement290",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement291",{"className":"token string-interpolation interpolation","style":{},"children":["time_elapsed"]}],["$","span","code-segement292",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement293",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[" s, \""]}],["$","span","code-segement294",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement295",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement296",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\"Time taken per image: "]}],["$","span","code-segement297",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement298",{"className":"token string-interpolation interpolation","style":{"color":"#755f00"},"children":["1000"]}],["$","span","code-segement299",{"className":"token string-interpolation interpolation","style":{},"children":[" "]}],["$","span","code-segement300",{"className":"token string-interpolation interpolation","style":{"color":"#a04900"},"children":["*"]}],["$","span","code-segement301",{"className":"token string-interpolation interpolation","style":{},"children":[" time_elapsed "]}],["$","span","code-segement302",{"className":"token string-interpolation interpolation","style":{"color":"#a04900"},"children":["/"]}],["$","span","code-segement303",{"className":"token string-interpolation interpolation","style":{},"children":[" "]}],["$","span","code-segement304",{"className":"token string-interpolation interpolation","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement305",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement306",{"className":"token string-interpolation interpolation","style":{},"children":["test_images"]}],["$","span","code-segement307",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement308",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement309",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[" ms\""]}],["$","span","code-segement310",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement311",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement312",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement313",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement315",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement316",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement317",{"className":"$undefined","style":{},"children":[" output "]}],["$","span","code-segement318",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement319",{"className":"$undefined","style":{},"children":[" outputs"]}],["$","span","code-segement320",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement321",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement322",{"className":"$undefined","style":{},"children":["        boolean_array "]}],["$","span","code-segement323",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement324",{"className":"$undefined","style":{},"children":[" model"]}],["$","span","code-segement325",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement326",{"className":"$undefined","style":{},"children":["postprocess"]}],["$","span","code-segement327",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement328",{"className":"$undefined","style":{},"children":["output"]}],["$","span","code-segement329",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement330",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement331",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement332",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement333",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement334",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement335",{"className":"token","style":{"color":"#755f00"},"children":["512"]}],["$","span","code-segement336",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement337",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement338",{"className":"token","style":{"color":"#755f00"},"children":["512"]}],["$","span","code-segement339",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement340",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement341",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement342",{"className":"$undefined","style":{},"children":["        binary_image "]}],["$","span","code-segement343",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement344",{"className":"$undefined","style":{},"children":[" boolean_array"]}],["$","span","code-segement345",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement346",{"className":"$undefined","style":{},"children":["astype"]}],["$","span","code-segement347",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement348",{"className":"$undefined","style":{},"children":["np"]}],["$","span","code-segement349",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement350",{"className":"$undefined","style":{},"children":["uint8"]}],["$","span","code-segement351",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement352",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement353",{"className":"token","style":{"color":"#a04900"},"children":["*"]}],["$","span","code-segement354",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement355",{"className":"token","style":{"color":"#755f00"},"children":["255"]}],["$","span","code-segement356",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement357",{"className":"$undefined","style":{},"children":["        file_path "]}],["$","span","code-segement358",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement359",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement360",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement361",{"className":"$undefined","style":{},"children":["outputs_dir"]}],["$","span","code-segement362",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement363",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement364",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\""]}],["$","span","code-segement365",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement366",{"className":"token string-interpolation interpolation","style":{},"children":["i"]}],["$","span","code-segement367",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement368",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[".png\""]}],["$","span","code-segement369",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement370",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement371",{"className":"$undefined","style":{},"children":["        cv2"]}],["$","span","code-segement372",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement373",{"className":"$undefined","style":{},"children":["imwrite"]}],["$","span","code-segement374",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement375",{"className":"$undefined","style":{},"children":["file_path"]}],["$","span","code-segement376",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement377",{"className":"$undefined","style":{},"children":[" binary_image"]}],["$","span","code-segement378",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Lc","26",{"id":"cpu-inference","variant":"h4","component":"h1","mb":2,"children":["$","strong",null,{"children":"CPU Inference"}]}],["$","$Lc","27",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Right now, in the line where we have initialized the model, we pass the ",["$","$La","27-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"use_cuda"}]," parameter as ",["$","$La","27-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"False"}],". Actually, we don't really need to do that because that is what it defaults to."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"model = Model(path_join(weights_dir, \"weights_001.pt\"), use_cuda=False)"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"$undefined","style":{},"children":["model "]}],["$","span","code-segement1",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement2",{"className":"$undefined","style":{},"children":[" Model"]}],["$","span","code-segement3",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":["path_join"]}],["$","span","code-segement5",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement6",{"className":"$undefined","style":{},"children":["weights_dir"]}],["$","span","code-segement7",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement9",{"className":"token","style":{"color":"#116b00"},"children":["\"weights_001.pt\""]}],["$","span","code-segement10",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement11",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement12",{"className":"$undefined","style":{},"children":[" use_cuda"]}],["$","span","code-segement13",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement14",{"className":"token","style":{"color":"#755f00"},"children":["False"]}],["$","span","code-segement15",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Lc","29",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Let's run the script."]}],["$","$Lc","30",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","For 5,000 images, it took around 6674.206 seconds (01h51m14s). This is around 1.3348 s per image or 0.7491 FPS."]}],["$","$La","31",{"sx":{"width":"100%","display":"flex","flexDirection":"column","justifyContent":"center","alignItems":"center","marginBottom":2},"children":["$","$L1b",null,{"sx":{"backgroundColor":"rgb(227, 234, 242)"},"children":[["$","$Lc",null,{"variant":"h6","component":"h4","sx":{"width":"100%","textAlign":"center","marginTop":2},"children":["$","strong",null,{"children":"Num images: 5,000 | Device: CPU"}]}],["$","$L1c",null,{"children":[["$","$L1d",null,{"children":["$","$L1e",null,{"children":[["$","$L1f","0",{"sx":{"fontWeight":"bold"},"children":"Batch Size"}],["$","$L1f","1",{"sx":{"fontWeight":"bold"},"children":"Time Taken (s)"}],["$","$L1f","2",{"sx":{"fontWeight":"bold"},"children":"Time Taken per Image (s)"}],["$","$L1f","3",{"sx":{"fontWeight":"bold"},"children":"FPS"}]]}]}],["$","$L20",null,{"children":[["$","$L1e","0",{"sx":{"&:last-child td, &:last-child th":{"border":0}},"children":[["$","$L1f","0",{"children":"1"}],["$","$L1f","1",{"children":"01h51m14s"}],["$","$L1f","2",{"children":"1.3348"}],["$","$L1f","3",{"children":"0.7491"}]]}]]}]]}]]}]}],["$","$Lc","32",{"id":"gpu-inference","variant":"h4","component":"h1","mb":2,"children":["$","strong",null,{"children":"GPU Inference"}]}],["$","$Lc","33",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Before we try to run our model on a GPU, we should make sure that CUDA is indeed available to torch. Open up a new Python interpreter in your environment and run the following lines:"]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"import torch\n\ntorch.cuda.is_available()"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" torch\n"]}],"\n",["$","span","code-segement3",{"className":"$undefined","style":{},"children":["torch"]}],["$","span","code-segement4",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement5",{"className":"$undefined","style":{},"children":["cuda"]}],["$","span","code-segement6",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement7",{"className":"$undefined","style":{},"children":["is_available"]}],["$","span","code-segement8",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement9",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Lc","35",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","You should get ",["$","$La","35-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"True"}]," in the output."]}],["$","$Lc","36",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Let's convert our code to now run the inference on the machine's GPU. Since we have already written logic in the ",["$","$La","36-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"model.py"}]," to handle this, we can change our inference device by changing a single line in the ",["$","$La","36-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"test.py"}]," where we are initializing our model."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"model = Model(path_join(weights_dir, \"weights_001.pt\"), use_cuda=True)"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"$undefined","style":{},"children":["model "]}],["$","span","code-segement1",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement2",{"className":"$undefined","style":{},"children":[" Model"]}],["$","span","code-segement3",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":["path_join"]}],["$","span","code-segement5",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement6",{"className":"$undefined","style":{},"children":["weights_dir"]}],["$","span","code-segement7",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement9",{"className":"token","style":{"color":"#116b00"},"children":["\"weights_001.pt\""]}],["$","span","code-segement10",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement11",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement12",{"className":"$undefined","style":{},"children":[" use_cuda"]}],["$","span","code-segement13",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement14",{"className":"token","style":{"color":"#755f00"},"children":["True"]}],["$","span","code-segement15",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Lc","38",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Let's run this and see how much of a speed improvement we got."]}],["$","$La","39",{"sx":{"width":"100%","display":"flex","flexDirection":"column","justifyContent":"center","alignItems":"center","marginBottom":2},"children":["$","$L1b",null,{"sx":{"backgroundColor":"rgb(227, 234, 242)"},"children":[["$","$Lc",null,{"variant":"h6","component":"h4","sx":{"width":"100%","textAlign":"center","marginTop":2},"children":["$","strong",null,{"children":"Num images: 5,000 | Device: GPU"}]}],["$","$L1c",null,{"children":[["$","$L1d",null,{"children":["$","$L1e",null,{"children":[["$","$L1f","0",{"sx":{"fontWeight":"bold"},"children":"Batch Size"}],["$","$L1f","1",{"sx":{"fontWeight":"bold"},"children":"Time Taken (s)"}],["$","$L1f","2",{"sx":{"fontWeight":"bold"},"children":"Time Taken per Image (ms)"}],["$","$L1f","3",{"sx":{"fontWeight":"bold"},"children":"FPS"}]]}]}],["$","$L20",null,{"children":[["$","$L1e","0",{"sx":{"&:last-child td, &:last-child th":{"border":0}},"children":[["$","$L1f","0",{"children":"1"}],["$","$L1f","1",{"children":"49.6585s"}],["$","$L1f","2",{"children":"9.9317"}],["$","$L1f","3",{"children":"100.6876"}]]}]]}]]}]]}]}],["$","$Lc","40",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Woah! That's a 134.41 times improvement. The ",["$","$L17","40-link",{"href":"https://en.wikipedia.org/wiki/MythBusters","rel":"noopener noreferrer","target":"_blank","color":"primary","underline":"hover","children":"MythBusters"}]," made a ",["$","$L17","40-link",{"href":"https://www.youtube.com/watch?v=-P28LKWTzrI","rel":"noopener noreferrer","target":"_blank","color":"primary","underline":"hover","children":"good illustration of this speed comparison"}],". GPUs mean business when it comes to crunching numbers."]}],["$","$Lc","41",{"id":"batched-gpu-inference","variant":"h4","component":"h1","mb":2,"children":["$","strong",null,{"children":"Batched GPU Inference"}]}],["$","$Lc","42",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Let's take a look at the ",["$","$La","42-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"preprocess"}]," function in ",["$","$La","42-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"model.py"}],"."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"def preprocess(self, images):\n    transformed_images = torch.stack([self.preprocessing_transform(image) for image in images])\n    transformed_images = transformed_images.type(self.dtype)\n\n    batched_images = transformed_images.to(self.device)\n\n    return batched_images"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["def"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement2",{"className":"token","style":{"color":"#7c00aa"},"children":["preprocess"]}],["$","span","code-segement3",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement5",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement6",{"className":"$undefined","style":{},"children":[" images"]}],["$","span","code-segement7",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement8",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement9",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":["    transformed_images "]}],["$","span","code-segement11",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement12",{"className":"$undefined","style":{},"children":[" torch"]}],["$","span","code-segement13",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement14",{"className":"$undefined","style":{},"children":["stack"]}],["$","span","code-segement15",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement16",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement17",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement18",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement19",{"className":"$undefined","style":{},"children":["preprocessing_transform"]}],["$","span","code-segement20",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement21",{"className":"$undefined","style":{},"children":["image"]}],["$","span","code-segement22",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement23",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement24",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement25",{"className":"$undefined","style":{},"children":[" image "]}],["$","span","code-segement26",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement27",{"className":"$undefined","style":{},"children":[" images"]}],["$","span","code-segement28",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement29",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement30",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement31",{"className":"$undefined","style":{},"children":["    transformed_images "]}],["$","span","code-segement32",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement33",{"className":"$undefined","style":{},"children":[" transformed_images"]}],["$","span","code-segement34",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement35",{"className":"token","style":{"color":"#af00af"},"children":["type"]}],["$","span","code-segement36",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement37",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement38",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement39",{"className":"$undefined","style":{},"children":["dtype"]}],["$","span","code-segement40",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement41",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement43",{"className":"$undefined","style":{},"children":["    batched_images "]}],["$","span","code-segement44",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement45",{"className":"$undefined","style":{},"children":[" transformed_images"]}],["$","span","code-segement46",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement47",{"className":"$undefined","style":{},"children":["to"]}],["$","span","code-segement48",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement49",{"className":"$undefined","style":{},"children":["self"]}],["$","span","code-segement50",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement51",{"className":"$undefined","style":{},"children":["device"]}],["$","span","code-segement52",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement53",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement55",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement56",{"className":"token","style":{"color":"#a04900"},"children":["return"]}],["$","span","code-segement57",{"className":"$undefined","style":{},"children":[" batched_images"]}]]]}]}]]}],["$","$Lc","44",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Here, we are accepting a list of images, transforming them using the preprocessing transform, and then combining them into a single tensor using ",["$","$La","44-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"torch.stack"}],". We can call ",["$","$La","44-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"forward"}]," with this single tensor and the output tensor will include the result for each of the inputs i.e. the output is also a batch."]}],["$","$Lc","45",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","In ",["$","$La","45-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"test.py"}],", we'll create a variable called ",["$","$La","45-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"batch_size"}]," to define how many images are preprocessed and sent for inference at once. Then, we can create batches from the ",["$","$La","45-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"test_images"}]," list as follows:"]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"batch_size = 4\ntest_batches = [test_images[i:i+batch_size] for i in range(0, len(test_images), batch_size)]"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"$undefined","style":{},"children":["batch_size "]}],["$","span","code-segement1",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement2",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement3",{"className":"token","style":{"color":"#755f00"},"children":["4"]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement5",{"className":"$undefined","style":{},"children":["test_batches "]}],["$","span","code-segement6",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement7",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement8",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement9",{"className":"$undefined","style":{},"children":["test_images"]}],["$","span","code-segement10",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement11",{"className":"$undefined","style":{},"children":["i"]}],["$","span","code-segement12",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement13",{"className":"$undefined","style":{},"children":["i"]}],["$","span","code-segement14",{"className":"token","style":{"color":"#a04900"},"children":["+"]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":["batch_size"]}],["$","span","code-segement16",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement17",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement18",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement19",{"className":"$undefined","style":{},"children":[" i "]}],["$","span","code-segement20",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement21",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement22",{"className":"token","style":{"color":"#af00af"},"children":["range"]}],["$","span","code-segement23",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement24",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement25",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement27",{"className":"token","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement28",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement29",{"className":"$undefined","style":{},"children":["test_images"]}],["$","span","code-segement30",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement31",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement32",{"className":"$undefined","style":{},"children":[" batch_size"]}],["$","span","code-segement33",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement34",{"className":"token","style":{"color":"#111b27"},"children":["]"]}]]]}]}]]}],["$","$Lc","47",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Let's iterate the batch size from 1 to 32 (at 32 my GPU ran out of memory) and print the time taken to process."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"for batch_size in [1, 2, 4, 8, 16, 32]: #, 64, 128, 256]:\n    test_batches = [test_images[i:i+batch_size] for i in range(0, len(test_images), batch_size)]\n    outputs = []\n\n    start_time = time()\n    preprocessed_batches = [model.preprocess(batch) for batch in test_batches]\n\n    for i, preprocessed_batch in enumerate(preprocessed_batches):\n        output = model.forward(preprocessed_batch)\n        output = output.detach()\n        outputs.append(output)\n\n        if (i + 1) % 25 == 0:\n            print(f\"Processed: {i} / {len(preprocessed_batches)}\")\n\n    end_time = time()\n    time_elapsed = end_time - start_time\n\n    print(\n        f\"Num images: {len(test_images)}, \"\n        f\"Batch size: {batch_size}, \"\n        f\"Time taken: {time_elapsed} s, \"\n        f\"Time taken per image: {1000 * time_elapsed / len(test_images)} ms\"\n    )"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" batch_size "]}],["$","span","code-segement2",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement4",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement5",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement6",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement7",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement8",{"className":"token","style":{"color":"#755f00"},"children":["2"]}],["$","span","code-segement9",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement11",{"className":"token","style":{"color":"#755f00"},"children":["4"]}],["$","span","code-segement12",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement13",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement14",{"className":"token","style":{"color":"#755f00"},"children":["8"]}],["$","span","code-segement15",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement16",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement17",{"className":"token","style":{"color":"#755f00"},"children":["16"]}],["$","span","code-segement18",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement19",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement20",{"className":"token","style":{"color":"#755f00"},"children":["32"]}],["$","span","code-segement21",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement22",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement23",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement24",{"className":"token","style":{"color":"#3c526d"},"children":["#, 64, 128, 256]:"]}],["$","span","code-segement25",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":["    test_batches "]}],["$","span","code-segement27",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement28",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement29",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement30",{"className":"$undefined","style":{},"children":["test_images"]}],["$","span","code-segement31",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement32",{"className":"$undefined","style":{},"children":["i"]}],["$","span","code-segement33",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement34",{"className":"$undefined","style":{},"children":["i"]}],["$","span","code-segement35",{"className":"token","style":{"color":"#a04900"},"children":["+"]}],["$","span","code-segement36",{"className":"$undefined","style":{},"children":["batch_size"]}],["$","span","code-segement37",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement38",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement39",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement40",{"className":"$undefined","style":{},"children":[" i "]}],["$","span","code-segement41",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement42",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement43",{"className":"token","style":{"color":"#af00af"},"children":["range"]}],["$","span","code-segement44",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement45",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement46",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement47",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement48",{"className":"token","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement49",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement50",{"className":"$undefined","style":{},"children":["test_images"]}],["$","span","code-segement51",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement52",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement53",{"className":"$undefined","style":{},"children":[" batch_size"]}],["$","span","code-segement54",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement55",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement56",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement57",{"className":"$undefined","style":{},"children":["    outputs "]}],["$","span","code-segement58",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement59",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement60",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement61",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement62",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement64",{"className":"$undefined","style":{},"children":["    start_time "]}],["$","span","code-segement65",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement66",{"className":"$undefined","style":{},"children":[" time"]}],["$","span","code-segement67",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement68",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement69",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement70",{"className":"$undefined","style":{},"children":["    preprocessed_batches "]}],["$","span","code-segement71",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement72",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement73",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement74",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement75",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement76",{"className":"$undefined","style":{},"children":["preprocess"]}],["$","span","code-segement77",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement78",{"className":"$undefined","style":{},"children":["batch"]}],["$","span","code-segement79",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement80",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement81",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement82",{"className":"$undefined","style":{},"children":[" batch "]}],["$","span","code-segement83",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement84",{"className":"$undefined","style":{},"children":[" test_batches"]}],["$","span","code-segement85",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement86",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement88",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement89",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement90",{"className":"$undefined","style":{},"children":[" i"]}],["$","span","code-segement91",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement92",{"className":"$undefined","style":{},"children":[" preprocessed_batch "]}],["$","span","code-segement93",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement94",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement95",{"className":"token","style":{"color":"#af00af"},"children":["enumerate"]}],["$","span","code-segement96",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement97",{"className":"$undefined","style":{},"children":["preprocessed_batches"]}],["$","span","code-segement98",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement99",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement100",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement101",{"className":"$undefined","style":{},"children":["        output "]}],["$","span","code-segement102",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement103",{"className":"$undefined","style":{},"children":[" model"]}],["$","span","code-segement104",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement105",{"className":"$undefined","style":{},"children":["forward"]}],["$","span","code-segement106",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement107",{"className":"$undefined","style":{},"children":["preprocessed_batch"]}],["$","span","code-segement108",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement109",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement110",{"className":"$undefined","style":{},"children":["        output "]}],["$","span","code-segement111",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement112",{"className":"$undefined","style":{},"children":[" output"]}],["$","span","code-segement113",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement114",{"className":"$undefined","style":{},"children":["detach"]}],["$","span","code-segement115",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement116",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement117",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement118",{"className":"$undefined","style":{},"children":["        outputs"]}],["$","span","code-segement119",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement120",{"className":"$undefined","style":{},"children":["append"]}],["$","span","code-segement121",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement122",{"className":"$undefined","style":{},"children":["output"]}],["$","span","code-segement123",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement124",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement126",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement127",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement128",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement129",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement130",{"className":"$undefined","style":{},"children":["i "]}],["$","span","code-segement131",{"className":"token","style":{"color":"#a04900"},"children":["+"]}],["$","span","code-segement132",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement133",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement134",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement135",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement136",{"className":"token","style":{"color":"#a04900"},"children":["%"]}],["$","span","code-segement137",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement138",{"className":"token","style":{"color":"#755f00"},"children":["25"]}],["$","span","code-segement139",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement140",{"className":"token","style":{"color":"#a04900"},"children":["=="]}],["$","span","code-segement141",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement142",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement143",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement144",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement145",{"className":"$undefined","style":{},"children":["            "]}],["$","span","code-segement146",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement147",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement148",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\"Processed: "]}],["$","span","code-segement149",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement150",{"className":"token string-interpolation interpolation","style":{},"children":["i"]}],["$","span","code-segement151",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement152",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[" / "]}],["$","span","code-segement153",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement154",{"className":"token string-interpolation interpolation","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement155",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement156",{"className":"token string-interpolation interpolation","style":{},"children":["preprocessed_batches"]}],["$","span","code-segement157",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement158",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement159",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["\""]}],["$","span","code-segement160",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement161",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement163",{"className":"$undefined","style":{},"children":["    end_time "]}],["$","span","code-segement164",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement165",{"className":"$undefined","style":{},"children":[" time"]}],["$","span","code-segement166",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement167",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement168",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement169",{"className":"$undefined","style":{},"children":["    time_elapsed "]}],["$","span","code-segement170",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement171",{"className":"$undefined","style":{},"children":[" end_time "]}],["$","span","code-segement172",{"className":"token","style":{"color":"#a04900"},"children":["-"]}],["$","span","code-segement173",{"className":"$undefined","style":{},"children":[" start_time\n"]}],"\n",["$","span","code-segement175",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement176",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement177",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement178",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement179",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement180",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\"Num images: "]}],["$","span","code-segement181",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement182",{"className":"token string-interpolation interpolation","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement183",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement184",{"className":"token string-interpolation interpolation","style":{},"children":["test_images"]}],["$","span","code-segement185",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement186",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement187",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[", \""]}],["$","span","code-segement188",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement189",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement190",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\"Batch size: "]}],["$","span","code-segement191",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement192",{"className":"token string-interpolation interpolation","style":{},"children":["batch_size"]}],["$","span","code-segement193",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement194",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[", \""]}],["$","span","code-segement195",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement196",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement197",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\"Time taken: "]}],["$","span","code-segement198",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement199",{"className":"token string-interpolation interpolation","style":{},"children":["time_elapsed"]}],["$","span","code-segement200",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement201",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[" s, \""]}],["$","span","code-segement202",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement203",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement204",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\"Time taken per image: "]}],["$","span","code-segement205",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement206",{"className":"token string-interpolation interpolation","style":{"color":"#755f00"},"children":["1000"]}],["$","span","code-segement207",{"className":"token string-interpolation interpolation","style":{},"children":[" "]}],["$","span","code-segement208",{"className":"token string-interpolation interpolation","style":{"color":"#a04900"},"children":["*"]}],["$","span","code-segement209",{"className":"token string-interpolation interpolation","style":{},"children":[" time_elapsed "]}],["$","span","code-segement210",{"className":"token string-interpolation interpolation","style":{"color":"#a04900"},"children":["/"]}],["$","span","code-segement211",{"className":"token string-interpolation interpolation","style":{},"children":[" "]}],["$","span","code-segement212",{"className":"token string-interpolation interpolation","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement213",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement214",{"className":"token string-interpolation interpolation","style":{},"children":["test_images"]}],["$","span","code-segement215",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement216",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement217",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[" ms\""]}],["$","span","code-segement218",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement219",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement220",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Lc","49",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Here's the entire ",["$","$La","49-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"test.py"}]," file:"]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"$21"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement1",{"className":"$undefined","style":{},"children":[" os "]}],["$","span","code-segement2",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement3",{"className":"$undefined","style":{},"children":[" listdir\n"]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement5",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement6",{"className":"$undefined","style":{},"children":[" os"]}],["$","span","code-segement7",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":["path "]}],["$","span","code-segement9",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement10",{"className":"$undefined","style":{},"children":[" join "]}],["$","span","code-segement11",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement12",{"className":"$undefined","style":{},"children":[" path_join\n"]}],["$","span","code-segement13",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement14",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement15",{"className":"$undefined","style":{},"children":[" time "]}],["$","span","code-segement16",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement17",{"className":"$undefined","style":{},"children":[" time\n"]}],"\n",["$","span","code-segement19",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement20",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement21",{"className":"$undefined","style":{},"children":[" cv2\n"]}],["$","span","code-segement22",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement23",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement24",{"className":"$undefined","style":{},"children":[" numpy "]}],["$","span","code-segement25",{"className":"token","style":{"color":"#a04900"},"children":["as"]}],["$","span","code-segement26",{"className":"$undefined","style":{},"children":[" np\n"]}],"\n",["$","span","code-segement28",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement29",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement30",{"className":"$undefined","style":{},"children":[" config "]}],["$","span","code-segement31",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement32",{"className":"$undefined","style":{},"children":[" inputs_dir"]}],["$","span","code-segement33",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement34",{"className":"$undefined","style":{},"children":[" outputs_dir"]}],["$","span","code-segement35",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement36",{"className":"$undefined","style":{},"children":[" weights_dir\n"]}],["$","span","code-segement37",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement38",{"className":"token","style":{"color":"#a04900"},"children":["from"]}],["$","span","code-segement39",{"className":"$undefined","style":{},"children":[" model "]}],["$","span","code-segement40",{"className":"token","style":{"color":"#a04900"},"children":["import"]}],["$","span","code-segement41",{"className":"$undefined","style":{},"children":[" Model\n"]}],"\n","\n",["$","span","code-segement44",{"className":"$undefined","style":{},"children":[""]}],["$","span","code-segement45",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement46",{"className":"$undefined","style":{},"children":[" __name__ "]}],["$","span","code-segement47",{"className":"token","style":{"color":"#a04900"},"children":["=="]}],["$","span","code-segement48",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement49",{"className":"token","style":{"color":"#116b00"},"children":["\"__main__\""]}],["$","span","code-segement50",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement51",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement52",{"className":"$undefined","style":{},"children":["    test_images "]}],["$","span","code-segement53",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement54",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement55",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement56",{"className":"$undefined","style":{},"children":["cv2"]}],["$","span","code-segement57",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement58",{"className":"$undefined","style":{},"children":["imread"]}],["$","span","code-segement59",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement60",{"className":"$undefined","style":{},"children":["path_join"]}],["$","span","code-segement61",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement62",{"className":"$undefined","style":{},"children":["inputs_dir"]}],["$","span","code-segement63",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement64",{"className":"$undefined","style":{},"children":[" image_name"]}],["$","span","code-segement65",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement66",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement67",{"className":"$undefined","style":{},"children":[" cv2"]}],["$","span","code-segement68",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement69",{"className":"$undefined","style":{},"children":["IMREAD_GRAYSCALE"]}],["$","span","code-segement70",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement71",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement72",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement73",{"className":"$undefined","style":{},"children":[" image_name "]}],["$","span","code-segement74",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement75",{"className":"$undefined","style":{},"children":[" listdir"]}],["$","span","code-segement76",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement77",{"className":"$undefined","style":{},"children":["inputs_dir"]}],["$","span","code-segement78",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement79",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement80",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement81",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement82",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement83",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement84",{"className":"token","style":{"color":"#116b00"},"children":["\"Images loaded.\""]}],["$","span","code-segement85",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement86",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement88",{"className":"$undefined","style":{},"children":["    model "]}],["$","span","code-segement89",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement90",{"className":"$undefined","style":{},"children":[" Model"]}],["$","span","code-segement91",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement92",{"className":"$undefined","style":{},"children":["path_join"]}],["$","span","code-segement93",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement94",{"className":"$undefined","style":{},"children":["weights_dir"]}],["$","span","code-segement95",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement96",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement97",{"className":"token","style":{"color":"#116b00"},"children":["\"weights_001.pt\""]}],["$","span","code-segement98",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement99",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement100",{"className":"$undefined","style":{},"children":[" use_cuda"]}],["$","span","code-segement101",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement102",{"className":"token","style":{"color":"#755f00"},"children":["True"]}],["$","span","code-segement103",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement104",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement105",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement106",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement107",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement108",{"className":"token","style":{"color":"#116b00"},"children":["\"Model loaded.\""]}],["$","span","code-segement109",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement110",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement112",{"className":"$undefined","style":{},"children":["    "]}],["$","span","code-segement113",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement114",{"className":"$undefined","style":{},"children":[" batch_size "]}],["$","span","code-segement115",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement116",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement117",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement118",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement119",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement120",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement121",{"className":"token","style":{"color":"#755f00"},"children":["2"]}],["$","span","code-segement122",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement123",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement124",{"className":"token","style":{"color":"#755f00"},"children":["4"]}],["$","span","code-segement125",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement126",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement127",{"className":"token","style":{"color":"#755f00"},"children":["8"]}],["$","span","code-segement128",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement129",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement130",{"className":"token","style":{"color":"#755f00"},"children":["16"]}],["$","span","code-segement131",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement132",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement133",{"className":"token","style":{"color":"#755f00"},"children":["32"]}],["$","span","code-segement134",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement135",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement136",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement137",{"className":"token","style":{"color":"#3c526d"},"children":["#, 64, 128, 256]:"]}],["$","span","code-segement138",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement139",{"className":"$undefined","style":{},"children":["        test_batches "]}],["$","span","code-segement140",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement141",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement142",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement143",{"className":"$undefined","style":{},"children":["test_images"]}],["$","span","code-segement144",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement145",{"className":"$undefined","style":{},"children":["i"]}],["$","span","code-segement146",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement147",{"className":"$undefined","style":{},"children":["i"]}],["$","span","code-segement148",{"className":"token","style":{"color":"#a04900"},"children":["+"]}],["$","span","code-segement149",{"className":"$undefined","style":{},"children":["batch_size"]}],["$","span","code-segement150",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement151",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement152",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement153",{"className":"$undefined","style":{},"children":[" i "]}],["$","span","code-segement154",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement155",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement156",{"className":"token","style":{"color":"#af00af"},"children":["range"]}],["$","span","code-segement157",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement158",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement159",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement160",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement161",{"className":"token","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement162",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement163",{"className":"$undefined","style":{},"children":["test_images"]}],["$","span","code-segement164",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement165",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement166",{"className":"$undefined","style":{},"children":[" batch_size"]}],["$","span","code-segement167",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement168",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement169",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement170",{"className":"$undefined","style":{},"children":["        outputs "]}],["$","span","code-segement171",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement172",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement173",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement174",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement175",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement177",{"className":"$undefined","style":{},"children":["        start_time "]}],["$","span","code-segement178",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement179",{"className":"$undefined","style":{},"children":[" time"]}],["$","span","code-segement180",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement181",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement182",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement183",{"className":"$undefined","style":{},"children":["        preprocessed_batches "]}],["$","span","code-segement184",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement185",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement186",{"className":"token","style":{"color":"#111b27"},"children":["["]}],["$","span","code-segement187",{"className":"$undefined","style":{},"children":["model"]}],["$","span","code-segement188",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement189",{"className":"$undefined","style":{},"children":["preprocess"]}],["$","span","code-segement190",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement191",{"className":"$undefined","style":{},"children":["batch"]}],["$","span","code-segement192",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement193",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement194",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement195",{"className":"$undefined","style":{},"children":[" batch "]}],["$","span","code-segement196",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement197",{"className":"$undefined","style":{},"children":[" test_batches"]}],["$","span","code-segement198",{"className":"token","style":{"color":"#111b27"},"children":["]"]}],["$","span","code-segement199",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement201",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement202",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement203",{"className":"$undefined","style":{},"children":[" i"]}],["$","span","code-segement204",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement205",{"className":"$undefined","style":{},"children":[" preprocessed_batch "]}],["$","span","code-segement206",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement207",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement208",{"className":"token","style":{"color":"#af00af"},"children":["enumerate"]}],["$","span","code-segement209",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement210",{"className":"$undefined","style":{},"children":["preprocessed_batches"]}],["$","span","code-segement211",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement212",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement213",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement214",{"className":"$undefined","style":{},"children":["            output "]}],["$","span","code-segement215",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement216",{"className":"$undefined","style":{},"children":[" model"]}],["$","span","code-segement217",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement218",{"className":"$undefined","style":{},"children":["forward"]}],["$","span","code-segement219",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement220",{"className":"$undefined","style":{},"children":["preprocessed_batch"]}],["$","span","code-segement221",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement222",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement223",{"className":"$undefined","style":{},"children":["            output "]}],["$","span","code-segement224",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement225",{"className":"$undefined","style":{},"children":[" output"]}],["$","span","code-segement226",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement227",{"className":"$undefined","style":{},"children":["detach"]}],["$","span","code-segement228",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement229",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement230",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement231",{"className":"$undefined","style":{},"children":["            outputs"]}],["$","span","code-segement232",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement233",{"className":"$undefined","style":{},"children":["append"]}],["$","span","code-segement234",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement235",{"className":"$undefined","style":{},"children":["output"]}],["$","span","code-segement236",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement237",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement239",{"className":"$undefined","style":{},"children":["            "]}],["$","span","code-segement240",{"className":"token","style":{"color":"#a04900"},"children":["if"]}],["$","span","code-segement241",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement242",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement243",{"className":"$undefined","style":{},"children":["i "]}],["$","span","code-segement244",{"className":"token","style":{"color":"#a04900"},"children":["+"]}],["$","span","code-segement245",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement246",{"className":"token","style":{"color":"#755f00"},"children":["1"]}],["$","span","code-segement247",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement248",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement249",{"className":"token","style":{"color":"#a04900"},"children":["%"]}],["$","span","code-segement250",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement251",{"className":"token","style":{"color":"#755f00"},"children":["25"]}],["$","span","code-segement252",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement253",{"className":"token","style":{"color":"#a04900"},"children":["=="]}],["$","span","code-segement254",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement255",{"className":"token","style":{"color":"#755f00"},"children":["0"]}],["$","span","code-segement256",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement257",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement258",{"className":"$undefined","style":{},"children":["                "]}],["$","span","code-segement259",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement260",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement261",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\"Processed: "]}],["$","span","code-segement262",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement263",{"className":"token string-interpolation interpolation","style":{},"children":["i"]}],["$","span","code-segement264",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement265",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[" / "]}],["$","span","code-segement266",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement267",{"className":"token string-interpolation interpolation","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement268",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement269",{"className":"token string-interpolation interpolation","style":{},"children":["preprocessed_batches"]}],["$","span","code-segement270",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement271",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement272",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["\""]}],["$","span","code-segement273",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement274",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement276",{"className":"$undefined","style":{},"children":["        end_time "]}],["$","span","code-segement277",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement278",{"className":"$undefined","style":{},"children":[" time"]}],["$","span","code-segement279",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement280",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement281",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement282",{"className":"$undefined","style":{},"children":["        time_elapsed "]}],["$","span","code-segement283",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement284",{"className":"$undefined","style":{},"children":[" end_time "]}],["$","span","code-segement285",{"className":"token","style":{"color":"#a04900"},"children":["-"]}],["$","span","code-segement286",{"className":"$undefined","style":{},"children":[" start_time\n"]}],"\n",["$","span","code-segement288",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement289",{"className":"token","style":{"color":"#a04900"},"children":["print"]}],["$","span","code-segement290",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement291",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement292",{"className":"$undefined","style":{},"children":["            "]}],["$","span","code-segement293",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\"Num images: "]}],["$","span","code-segement294",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement295",{"className":"token string-interpolation interpolation","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement296",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement297",{"className":"token string-interpolation interpolation","style":{},"children":["test_images"]}],["$","span","code-segement298",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement299",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement300",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[", \""]}],["$","span","code-segement301",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement302",{"className":"$undefined","style":{},"children":["            "]}],["$","span","code-segement303",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\"Batch size: "]}],["$","span","code-segement304",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement305",{"className":"token string-interpolation interpolation","style":{},"children":["batch_size"]}],["$","span","code-segement306",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement307",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[", \""]}],["$","span","code-segement308",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement309",{"className":"$undefined","style":{},"children":["            "]}],["$","span","code-segement310",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\"Time taken: "]}],["$","span","code-segement311",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement312",{"className":"token string-interpolation interpolation","style":{},"children":["time_elapsed"]}],["$","span","code-segement313",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement314",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[" s, \""]}],["$","span","code-segement315",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement316",{"className":"$undefined","style":{},"children":["            "]}],["$","span","code-segement317",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\"Time taken per image: "]}],["$","span","code-segement318",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement319",{"className":"token string-interpolation interpolation","style":{"color":"#755f00"},"children":["1000"]}],["$","span","code-segement320",{"className":"token string-interpolation interpolation","style":{},"children":[" "]}],["$","span","code-segement321",{"className":"token string-interpolation interpolation","style":{"color":"#a04900"},"children":["*"]}],["$","span","code-segement322",{"className":"token string-interpolation interpolation","style":{},"children":[" time_elapsed "]}],["$","span","code-segement323",{"className":"token string-interpolation interpolation","style":{"color":"#a04900"},"children":["/"]}],["$","span","code-segement324",{"className":"token string-interpolation interpolation","style":{},"children":[" "]}],["$","span","code-segement325",{"className":"token string-interpolation interpolation","style":{"color":"#af00af"},"children":["len"]}],["$","span","code-segement326",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement327",{"className":"token string-interpolation interpolation","style":{},"children":["test_images"]}],["$","span","code-segement328",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement329",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement330",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[" ms\""]}],["$","span","code-segement331",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement332",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement333",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement334",{"className":"$undefined","style":{},"children":["\n"]}],"\n",["$","span","code-segement336",{"className":"$undefined","style":{},"children":["        "]}],["$","span","code-segement337",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement338",{"className":"$undefined","style":{},"children":[" i"]}],["$","span","code-segement339",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement340",{"className":"$undefined","style":{},"children":[" output "]}],["$","span","code-segement341",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement342",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement343",{"className":"token","style":{"color":"#af00af"},"children":["enumerate"]}],["$","span","code-segement344",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement345",{"className":"$undefined","style":{},"children":["outputs"]}],["$","span","code-segement346",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement347",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement348",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement349",{"className":"$undefined","style":{},"children":["            "]}],["$","span","code-segement350",{"className":"token","style":{"color":"#a04900"},"children":["for"]}],["$","span","code-segement351",{"className":"$undefined","style":{},"children":[" j"]}],["$","span","code-segement352",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement353",{"className":"$undefined","style":{},"children":[" single_output "]}],["$","span","code-segement354",{"className":"token","style":{"color":"#a04900"},"children":["in"]}],["$","span","code-segement355",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement356",{"className":"token","style":{"color":"#af00af"},"children":["enumerate"]}],["$","span","code-segement357",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement358",{"className":"$undefined","style":{},"children":["output"]}],["$","span","code-segement359",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement360",{"className":"token","style":{"color":"#111b27"},"children":[":"]}],["$","span","code-segement361",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement362",{"className":"$undefined","style":{},"children":["                boolean_array "]}],["$","span","code-segement363",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement364",{"className":"$undefined","style":{},"children":[" model"]}],["$","span","code-segement365",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement366",{"className":"$undefined","style":{},"children":["postprocess"]}],["$","span","code-segement367",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement368",{"className":"$undefined","style":{},"children":["single_output"]}],["$","span","code-segement369",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement370",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement371",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement372",{"className":"token","style":{"color":"#755f00"},"children":["512"]}],["$","span","code-segement373",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement374",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement375",{"className":"token","style":{"color":"#755f00"},"children":["512"]}],["$","span","code-segement376",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement377",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement378",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement379",{"className":"$undefined","style":{},"children":["                binary_image "]}],["$","span","code-segement380",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement381",{"className":"$undefined","style":{},"children":[" boolean_array"]}],["$","span","code-segement382",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement383",{"className":"$undefined","style":{},"children":["astype"]}],["$","span","code-segement384",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement385",{"className":"$undefined","style":{},"children":["np"]}],["$","span","code-segement386",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement387",{"className":"$undefined","style":{},"children":["uint8"]}],["$","span","code-segement388",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement389",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement390",{"className":"token","style":{"color":"#a04900"},"children":["*"]}],["$","span","code-segement391",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement392",{"className":"token","style":{"color":"#755f00"},"children":["255"]}],["$","span","code-segement393",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement394",{"className":"$undefined","style":{},"children":["                file_path "]}],["$","span","code-segement395",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement396",{"className":"$undefined","style":{},"children":[" path_join"]}],["$","span","code-segement397",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement398",{"className":"$undefined","style":{},"children":["outputs_dir"]}],["$","span","code-segement399",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement400",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement401",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":["f\""]}],["$","span","code-segement402",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["{"]}],["$","span","code-segement403",{"className":"token string-interpolation interpolation","style":{},"children":["i "]}],["$","span","code-segement404",{"className":"token string-interpolation interpolation","style":{"color":"#a04900"},"children":["*"]}],["$","span","code-segement405",{"className":"token string-interpolation interpolation","style":{},"children":[" batch_size "]}],["$","span","code-segement406",{"className":"token string-interpolation interpolation","style":{"color":"#a04900"},"children":["+"]}],["$","span","code-segement407",{"className":"token string-interpolation interpolation","style":{},"children":[" j"]}],["$","span","code-segement408",{"className":"token string-interpolation interpolation","style":{"color":"#111b27"},"children":["}"]}],["$","span","code-segement409",{"className":"token string-interpolation","style":{"color":"#116b00"},"children":[".png\""]}],["$","span","code-segement410",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement411",{"className":"$undefined","style":{},"children":["\n"]}],["$","span","code-segement412",{"className":"$undefined","style":{},"children":["                cv2"]}],["$","span","code-segement413",{"className":"token","style":{"color":"#111b27"},"children":["."]}],["$","span","code-segement414",{"className":"$undefined","style":{},"children":["imwrite"]}],["$","span","code-segement415",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement416",{"className":"$undefined","style":{},"children":["file_path"]}],["$","span","code-segement417",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement418",{"className":"$undefined","style":{},"children":[" binary_image"]}],["$","span","code-segement419",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$Lc","51",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Run the code and you should see logs in the console saying how long it took. I've tabulated my results (for 5,000 input images):"]}],["$","$La","52",{"sx":{"width":"100%","display":"flex","flexDirection":"column","justifyContent":"center","alignItems":"center","marginBottom":2},"children":["$","$L1b",null,{"sx":{"backgroundColor":"rgb(227, 234, 242)"},"children":[["$","$Lc",null,{"variant":"h6","component":"h4","sx":{"width":"100%","textAlign":"center","marginTop":2},"children":["$","strong",null,{"children":"Num images: 5,000 | Device: GPU"}]}],["$","$L1c",null,{"children":[["$","$L1d",null,{"children":["$","$L1e",null,{"children":[["$","$L1f","0",{"sx":{"fontWeight":"bold"},"children":"Batch Size"}],["$","$L1f","1",{"sx":{"fontWeight":"bold"},"children":"Time Taken (s)"}],["$","$L1f","2",{"sx":{"fontWeight":"bold"},"children":"Time Taken per Image (ms)"}],["$","$L1f","3",{"sx":{"fontWeight":"bold"},"children":"FPS"}],["$","$L1f","4",{"sx":{"fontWeight":"bold"},"children":"CUDA Memory Consumption (GB)"}],["$","$L1f","5",{"sx":{"fontWeight":"bold"},"children":"Improvement over Batch Size 1"}],["$","$L1f","6",{"sx":{"fontWeight":"bold"},"children":"Improvement over Previous Row"}]]}]}],["$","$L20",null,{"children":[["$","$L1e","0",{"sx":{"&:last-child td, &:last-child th":{"border":0}},"children":[["$","$L1f","0",{"children":"1"}],["$","$L1f","1",{"children":"46.9190"}],["$","$L1f","2",{"children":"9.3838"}],["$","$L1f","3",{"children":"106.5666"}],["$","$L1f","4",{"children":"0.9051"}],["$","$L1f","5",{"children":"1x"}],["$","$L1f","6",{"children":"-"}]]}],["$","$L1e","1",{"sx":{"&:last-child td, &:last-child th":{"border":0}},"children":[["$","$L1f","0",{"children":"2"}],["$","$L1f","1",{"children":"40.4961"}],["$","$L1f","2",{"children":"8.0992"}],["$","$L1f","3",{"children":"123.4689"}],["$","$L1f","4",{"children":"1.1397"}],["$","$L1f","5",{"children":"1.1586x"}],["$","$L1f","6",{"children":"1.1586x"}]]}],["$","$L1e","2",{"sx":{"&:last-child td, &:last-child th":{"border":0}},"children":[["$","$L1f","0",{"children":"4"}],["$","$L1f","1",{"children":"39.8241"}],["$","$L1f","2",{"children":"7.9648"}],["$","$L1f","3",{"children":"125.5524"}],["$","$L1f","4",{"children":"1.5774"}],["$","$L1f","5",{"children":"1.1781x"}],["$","$L1f","6",{"children":"1.0168x"}]]}],["$","$L1e","3",{"sx":{"&:last-child td, &:last-child th":{"border":0}},"children":[["$","$L1f","0",{"children":"8"}],["$","$L1f","1",{"children":"39.3241"}],["$","$L1f","2",{"children":"7.8648"}],["$","$L1f","3",{"children":"127.1488"}],["$","$L1f","4",{"children":"2.6414"}],["$","$L1f","5",{"children":"1.1931x"}],["$","$L1f","6",{"children":"1.0127x"}]]}],["$","$L1e","4",{"sx":{"&:last-child td, &:last-child th":{"border":0}},"children":[["$","$L1f","0",{"children":"16"}],["$","$L1f","1",{"children":"39.2899"}],["$","$L1f","2",{"children":"7.8579"}],["$","$L1f","3",{"children":"127.2442"}],["$","$L1f","4",{"children":"4.4764"}],["$","$L1f","5",{"children":"1.1940x"}],["$","$L1f","6",{"children":"1.00087x"}]]}]]}]]}]]}]}],["$","$Lc","53",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","The biggest improvement is from Batch Size 1 -> 2, while the least increase in memory consumption."]}],["$","$Lc","54",{"id":"batched-cpu-inference:-any-good?","variant":"h5","component":"h2","mb":2,"children":["$","strong",null,{"children":"Batched CPU Inference: Any Good?"}]}],["$","$Lc","55",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","I'll set ",["$","$La","55-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"use_cuda"}]," to ",["$","$La","55-text-italics",{"component":"span","sx":{"paddingLeft":0.5,"paddingRight":0.5,"borderRadius":1,"backgroundColor":"rgb(227, 234, 242)"},"children":"False"}]," where we are loading the model and run the inference again, with the same batches."]}],["$","$La",null,{"sx":{"width":"100%","marginBottom":2},"children":[["$","$L18",null,{"contentToCopy":"model = Model(path_join(weights_dir, \"weights_001.pt\"), use_cuda=True)"}],["$","pre",null,{"style":{"color":"#111b27","background":"#e3eaf2","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none","padding":"1em","margin":0,"overflow":"auto"},"children":["$","code",null,{"className":"language-python","style":{"color":"#111b27","background":"none","fontFamily":"Consolas, Monaco, \"Andale Mono\", \"Ubuntu Mono\", monospace","textAlign":"left","whiteSpace":"pre","wordSpacing":"normal","wordBreak":"normal","wordWrap":"normal","lineHeight":"1.5","MozTabSize":"4","OTabSize":"4","tabSize":"4","WebkitHyphens":"none","MozHyphens":"none","msHyphens":"none","hyphens":"none"},"children":[false,[["$","span","code-segement0",{"className":"$undefined","style":{},"children":["model "]}],["$","span","code-segement1",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement2",{"className":"$undefined","style":{},"children":[" Model"]}],["$","span","code-segement3",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement4",{"className":"$undefined","style":{},"children":["path_join"]}],["$","span","code-segement5",{"className":"token","style":{"color":"#111b27"},"children":["("]}],["$","span","code-segement6",{"className":"$undefined","style":{},"children":["weights_dir"]}],["$","span","code-segement7",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement8",{"className":"$undefined","style":{},"children":[" "]}],["$","span","code-segement9",{"className":"token","style":{"color":"#116b00"},"children":["\"weights_001.pt\""]}],["$","span","code-segement10",{"className":"token","style":{"color":"#111b27"},"children":[")"]}],["$","span","code-segement11",{"className":"token","style":{"color":"#111b27"},"children":[","]}],["$","span","code-segement12",{"className":"$undefined","style":{},"children":[" use_cuda"]}],["$","span","code-segement13",{"className":"token","style":{"color":"#a04900"},"children":["="]}],["$","span","code-segement14",{"className":"token","style":{"color":"#755f00"},"children":["True"]}],["$","span","code-segement15",{"className":"token","style":{"color":"#111b27"},"children":[")"]}]]]}]}]]}],["$","$La","57",{"sx":{"width":"100%","display":"flex","flexDirection":"column","justifyContent":"center","alignItems":"center","marginBottom":2},"children":["$","$L1b",null,{"sx":{"backgroundColor":"rgb(227, 234, 242)"},"children":[["$","$Lc",null,{"variant":"h6","component":"h4","sx":{"width":"100%","textAlign":"center","marginTop":2},"children":["$","strong",null,{"children":"Num images: 5,000 | Device: CPU"}]}],["$","$L1c",null,{"children":[["$","$L1d",null,{"children":["$","$L1e",null,{"children":[["$","$L1f","0",{"sx":{"fontWeight":"bold"},"children":"Batch Size"}],["$","$L1f","1",{"sx":{"fontWeight":"bold"},"children":"Time Taken"}],["$","$L1f","2",{"sx":{"fontWeight":"bold"},"children":"Time Taken per Image (s)"}],["$","$L1f","3",{"sx":{"fontWeight":"bold"},"children":"FPS"}]]}]}],["$","$L20",null,{"children":[["$","$L1e","0",{"sx":{"&:last-child td, &:last-child th":{"border":0}},"children":[["$","$L1f","0",{"children":"1"}],["$","$L1f","1",{"children":"01h51m14s"}],["$","$L1f","2",{"children":"1.3348"}],["$","$L1f","3",{"children":"0.7491"}]]}],["$","$L1e","1",{"sx":{"&:last-child td, &:last-child th":{"border":0}},"children":[["$","$L1f","0",{"children":"2"}],["$","$L1f","1",{"children":"01h47m19s"}],["$","$L1f","2",{"children":"1.2878"}],["$","$L1f","3",{"children":"0.7765"}]]}],["$","$L1e","2",{"sx":{"&:last-child td, &:last-child th":{"border":0}},"children":[["$","$L1f","0",{"children":"4"}],["$","$L1f","1",{"children":"01h42m44s"}],["$","$L1f","2",{"children":"1.2327"}],["$","$L1f","3",{"children":"0.8112"}]]}],["$","$L1e","3",{"sx":{"&:last-child td, &:last-child th":{"border":0}},"children":[["$","$L1f","0",{"children":"8"}],["$","$L1f","1",{"children":"01h40m47s"}],["$","$L1f","2",{"children":"1.2095"}],["$","$L1f","3",{"children":"0.8267"}]]}],["$","$L1e","4",{"sx":{"&:last-child td, &:last-child th":{"border":0}},"children":[["$","$L1f","0",{"children":"16"}],["$","$L1f","1",{"children":"01h38m59s"}],["$","$L1f","2",{"children":"1.1877"}],["$","$L1f","3",{"children":"0.8419"}]]}]]}]]}]]}]}],["$","$Lc","58",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","In this case, there is a trend of decreasing inference time with larger batch sizes but it's no significant improvement."]}],["$","$Lc","59",{"id":"model-dependence","variant":"h5","component":"h2","mb":2,"children":["$","strong",null,{"children":"Model Dependence"}]}],["$","$Lc","60",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","The improvement we get while running a model on GPU or while running batched inference depends highly on how to model has been constructed. Here are some tests that I ran on another model (these were on an RTX 4090, with much smaller images, with a model for a different task)."]}],["$","$La","61",{"sx":{"width":"100%","display":"flex","flexDirection":"column","justifyContent":"center","alignItems":"center","marginBottom":2},"children":["$","$L1b",null,{"sx":{"backgroundColor":"rgb(227, 234, 242)"},"children":[["$","$Lc",null,{"variant":"h6","component":"h4","sx":{"width":"100%","textAlign":"center","marginTop":2},"children":["$","strong",null,{"children":"Num images: 21,846 | Device: GPU"}]}],["$","$L1c",null,{"children":[["$","$L1d",null,{"children":["$","$L1e",null,{"children":[["$","$L1f","0",{"sx":{"fontWeight":"bold"},"children":"Batch Size"}],["$","$L1f","1",{"sx":{"fontWeight":"bold"},"children":"Time Taken (s)"}],["$","$L1f","2",{"sx":{"fontWeight":"bold"},"children":"Time Taken per Image (ms)"}],["$","$L1f","3",{"sx":{"fontWeight":"bold"},"children":"FPS"}],["$","$L1f","4",{"sx":{"fontWeight":"bold"},"children":"CUDA Memory Consumption (GB)"}],["$","$L1f","5",{"sx":{"fontWeight":"bold"},"children":"Improvement over Batch Size 1"}],["$","$L1f","6",{"sx":{"fontWeight":"bold"},"children":"Improvement over Previous Row"}]]}]}],["$","$L20",null,{"children":[["$","$L1e","0",{"sx":{"&:last-child td, &:last-child th":{"border":0}},"children":[["$","$L1f","0",{"children":"1"}],["$","$L1f","1",{"children":"219.56"}],["$","$L1f","2",{"children":"10.05"}],["$","$L1f","3",{"children":"99.50"}],["$","$L1f","4",{"children":"0.2628"}],["$","$L1f","5",{"children":"1x"}],["$","$L1f","6",{"children":"-"}]]}],["$","$L1e","1",{"sx":{"&:last-child td, &:last-child th":{"border":0}},"children":[["$","$L1f","0",{"children":"2"}],["$","$L1f","1",{"children":"134.41"}],["$","$L1f","2",{"children":"6.15"}],["$","$L1f","3",{"children":"162.60"}],["$","$L1f","4",{"children":"0.3487"}],["$","$L1f","5",{"children":"1.6341x"}],["$","$L1f","6",{"children":"1.6341x"}]]}],["$","$L1e","2",{"sx":{"&:last-child td, &:last-child th":{"border":0}},"children":[["$","$L1f","0",{"children":"4"}],["$","$L1f","1",{"children":"76.88"}],["$","$L1f","2",{"children":"3.5193"}],["$","$L1f","3",{"children":"284.14"}],["$","$L1f","4",{"children":"0.4893"}],["$","$L1f","5",{"children":"2.8556x"}],["$","$L1f","6",{"children":"1.7474x"}]]}],["$","$L1e","3",{"sx":{"&:last-child td, &:last-child th":{"border":0}},"children":[["$","$L1f","0",{"children":"8"}],["$","$L1f","1",{"children":"44.47"}],["$","$L1f","2",{"children":"2.0360"}],["$","$L1f","3",{"children":"491.15"}],["$","$L1f","4",{"children":"0.8018"}],["$","$L1f","5",{"children":"4.9361x"}],["$","$L1f","6",{"children":"1.6933x"}]]}],["$","$L1e","4",{"sx":{"&:last-child td, &:last-child th":{"border":0}},"children":[["$","$L1f","0",{"children":"16"}],["$","$L1f","1",{"children":"26.64"}],["$","$L1f","2",{"children":"1.2196"}],["$","$L1f","3",{"children":"819.94"}],["$","$L1f","4",{"children":"1.3409"}],["$","$L1f","5",{"children":"8.2406x"}],["$","$L1f","6",{"children":"1.6694x"}]]}],["$","$L1e","5",{"sx":{"&:last-child td, &:last-child th":{"border":0}},"children":[["$","$L1f","0",{"children":"32"}],["$","$L1f","1",{"children":"19.37"}],["$","$L1f","2",{"children":"0.8871"}],["$","$L1f","3",{"children":"1,127.26"}],["$","$L1f","4",{"children":"2.3565"}],["$","$L1f","5",{"children":"11.3292x"}],["$","$L1f","6",{"children":"1.3748x"}]]}],["$","$L1e","6",{"sx":{"&:last-child td, &:last-child th":{"border":0}},"children":[["$","$L1f","0",{"children":"64"}],["$","$L1f","1",{"children":"14.69"}],["$","$L1f","2",{"children":"0.6725"}],["$","$L1f","3",{"children":"1,486.98"}],["$","$L1f","4",{"children":"4.4815"}],["$","$L1f","5",{"children":"14.9445x"}],["$","$L1f","6",{"children":"1.3191x"}]]}],["$","$L1e","7",{"sx":{"&:last-child td, &:last-child th":{"border":0}},"children":[["$","$L1f","0",{"children":"128"}],["$","$L1f","1",{"children":"12.84"}],["$","$L1f","2",{"children":"0.5881"}],["$","$L1f","3",{"children":"1,700.39"}],["$","$L1f","4",{"children":"9.6925"}],["$","$L1f","5",{"children":"17.0893x"}],["$","$L1f","6",{"children":"1.1435x"}]]}],["$","$L1e","8",{"sx":{"&:last-child td, &:last-child th":{"border":0}},"children":[["$","$L1f","0",{"children":"256"}],["$","$L1f","1",{"children":"12.35"}],["$","$L1f","2",{"children":"0.5656"}],["$","$L1f","3",{"children":"1,768.03"}],["$","$L1f","4",{"children":"19.2745"}],["$","$L1f","5",{"children":"17.7691x"}],["$","$L1f","6",{"children":"1.0397x"}]]}]]}]]}]]}]}],["$","$Lc","62",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","The improvements for this model and input are very different."]}],["$","$Lc","63",{"id":"conclusion","variant":"h4","component":"h1","mb":2,"children":["$","strong",null,{"children":"Conclusion"}]}],["$","$Lc","64",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","In this Post, we have seen how GPUs are significantly faster than CPUs for ML inference tasks. We have also seen that processing multiple inputs in parallel i.e. in a batch serves to decrease the inference time. The relative decrease is considerable among smaller batch sizes but diminishes as the batch sizes get larger. The effect on performance also depends on the model architecture and its implementation."]}],["$","$Lc","65",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","Or maybe, you want to serve models to run on the client side, in that case, ",["$","$L17","65-link",{"href":"/ml-ops/tensorflow-js-inference-in-react","color":"primary","underline":"hover","children":"this Article"}]," may interest you, where we run a model on the user's web browser using TensorFlow JS."]}],["$","$Lc","66",{"variant":"p","component":"p","sx":{"textAlign":"justify","marginBottom":2},"children":["$undefined","See you next time :)"]}]]}]}]]}]}],"$L22"]}]
23:I[3713,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],"default"]
12:["$","$La",null,{"sx":{"width":"100%","display":"flex","flexDirection":"row","justifyContent":"space-between","alignItems":"center"},"children":[["$","$Lc",null,{"variant":"p","component":"p","mr":2,"children":"By: Abhilaksh Singh Reen"}],["$","$L23",null,{"socialMediaProfiles":[{"network_name":"LinkedIn","profile_url":"https://www.linkedin.com/in/abhilaksh-singh-837901210/","profile_display_name":"Abhilaksh Singh Reen"},{"network_name":"Twitter","profile_url":"https://x.com/TheVeteran06","profile_display_name":"The Veteran 06"},{"network_name":"GitHub","profile_url":"https://github.com/AbhilakshSinghReen","profile_display_name":"Abhilaksh Singh Reen"}]}]]}]
24:I[6652,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],""]
25:I[6981,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],""]
26:I[2818,["98","static/chunks/98-98337b3bb708bd24.js","134","static/chunks/134-4d46f2c5e7204b76.js","830","static/chunks/830-8a0df588e7c84864.js","748","static/chunks/748-1f14ee6eb3d7029a.js","411","static/chunks/411-3d27264901e39398.js","533","static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-1b889bd6bb1438d9.js"],""]
22:["$","$La",null,{"mt":5,"mb":5,"pb":2,"sx":{"width":"100%","display":"flex","flexDirection":"column","justifyContent":"flex-start","alignItems":"center"},"children":["$","$L11",null,{"container":true,"spacing":2,"mt":4,"mb":4,"children":[["$","$L11","/ml-ops/tensorflow-js-inference-in-react",{"item":true,"xs":12,"sm":6,"md":4,"lg":3,"children":["$","$Ld",null,{"href":"/ml-ops/tensorflow-js-inference-in-react","passHref":true,"style":{"textDecoration":"none"},"children":["$","$L24",null,{"sx":{"width":"100%","height":"100%","boxShadow":"1px 1px 1px 1px \"#eeeeee\"","&:hover":{"boxShadow":"3px 3px 3px 3px \"#eeeeee\"","cursor":"pointer"}},"children":[["$","$L25",null,{"component":"img","height":"150","image":"/media/images/react-digit-recog-app-final.jpg","alt":"TensorFlow.js Inference in React on an image drawn with Konva","sx":{"objectFit":"cover"}}],["$","$L26",null,{"children":[["$","$Lc",null,{"gutterBottom":true,"variant":"h6","component":"h2","children":[""," ","TensorFlow.js Inference in React on an image drawn with Konva"]}],["$","$Lc",null,{"gutterBottom":true,"variant":"p","component":"p","sx":{"overflow":"hidden","textOverflow":"ellipsis","display":"-webkit-box","WebkitLineClamp":"3","WebkitBoxOrient":"vertical"},"children":"Inferencing on an ONNX model in a React App using ONNXRuntime Web."}],["$","$La",null,{"sx":{"width":"100%","display":"flex","flexDirection":"row","justifyContent":"flex-end","alignItems":"center"},"children":["$","$Lc",null,{"gutterBottom":true,"variant":"p","component":"p","children":"08m Read"}]}],false]}]]}]}]}],["$","$L11","/ml-ops/onnxruntime-web-inference-in-react",{"item":true,"xs":12,"sm":6,"md":4,"lg":3,"children":["$","$Ld",null,{"href":"/ml-ops/onnxruntime-web-inference-in-react","passHref":true,"style":{"textDecoration":"none"},"children":["$","$L24",null,{"sx":{"width":"100%","height":"100%","boxShadow":"1px 1px 1px 1px \"#eeeeee\"","&:hover":{"boxShadow":"3px 3px 3px 3px \"#eeeeee\"","cursor":"pointer"}},"children":[["$","$L25",null,{"component":"img","height":"150","image":"/media/images/react-digit-recog-app-final.jpg","alt":"ONNXRuntime Inference in a React App","sx":{"objectFit":"cover"}}],["$","$L26",null,{"children":[["$","$Lc",null,{"gutterBottom":true,"variant":"h6","component":"h2","children":[""," ","ONNXRuntime Inference in a React App"]}],["$","$Lc",null,{"gutterBottom":true,"variant":"p","component":"p","sx":{"overflow":"hidden","textOverflow":"ellipsis","display":"-webkit-box","WebkitLineClamp":"3","WebkitBoxOrient":"vertical"},"children":"Inferencing on an ONNX model in a React App using ONNXRuntime Web."}],["$","$La",null,{"sx":{"width":"100%","display":"flex","flexDirection":"row","justifyContent":"flex-end","alignItems":"center"},"children":["$","$Lc",null,{"gutterBottom":true,"variant":"p","component":"p","children":"08m Read"}]}],false]}]]}]}]}]]}]}]
