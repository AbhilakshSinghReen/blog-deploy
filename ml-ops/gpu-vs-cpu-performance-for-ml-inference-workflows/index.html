<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" as="image" href="/media/images/main-contact-email-light.jpg"/><link rel="preload" as="image" href="/media/images/gpu-vs-cpu-performance-for-ml-inference-workflows-thumbnail.jpg"/><link rel="preload" as="image" href="/media/images/react-digit-recog-app-final.jpg"/><link rel="stylesheet" href="/_next/static/css/1d4d01086947be98.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-83486951edee0db5.js"/><script src="/_next/static/chunks/fd9d1056-90960e0a7e77703c.js" async=""></script><script src="/_next/static/chunks/23-365ff0b9e0ad811d.js" async=""></script><script src="/_next/static/chunks/main-app-37d3bbd360c1bff1.js" async=""></script><script src="/_next/static/chunks/98-7f6363f9ac68c942.js" async=""></script><script src="/_next/static/chunks/748-1f14ee6eb3d7029a.js" async=""></script><script src="/_next/static/chunks/271-37a22bace913f735.js" async=""></script><script src="/_next/static/chunks/app/layout-08611f287dda1230.js" async=""></script><script src="/_next/static/chunks/134-9729e0afcc6dfdfe.js" async=""></script><script src="/_next/static/chunks/830-8a0df588e7c84864.js" async=""></script><script src="/_next/static/chunks/411-e5dcfc2304d91b2f.js" async=""></script><script src="/_next/static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js" async=""></script><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="16x16"/><script src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js" noModule=""></script></head><body class="__className_d65c78"><header style="margin-bottom:25px"><style data-emotion="css 13x2oq7">.css-13x2oq7{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:100%;box-sizing:border-box;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;position:fixed;z-index:1100;top:0;left:auto;right:0;background-color:#1976d2;color:#fff;}@media print{.css-13x2oq7{position:absolute;}}</style><style data-emotion="css 5poeop">.css-5poeop{background-color:#fff;color:rgba(0, 0, 0, 0.87);-webkit-transition:box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;box-shadow:0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:100%;box-sizing:border-box;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;position:fixed;z-index:1100;top:0;left:auto;right:0;background-color:#1976d2;color:#fff;}@media print{.css-5poeop{position:absolute;}}</style><header class="MuiPaper-root MuiPaper-elevation MuiPaper-elevation4 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionFixed mui-fixed css-5poeop"><style data-emotion="css 1qsxih2">.css-1qsxih2{width:100%;margin-left:auto;box-sizing:border-box;margin-right:auto;display:block;padding-left:16px;padding-right:16px;}@media (min-width:600px){.css-1qsxih2{padding-left:24px;padding-right:24px;}}@media (min-width:1200px){.css-1qsxih2{max-width:1200px;}}</style><div class="MuiContainer-root MuiContainer-maxWidthLg css-1qsxih2"><style data-emotion="css r4h1bh">.css-r4h1bh{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding-left:16px;padding-right:16px;min-height:56px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:100%;padding:0px;}@media (min-width:600px){.css-r4h1bh{padding-left:24px;padding-right:24px;}}@media (min-width:0px){@media (orientation: landscape){.css-r4h1bh{min-height:48px;}}}@media (min-width:600px){.css-r4h1bh{min-height:64px;}}</style><div class="MuiToolbar-root MuiToolbar-gutters MuiToolbar-regular css-r4h1bh"><style data-emotion="css 1pna09g">.css-1pna09g{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:2.125rem;line-height:1.235;letter-spacing:0.00735em;font-weight:700;text-align:center;background:linear-gradient(45deg, #FFD700 30%, #FFA500 90%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;}.css-1pna09g:hover{cursor:pointer;}</style><h4 class="MuiTypography-root MuiTypography-h4 css-1pna09g">A.N.T</h4><div class="MuiBox-root css-0"><style data-emotion="css j4ylzh">.css-j4ylzh{text-align:center;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;font-size:1.5rem;padding:8px;border-radius:50%;overflow:visible;color:rgba(0, 0, 0, 0.54);-webkit-transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;color:#ed6c02;}.css-j4ylzh:hover{background-color:rgba(0, 0, 0, 0.04);}@media (hover: none){.css-j4ylzh:hover{background-color:transparent;}}.css-j4ylzh:hover{background-color:rgba(237, 108, 2, 0.04);}@media (hover: none){.css-j4ylzh:hover{background-color:transparent;}}.css-j4ylzh.Mui-disabled{background-color:transparent;color:rgba(0, 0, 0, 0.26);}</style><style data-emotion="css r4nl99">.css-r4nl99{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;position:relative;box-sizing:border-box;-webkit-tap-highlight-color:transparent;background-color:transparent;outline:0;border:0;margin:0;border-radius:0;padding:0;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle;-moz-appearance:none;-webkit-appearance:none;-webkit-text-decoration:none;text-decoration:none;color:inherit;text-align:center;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;font-size:1.5rem;padding:8px;border-radius:50%;overflow:visible;color:rgba(0, 0, 0, 0.54);-webkit-transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;color:#ed6c02;}.css-r4nl99::-moz-focus-inner{border-style:none;}.css-r4nl99.Mui-disabled{pointer-events:none;cursor:default;}@media print{.css-r4nl99{-webkit-print-color-adjust:exact;color-adjust:exact;}}.css-r4nl99:hover{background-color:rgba(0, 0, 0, 0.04);}@media (hover: none){.css-r4nl99:hover{background-color:transparent;}}.css-r4nl99:hover{background-color:rgba(237, 108, 2, 0.04);}@media (hover: none){.css-r4nl99:hover{background-color:transparent;}}.css-r4nl99.Mui-disabled{background-color:transparent;color:rgba(0, 0, 0, 0.26);}</style><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorWarning MuiIconButton-sizeMedium css-r4nl99" tabindex="0" type="button"><style data-emotion="css 6flbmm">.css-6flbmm{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;fill:currentColor;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;font-size:2.1875rem;}</style><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeLarge css-6flbmm" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="MenuIcon"><path d="M3 18h18v-2H3zm0-5h18v-2H3zm0-7v2h18V6z"></path></svg></button></div></div></div></header><div style="padding-top:55px"></div> </header><style data-emotion="css 1qsxih2">.css-1qsxih2{width:100%;margin-left:auto;box-sizing:border-box;margin-right:auto;display:block;padding-left:16px;padding-right:16px;}@media (min-width:600px){.css-1qsxih2{padding-left:24px;padding-right:24px;}}@media (min-width:1200px){.css-1qsxih2{max-width:1200px;}}</style><div class="MuiContainer-root MuiContainer-maxWidthLg css-1qsxih2"><style data-emotion="css 1g0xyuw">.css-1g0xyuw{margin-bottom:40px;padding-bottom:16px;width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:start;-ms-flex-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}</style><div class="MuiBox-root css-1g0xyuw"><style data-emotion="css 1vl439b">.css-1vl439b{width:100%;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:start;-ms-flex-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-bottom:24px;}@media (min-width:0px){.css-1vl439b{display:none;}}@media (min-width:900px){.css-1vl439b{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}</style><div class="MuiBox-root css-1vl439b"><style data-emotion="css 1yae3jf">.css-1yae3jf{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:start;-ms-flex-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div class="MuiBox-root css-1yae3jf"><a href="/"><style data-emotion="css pbbsfi">.css-pbbsfi{font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:500;font-size:0.8125rem;line-height:1.75;letter-spacing:0.02857em;text-transform:uppercase;min-width:64px;padding:3px 9px;border-radius:4px;-webkit-transition:background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;border:1px solid rgba(237, 108, 2, 0.5);color:#ed6c02;}.css-pbbsfi:hover{-webkit-text-decoration:none;text-decoration:none;background-color:rgba(237, 108, 2, 0.04);border:1px solid #ed6c02;}@media (hover: none){.css-pbbsfi:hover{background-color:transparent;}}.css-pbbsfi.Mui-disabled{color:rgba(0, 0, 0, 0.26);border:1px solid rgba(0, 0, 0, 0.12);}</style><style data-emotion="css 1184ln1">.css-1184ln1{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;position:relative;box-sizing:border-box;-webkit-tap-highlight-color:transparent;background-color:transparent;outline:0;border:0;margin:0;border-radius:0;padding:0;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle;-moz-appearance:none;-webkit-appearance:none;-webkit-text-decoration:none;text-decoration:none;color:inherit;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:500;font-size:0.8125rem;line-height:1.75;letter-spacing:0.02857em;text-transform:uppercase;min-width:64px;padding:3px 9px;border-radius:4px;-webkit-transition:background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;border:1px solid rgba(237, 108, 2, 0.5);color:#ed6c02;}.css-1184ln1::-moz-focus-inner{border-style:none;}.css-1184ln1.Mui-disabled{pointer-events:none;cursor:default;}@media print{.css-1184ln1{-webkit-print-color-adjust:exact;color-adjust:exact;}}.css-1184ln1:hover{-webkit-text-decoration:none;text-decoration:none;background-color:rgba(237, 108, 2, 0.04);border:1px solid #ed6c02;}@media (hover: none){.css-1184ln1:hover{background-color:transparent;}}.css-1184ln1.Mui-disabled{color:rgba(0, 0, 0, 0.26);border:1px solid rgba(0, 0, 0, 0.12);}</style><button class="MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedWarning MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorWarning MuiButton-root MuiButton-outlined MuiButton-outlinedWarning MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorWarning css-1184ln1" tabindex="0" type="button">Home</button></a></div><div class="MuiBox-root css-1yae3jf"><style data-emotion="css vubbuv">.css-vubbuv{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;fill:currentColor;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;font-size:1.5rem;}</style><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="KeyboardArrowRightIcon"><path d="M8.59 16.59 13.17 12 8.59 7.41 10 6l6 6-6 6z"></path></svg><a href="/ml-ops/"><button class="MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedWarning MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorWarning MuiButton-root MuiButton-outlined MuiButton-outlinedWarning MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorWarning css-1184ln1" tabindex="0" type="button">ML Ops</button></a></div><div class="MuiBox-root css-1yae3jf"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="KeyboardArrowRightIcon"><path d="M8.59 16.59 13.17 12 8.59 7.41 10 6l6 6-6 6z"></path></svg><a href="/ml-ops/gpu-vs-cpu-performance-for-ml-inference-workflows/"><button class="MuiButtonBase-root MuiButton-root MuiButton-outlined MuiButton-outlinedWarning MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorWarning MuiButton-root MuiButton-outlined MuiButton-outlinedWarning MuiButton-sizeSmall MuiButton-outlinedSizeSmall MuiButton-colorWarning css-1184ln1" tabindex="0" type="button">ML Inference Performance on GPU and CPU across different batch sizes.</button></a></div></div><style data-emotion="css slaq2o">.css-slaq2o{box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;width:100%;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;margin-top:-16px;width:calc(100% + 16px);margin-left:-16px;margin-bottom:0px;}.css-slaq2o>.MuiGrid-item{padding-top:16px;}.css-slaq2o>.MuiGrid-item{padding-left:16px;}</style><div class="MuiGrid-root MuiGrid-container MuiGrid-spacing-xs-2 css-slaq2o"><style data-emotion="css hr4540">.css-hr4540{box-sizing:border-box;margin:0;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-flex-basis:100%;-ms-flex-preferred-size:100%;flex-basis:100%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:100%;background:linear-gradient(to right, #eeeeee, #ffffff);border-radius:20px;}@media (min-width:600px){.css-hr4540{-webkit-flex-basis:100%;-ms-flex-preferred-size:100%;flex-basis:100%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:100%;}}@media (min-width:900px){.css-hr4540{-webkit-flex-basis:33.333333%;-ms-flex-preferred-size:33.333333%;flex-basis:33.333333%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:33.333333%;}}@media (min-width:1200px){.css-hr4540{-webkit-flex-basis:33.333333%;-ms-flex-preferred-size:33.333333%;flex-basis:33.333333%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:33.333333%;}}@media (min-width:1536px){.css-hr4540{-webkit-flex-basis:33.333333%;-ms-flex-preferred-size:33.333333%;flex-basis:33.333333%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:33.333333%;}}</style><div class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-12 MuiGrid-grid-sm-12 MuiGrid-grid-md-4 css-hr4540"><style data-emotion="css 194lag7">.css-194lag7{width:100%;height:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;padding-bottom:16px;}</style><div class="MuiBox-root css-194lag7"><style data-emotion="css t1nuxs">.css-t1nuxs{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1.5rem;line-height:1.334;letter-spacing:0em;margin-bottom:0.35em;}</style><h1 class="MuiTypography-root MuiTypography-h5 MuiTypography-gutterBottom css-t1nuxs">ML Inference Performance on GPU and CPU across different batch sizes.</h1><style data-emotion="css 15wzlf5">.css-15wzlf5{margin:0;margin-bottom:0.35em;margin-bottom:32px;}</style><p class="MuiTypography-root MuiTypography-p MuiTypography-gutterBottom css-15wzlf5">A comparison of ML inference speed and memory consumption across various batch sizes on both GPU and CPU.</p><style data-emotion="css 1aiyebw">.css-1aiyebw{width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-bottom:16px;}</style><div class="MuiBox-root css-1aiyebw"><style data-emotion="css mxjm1x">.css-mxjm1x{margin:0;margin-bottom:0.35em;}</style><p class="MuiTypography-root MuiTypography-p MuiTypography-gutterBottom css-mxjm1x">June 09, 2024</p><p class="MuiTypography-root MuiTypography-p MuiTypography-gutterBottom css-mxjm1x">08m<!-- --> Read</p></div><style data-emotion="css 1sdy4c7">.css-1sdy4c7{width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div class="MuiBox-root css-1sdy4c7"><style data-emotion="css 19115x2">.css-19115x2{margin:0;margin-right:16px;}</style><p class="MuiTypography-root MuiTypography-p css-19115x2">By: Abhilaksh Singh Reen</p><style data-emotion="css o6eoqx">.css-o6eoqx{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:space-evenly;-ms-flex-pack:space-evenly;-webkit-justify-content:space-evenly;justify-content:space-evenly;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div class="MuiBox-root css-o6eoqx"><style data-emotion="css 1t2xui4">.css-1t2xui4{text-align:center;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;font-size:1.5rem;padding:8px;border-radius:50%;overflow:visible;color:rgba(0, 0, 0, 0.54);-webkit-transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;color:#0077B5;}.css-1t2xui4:hover{background-color:rgba(0, 0, 0, 0.04);}@media (hover: none){.css-1t2xui4:hover{background-color:transparent;}}.css-1t2xui4.Mui-disabled{background-color:transparent;color:rgba(0, 0, 0, 0.26);}</style><style data-emotion="css 1yl6xtp">.css-1yl6xtp{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;position:relative;box-sizing:border-box;-webkit-tap-highlight-color:transparent;background-color:transparent;outline:0;border:0;margin:0;border-radius:0;padding:0;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle;-moz-appearance:none;-webkit-appearance:none;-webkit-text-decoration:none;text-decoration:none;color:inherit;text-align:center;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;font-size:1.5rem;padding:8px;border-radius:50%;overflow:visible;color:rgba(0, 0, 0, 0.54);-webkit-transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;color:#0077B5;}.css-1yl6xtp::-moz-focus-inner{border-style:none;}.css-1yl6xtp.Mui-disabled{pointer-events:none;cursor:default;}@media print{.css-1yl6xtp{-webkit-print-color-adjust:exact;color-adjust:exact;}}.css-1yl6xtp:hover{background-color:rgba(0, 0, 0, 0.04);}@media (hover: none){.css-1yl6xtp:hover{background-color:transparent;}}.css-1yl6xtp.Mui-disabled{background-color:transparent;color:rgba(0, 0, 0, 0.26);}</style><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-sizeMedium css-1yl6xtp" tabindex="0" type="button"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="LinkedInIcon"><path d="M19 3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14m-.5 15.5v-5.3a3.26 3.26 0 0 0-3.26-3.26c-.85 0-1.84.52-2.32 1.3v-1.11h-2.79v8.37h2.79v-4.93c0-.77.62-1.4 1.39-1.4a1.4 1.4 0 0 1 1.4 1.4v4.93h2.79M6.88 8.56a1.68 1.68 0 0 0 1.68-1.68c0-.93-.75-1.69-1.68-1.69a1.69 1.69 0 0 0-1.69 1.69c0 .93.76 1.68 1.69 1.68m1.39 9.94v-8.37H5.5v8.37h2.77z"></path></svg></button><style data-emotion="css 161nngb">.css-161nngb{text-align:center;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;font-size:1.5rem;padding:8px;border-radius:50%;overflow:visible;color:rgba(0, 0, 0, 0.54);-webkit-transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;color:#000000;}.css-161nngb:hover{background-color:rgba(0, 0, 0, 0.04);}@media (hover: none){.css-161nngb:hover{background-color:transparent;}}.css-161nngb.Mui-disabled{background-color:transparent;color:rgba(0, 0, 0, 0.26);}</style><style data-emotion="css tn2bks">.css-tn2bks{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;position:relative;box-sizing:border-box;-webkit-tap-highlight-color:transparent;background-color:transparent;outline:0;border:0;margin:0;border-radius:0;padding:0;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle;-moz-appearance:none;-webkit-appearance:none;-webkit-text-decoration:none;text-decoration:none;color:inherit;text-align:center;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;font-size:1.5rem;padding:8px;border-radius:50%;overflow:visible;color:rgba(0, 0, 0, 0.54);-webkit-transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;color:#000000;}.css-tn2bks::-moz-focus-inner{border-style:none;}.css-tn2bks.Mui-disabled{pointer-events:none;cursor:default;}@media print{.css-tn2bks{-webkit-print-color-adjust:exact;color-adjust:exact;}}.css-tn2bks:hover{background-color:rgba(0, 0, 0, 0.04);}@media (hover: none){.css-tn2bks:hover{background-color:transparent;}}.css-tn2bks.Mui-disabled{background-color:transparent;color:rgba(0, 0, 0, 0.26);}</style><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-sizeMedium css-tn2bks" tabindex="0" type="button"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="XIcon"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"></path></svg></button><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-sizeMedium css-tn2bks" tabindex="0" type="button"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="GitHubIcon"><path d="M12 1.27a11 11 0 00-3.48 21.46c.55.09.73-.28.73-.55v-1.84c-3.03.64-3.67-1.46-3.67-1.46-.55-1.29-1.28-1.65-1.28-1.65-.92-.65.1-.65.1-.65 1.1 0 1.73 1.1 1.73 1.1.92 1.65 2.57 1.2 3.21.92a2 2 0 01.64-1.47c-2.47-.27-5.04-1.19-5.04-5.5 0-1.1.46-2.1 1.2-2.84a3.76 3.76 0 010-2.93s.91-.28 3.11 1.1c1.8-.49 3.7-.49 5.5 0 2.1-1.38 3.02-1.1 3.02-1.1a3.76 3.76 0 010 2.93c.83.74 1.2 1.74 1.2 2.94 0 4.21-2.57 5.13-5.04 5.4.45.37.82.92.82 2.02v3.03c0 .27.1.64.73.55A11 11 0 0012 1.27"></path></svg></button></div></div></div></div><style data-emotion="css efwuvd">.css-efwuvd{box-sizing:border-box;margin:0;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-flex-basis:100%;-ms-flex-preferred-size:100%;flex-basis:100%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:100%;}@media (min-width:600px){.css-efwuvd{-webkit-flex-basis:100%;-ms-flex-preferred-size:100%;flex-basis:100%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:100%;}}@media (min-width:900px){.css-efwuvd{-webkit-flex-basis:66.666667%;-ms-flex-preferred-size:66.666667%;flex-basis:66.666667%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:66.666667%;}}@media (min-width:1200px){.css-efwuvd{-webkit-flex-basis:66.666667%;-ms-flex-preferred-size:66.666667%;flex-basis:66.666667%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:66.666667%;}}@media (min-width:1536px){.css-efwuvd{-webkit-flex-basis:66.666667%;-ms-flex-preferred-size:66.666667%;flex-basis:66.666667%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:66.666667%;}}</style><div class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-12 MuiGrid-grid-sm-12 MuiGrid-grid-md-8 css-efwuvd"><style data-emotion="css fbmkol">.css-fbmkol{-webkit-flex:1;-ms-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-right:16px;}</style><div class="MuiBox-root css-fbmkol"><img src="/media/images/gpu-vs-cpu-performance-for-ml-inference-workflows-thumbnail.jpg" style="width:100%;max-width:75vw;height:auto;max-height:35vh;object-fit:cover"/></div></div></div><style data-emotion="css 8atqhb">.css-8atqhb{width:100%;}</style><div class="MuiBox-root css-8atqhb"><style data-emotion="css iv262p">.css-iv262p{box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;width:100%;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;margin-top:-16px;width:calc(100% + 16px);margin-left:-16px;margin-top:32px;margin-bottom:0px;}.css-iv262p>.MuiGrid-item{padding-top:16px;}.css-iv262p>.MuiGrid-item{padding-left:16px;}</style><div class="MuiGrid-root MuiGrid-container MuiGrid-spacing-xs-2 css-iv262p"><style data-emotion="css 1hclw6t">.css-1hclw6t{box-sizing:border-box;margin:0;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-flex-basis:100%;-ms-flex-preferred-size:100%;flex-basis:100%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:100%;background:linear-gradient(to right, #eeeeee, #ffffff);border-radius:20px;}@media (min-width:600px){.css-1hclw6t{-webkit-flex-basis:100%;-ms-flex-preferred-size:100%;flex-basis:100%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:100%;}}@media (min-width:900px){.css-1hclw6t{-webkit-flex-basis:33.333333%;-ms-flex-preferred-size:33.333333%;flex-basis:33.333333%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:33.333333%;}}@media (min-width:1200px){.css-1hclw6t{-webkit-flex-basis:25%;-ms-flex-preferred-size:25%;flex-basis:25%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:25%;}}@media (min-width:1536px){.css-1hclw6t{-webkit-flex-basis:25%;-ms-flex-preferred-size:25%;flex-basis:25%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:25%;}}</style><div class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-12 MuiGrid-grid-sm-12 MuiGrid-grid-md-4 MuiGrid-grid-lg-3 css-1hclw6t"><div class="MuiBox-root css-8atqhb"><style data-emotion="css 1zqdou">.css-1zqdou{width:100%;margin-bottom:16px;}@media (min-width:0px){.css-1zqdou{display:block;}}@media (min-width:900px){.css-1zqdou{display:none;}}</style><div class="MuiBox-root css-1zqdou"><style data-emotion="css mgu3mc">.css-mgu3mc{position:relative;-webkit-transition:margin 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:margin 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;overflow-anchor:none;border-radius:0;width:100%;margin-bottom:16px;box-shadow:0px 3px 3px -2px rgba(0,0,0,0.2),0px 3px 4px 0px rgba(0,0,0,0.14),0px 1px 8px 0px rgba(0,0,0,0.12);background-color:#ffffff22;}.css-mgu3mc::before{position:absolute;left:0;top:-1px;right:0;height:1px;content:"";opacity:1;background-color:rgba(0, 0, 0, 0.12);-webkit-transition:opacity 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:opacity 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;}.css-mgu3mc:first-of-type::before{display:none;}.css-mgu3mc.Mui-expanded::before{opacity:0;}.css-mgu3mc.Mui-expanded:first-of-type{margin-top:0;}.css-mgu3mc.Mui-expanded:last-of-type{margin-bottom:0;}.css-mgu3mc.Mui-expanded+.css-mgu3mc.Mui-expanded::before{display:none;}.css-mgu3mc.Mui-disabled{background-color:rgba(0, 0, 0, 0.12);}.css-mgu3mc:first-of-type{border-top-left-radius:4px;border-top-right-radius:4px;}.css-mgu3mc:last-of-type{border-bottom-left-radius:4px;border-bottom-right-radius:4px;}@supports (-ms-ime-align: auto){.css-mgu3mc:last-of-type{border-bottom-left-radius:0;border-bottom-right-radius:0;}}</style><style data-emotion="css 16ex79u">.css-16ex79u{background-color:#fff;color:rgba(0, 0, 0, 0.87);-webkit-transition:box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;border-radius:4px;box-shadow:0px 2px 1px -1px rgba(0,0,0,0.2),0px 1px 1px 0px rgba(0,0,0,0.14),0px 1px 3px 0px rgba(0,0,0,0.12);position:relative;-webkit-transition:margin 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:margin 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;overflow-anchor:none;border-radius:0;width:100%;margin-bottom:16px;box-shadow:0px 3px 3px -2px rgba(0,0,0,0.2),0px 3px 4px 0px rgba(0,0,0,0.14),0px 1px 8px 0px rgba(0,0,0,0.12);background-color:#ffffff22;}.css-16ex79u::before{position:absolute;left:0;top:-1px;right:0;height:1px;content:"";opacity:1;background-color:rgba(0, 0, 0, 0.12);-webkit-transition:opacity 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:opacity 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;}.css-16ex79u:first-of-type::before{display:none;}.css-16ex79u.Mui-expanded::before{opacity:0;}.css-16ex79u.Mui-expanded:first-of-type{margin-top:0;}.css-16ex79u.Mui-expanded:last-of-type{margin-bottom:0;}.css-16ex79u.Mui-expanded+.css-16ex79u.Mui-expanded::before{display:none;}.css-16ex79u.Mui-disabled{background-color:rgba(0, 0, 0, 0.12);}.css-16ex79u:first-of-type{border-top-left-radius:4px;border-top-right-radius:4px;}.css-16ex79u:last-of-type{border-bottom-left-radius:4px;border-bottom-right-radius:4px;}@supports (-ms-ime-align: auto){.css-16ex79u:last-of-type{border-bottom-left-radius:0;border-bottom-right-radius:0;}}</style><div class="MuiPaper-root MuiPaper-elevation MuiPaper-rounded MuiPaper-elevation1 MuiAccordion-root MuiAccordion-rounded css-16ex79u"><style data-emotion="css 148gpqp">.css-148gpqp{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;min-height:48px;padding:0px 16px;-webkit-transition:min-height 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:min-height 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;}.css-148gpqp.Mui-focusVisible{background-color:rgba(0, 0, 0, 0.12);}.css-148gpqp.Mui-disabled{opacity:0.38;}.css-148gpqp:hover:not(.Mui-disabled){cursor:pointer;}</style><style data-emotion="css 1uaukoe">.css-1uaukoe{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;position:relative;box-sizing:border-box;-webkit-tap-highlight-color:transparent;background-color:transparent;outline:0;border:0;margin:0;border-radius:0;padding:0;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle;-moz-appearance:none;-webkit-appearance:none;-webkit-text-decoration:none;text-decoration:none;color:inherit;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;min-height:48px;padding:0px 16px;-webkit-transition:min-height 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:min-height 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;}.css-1uaukoe::-moz-focus-inner{border-style:none;}.css-1uaukoe.Mui-disabled{pointer-events:none;cursor:default;}@media print{.css-1uaukoe{-webkit-print-color-adjust:exact;color-adjust:exact;}}.css-1uaukoe.Mui-focusVisible{background-color:rgba(0, 0, 0, 0.12);}.css-1uaukoe.Mui-disabled{opacity:0.38;}.css-1uaukoe:hover:not(.Mui-disabled){cursor:pointer;}</style><div class="MuiButtonBase-root MuiAccordionSummary-root css-1uaukoe" tabindex="0" role="button" aria-expanded="false"><style data-emotion="css 1n11r91">.css-1n11r91{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;margin:12px 0;}</style><div class="MuiAccordionSummary-content css-1n11r91"><style data-emotion="css 10n6ggx">.css-10n6ggx{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:500;font-size:1.25rem;line-height:1.6;letter-spacing:0.0075em;margin:0px;padding:0px;}</style><h6 class="MuiTypography-root MuiTypography-h6 css-10n6ggx">Table of Contents</h6></div><style data-emotion="css 1fx8m19">.css-1fx8m19{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;color:rgba(0, 0, 0, 0.54);-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-ms-transform:rotate(0deg);transform:rotate(0deg);-webkit-transition:-webkit-transform 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:transform 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;}.css-1fx8m19.Mui-expanded{-webkit-transform:rotate(180deg);-moz-transform:rotate(180deg);-ms-transform:rotate(180deg);transform:rotate(180deg);}</style><div class="MuiAccordionSummary-expandIconWrapper css-1fx8m19"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ExpandMoreIcon"><path d="M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"></path></svg></div></div><style data-emotion="css a0y2e3">.css-a0y2e3{height:0;overflow:hidden;-webkit-transition:height 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:height 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;visibility:hidden;}</style><div class="MuiCollapse-root MuiCollapse-vertical MuiCollapse-hidden css-a0y2e3" style="min-height:0px"><style data-emotion="css hboir5">.css-hboir5{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;width:100%;}</style><div class="MuiCollapse-wrapper MuiCollapse-vertical css-hboir5"><div class="MuiCollapse-wrapperInner MuiCollapse-vertical css-8atqhb"><div role="region" class="MuiAccordion-region"><style data-emotion="css 2m6k8o">.css-2m6k8o{padding:8px 16px 16px;width:90%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:start;-ms-flex-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;margin-bottom:16px;}</style><div class="MuiAccordionDetails-root css-2m6k8o"><a href="#the-model" style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"><style data-emotion="css vmnodn">.css-vmnodn{margin:0;margin-left:0px;margin-bottom:20px;}.css-vmnodn:hover{color:blue;}</style><p class="MuiTypography-root MuiTypography-p css-vmnodn">The Model</p></a><a href="#cpu-and-gpu" style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"><style data-emotion="css 1i0m0sm">.css-1i0m0sm{margin:0;margin-left:8px;margin-bottom:16px;}.css-1i0m0sm:hover{color:blue;}</style><p class="MuiTypography-root MuiTypography-p css-1i0m0sm">CPU and GPU</p></a><a href="#testing-code" style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"><p class="MuiTypography-root MuiTypography-p css-1i0m0sm">Testing Code</p></a><a href="#cpu-inference" style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"><p class="MuiTypography-root MuiTypography-p css-vmnodn">CPU Inference</p></a><a href="#gpu-inference" style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"><p class="MuiTypography-root MuiTypography-p css-vmnodn">GPU Inference</p></a><a href="#batched-gpu-inference" style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"><p class="MuiTypography-root MuiTypography-p css-vmnodn">Batched GPU Inference</p></a><a href="#batched-cpu-inference:-any-good?" style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"><p class="MuiTypography-root MuiTypography-p css-1i0m0sm">Batched CPU Inference: Any Good?</p></a><a href="#model-dependence" style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"><p class="MuiTypography-root MuiTypography-p css-1i0m0sm">Model Dependence</p></a><a href="#conclusion" style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"><p class="MuiTypography-root MuiTypography-p css-vmnodn">Conclusion</p></a></div></div></div></div></div></div></div><style data-emotion="css 8e7o3j">.css-8e7o3j{width:100%;}@media (min-width:0px){.css-8e7o3j{display:none;}}@media (min-width:900px){.css-8e7o3j{display:block;}}</style><div class="MuiBox-root css-8e7o3j"><style data-emotion="css 1npmiby">.css-1npmiby{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1.5rem;line-height:1.334;letter-spacing:0em;margin:0px;padding:0px;}</style><h5 class="MuiTypography-root MuiTypography-h5 css-1npmiby">Table of Contents</h5><a href="#the-model" style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"><p class="MuiTypography-root MuiTypography-p css-vmnodn">The Model</p></a><a href="#cpu-and-gpu" style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"><p class="MuiTypography-root MuiTypography-p css-1i0m0sm">CPU and GPU</p></a><a href="#testing-code" style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"><p class="MuiTypography-root MuiTypography-p css-1i0m0sm">Testing Code</p></a><a href="#cpu-inference" style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"><p class="MuiTypography-root MuiTypography-p css-vmnodn">CPU Inference</p></a><a href="#gpu-inference" style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"><p class="MuiTypography-root MuiTypography-p css-vmnodn">GPU Inference</p></a><a href="#batched-gpu-inference" style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"><p class="MuiTypography-root MuiTypography-p css-vmnodn">Batched GPU Inference</p></a><a href="#batched-cpu-inference:-any-good?" style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"><p class="MuiTypography-root MuiTypography-p css-1i0m0sm">Batched CPU Inference: Any Good?</p></a><a href="#model-dependence" style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"><p class="MuiTypography-root MuiTypography-p css-1i0m0sm">Model Dependence</p></a><a href="#conclusion" style="text-decoration:none;color:inherit;&amp;:visited:[object Object]"><p class="MuiTypography-root MuiTypography-p css-vmnodn">Conclusion</p></a></div></div></div><style data-emotion="css 4uwbp1">.css-4uwbp1{box-sizing:border-box;margin:0;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-flex-basis:100%;-ms-flex-preferred-size:100%;flex-basis:100%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:100%;background:linear-gradient(to right, #ffffff, #eeeeee);border-radius:20px;}@media (min-width:600px){.css-4uwbp1{-webkit-flex-basis:100%;-ms-flex-preferred-size:100%;flex-basis:100%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:100%;}}@media (min-width:900px){.css-4uwbp1{-webkit-flex-basis:66.666667%;-ms-flex-preferred-size:66.666667%;flex-basis:66.666667%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:66.666667%;}}@media (min-width:1200px){.css-4uwbp1{-webkit-flex-basis:75%;-ms-flex-preferred-size:75%;flex-basis:75%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:75%;}}@media (min-width:1536px){.css-4uwbp1{-webkit-flex-basis:75%;-ms-flex-preferred-size:75%;flex-basis:75%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:75%;}}</style><div class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-12 MuiGrid-grid-sm-12 MuiGrid-grid-md-8 MuiGrid-grid-lg-9 css-4uwbp1"><style data-emotion="css 1zo2vp">.css-1zo2vp{-webkit-flex:1;-ms-flex:1;flex:1;margin-right:16px;}</style><div class="MuiBox-root css-1zo2vp"><style data-emotion="css vsuld9">.css-vsuld9{margin:0;text-align:justify;margin-bottom:16px;}</style><p class="MuiTypography-root MuiTypography-p css-vsuld9">When deploying your ML model to production, it is important to get the inference process running as fast as possible. GPUs are efficient at parallel processing. In today&#x27;s article, we compare the inference speeds of running a PyTorch model on a CPU and a GPU. We also test how processing more images in parallel, as batches, on GPU affects the speed.</p><style data-emotion="css rg843f">.css-rg843f{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:2.125rem;line-height:1.235;letter-spacing:0.00735em;margin-bottom:16px;}</style><h1 class="MuiTypography-root MuiTypography-h4 css-rg843f" id="the-model"><strong>The Model</strong></h1><p class="MuiTypography-root MuiTypography-p css-vsuld9">Inside the project directory, let&#x27;s create a folder called <style data-emotion="css 87x4qo">.css-87x4qo{padding-left:4px;padding-right:4px;border-radius:4px;background-color:rgb(227, 234, 242);}</style><span class="MuiBox-root css-87x4qo">src</span>. Inside this folder, create a new file called <span class="MuiBox-root css-87x4qo">model.py</span>. Here, we&#x27;ll define a very simple model based on the <span class="MuiBox-root css-87x4qo">UNet++</span> architecture. For this, we&#x27;ll use the <style data-emotion="css ct9vl7">.css-ct9vl7{-webkit-text-decoration:none;text-decoration:none;}.css-ct9vl7:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><style data-emotion="css 1vxruma">.css-1vxruma{margin:0;font:inherit;color:#1976d2;-webkit-text-decoration:none;text-decoration:none;}.css-1vxruma:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover css-1vxruma" href="https://pypi.org/project/segmentation-models-pytorch/0.0.3/" rel="noopener noreferrer" target="_blank">segmentation_models_pytorch</a> package. Inside the file, we create a class called <span class="MuiBox-root css-87x4qo">Model</span> that has 4 main functions:</p><p class="MuiTypography-root MuiTypography-p css-vsuld9">1. <span class="MuiBox-root css-87x4qo">__init__</span>: initializes the model, loads the weights, and creates the preprocessing transform.</p><p class="MuiTypography-root MuiTypography-p css-vsuld9">1. <span class="MuiBox-root css-87x4qo">preprocess</span>: takes a list of images and returns a batch that can be passed to the <span class="MuiBox-root css-87x4qo">forward</span> function.</p><p class="MuiTypography-root MuiTypography-p css-vsuld9">1. <span class="MuiBox-root css-87x4qo">postprocess</span>: takes a single model output and returns an image with an option to resize the image.</p><p class="MuiTypography-root MuiTypography-p css-vsuld9">1. <span class="MuiBox-root css-87x4qo">forward</span>: the function used for inference.</p><style data-emotion="css dzaqf9">.css-dzaqf9{width:100%;margin-bottom:16px;}</style><div class="MuiBox-root css-dzaqf9"><style data-emotion="css 125pbeb">.css-125pbeb{background-color:rgb(227, 234, 242);width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:end;-ms-flex-pack:end;-webkit-justify-content:flex-end;justify-content:flex-end;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div class="MuiBox-root css-125pbeb"><style data-emotion="css 1xdvxj1">.css-1xdvxj1{text-align:center;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;font-size:1.5rem;padding:8px;border-radius:50%;overflow:visible;color:rgba(0, 0, 0, 0.54);-webkit-transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;color:#1976d2;padding:12px;font-size:1.75rem;}.css-1xdvxj1:hover{background-color:rgba(0, 0, 0, 0.04);}@media (hover: none){.css-1xdvxj1:hover{background-color:transparent;}}.css-1xdvxj1:hover{background-color:rgba(25, 118, 210, 0.04);}@media (hover: none){.css-1xdvxj1:hover{background-color:transparent;}}.css-1xdvxj1.Mui-disabled{background-color:transparent;color:rgba(0, 0, 0, 0.26);}</style><style data-emotion="css h1oho">.css-h1oho{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;position:relative;box-sizing:border-box;-webkit-tap-highlight-color:transparent;background-color:transparent;outline:0;border:0;margin:0;border-radius:0;padding:0;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle;-moz-appearance:none;-webkit-appearance:none;-webkit-text-decoration:none;text-decoration:none;color:inherit;text-align:center;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;font-size:1.5rem;padding:8px;border-radius:50%;overflow:visible;color:rgba(0, 0, 0, 0.54);-webkit-transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;color:#1976d2;padding:12px;font-size:1.75rem;}.css-h1oho::-moz-focus-inner{border-style:none;}.css-h1oho.Mui-disabled{pointer-events:none;cursor:default;}@media print{.css-h1oho{-webkit-print-color-adjust:exact;color-adjust:exact;}}.css-h1oho:hover{background-color:rgba(0, 0, 0, 0.04);}@media (hover: none){.css-h1oho:hover{background-color:transparent;}}.css-h1oho:hover{background-color:rgba(25, 118, 210, 0.04);}@media (hover: none){.css-h1oho:hover{background-color:transparent;}}.css-h1oho.Mui-disabled{background-color:transparent;color:rgba(0, 0, 0, 0.26);}</style><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho" tabindex="0" type="button"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ContentCopyIcon"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"></path></svg></button></div><pre style="color:#111b27;background:#e3eaf2;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0;overflow:auto"><code class="language-python" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#a04900">from</span><span> segmentation_models_pytorch </span><span class="token" style="color:#a04900">import</span><span> UnetPlusPlus
</span><span></span><span class="token" style="color:#a04900">import</span><span> torch
</span><span></span><span class="token" style="color:#a04900">import</span><span> torch</span><span class="token" style="color:#111b27">.</span><span>nn</span><span class="token" style="color:#111b27">.</span><span>functional </span><span class="token" style="color:#a04900">as</span><span> F
</span><span></span><span class="token" style="color:#a04900">from</span><span> torchvision </span><span class="token" style="color:#a04900">import</span><span> transforms
</span>
<!-- -->
<span></span><span class="token" style="color:#a04900">class</span><span> </span><span class="token" style="color:#005a8e">Model</span><span class="token" style="color:#111b27">:</span><span>
</span><span>    </span><span class="token" style="color:#a04900">def</span><span> </span><span class="token" style="color:#7c00aa">__init__</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">,</span><span> weights_path</span><span class="token" style="color:#111b27">,</span><span> use_cuda</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">False</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>        self</span><span class="token" style="color:#111b27">.</span><span>using_cuda </span><span class="token" style="color:#a04900">=</span><span> use_cuda </span><span class="token" style="color:#a04900">and</span><span> torch</span><span class="token" style="color:#111b27">.</span><span>cuda</span><span class="token" style="color:#111b27">.</span><span>is_available</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        self</span><span class="token" style="color:#111b27">.</span><span>device </span><span class="token" style="color:#a04900">=</span><span> torch</span><span class="token" style="color:#111b27">.</span><span>device</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;cuda&quot;</span><span class="token" style="color:#111b27">)</span><span> </span><span class="token" style="color:#a04900">if</span><span> self</span><span class="token" style="color:#111b27">.</span><span>using_cuda </span><span class="token" style="color:#a04900">else</span><span> torch</span><span class="token" style="color:#111b27">.</span><span>device</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;cpu&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        self</span><span class="token" style="color:#111b27">.</span><span>dtype </span><span class="token" style="color:#a04900">=</span><span> torch</span><span class="token" style="color:#111b27">.</span><span>cuda</span><span class="token" style="color:#111b27">.</span><span>FloatTensor </span><span class="token" style="color:#a04900">if</span><span> self</span><span class="token" style="color:#111b27">.</span><span>using_cuda </span><span class="token" style="color:#a04900">else</span><span> torch</span><span class="token" style="color:#111b27">.</span><span>Tensor
</span>
<span>        self</span><span class="token" style="color:#111b27">.</span><span>model </span><span class="token" style="color:#a04900">=</span><span> UnetPlusPlus</span><span class="token" style="color:#111b27">(</span><span>
</span><span>            encoder_name</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#116b00">&quot;resnet34&quot;</span><span class="token" style="color:#111b27">,</span><span>
</span><span>            encoder_depth</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">4</span><span class="token" style="color:#111b27">,</span><span>
</span><span>            encoder_weights</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#116b00">&quot;imagenet&quot;</span><span class="token" style="color:#111b27">,</span><span>
</span><span>            decoder_channels</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#755f00">256</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">128</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">64</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">32</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span>
</span><span>            in_channels</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">1</span><span class="token" style="color:#111b27">,</span><span>
</span><span>            classes</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">1</span><span class="token" style="color:#111b27">,</span><span>
</span><span>            activation</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">None</span><span class="token" style="color:#111b27">,</span><span>
</span><span>            aux_params</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">None</span><span>
</span><span>        </span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        self</span><span class="token" style="color:#111b27">.</span><span>model </span><span class="token" style="color:#a04900">=</span><span> self</span><span class="token" style="color:#111b27">.</span><span>model</span><span class="token" style="color:#111b27">.</span><span>to</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">.</span><span>device</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        self</span><span class="token" style="color:#111b27">.</span><span>model</span><span class="token" style="color:#111b27">.</span><span>load_state_dict</span><span class="token" style="color:#111b27">(</span><span>torch</span><span class="token" style="color:#111b27">.</span><span>load</span><span class="token" style="color:#111b27">(</span><span>weights_path</span><span class="token" style="color:#111b27">,</span><span> map_location</span><span class="token" style="color:#a04900">=</span><span>self</span><span class="token" style="color:#111b27">.</span><span>device</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        self</span><span class="token" style="color:#111b27">.</span><span>preprocessing_transform </span><span class="token" style="color:#a04900">=</span><span> transforms</span><span class="token" style="color:#111b27">.</span><span>Compose</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">[</span><span>
</span><span>            transforms</span><span class="token" style="color:#111b27">.</span><span>ToTensor</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span>
</span><span>            transforms</span><span class="token" style="color:#111b27">.</span><span>Resize</span><span class="token" style="color:#111b27">(</span><span>size</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#755f00">256</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">256</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        </span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        </span><span class="token" style="color:#a04900">if</span><span> use_cuda </span><span class="token" style="color:#a04900">and</span><span> </span><span class="token" style="color:#a04900">not</span><span> self</span><span class="token" style="color:#111b27">.</span><span>using_cuda</span><span class="token" style="color:#111b27">:</span><span>
</span><span>            </span><span class="token" style="color:#a04900">print</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;CUDA is not available to Torch, using CPU instead.&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    </span><span class="token" style="color:#a04900">def</span><span> </span><span class="token" style="color:#7c00aa">preprocess</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">,</span><span> images</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>        transformed_images </span><span class="token" style="color:#a04900">=</span><span> torch</span><span class="token" style="color:#111b27">.</span><span>stack</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">[</span><span>self</span><span class="token" style="color:#111b27">.</span><span>preprocessing_transform</span><span class="token" style="color:#111b27">(</span><span>image</span><span class="token" style="color:#111b27">)</span><span> </span><span class="token" style="color:#a04900">for</span><span> image </span><span class="token" style="color:#a04900">in</span><span> images</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        transformed_images </span><span class="token" style="color:#a04900">=</span><span> transformed_images</span><span class="token" style="color:#111b27">.</span><span class="token" style="color:#af00af">type</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">.</span><span>dtype</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        batched_images </span><span class="token" style="color:#a04900">=</span><span> transformed_images</span><span class="token" style="color:#111b27">.</span><span>to</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">.</span><span>device</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        </span><span class="token" style="color:#a04900">return</span><span> batched_images
</span>
<span>    </span><span class="token" style="color:#a04900">def</span><span> </span><span class="token" style="color:#7c00aa">postprocess</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">,</span><span> output</span><span class="token" style="color:#111b27">,</span><span> output_size</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#755f00">256</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">256</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>        output </span><span class="token" style="color:#a04900">=</span><span> output</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#755f00">0</span><span class="token" style="color:#111b27">]</span><span>
</span><span>        output </span><span class="token" style="color:#a04900">=</span><span> output</span><span class="token" style="color:#111b27">.</span><span>ge</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#755f00">0.5</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        output </span><span class="token" style="color:#a04900">=</span><span> F</span><span class="token" style="color:#111b27">.</span><span>interpolate</span><span class="token" style="color:#111b27">(</span><span>output</span><span class="token" style="color:#111b27">.</span><span>unsqueeze</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#755f00">0</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">.</span><span>unsqueeze</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#755f00">0</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">.</span><span class="token" style="color:#af00af">float</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span> size</span><span class="token" style="color:#a04900">=</span><span>output_size</span><span class="token" style="color:#111b27">,</span><span> mode</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#116b00">&quot;nearest&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        output </span><span class="token" style="color:#a04900">=</span><span> output</span><span class="token" style="color:#111b27">.</span><span class="token" style="color:#af00af">bool</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">.</span><span>squeeze</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#755f00">0</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">.</span><span>squeeze</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#755f00">0</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        </span><span class="token" style="color:#a04900">if</span><span> self</span><span class="token" style="color:#111b27">.</span><span>using_cuda</span><span class="token" style="color:#111b27">:</span><span>
</span><span>            output </span><span class="token" style="color:#a04900">=</span><span> output</span><span class="token" style="color:#111b27">.</span><span>cpu</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        output </span><span class="token" style="color:#a04900">=</span><span> output</span><span class="token" style="color:#111b27">.</span><span>numpy</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        </span><span class="token" style="color:#a04900">return</span><span> output
</span>
<span>    </span><span class="token" style="color:#a04900">def</span><span> </span><span class="token" style="color:#7c00aa">forward</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">,</span><span> preprocessed_images</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>        output </span><span class="token" style="color:#a04900">=</span><span> self</span><span class="token" style="color:#111b27">.</span><span>model</span><span class="token" style="color:#111b27">.</span><span>forward</span><span class="token" style="color:#111b27">(</span><span>preprocessed_images</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        output </span><span class="token" style="color:#a04900">=</span><span> torch</span><span class="token" style="color:#111b27">.</span><span>sigmoid</span><span class="token" style="color:#111b27">(</span><span>output</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        output </span><span class="token" style="color:#a04900">=</span><span> output</span><span class="token" style="color:#111b27">.</span><span>detach</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        </span><span class="token" style="color:#a04900">return</span><span> output</span></code></pre></div><style data-emotion="css 1oj41as">.css-1oj41as{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1.5rem;line-height:1.334;letter-spacing:0em;margin-bottom:16px;}</style><h2 class="MuiTypography-root MuiTypography-h5 css-1oj41as" id="cpu-and-gpu"><strong>CPU and GPU</strong></h2><p class="MuiTypography-root MuiTypography-p css-vsuld9">In the following three lines, define <span class="MuiBox-root css-87x4qo">self.device</span> and <span class="MuiBox-root css-87x4qo">self.dtype</span> based on whether the constructor was called with the instruction to use CUDA and if CUDA is actually available to torch.</p><div class="MuiBox-root css-dzaqf9"><div class="MuiBox-root css-125pbeb"><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho" tabindex="0" type="button"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ContentCopyIcon"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"></path></svg></button></div><pre style="color:#111b27;background:#e3eaf2;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0;overflow:auto"><code class="language-python" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>self</span><span class="token" style="color:#111b27">.</span><span>using_cuda </span><span class="token" style="color:#a04900">=</span><span> use_cuda </span><span class="token" style="color:#a04900">and</span><span> torch</span><span class="token" style="color:#111b27">.</span><span>cuda</span><span class="token" style="color:#111b27">.</span><span>is_available</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span><span>self</span><span class="token" style="color:#111b27">.</span><span>device </span><span class="token" style="color:#a04900">=</span><span> torch</span><span class="token" style="color:#111b27">.</span><span>device</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;cuda&quot;</span><span class="token" style="color:#111b27">)</span><span> </span><span class="token" style="color:#a04900">if</span><span> self</span><span class="token" style="color:#111b27">.</span><span>using_cuda </span><span class="token" style="color:#a04900">else</span><span> torch</span><span class="token" style="color:#111b27">.</span><span>device</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;cpu&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span><span>self</span><span class="token" style="color:#111b27">.</span><span>dtype </span><span class="token" style="color:#a04900">=</span><span> torch</span><span class="token" style="color:#111b27">.</span><span>cuda</span><span class="token" style="color:#111b27">.</span><span>FloatTensor </span><span class="token" style="color:#a04900">if</span><span> self</span><span class="token" style="color:#111b27">.</span><span>using_cuda </span><span class="token" style="color:#a04900">else</span><span> torch</span><span class="token" style="color:#111b27">.</span><span>Tensor</span></code></pre></div><p class="MuiTypography-root MuiTypography-p css-vsuld9">We load the model to the <span class="MuiBox-root css-87x4qo">device</span>.</p><div class="MuiBox-root css-dzaqf9"><div class="MuiBox-root css-125pbeb"><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho" tabindex="0" type="button"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ContentCopyIcon"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"></path></svg></button></div><pre style="color:#111b27;background:#e3eaf2;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0;overflow:auto"><code class="language-python" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>self</span><span class="token" style="color:#111b27">.</span><span>model </span><span class="token" style="color:#a04900">=</span><span> self</span><span class="token" style="color:#111b27">.</span><span>model</span><span class="token" style="color:#111b27">.</span><span>to</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">.</span><span>device</span><span class="token" style="color:#111b27">)</span><span>
</span><span>self</span><span class="token" style="color:#111b27">.</span><span>model</span><span class="token" style="color:#111b27">.</span><span>load_state_dict</span><span class="token" style="color:#111b27">(</span><span>torch</span><span class="token" style="color:#111b27">.</span><span>load</span><span class="token" style="color:#111b27">(</span><span>weights_path</span><span class="token" style="color:#111b27">,</span><span> map_location</span><span class="token" style="color:#a04900">=</span><span>self</span><span class="token" style="color:#111b27">.</span><span>device</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">)</span></code></pre></div><p class="MuiTypography-root MuiTypography-p css-vsuld9">And, in the preprocessing function, we transfer our batched images to the device as well.</p><div class="MuiBox-root css-dzaqf9"><div class="MuiBox-root css-125pbeb"><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho" tabindex="0" type="button"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ContentCopyIcon"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"></path></svg></button></div><pre style="color:#111b27;background:#e3eaf2;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0;overflow:auto"><code class="language-python" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>batched_images </span><span class="token" style="color:#a04900">=</span><span> transformed_images</span><span class="token" style="color:#111b27">.</span><span>to</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">.</span><span>device</span><span class="token" style="color:#111b27">)</span></code></pre></div><p class="MuiTypography-root MuiTypography-p css-vsuld9">In the src directory, we&#x27;ll make another file <span class="MuiBox-root css-87x4qo">config.py</span> to store the directories we will be using for testing.</p><div class="MuiBox-root css-dzaqf9"><div class="MuiBox-root css-125pbeb"><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho" tabindex="0" type="button"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ContentCopyIcon"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"></path></svg></button></div><pre style="color:#111b27;background:#e3eaf2;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0;overflow:auto"><code class="language-python" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#a04900">from</span><span> os</span><span class="token" style="color:#111b27">.</span><span>path </span><span class="token" style="color:#a04900">import</span><span> dirname</span><span class="token" style="color:#111b27">,</span><span> join </span><span class="token" style="color:#a04900">as</span><span> path_join
</span>
<!-- -->
<span>inputs_dir </span><span class="token" style="color:#a04900">=</span><span> path_join</span><span class="token" style="color:#111b27">(</span><span>dirname</span><span class="token" style="color:#111b27">(</span><span>dirname</span><span class="token" style="color:#111b27">(</span><span>__file__</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;inputs&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span><span>weights_dir </span><span class="token" style="color:#a04900">=</span><span> path_join</span><span class="token" style="color:#111b27">(</span><span>dirname</span><span class="token" style="color:#111b27">(</span><span>dirname</span><span class="token" style="color:#111b27">(</span><span>__file__</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;weights&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span><span>outputs_dir </span><span class="token" style="color:#a04900">=</span><span> path_join</span><span class="token" style="color:#111b27">(</span><span>dirname</span><span class="token" style="color:#111b27">(</span><span>dirname</span><span class="token" style="color:#111b27">(</span><span>__file__</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;outputs&quot;</span><span class="token" style="color:#111b27">)</span></code></pre></div><p class="MuiTypography-root MuiTypography-p css-vsuld9">Let us also create these three folders, here is what the project&#x27;s directory structure should look like after doing so.</p><div class="MuiBox-root css-dzaqf9"><div class="MuiBox-root css-125pbeb"><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho" tabindex="0" type="button"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ContentCopyIcon"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"></path></svg></button></div><pre style="color:#111b27;background:#e3eaf2;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0;overflow:auto"><code class="language-bash" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>inputs
</span>       sample_image.png
<!-- -->
<!-- -->outputs
<!-- -->       sample_mask.png
<!-- -->
<!-- -->src
<!-- -->       config.py
<!-- -->       model.py
<!-- -->       test.py
<!-- -->
<!-- -->weights
<!-- -->        weights_001.pt</code></pre></div><h2 class="MuiTypography-root MuiTypography-h5 css-1oj41as" id="testing-code"><strong>Testing Code</strong></h2><p class="MuiTypography-root MuiTypography-p css-vsuld9">Let&#x27;s work on the <span class="MuiBox-root css-87x4qo">src/test.py</span> file. Our input images are located in the <span class="MuiBox-root css-87x4qo">inputs</span> folder and model weights are in the <span class="MuiBox-root css-87x4qo">weights</span> folder.</p><div class="MuiBox-root css-dzaqf9"><div class="MuiBox-root css-125pbeb"><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho" tabindex="0" type="button"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ContentCopyIcon"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"></path></svg></button></div><pre style="color:#111b27;background:#e3eaf2;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0;overflow:auto"><code class="language-python" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#a04900">from</span><span> os </span><span class="token" style="color:#a04900">import</span><span> listdir
</span><span></span><span class="token" style="color:#a04900">from</span><span> os</span><span class="token" style="color:#111b27">.</span><span>path </span><span class="token" style="color:#a04900">import</span><span> join </span><span class="token" style="color:#a04900">as</span><span> path_join
</span><span></span><span class="token" style="color:#a04900">from</span><span> time </span><span class="token" style="color:#a04900">import</span><span> time
</span>
<span></span><span class="token" style="color:#a04900">import</span><span> cv2
</span><span></span><span class="token" style="color:#a04900">import</span><span> numpy </span><span class="token" style="color:#a04900">as</span><span> np
</span>
<span></span><span class="token" style="color:#a04900">from</span><span> config </span><span class="token" style="color:#a04900">import</span><span> inputs_dir</span><span class="token" style="color:#111b27">,</span><span> outputs_dir</span><span class="token" style="color:#111b27">,</span><span> weights_dir
</span><span></span><span class="token" style="color:#a04900">from</span><span> model </span><span class="token" style="color:#a04900">import</span><span> Model
</span>
<!-- -->
<span></span><span class="token" style="color:#a04900">if</span><span> __name__ </span><span class="token" style="color:#a04900">==</span><span> </span><span class="token" style="color:#116b00">&quot;__main__&quot;</span><span class="token" style="color:#111b27">:</span><span>
</span><span>    test_images </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token" style="color:#111b27">[</span><span>cv2</span><span class="token" style="color:#111b27">.</span><span>imread</span><span class="token" style="color:#111b27">(</span><span>path_join</span><span class="token" style="color:#111b27">(</span><span>inputs_dir</span><span class="token" style="color:#111b27">,</span><span> image_name</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span> cv2</span><span class="token" style="color:#111b27">.</span><span>IMREAD_GRAYSCALE</span><span class="token" style="color:#111b27">)</span><span> </span><span class="token" style="color:#a04900">for</span><span> image_name </span><span class="token" style="color:#a04900">in</span><span> listdir</span><span class="token" style="color:#111b27">(</span><span>inputs_dir</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">]</span><span>
</span><span>    </span><span class="token" style="color:#a04900">print</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;Images loaded.&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    model </span><span class="token" style="color:#a04900">=</span><span> Model</span><span class="token" style="color:#111b27">(</span><span>path_join</span><span class="token" style="color:#111b27">(</span><span>weights_dir</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;weights_001.pt&quot;</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">)</span><span>
</span><span>    </span><span class="token" style="color:#a04900">print</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;Model loaded.&quot;</span><span class="token" style="color:#111b27">)</span></code></pre></div><p class="MuiTypography-root MuiTypography-p css-vsuld9">Next, we can iterate over each of the test images, preprocess them, run a forward pass, postprocess, and save the output.</p><div class="MuiBox-root css-dzaqf9"><div class="MuiBox-root css-125pbeb"><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho" tabindex="0" type="button"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ContentCopyIcon"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"></path></svg></button></div><pre style="color:#111b27;background:#e3eaf2;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0;overflow:auto"><code class="language-python" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>start_time </span><span class="token" style="color:#a04900">=</span><span> time</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>outputs </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#111b27">]</span><span>
</span><span></span><span class="token" style="color:#a04900">for</span><span> i</span><span class="token" style="color:#111b27">,</span><span> test_image </span><span class="token" style="color:#a04900">in</span><span> </span><span class="token" style="color:#af00af">enumerate</span><span class="token" style="color:#111b27">(</span><span>test_images</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>    preprocessed_image </span><span class="token" style="color:#a04900">=</span><span> model</span><span class="token" style="color:#111b27">.</span><span>preprocess</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">[</span><span>test_image</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">)</span><span>
</span><span>    output </span><span class="token" style="color:#a04900">=</span><span> model</span><span class="token" style="color:#111b27">.</span><span>forward</span><span class="token" style="color:#111b27">(</span><span>preprocessed_image</span><span class="token" style="color:#111b27">)</span><span>
</span><span>    output </span><span class="token" style="color:#a04900">=</span><span> output</span><span class="token" style="color:#111b27">.</span><span>detach</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span><span>    outputs</span><span class="token" style="color:#111b27">.</span><span>append</span><span class="token" style="color:#111b27">(</span><span>output</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>end_time </span><span class="token" style="color:#a04900">=</span><span> time</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span><span>time_elapsed </span><span class="token" style="color:#a04900">=</span><span> end_time </span><span class="token" style="color:#a04900">-</span><span> start_time
</span><span></span><span class="token" style="color:#a04900">print</span><span class="token" style="color:#111b27">(</span><span>
</span><span>    </span><span class="token string-interpolation" style="color:#116b00">f&quot;Num images: </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation" style="color:#af00af">len</span><span class="token string-interpolation interpolation" style="color:#111b27">(</span><span class="token string-interpolation interpolation">test_images</span><span class="token string-interpolation interpolation" style="color:#111b27">)</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">, &quot;</span><span>
</span><span>    </span><span class="token string-interpolation" style="color:#116b00">f&quot;Batch size: </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation" style="color:#755f00">1</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">, &quot;</span><span>
</span><span>    </span><span class="token string-interpolation" style="color:#116b00">f&quot;Time taken: </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">time_elapsed</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00"> s, &quot;</span><span>
</span><span>    </span><span class="token string-interpolation" style="color:#116b00">f&quot;Time taken per image: </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation" style="color:#755f00">1000</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation" style="color:#a04900">*</span><span class="token string-interpolation interpolation"> time_elapsed </span><span class="token string-interpolation interpolation" style="color:#a04900">/</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation" style="color:#af00af">len</span><span class="token string-interpolation interpolation" style="color:#111b27">(</span><span class="token string-interpolation interpolation">test_images</span><span class="token string-interpolation interpolation" style="color:#111b27">)</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00"> ms&quot;</span><span>
</span><span></span><span class="token" style="color:#111b27">)</span><span>
</span>
<span></span><span class="token" style="color:#a04900">for</span><span> output </span><span class="token" style="color:#a04900">in</span><span> outputs</span><span class="token" style="color:#111b27">:</span><span>
</span><span>    boolean_array </span><span class="token" style="color:#a04900">=</span><span> model</span><span class="token" style="color:#111b27">.</span><span>postprocess</span><span class="token" style="color:#111b27">(</span><span>output</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#755f00">0</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#755f00">512</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">512</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">)</span><span>
</span><span>    binary_image </span><span class="token" style="color:#a04900">=</span><span> boolean_array</span><span class="token" style="color:#111b27">.</span><span>astype</span><span class="token" style="color:#111b27">(</span><span>np</span><span class="token" style="color:#111b27">.</span><span>uint8</span><span class="token" style="color:#111b27">)</span><span> </span><span class="token" style="color:#a04900">*</span><span> </span><span class="token" style="color:#755f00">255</span><span>
</span><span>    file_path </span><span class="token" style="color:#a04900">=</span><span> path_join</span><span class="token" style="color:#111b27">(</span><span>outputs_dir</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token string-interpolation" style="color:#116b00">f&quot;</span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">i</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">.png&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span><span>    cv2</span><span class="token" style="color:#111b27">.</span><span>imwrite</span><span class="token" style="color:#111b27">(</span><span>file_path</span><span class="token" style="color:#111b27">,</span><span> binary_image</span><span class="token" style="color:#111b27">)</span></code></pre></div><p class="MuiTypography-root MuiTypography-p css-vsuld9">Here&#x27;s the entire <span class="MuiBox-root css-87x4qo">test.py</span> file:</p><div class="MuiBox-root css-dzaqf9"><div class="MuiBox-root css-125pbeb"><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho" tabindex="0" type="button"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ContentCopyIcon"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"></path></svg></button></div><pre style="color:#111b27;background:#e3eaf2;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0;overflow:auto"><code class="language-python" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#a04900">from</span><span> os </span><span class="token" style="color:#a04900">import</span><span> listdir
</span><span></span><span class="token" style="color:#a04900">from</span><span> os</span><span class="token" style="color:#111b27">.</span><span>path </span><span class="token" style="color:#a04900">import</span><span> join </span><span class="token" style="color:#a04900">as</span><span> path_join
</span><span></span><span class="token" style="color:#a04900">from</span><span> time </span><span class="token" style="color:#a04900">import</span><span> time
</span>
<span></span><span class="token" style="color:#a04900">import</span><span> cv2
</span><span></span><span class="token" style="color:#a04900">import</span><span> numpy </span><span class="token" style="color:#a04900">as</span><span> np
</span>
<span></span><span class="token" style="color:#a04900">from</span><span> config </span><span class="token" style="color:#a04900">import</span><span> inputs_dir</span><span class="token" style="color:#111b27">,</span><span> outputs_dir</span><span class="token" style="color:#111b27">,</span><span> weights_dir
</span><span></span><span class="token" style="color:#a04900">from</span><span> model </span><span class="token" style="color:#a04900">import</span><span> Model
</span>
<!-- -->
<span></span><span class="token" style="color:#a04900">if</span><span> __name__ </span><span class="token" style="color:#a04900">==</span><span> </span><span class="token" style="color:#116b00">&quot;__main__&quot;</span><span class="token" style="color:#111b27">:</span><span>
</span><span>    test_images </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#111b27">]</span><span>
</span><span>    all_image_names </span><span class="token" style="color:#a04900">=</span><span> listdir</span><span class="token" style="color:#111b27">(</span><span>inputs_dir</span><span class="token" style="color:#111b27">)</span><span>
</span><span>    </span><span class="token" style="color:#a04900">for</span><span> i</span><span class="token" style="color:#111b27">,</span><span> image_name </span><span class="token" style="color:#a04900">in</span><span> </span><span class="token" style="color:#af00af">enumerate</span><span class="token" style="color:#111b27">(</span><span>all_image_names</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>        image </span><span class="token" style="color:#a04900">=</span><span> cv2</span><span class="token" style="color:#111b27">.</span><span>imread</span><span class="token" style="color:#111b27">(</span><span>path_join</span><span class="token" style="color:#111b27">(</span><span>inputs_dir</span><span class="token" style="color:#111b27">,</span><span> image_name</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span> cv2</span><span class="token" style="color:#111b27">.</span><span>IMREAD_GRAYSCALE</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        test_images</span><span class="token" style="color:#111b27">.</span><span>append</span><span class="token" style="color:#111b27">(</span><span>image</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        </span><span class="token" style="color:#a04900">if</span><span> </span><span class="token" style="color:#111b27">(</span><span>i </span><span class="token" style="color:#a04900">+</span><span> </span><span class="token" style="color:#755f00">1</span><span class="token" style="color:#111b27">)</span><span> </span><span class="token" style="color:#a04900">%</span><span> </span><span class="token" style="color:#755f00">500</span><span> </span><span class="token" style="color:#a04900">==</span><span> </span><span class="token" style="color:#755f00">0</span><span class="token" style="color:#111b27">:</span><span>
</span><span>            </span><span class="token" style="color:#a04900">print</span><span class="token" style="color:#111b27">(</span><span class="token string-interpolation" style="color:#116b00">f&quot;Loaded images: </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">i</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00"> / </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation" style="color:#af00af">len</span><span class="token string-interpolation interpolation" style="color:#111b27">(</span><span class="token string-interpolation interpolation">all_image_names</span><span class="token string-interpolation interpolation" style="color:#111b27">)</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        </span><span class="token" style="color:#a04900">if</span><span> </span><span class="token" style="color:#111b27">(</span><span>i </span><span class="token" style="color:#a04900">+</span><span> </span><span class="token" style="color:#755f00">1</span><span class="token" style="color:#111b27">)</span><span> </span><span class="token" style="color:#a04900">%</span><span> </span><span class="token" style="color:#755f00">50</span><span> </span><span class="token" style="color:#a04900">==</span><span> </span><span class="token" style="color:#755f00">0</span><span class="token" style="color:#111b27">:</span><span>
</span><span>            </span><span class="token" style="color:#a04900">break</span><span>
</span><span>    </span><span class="token" style="color:#a04900">print</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;Images loaded.&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    model </span><span class="token" style="color:#a04900">=</span><span> Model</span><span class="token" style="color:#111b27">(</span><span>path_join</span><span class="token" style="color:#111b27">(</span><span>weights_dir</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;weights_001.pt&quot;</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span> use_cuda</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">False</span><span class="token" style="color:#111b27">)</span><span>
</span><span>    </span><span class="token" style="color:#a04900">print</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;Model loaded.&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    start_time </span><span class="token" style="color:#a04900">=</span><span> time</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    outputs </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#111b27">]</span><span>
</span><span>    </span><span class="token" style="color:#a04900">for</span><span> i</span><span class="token" style="color:#111b27">,</span><span> test_image </span><span class="token" style="color:#a04900">in</span><span> </span><span class="token" style="color:#af00af">enumerate</span><span class="token" style="color:#111b27">(</span><span>test_images</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>        preprocessed_image </span><span class="token" style="color:#a04900">=</span><span> model</span><span class="token" style="color:#111b27">.</span><span>preprocess</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">[</span><span>test_image</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        output </span><span class="token" style="color:#a04900">=</span><span> model</span><span class="token" style="color:#111b27">.</span><span>forward</span><span class="token" style="color:#111b27">(</span><span>preprocessed_image</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        output </span><span class="token" style="color:#a04900">=</span><span> output</span><span class="token" style="color:#111b27">.</span><span>detach</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        outputs</span><span class="token" style="color:#111b27">.</span><span>append</span><span class="token" style="color:#111b27">(</span><span>output</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    end_time </span><span class="token" style="color:#a04900">=</span><span> time</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span><span>    time_elapsed </span><span class="token" style="color:#a04900">=</span><span> end_time </span><span class="token" style="color:#a04900">-</span><span> start_time
</span><span>    </span><span class="token" style="color:#a04900">print</span><span class="token" style="color:#111b27">(</span><span>
</span><span>        </span><span class="token string-interpolation" style="color:#116b00">f&quot;Num images: </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation" style="color:#af00af">len</span><span class="token string-interpolation interpolation" style="color:#111b27">(</span><span class="token string-interpolation interpolation">test_images</span><span class="token string-interpolation interpolation" style="color:#111b27">)</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">, &quot;</span><span>
</span><span>        </span><span class="token string-interpolation" style="color:#116b00">f&quot;Batch size: </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation" style="color:#755f00">1</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">, &quot;</span><span>
</span><span>        </span><span class="token string-interpolation" style="color:#116b00">f&quot;Time taken: </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">time_elapsed</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00"> s, &quot;</span><span>
</span><span>        </span><span class="token string-interpolation" style="color:#116b00">f&quot;Time taken per image: </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation" style="color:#755f00">1000</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation" style="color:#a04900">*</span><span class="token string-interpolation interpolation"> time_elapsed </span><span class="token string-interpolation interpolation" style="color:#a04900">/</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation" style="color:#af00af">len</span><span class="token string-interpolation interpolation" style="color:#111b27">(</span><span class="token string-interpolation interpolation">test_images</span><span class="token string-interpolation interpolation" style="color:#111b27">)</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00"> ms&quot;</span><span>
</span><span>    </span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    </span><span class="token" style="color:#a04900">for</span><span> output </span><span class="token" style="color:#a04900">in</span><span> outputs</span><span class="token" style="color:#111b27">:</span><span>
</span><span>        boolean_array </span><span class="token" style="color:#a04900">=</span><span> model</span><span class="token" style="color:#111b27">.</span><span>postprocess</span><span class="token" style="color:#111b27">(</span><span>output</span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#755f00">0</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#755f00">512</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">512</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        binary_image </span><span class="token" style="color:#a04900">=</span><span> boolean_array</span><span class="token" style="color:#111b27">.</span><span>astype</span><span class="token" style="color:#111b27">(</span><span>np</span><span class="token" style="color:#111b27">.</span><span>uint8</span><span class="token" style="color:#111b27">)</span><span> </span><span class="token" style="color:#a04900">*</span><span> </span><span class="token" style="color:#755f00">255</span><span>
</span><span>        file_path </span><span class="token" style="color:#a04900">=</span><span> path_join</span><span class="token" style="color:#111b27">(</span><span>outputs_dir</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token string-interpolation" style="color:#116b00">f&quot;</span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">i</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">.png&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        cv2</span><span class="token" style="color:#111b27">.</span><span>imwrite</span><span class="token" style="color:#111b27">(</span><span>file_path</span><span class="token" style="color:#111b27">,</span><span> binary_image</span><span class="token" style="color:#111b27">)</span></code></pre></div><h1 class="MuiTypography-root MuiTypography-h4 css-rg843f" id="cpu-inference"><strong>CPU Inference</strong></h1><p class="MuiTypography-root MuiTypography-p css-vsuld9">Right now, in the line where we have initialized the model, we pass the <span class="MuiBox-root css-87x4qo">use_cuda</span> parameter as <span class="MuiBox-root css-87x4qo">False</span>. Actually, we don&#x27;t really need to do that because that is what it defaults to.</p><div class="MuiBox-root css-dzaqf9"><div class="MuiBox-root css-125pbeb"><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho" tabindex="0" type="button"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ContentCopyIcon"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"></path></svg></button></div><pre style="color:#111b27;background:#e3eaf2;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0;overflow:auto"><code class="language-python" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>model </span><span class="token" style="color:#a04900">=</span><span> Model</span><span class="token" style="color:#111b27">(</span><span>path_join</span><span class="token" style="color:#111b27">(</span><span>weights_dir</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;weights_001.pt&quot;</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span> use_cuda</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">False</span><span class="token" style="color:#111b27">)</span></code></pre></div><p class="MuiTypography-root MuiTypography-p css-vsuld9">Let&#x27;s run the script.</p><p class="MuiTypography-root MuiTypography-p css-vsuld9">For 5,000 images, it took around 6674.206 seconds (01h51m14s). This is around 1.3348 s per image or 0.7491 FPS.</p><style data-emotion="css 16am2bb">.css-16am2bb{width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-bottom:16px;}</style><div class="MuiBox-root css-16am2bb"><style data-emotion="css i3anzz">.css-i3anzz{width:100%;overflow-x:auto;background-color:rgb(227, 234, 242);}</style><div class="MuiTableContainer-root css-i3anzz"><style data-emotion="css 1f1vrq4">.css-1f1vrq4{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:500;font-size:1.25rem;line-height:1.6;letter-spacing:0.0075em;width:100%;text-align:center;margin-top:16px;}</style><h4 class="MuiTypography-root MuiTypography-h6 css-1f1vrq4"><strong>Num images: 5,000 | Device: CPU</strong></h4><style data-emotion="css 1owb465">.css-1owb465{display:table;width:100%;border-collapse:collapse;border-spacing:0;}.css-1owb465 caption{font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:0.875rem;line-height:1.43;letter-spacing:0.01071em;padding:16px;color:rgba(0, 0, 0, 0.6);text-align:left;caption-side:bottom;}</style><table class="MuiTable-root css-1owb465"><style data-emotion="css 1wbz3t9">.css-1wbz3t9{display:table-header-group;}</style><thead class="MuiTableHead-root css-1wbz3t9"><style data-emotion="css 1gqug66">.css-1gqug66{color:inherit;display:table-row;vertical-align:middle;outline:0;}.css-1gqug66.MuiTableRow-hover:hover{background-color:rgba(0, 0, 0, 0.04);}.css-1gqug66.Mui-selected{background-color:rgba(25, 118, 210, 0.08);}.css-1gqug66.Mui-selected:hover{background-color:rgba(25, 118, 210, 0.12);}</style><tr class="MuiTableRow-root MuiTableRow-head css-1gqug66"><style data-emotion="css 1vuymvr">.css-1vuymvr{font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:500;font-size:0.875rem;line-height:1.5rem;letter-spacing:0.01071em;display:table-cell;vertical-align:inherit;border-bottom:1px solid rgba(224, 224, 224, 1);text-align:left;padding:16px;color:rgba(0, 0, 0, 0.87);font-weight:700;}</style><th class="MuiTableCell-root MuiTableCell-head MuiTableCell-sizeMedium css-1vuymvr" scope="col">Batch Size</th><th class="MuiTableCell-root MuiTableCell-head MuiTableCell-sizeMedium css-1vuymvr" scope="col">Time Taken (s)</th><th class="MuiTableCell-root MuiTableCell-head MuiTableCell-sizeMedium css-1vuymvr" scope="col">Time Taken per Image (s)</th><th class="MuiTableCell-root MuiTableCell-head MuiTableCell-sizeMedium css-1vuymvr" scope="col">FPS</th></tr></thead><style data-emotion="css 1xnox0e">.css-1xnox0e{display:table-row-group;}</style><tbody class="MuiTableBody-root css-1xnox0e"><style data-emotion="css 16nxph9">.css-16nxph9{color:inherit;display:table-row;vertical-align:middle;outline:0;}.css-16nxph9.MuiTableRow-hover:hover{background-color:rgba(0, 0, 0, 0.04);}.css-16nxph9.Mui-selected{background-color:rgba(25, 118, 210, 0.08);}.css-16nxph9.Mui-selected:hover{background-color:rgba(25, 118, 210, 0.12);}.css-16nxph9:last-child td,.css-16nxph9:last-child th{border:0px solid;}</style><tr class="MuiTableRow-root css-16nxph9"><style data-emotion="css q34dxg">.css-q34dxg{font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:0.875rem;line-height:1.43;letter-spacing:0.01071em;display:table-cell;vertical-align:inherit;border-bottom:1px solid rgba(224, 224, 224, 1);text-align:left;padding:16px;color:rgba(0, 0, 0, 0.87);}</style><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">1</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">01h51m14s</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">1.3348</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">0.7491</td></tr></tbody></table></div></div><h1 class="MuiTypography-root MuiTypography-h4 css-rg843f" id="gpu-inference"><strong>GPU Inference</strong></h1><p class="MuiTypography-root MuiTypography-p css-vsuld9">Before we try to run our model on a GPU, we should make sure that CUDA is indeed available to torch. Open up a new Python interpreter in your environment and run the following lines:</p><div class="MuiBox-root css-dzaqf9"><div class="MuiBox-root css-125pbeb"><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho" tabindex="0" type="button"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ContentCopyIcon"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"></path></svg></button></div><pre style="color:#111b27;background:#e3eaf2;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0;overflow:auto"><code class="language-python" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#a04900">import</span><span> torch
</span>
<span>torch</span><span class="token" style="color:#111b27">.</span><span>cuda</span><span class="token" style="color:#111b27">.</span><span>is_available</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span></code></pre></div><p class="MuiTypography-root MuiTypography-p css-vsuld9">You should get <span class="MuiBox-root css-87x4qo">True</span> in the output.</p><p class="MuiTypography-root MuiTypography-p css-vsuld9">Let&#x27;s convert our code to now run the inference on the machine&#x27;s GPU. Since we have already written logic in the <span class="MuiBox-root css-87x4qo">model.py</span> to handle this, we can change our inference device by changing a single line in the <span class="MuiBox-root css-87x4qo">test.py</span> where we are initializing our model.</p><div class="MuiBox-root css-dzaqf9"><div class="MuiBox-root css-125pbeb"><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho" tabindex="0" type="button"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ContentCopyIcon"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"></path></svg></button></div><pre style="color:#111b27;background:#e3eaf2;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0;overflow:auto"><code class="language-python" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>model </span><span class="token" style="color:#a04900">=</span><span> Model</span><span class="token" style="color:#111b27">(</span><span>path_join</span><span class="token" style="color:#111b27">(</span><span>weights_dir</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;weights_001.pt&quot;</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span> use_cuda</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">True</span><span class="token" style="color:#111b27">)</span></code></pre></div><p class="MuiTypography-root MuiTypography-p css-vsuld9">Let&#x27;s run this and see how much of a speed improvement we got.</p><div class="MuiBox-root css-16am2bb"><div class="MuiTableContainer-root css-i3anzz"><h4 class="MuiTypography-root MuiTypography-h6 css-1f1vrq4"><strong>Num images: 5,000 | Device: GPU</strong></h4><table class="MuiTable-root css-1owb465"><thead class="MuiTableHead-root css-1wbz3t9"><tr class="MuiTableRow-root MuiTableRow-head css-1gqug66"><th class="MuiTableCell-root MuiTableCell-head MuiTableCell-sizeMedium css-1vuymvr" scope="col">Batch Size</th><th class="MuiTableCell-root MuiTableCell-head MuiTableCell-sizeMedium css-1vuymvr" scope="col">Time Taken (s)</th><th class="MuiTableCell-root MuiTableCell-head MuiTableCell-sizeMedium css-1vuymvr" scope="col">Time Taken per Image (ms)</th><th class="MuiTableCell-root MuiTableCell-head MuiTableCell-sizeMedium css-1vuymvr" scope="col">FPS</th></tr></thead><tbody class="MuiTableBody-root css-1xnox0e"><tr class="MuiTableRow-root css-16nxph9"><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">1</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">49.6585s</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">9.9317</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">100.6876</td></tr></tbody></table></div></div><p class="MuiTypography-root MuiTypography-p css-vsuld9">Woah! That&#x27;s a 134.41 times improvement. The <a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover css-1vxruma" href="https://en.wikipedia.org/wiki/MythBusters" rel="noopener noreferrer" target="_blank">MythBusters</a> made a <a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover css-1vxruma" href="https://www.youtube.com/watch?v=-P28LKWTzrI" rel="noopener noreferrer" target="_blank">good illustration of this speed comparison</a>. GPUs mean business when it comes to crunching numbers.</p><h1 class="MuiTypography-root MuiTypography-h4 css-rg843f" id="batched-gpu-inference"><strong>Batched GPU Inference</strong></h1><p class="MuiTypography-root MuiTypography-p css-vsuld9">Let&#x27;s take a look at the <span class="MuiBox-root css-87x4qo">preprocess</span> function in <span class="MuiBox-root css-87x4qo">model.py</span>.</p><div class="MuiBox-root css-dzaqf9"><div class="MuiBox-root css-125pbeb"><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho" tabindex="0" type="button"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ContentCopyIcon"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"></path></svg></button></div><pre style="color:#111b27;background:#e3eaf2;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0;overflow:auto"><code class="language-python" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#a04900">def</span><span> </span><span class="token" style="color:#7c00aa">preprocess</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">,</span><span> images</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>    transformed_images </span><span class="token" style="color:#a04900">=</span><span> torch</span><span class="token" style="color:#111b27">.</span><span>stack</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">[</span><span>self</span><span class="token" style="color:#111b27">.</span><span>preprocessing_transform</span><span class="token" style="color:#111b27">(</span><span>image</span><span class="token" style="color:#111b27">)</span><span> </span><span class="token" style="color:#a04900">for</span><span> image </span><span class="token" style="color:#a04900">in</span><span> images</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">)</span><span>
</span><span>    transformed_images </span><span class="token" style="color:#a04900">=</span><span> transformed_images</span><span class="token" style="color:#111b27">.</span><span class="token" style="color:#af00af">type</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">.</span><span>dtype</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    batched_images </span><span class="token" style="color:#a04900">=</span><span> transformed_images</span><span class="token" style="color:#111b27">.</span><span>to</span><span class="token" style="color:#111b27">(</span><span>self</span><span class="token" style="color:#111b27">.</span><span>device</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    </span><span class="token" style="color:#a04900">return</span><span> batched_images</span></code></pre></div><p class="MuiTypography-root MuiTypography-p css-vsuld9">Here, we are accepting a list of images, transforming them using the preprocessing transform, and then combining them into a single tensor using <span class="MuiBox-root css-87x4qo">torch.stack</span>. We can call <span class="MuiBox-root css-87x4qo">forward</span> with this single tensor and the output tensor will include the result for each of the inputs i.e. the output is also a batch.</p><p class="MuiTypography-root MuiTypography-p css-vsuld9">In <span class="MuiBox-root css-87x4qo">test.py</span>, we&#x27;ll create a variable called <span class="MuiBox-root css-87x4qo">batch_size</span> to define how many images are preprocessed and sent for inference at once. Then, we can create batches from the <span class="MuiBox-root css-87x4qo">test_images</span> list as follows:</p><div class="MuiBox-root css-dzaqf9"><div class="MuiBox-root css-125pbeb"><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho" tabindex="0" type="button"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ContentCopyIcon"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"></path></svg></button></div><pre style="color:#111b27;background:#e3eaf2;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0;overflow:auto"><code class="language-python" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>batch_size </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token" style="color:#755f00">4</span><span>
</span><span>test_batches </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token" style="color:#111b27">[</span><span>test_images</span><span class="token" style="color:#111b27">[</span><span>i</span><span class="token" style="color:#111b27">:</span><span>i</span><span class="token" style="color:#a04900">+</span><span>batch_size</span><span class="token" style="color:#111b27">]</span><span> </span><span class="token" style="color:#a04900">for</span><span> i </span><span class="token" style="color:#a04900">in</span><span> </span><span class="token" style="color:#af00af">range</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#755f00">0</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#af00af">len</span><span class="token" style="color:#111b27">(</span><span>test_images</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span> batch_size</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">]</span></code></pre></div><p class="MuiTypography-root MuiTypography-p css-vsuld9">Let&#x27;s iterate the batch size from 1 to 32 (at 32 my GPU ran out of memory) and print the time taken to process.</p><div class="MuiBox-root css-dzaqf9"><div class="MuiBox-root css-125pbeb"><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho" tabindex="0" type="button"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ContentCopyIcon"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"></path></svg></button></div><pre style="color:#111b27;background:#e3eaf2;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0;overflow:auto"><code class="language-python" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#a04900">for</span><span> batch_size </span><span class="token" style="color:#a04900">in</span><span> </span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#755f00">1</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">2</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">4</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">8</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">16</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">32</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">:</span><span> </span><span class="token" style="color:#3c526d">#, 64, 128, 256]:</span><span>
</span><span>    test_batches </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token" style="color:#111b27">[</span><span>test_images</span><span class="token" style="color:#111b27">[</span><span>i</span><span class="token" style="color:#111b27">:</span><span>i</span><span class="token" style="color:#a04900">+</span><span>batch_size</span><span class="token" style="color:#111b27">]</span><span> </span><span class="token" style="color:#a04900">for</span><span> i </span><span class="token" style="color:#a04900">in</span><span> </span><span class="token" style="color:#af00af">range</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#755f00">0</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#af00af">len</span><span class="token" style="color:#111b27">(</span><span>test_images</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span> batch_size</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">]</span><span>
</span><span>    outputs </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#111b27">]</span><span>
</span>
<span>    start_time </span><span class="token" style="color:#a04900">=</span><span> time</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span><span>    preprocessed_batches </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token" style="color:#111b27">[</span><span>model</span><span class="token" style="color:#111b27">.</span><span>preprocess</span><span class="token" style="color:#111b27">(</span><span>batch</span><span class="token" style="color:#111b27">)</span><span> </span><span class="token" style="color:#a04900">for</span><span> batch </span><span class="token" style="color:#a04900">in</span><span> test_batches</span><span class="token" style="color:#111b27">]</span><span>
</span>
<span>    </span><span class="token" style="color:#a04900">for</span><span> i</span><span class="token" style="color:#111b27">,</span><span> preprocessed_batch </span><span class="token" style="color:#a04900">in</span><span> </span><span class="token" style="color:#af00af">enumerate</span><span class="token" style="color:#111b27">(</span><span>preprocessed_batches</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>        output </span><span class="token" style="color:#a04900">=</span><span> model</span><span class="token" style="color:#111b27">.</span><span>forward</span><span class="token" style="color:#111b27">(</span><span>preprocessed_batch</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        output </span><span class="token" style="color:#a04900">=</span><span> output</span><span class="token" style="color:#111b27">.</span><span>detach</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        outputs</span><span class="token" style="color:#111b27">.</span><span>append</span><span class="token" style="color:#111b27">(</span><span>output</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        </span><span class="token" style="color:#a04900">if</span><span> </span><span class="token" style="color:#111b27">(</span><span>i </span><span class="token" style="color:#a04900">+</span><span> </span><span class="token" style="color:#755f00">1</span><span class="token" style="color:#111b27">)</span><span> </span><span class="token" style="color:#a04900">%</span><span> </span><span class="token" style="color:#755f00">25</span><span> </span><span class="token" style="color:#a04900">==</span><span> </span><span class="token" style="color:#755f00">0</span><span class="token" style="color:#111b27">:</span><span>
</span><span>            </span><span class="token" style="color:#a04900">print</span><span class="token" style="color:#111b27">(</span><span class="token string-interpolation" style="color:#116b00">f&quot;Processed: </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">i</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00"> / </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation" style="color:#af00af">len</span><span class="token string-interpolation interpolation" style="color:#111b27">(</span><span class="token string-interpolation interpolation">preprocessed_batches</span><span class="token string-interpolation interpolation" style="color:#111b27">)</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    end_time </span><span class="token" style="color:#a04900">=</span><span> time</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span><span>    time_elapsed </span><span class="token" style="color:#a04900">=</span><span> end_time </span><span class="token" style="color:#a04900">-</span><span> start_time
</span>
<span>    </span><span class="token" style="color:#a04900">print</span><span class="token" style="color:#111b27">(</span><span>
</span><span>        </span><span class="token string-interpolation" style="color:#116b00">f&quot;Num images: </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation" style="color:#af00af">len</span><span class="token string-interpolation interpolation" style="color:#111b27">(</span><span class="token string-interpolation interpolation">test_images</span><span class="token string-interpolation interpolation" style="color:#111b27">)</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">, &quot;</span><span>
</span><span>        </span><span class="token string-interpolation" style="color:#116b00">f&quot;Batch size: </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">batch_size</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">, &quot;</span><span>
</span><span>        </span><span class="token string-interpolation" style="color:#116b00">f&quot;Time taken: </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">time_elapsed</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00"> s, &quot;</span><span>
</span><span>        </span><span class="token string-interpolation" style="color:#116b00">f&quot;Time taken per image: </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation" style="color:#755f00">1000</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation" style="color:#a04900">*</span><span class="token string-interpolation interpolation"> time_elapsed </span><span class="token string-interpolation interpolation" style="color:#a04900">/</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation" style="color:#af00af">len</span><span class="token string-interpolation interpolation" style="color:#111b27">(</span><span class="token string-interpolation interpolation">test_images</span><span class="token string-interpolation interpolation" style="color:#111b27">)</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00"> ms&quot;</span><span>
</span><span>    </span><span class="token" style="color:#111b27">)</span></code></pre></div><p class="MuiTypography-root MuiTypography-p css-vsuld9">Here&#x27;s the entire <span class="MuiBox-root css-87x4qo">test.py</span> file:</p><div class="MuiBox-root css-dzaqf9"><div class="MuiBox-root css-125pbeb"><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho" tabindex="0" type="button"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ContentCopyIcon"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"></path></svg></button></div><pre style="color:#111b27;background:#e3eaf2;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0;overflow:auto"><code class="language-python" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#a04900">from</span><span> os </span><span class="token" style="color:#a04900">import</span><span> listdir
</span><span></span><span class="token" style="color:#a04900">from</span><span> os</span><span class="token" style="color:#111b27">.</span><span>path </span><span class="token" style="color:#a04900">import</span><span> join </span><span class="token" style="color:#a04900">as</span><span> path_join
</span><span></span><span class="token" style="color:#a04900">from</span><span> time </span><span class="token" style="color:#a04900">import</span><span> time
</span>
<span></span><span class="token" style="color:#a04900">import</span><span> cv2
</span><span></span><span class="token" style="color:#a04900">import</span><span> numpy </span><span class="token" style="color:#a04900">as</span><span> np
</span>
<span></span><span class="token" style="color:#a04900">from</span><span> config </span><span class="token" style="color:#a04900">import</span><span> inputs_dir</span><span class="token" style="color:#111b27">,</span><span> outputs_dir</span><span class="token" style="color:#111b27">,</span><span> weights_dir
</span><span></span><span class="token" style="color:#a04900">from</span><span> model </span><span class="token" style="color:#a04900">import</span><span> Model
</span>
<!-- -->
<span></span><span class="token" style="color:#a04900">if</span><span> __name__ </span><span class="token" style="color:#a04900">==</span><span> </span><span class="token" style="color:#116b00">&quot;__main__&quot;</span><span class="token" style="color:#111b27">:</span><span>
</span><span>    test_images </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token" style="color:#111b27">[</span><span>cv2</span><span class="token" style="color:#111b27">.</span><span>imread</span><span class="token" style="color:#111b27">(</span><span>path_join</span><span class="token" style="color:#111b27">(</span><span>inputs_dir</span><span class="token" style="color:#111b27">,</span><span> image_name</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span> cv2</span><span class="token" style="color:#111b27">.</span><span>IMREAD_GRAYSCALE</span><span class="token" style="color:#111b27">)</span><span> </span><span class="token" style="color:#a04900">for</span><span> image_name </span><span class="token" style="color:#a04900">in</span><span> listdir</span><span class="token" style="color:#111b27">(</span><span>inputs_dir</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">]</span><span>
</span><span>    </span><span class="token" style="color:#a04900">print</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;Images loaded.&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    model </span><span class="token" style="color:#a04900">=</span><span> Model</span><span class="token" style="color:#111b27">(</span><span>path_join</span><span class="token" style="color:#111b27">(</span><span>weights_dir</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;weights_001.pt&quot;</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span> use_cuda</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">True</span><span class="token" style="color:#111b27">)</span><span>
</span><span>    </span><span class="token" style="color:#a04900">print</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#116b00">&quot;Model loaded.&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>    </span><span class="token" style="color:#a04900">for</span><span> batch_size </span><span class="token" style="color:#a04900">in</span><span> </span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#755f00">1</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">2</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">4</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">8</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">16</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">32</span><span class="token" style="color:#111b27">]</span><span class="token" style="color:#111b27">:</span><span> </span><span class="token" style="color:#3c526d">#, 64, 128, 256]:</span><span>
</span><span>        test_batches </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token" style="color:#111b27">[</span><span>test_images</span><span class="token" style="color:#111b27">[</span><span>i</span><span class="token" style="color:#111b27">:</span><span>i</span><span class="token" style="color:#a04900">+</span><span>batch_size</span><span class="token" style="color:#111b27">]</span><span> </span><span class="token" style="color:#a04900">for</span><span> i </span><span class="token" style="color:#a04900">in</span><span> </span><span class="token" style="color:#af00af">range</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#755f00">0</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#af00af">len</span><span class="token" style="color:#111b27">(</span><span>test_images</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span> batch_size</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">]</span><span>
</span><span>        outputs </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token" style="color:#111b27">[</span><span class="token" style="color:#111b27">]</span><span>
</span>
<span>        start_time </span><span class="token" style="color:#a04900">=</span><span> time</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        preprocessed_batches </span><span class="token" style="color:#a04900">=</span><span> </span><span class="token" style="color:#111b27">[</span><span>model</span><span class="token" style="color:#111b27">.</span><span>preprocess</span><span class="token" style="color:#111b27">(</span><span>batch</span><span class="token" style="color:#111b27">)</span><span> </span><span class="token" style="color:#a04900">for</span><span> batch </span><span class="token" style="color:#a04900">in</span><span> test_batches</span><span class="token" style="color:#111b27">]</span><span>
</span>
<span>        </span><span class="token" style="color:#a04900">for</span><span> i</span><span class="token" style="color:#111b27">,</span><span> preprocessed_batch </span><span class="token" style="color:#a04900">in</span><span> </span><span class="token" style="color:#af00af">enumerate</span><span class="token" style="color:#111b27">(</span><span>preprocessed_batches</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>            output </span><span class="token" style="color:#a04900">=</span><span> model</span><span class="token" style="color:#111b27">.</span><span>forward</span><span class="token" style="color:#111b27">(</span><span>preprocessed_batch</span><span class="token" style="color:#111b27">)</span><span>
</span><span>            output </span><span class="token" style="color:#a04900">=</span><span> output</span><span class="token" style="color:#111b27">.</span><span>detach</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span><span>            outputs</span><span class="token" style="color:#111b27">.</span><span>append</span><span class="token" style="color:#111b27">(</span><span>output</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>            </span><span class="token" style="color:#a04900">if</span><span> </span><span class="token" style="color:#111b27">(</span><span>i </span><span class="token" style="color:#a04900">+</span><span> </span><span class="token" style="color:#755f00">1</span><span class="token" style="color:#111b27">)</span><span> </span><span class="token" style="color:#a04900">%</span><span> </span><span class="token" style="color:#755f00">25</span><span> </span><span class="token" style="color:#a04900">==</span><span> </span><span class="token" style="color:#755f00">0</span><span class="token" style="color:#111b27">:</span><span>
</span><span>                </span><span class="token" style="color:#a04900">print</span><span class="token" style="color:#111b27">(</span><span class="token string-interpolation" style="color:#116b00">f&quot;Processed: </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">i</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00"> / </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation" style="color:#af00af">len</span><span class="token string-interpolation interpolation" style="color:#111b27">(</span><span class="token string-interpolation interpolation">preprocessed_batches</span><span class="token string-interpolation interpolation" style="color:#111b27">)</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        end_time </span><span class="token" style="color:#a04900">=</span><span> time</span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#111b27">)</span><span>
</span><span>        time_elapsed </span><span class="token" style="color:#a04900">=</span><span> end_time </span><span class="token" style="color:#a04900">-</span><span> start_time
</span>
<span>        </span><span class="token" style="color:#a04900">print</span><span class="token" style="color:#111b27">(</span><span>
</span><span>            </span><span class="token string-interpolation" style="color:#116b00">f&quot;Num images: </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation" style="color:#af00af">len</span><span class="token string-interpolation interpolation" style="color:#111b27">(</span><span class="token string-interpolation interpolation">test_images</span><span class="token string-interpolation interpolation" style="color:#111b27">)</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">, &quot;</span><span>
</span><span>            </span><span class="token string-interpolation" style="color:#116b00">f&quot;Batch size: </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">batch_size</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">, &quot;</span><span>
</span><span>            </span><span class="token string-interpolation" style="color:#116b00">f&quot;Time taken: </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">time_elapsed</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00"> s, &quot;</span><span>
</span><span>            </span><span class="token string-interpolation" style="color:#116b00">f&quot;Time taken per image: </span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation" style="color:#755f00">1000</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation" style="color:#a04900">*</span><span class="token string-interpolation interpolation"> time_elapsed </span><span class="token string-interpolation interpolation" style="color:#a04900">/</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation" style="color:#af00af">len</span><span class="token string-interpolation interpolation" style="color:#111b27">(</span><span class="token string-interpolation interpolation">test_images</span><span class="token string-interpolation interpolation" style="color:#111b27">)</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00"> ms&quot;</span><span>
</span><span>        </span><span class="token" style="color:#111b27">)</span><span>
</span>
<span>        </span><span class="token" style="color:#a04900">for</span><span> i</span><span class="token" style="color:#111b27">,</span><span> output </span><span class="token" style="color:#a04900">in</span><span> </span><span class="token" style="color:#af00af">enumerate</span><span class="token" style="color:#111b27">(</span><span>outputs</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>            </span><span class="token" style="color:#a04900">for</span><span> j</span><span class="token" style="color:#111b27">,</span><span> single_output </span><span class="token" style="color:#a04900">in</span><span> </span><span class="token" style="color:#af00af">enumerate</span><span class="token" style="color:#111b27">(</span><span>output</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">:</span><span>
</span><span>                boolean_array </span><span class="token" style="color:#a04900">=</span><span> model</span><span class="token" style="color:#111b27">.</span><span>postprocess</span><span class="token" style="color:#111b27">(</span><span>single_output</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#111b27">(</span><span class="token" style="color:#755f00">512</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#755f00">512</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">)</span><span>
</span><span>                binary_image </span><span class="token" style="color:#a04900">=</span><span> boolean_array</span><span class="token" style="color:#111b27">.</span><span>astype</span><span class="token" style="color:#111b27">(</span><span>np</span><span class="token" style="color:#111b27">.</span><span>uint8</span><span class="token" style="color:#111b27">)</span><span> </span><span class="token" style="color:#a04900">*</span><span> </span><span class="token" style="color:#755f00">255</span><span>
</span><span>                file_path </span><span class="token" style="color:#a04900">=</span><span> path_join</span><span class="token" style="color:#111b27">(</span><span>outputs_dir</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token string-interpolation" style="color:#116b00">f&quot;</span><span class="token string-interpolation interpolation" style="color:#111b27">{</span><span class="token string-interpolation interpolation">i </span><span class="token string-interpolation interpolation" style="color:#a04900">*</span><span class="token string-interpolation interpolation"> batch_size </span><span class="token string-interpolation interpolation" style="color:#a04900">+</span><span class="token string-interpolation interpolation"> j</span><span class="token string-interpolation interpolation" style="color:#111b27">}</span><span class="token string-interpolation" style="color:#116b00">.png&quot;</span><span class="token" style="color:#111b27">)</span><span>
</span><span>                cv2</span><span class="token" style="color:#111b27">.</span><span>imwrite</span><span class="token" style="color:#111b27">(</span><span>file_path</span><span class="token" style="color:#111b27">,</span><span> binary_image</span><span class="token" style="color:#111b27">)</span></code></pre></div><p class="MuiTypography-root MuiTypography-p css-vsuld9">Run the code and you should see logs in the console saying how long it took. I&#x27;ve tabulated my results (for 5,000 input images):</p><div class="MuiBox-root css-16am2bb"><div class="MuiTableContainer-root css-i3anzz"><h4 class="MuiTypography-root MuiTypography-h6 css-1f1vrq4"><strong>Num images: 5,000 | Device: GPU</strong></h4><table class="MuiTable-root css-1owb465"><thead class="MuiTableHead-root css-1wbz3t9"><tr class="MuiTableRow-root MuiTableRow-head css-1gqug66"><th class="MuiTableCell-root MuiTableCell-head MuiTableCell-sizeMedium css-1vuymvr" scope="col">Batch Size</th><th class="MuiTableCell-root MuiTableCell-head MuiTableCell-sizeMedium css-1vuymvr" scope="col">Time Taken (s)</th><th class="MuiTableCell-root MuiTableCell-head MuiTableCell-sizeMedium css-1vuymvr" scope="col">Time Taken per Image (ms)</th><th class="MuiTableCell-root MuiTableCell-head MuiTableCell-sizeMedium css-1vuymvr" scope="col">FPS</th><th class="MuiTableCell-root MuiTableCell-head MuiTableCell-sizeMedium css-1vuymvr" scope="col">CUDA Memory Consumption (GB)</th><th class="MuiTableCell-root MuiTableCell-head MuiTableCell-sizeMedium css-1vuymvr" scope="col">Improvement over Batch Size 1</th><th class="MuiTableCell-root MuiTableCell-head MuiTableCell-sizeMedium css-1vuymvr" scope="col">Improvement over Previous Row</th></tr></thead><tbody class="MuiTableBody-root css-1xnox0e"><tr class="MuiTableRow-root css-16nxph9"><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">1</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">46.9190</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">9.3838</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">106.5666</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">0.9051</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">1x</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">-</td></tr><tr class="MuiTableRow-root css-16nxph9"><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">2</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">40.4961</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">8.0992</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">123.4689</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">1.1397</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">1.1586x</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">1.1586x</td></tr><tr class="MuiTableRow-root css-16nxph9"><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">4</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">39.8241</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">7.9648</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">125.5524</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">1.5774</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">1.1781x</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">1.0168x</td></tr><tr class="MuiTableRow-root css-16nxph9"><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">8</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">39.3241</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">7.8648</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">127.1488</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">2.6414</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">1.1931x</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">1.0127x</td></tr><tr class="MuiTableRow-root css-16nxph9"><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">16</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">39.2899</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">7.8579</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">127.2442</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">4.4764</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">1.1940x</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">1.00087x</td></tr></tbody></table></div></div><p class="MuiTypography-root MuiTypography-p css-vsuld9">The biggest improvement is from Batch Size 1 -&gt; 2, while the least increase in memory consumption.</p><h2 class="MuiTypography-root MuiTypography-h5 css-1oj41as" id="batched-cpu-inference:-any-good?"><strong>Batched CPU Inference: Any Good?</strong></h2><p class="MuiTypography-root MuiTypography-p css-vsuld9">I&#x27;ll set <span class="MuiBox-root css-87x4qo">use_cuda</span> to <span class="MuiBox-root css-87x4qo">False</span> where we are loading the model and run the inference again, with the same batches.</p><div class="MuiBox-root css-dzaqf9"><div class="MuiBox-root css-125pbeb"><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-colorPrimary MuiIconButton-sizeLarge css-h1oho" tabindex="0" type="button"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ContentCopyIcon"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2m0 16H8V7h11z"></path></svg></button></div><pre style="color:#111b27;background:#e3eaf2;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0;overflow:auto"><code class="language-python" style="color:#111b27;background:none;font-family:Consolas, Monaco, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>model </span><span class="token" style="color:#a04900">=</span><span> Model</span><span class="token" style="color:#111b27">(</span><span>path_join</span><span class="token" style="color:#111b27">(</span><span>weights_dir</span><span class="token" style="color:#111b27">,</span><span> </span><span class="token" style="color:#116b00">&quot;weights_001.pt&quot;</span><span class="token" style="color:#111b27">)</span><span class="token" style="color:#111b27">,</span><span> use_cuda</span><span class="token" style="color:#a04900">=</span><span class="token" style="color:#755f00">True</span><span class="token" style="color:#111b27">)</span></code></pre></div><div class="MuiBox-root css-16am2bb"><div class="MuiTableContainer-root css-i3anzz"><h4 class="MuiTypography-root MuiTypography-h6 css-1f1vrq4"><strong>Num images: 5,000 | Device: CPU</strong></h4><table class="MuiTable-root css-1owb465"><thead class="MuiTableHead-root css-1wbz3t9"><tr class="MuiTableRow-root MuiTableRow-head css-1gqug66"><th class="MuiTableCell-root MuiTableCell-head MuiTableCell-sizeMedium css-1vuymvr" scope="col">Batch Size</th><th class="MuiTableCell-root MuiTableCell-head MuiTableCell-sizeMedium css-1vuymvr" scope="col">Time Taken</th><th class="MuiTableCell-root MuiTableCell-head MuiTableCell-sizeMedium css-1vuymvr" scope="col">Time Taken per Image (s)</th><th class="MuiTableCell-root MuiTableCell-head MuiTableCell-sizeMedium css-1vuymvr" scope="col">FPS</th></tr></thead><tbody class="MuiTableBody-root css-1xnox0e"><tr class="MuiTableRow-root css-16nxph9"><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">1</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">01h51m14s</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">1.3348</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">0.7491</td></tr><tr class="MuiTableRow-root css-16nxph9"><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">2</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">01h47m19s</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">1.2878</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">0.7765</td></tr><tr class="MuiTableRow-root css-16nxph9"><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">4</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">01h42m44s</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">1.2327</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">0.8112</td></tr><tr class="MuiTableRow-root css-16nxph9"><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">8</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">01h40m47s</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">1.2095</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">0.8267</td></tr><tr class="MuiTableRow-root css-16nxph9"><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">16</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">01h38m59s</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">1.1877</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">0.8419</td></tr></tbody></table></div></div><p class="MuiTypography-root MuiTypography-p css-vsuld9">In this case, there is a trend of decreasing inference time with larger batch sizes but it&#x27;s no significant improvement.</p><h2 class="MuiTypography-root MuiTypography-h5 css-1oj41as" id="model-dependence"><strong>Model Dependence</strong></h2><p class="MuiTypography-root MuiTypography-p css-vsuld9">The improvement we get while running a model on GPU or while running batched inference depends highly on how to model has been constructed. Here are some tests that I ran on another model (these were on an RTX 4090, with much smaller images, with a model for a different task).</p><div class="MuiBox-root css-16am2bb"><div class="MuiTableContainer-root css-i3anzz"><h4 class="MuiTypography-root MuiTypography-h6 css-1f1vrq4"><strong>Num images: 21,846 | Device: GPU</strong></h4><table class="MuiTable-root css-1owb465"><thead class="MuiTableHead-root css-1wbz3t9"><tr class="MuiTableRow-root MuiTableRow-head css-1gqug66"><th class="MuiTableCell-root MuiTableCell-head MuiTableCell-sizeMedium css-1vuymvr" scope="col">Batch Size</th><th class="MuiTableCell-root MuiTableCell-head MuiTableCell-sizeMedium css-1vuymvr" scope="col">Time Taken (s)</th><th class="MuiTableCell-root MuiTableCell-head MuiTableCell-sizeMedium css-1vuymvr" scope="col">Time Taken per Image (ms)</th><th class="MuiTableCell-root MuiTableCell-head MuiTableCell-sizeMedium css-1vuymvr" scope="col">FPS</th><th class="MuiTableCell-root MuiTableCell-head MuiTableCell-sizeMedium css-1vuymvr" scope="col">CUDA Memory Consumption (GB)</th><th class="MuiTableCell-root MuiTableCell-head MuiTableCell-sizeMedium css-1vuymvr" scope="col">Improvement over Batch Size 1</th><th class="MuiTableCell-root MuiTableCell-head MuiTableCell-sizeMedium css-1vuymvr" scope="col">Improvement over Previous Row</th></tr></thead><tbody class="MuiTableBody-root css-1xnox0e"><tr class="MuiTableRow-root css-16nxph9"><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">1</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">219.56</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">10.05</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">99.50</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">0.2628</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">1x</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">-</td></tr><tr class="MuiTableRow-root css-16nxph9"><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">2</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">134.41</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">6.15</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">162.60</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">0.3487</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">1.6341x</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">1.6341x</td></tr><tr class="MuiTableRow-root css-16nxph9"><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">4</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">76.88</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">3.5193</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">284.14</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">0.4893</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">2.8556x</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">1.7474x</td></tr><tr class="MuiTableRow-root css-16nxph9"><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">8</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">44.47</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">2.0360</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">491.15</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">0.8018</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">4.9361x</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">1.6933x</td></tr><tr class="MuiTableRow-root css-16nxph9"><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">16</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">26.64</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">1.2196</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">819.94</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">1.3409</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">8.2406x</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">1.6694x</td></tr><tr class="MuiTableRow-root css-16nxph9"><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">32</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">19.37</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">0.8871</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">1,127.26</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">2.3565</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">11.3292x</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">1.3748x</td></tr><tr class="MuiTableRow-root css-16nxph9"><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">64</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">14.69</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">0.6725</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">1,486.98</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">4.4815</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">14.9445x</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">1.3191x</td></tr><tr class="MuiTableRow-root css-16nxph9"><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">128</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">12.84</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">0.5881</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">1,700.39</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">9.6925</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">17.0893x</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">1.1435x</td></tr><tr class="MuiTableRow-root css-16nxph9"><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">256</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">12.35</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">0.5656</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">1,768.03</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">19.2745</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">17.7691x</td><td class="MuiTableCell-root MuiTableCell-body MuiTableCell-sizeMedium css-q34dxg">1.0397x</td></tr></tbody></table></div></div><p class="MuiTypography-root MuiTypography-p css-vsuld9">The improvements for this model and input are very different.</p><h1 class="MuiTypography-root MuiTypography-h4 css-rg843f" id="conclusion"><strong>Conclusion</strong></h1><p class="MuiTypography-root MuiTypography-p css-vsuld9">In this Post, we have seen how GPUs are significantly faster than CPUs for ML inference tasks. We have also seen that processing multiple inputs in parallel i.e. in a batch serves to decrease the inference time. The relative decrease is considerable among smaller batch sizes but diminishes as the batch sizes get larger. The effect on performance also depends on the model architecture and its implementation.</p><p class="MuiTypography-root MuiTypography-p css-vsuld9">Or maybe, you want to serve models to run on the client side, in that case, <a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineHover css-1vxruma" href="/ml-ops/tensorflow-js-inference-in-react">this Article</a> may interest you, where we run a model on the user&#x27;s web browser using TensorFlow JS.</p><p class="MuiTypography-root MuiTypography-p css-vsuld9">See you next time :)</p></div></div></div></div><style data-emotion="css sdeu8y">.css-sdeu8y{margin-top:40px;margin-bottom:40px;padding-bottom:16px;width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:start;-ms-flex-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div class="MuiBox-root css-sdeu8y"><style data-emotion="css iyxjf1">.css-iyxjf1{box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;width:100%;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;margin-top:-16px;width:calc(100% + 16px);margin-left:-16px;margin-top:32px;margin-bottom:32px;}.css-iyxjf1>.MuiGrid-item{padding-top:16px;}.css-iyxjf1>.MuiGrid-item{padding-left:16px;}</style><div class="MuiGrid-root MuiGrid-container MuiGrid-spacing-xs-2 css-iyxjf1"><style data-emotion="css 1etv89n">.css-1etv89n{box-sizing:border-box;margin:0;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-flex-basis:100%;-ms-flex-preferred-size:100%;flex-basis:100%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:100%;}@media (min-width:600px){.css-1etv89n{-webkit-flex-basis:50%;-ms-flex-preferred-size:50%;flex-basis:50%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:50%;}}@media (min-width:900px){.css-1etv89n{-webkit-flex-basis:33.333333%;-ms-flex-preferred-size:33.333333%;flex-basis:33.333333%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:33.333333%;}}@media (min-width:1200px){.css-1etv89n{-webkit-flex-basis:25%;-ms-flex-preferred-size:25%;flex-basis:25%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:25%;}}@media (min-width:1536px){.css-1etv89n{-webkit-flex-basis:25%;-ms-flex-preferred-size:25%;flex-basis:25%;-webkit-box-flex:0;-webkit-flex-grow:0;-ms-flex-positive:0;flex-grow:0;max-width:25%;}}</style><div class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-12 MuiGrid-grid-sm-6 MuiGrid-grid-md-4 MuiGrid-grid-lg-3 css-1etv89n"><a style="text-decoration:none" href="/ml-ops/tensorflow-js-inference-in-react/"><style data-emotion="css 1dp4q5j">.css-1dp4q5j{overflow:hidden;width:100%;height:100%;box-shadow:1px 1px 1px 1px "#eeeeee";}.css-1dp4q5j:hover{box-shadow:3px 3px 3px 3px "#eeeeee";cursor:pointer;}</style><style data-emotion="css ewbf0o">.css-ewbf0o{background-color:#fff;color:rgba(0, 0, 0, 0.87);-webkit-transition:box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;border-radius:4px;box-shadow:0px 2px 1px -1px rgba(0,0,0,0.2),0px 1px 1px 0px rgba(0,0,0,0.14),0px 1px 3px 0px rgba(0,0,0,0.12);overflow:hidden;width:100%;height:100%;box-shadow:1px 1px 1px 1px "#eeeeee";}.css-ewbf0o:hover{box-shadow:3px 3px 3px 3px "#eeeeee";cursor:pointer;}</style><div class="MuiPaper-root MuiPaper-elevation MuiPaper-rounded MuiPaper-elevation1 MuiCard-root css-ewbf0o"><style data-emotion="css 146e5oc">.css-146e5oc{display:block;-webkit-background-size:cover;background-size:cover;background-repeat:no-repeat;-webkit-background-position:center;background-position:center;width:100%;object-fit:cover;object-fit:cover;}</style><img class="MuiCardMedia-root MuiCardMedia-media MuiCardMedia-img css-146e5oc" src="/media/images/react-digit-recog-app-final.jpg" height="150" alt="TensorFlow.js Inference in React on an image drawn with Konva"/><style data-emotion="css 1qw96cp">.css-1qw96cp{padding:16px;}.css-1qw96cp:last-child{padding-bottom:24px;}</style><div class="MuiCardContent-root css-1qw96cp"><style data-emotion="css 4an0mh">.css-4an0mh{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:500;font-size:1.25rem;line-height:1.6;letter-spacing:0.0075em;margin-bottom:0.35em;}</style><h2 class="MuiTypography-root MuiTypography-h6 MuiTypography-gutterBottom css-4an0mh"> <!-- -->TensorFlow.js Inference in React on an image drawn with Konva</h2><style data-emotion="css r1ev5b">.css-r1ev5b{margin:0;margin-bottom:0.35em;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;}</style><p class="MuiTypography-root MuiTypography-p MuiTypography-gutterBottom css-r1ev5b">Inferencing on an ONNX model in a React App using ONNXRuntime Web.</p><style data-emotion="css 4jg4rq">.css-4jg4rq{width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:end;-ms-flex-pack:end;-webkit-justify-content:flex-end;justify-content:flex-end;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div class="MuiBox-root css-4jg4rq"><p class="MuiTypography-root MuiTypography-p MuiTypography-gutterBottom css-mxjm1x">08m Read</p></div></div></div></a></div><div class="MuiGrid-root MuiGrid-item MuiGrid-grid-xs-12 MuiGrid-grid-sm-6 MuiGrid-grid-md-4 MuiGrid-grid-lg-3 css-1etv89n"><a style="text-decoration:none" href="/ml-ops/onnxruntime-web-inference-in-react/"><div class="MuiPaper-root MuiPaper-elevation MuiPaper-rounded MuiPaper-elevation1 MuiCard-root css-ewbf0o"><img class="MuiCardMedia-root MuiCardMedia-media MuiCardMedia-img css-146e5oc" src="/media/images/react-digit-recog-app-final.jpg" height="150" alt="ONNXRuntime Inference in a React App"/><div class="MuiCardContent-root css-1qw96cp"><h2 class="MuiTypography-root MuiTypography-h6 MuiTypography-gutterBottom css-4an0mh"> <!-- -->ONNXRuntime Inference in a React App</h2><p class="MuiTypography-root MuiTypography-p MuiTypography-gutterBottom css-r1ev5b">Inferencing on an ONNX model in a React App using ONNXRuntime Web.</p><div class="MuiBox-root css-4jg4rq"><p class="MuiTypography-root MuiTypography-p MuiTypography-gutterBottom css-mxjm1x">08m Read</p></div></div></div></a></div></div></div></div><footer style="margin-top:25px"><style data-emotion="css 1uy1rgq">.css-1uy1rgq{width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:start;-ms-flex-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;-webkit-align-items:flex-end;-webkit-box-align:flex-end;-ms-flex-align:flex-end;align-items:flex-end;padding-top:200px;border-top:1px solid black;}</style><div class="MuiBox-root css-1uy1rgq"><img src="/media/images/main-contact-email-light.jpg" style="width:250px;height:27px"/><style data-emotion="css 1uk1gs8">.css-1uk1gs8{margin:0;}</style><span class="MuiTypography-root MuiTypography-p css-1uk1gs8">We typically reply within 24 hours.</span><style data-emotion="css zq6grw">.css-zq6grw{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1.5rem;line-height:1.334;letter-spacing:0em;}</style><h5 class="MuiTypography-root MuiTypography-h5 css-zq6grw"> 2024 <!-- -->A Nice Teacher</h5></div></footer></div><script src="/_next/static/chunks/webpack-83486951edee0db5.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/css/1d4d01086947be98.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"2:I[5751,[],\"\"]\n5:I[9275,[],\"\"]\n8:I[1343,[],\"\"]\n9:I[6871,[\"98\",\"static/chunks/98-7f6363f9ac68c942.js\",\"748\",\"static/chunks/748-1f14ee6eb3d7029a.js\",\"271\",\"static/chunks/271-37a22bace913f735.js\",\"185\",\"static/chunks/app/layout-08611f287dda1230.js\"],\"default\"]\na:I[5877,[\"98\",\"static/chunks/98-7f6363f9ac68c942.js\",\"748\",\"static/chunks/748-1f14ee6eb3d7029a.js\",\"271\",\"static/chunks/271-37a22bace913f735.js\",\"185\",\"static/chunks/app/layout-08611f287dda1230.js\"],\"default\"]\nb:I[902,[\"98\",\"static/chunks/98-7f6363f9ac68c942.js\",\"748\",\"static/chunks/748-1f14ee6eb3d7029a.js\",\"271\",\"static/chunks/271-37a22bace913f735.js\",\"185\",\"static/chunks/app/layout-08611f287dda1230.js\"],\"\"]\nc:I[5218,[\"98\",\"static/chunks/98-7f6363f9ac68c942.js\",\"134\",\"static/chunks/134-9729e0afcc6dfdfe.js\",\"830\",\"static/chunks/830-8a0df588e7c84864.js\",\"748\",\"static/chunks/748-1f14ee6eb3d7029a.js\",\"411\",\"static/chunks/411-e5dcfc2304d91b2f.js\",\"533\",\"static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js\"],\"\"]\nd:I[2324,[\"98\",\"static/chunks/98-7f6363f9ac68c942.js\",\"134\",\"static/chunks/134-9729e0afcc6dfdfe.js\",\"830\",\"static/chunks/830-8a0df588e7c84864.js\",\"748\",\"static/chunks/748-1f14ee6eb3d7029a.js\",\"411\",\"static/chunks/411-e5dcfc2304d91b2f.js\",\"533\",\"static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js\"],\"default\"]\ne:I[2591,[\"98\",\"static/chunks/98-7f6363f9ac68c942.js\",\"134\",\"static/chunks/134-9729e0afcc6dfdfe.js\",\"830\",\"static/chunks/830-8a0df588e7c84864.js\",\"748\",\"static/chunks/748-1f14ee6eb3d7029a.js\",\"411\",\"static/chunks/411-e5dcfc2304d91b2f.js\",\"533\",\"static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js\"],\"\"]\nf:I[231,[\"98\",\"static/chunks/98-7f6363f9ac68c942.js\",\"134\",\"static/chunks/134-9729e0afcc6dfdfe.js\",\"830\",\"static/chunks/830-8a0df588e7c84864.js\",\"748\",\"static/chunks/748-1f14ee6eb3d7029a.js\",\"411\",\"static/chunks/411-e5dcfc2304d91b2f.js\",\"533\",\"static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js\"],\"\"]\n10:I[3180,[\"98\",\"static/c"])</script><script>self.__next_f.push([1,"hunks/98-7f6363f9ac68c942.js\",\"134\",\"static/chunks/134-9729e0afcc6dfdfe.js\",\"830\",\"static/chunks/830-8a0df588e7c84864.js\",\"748\",\"static/chunks/748-1f14ee6eb3d7029a.js\",\"411\",\"static/chunks/411-e5dcfc2304d91b2f.js\",\"533\",\"static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js\"],\"\"]\n11:I[3245,[\"98\",\"static/chunks/98-7f6363f9ac68c942.js\",\"748\",\"static/chunks/748-1f14ee6eb3d7029a.js\",\"271\",\"static/chunks/271-37a22bace913f735.js\",\"185\",\"static/chunks/app/layout-08611f287dda1230.js\"],\"default\"]\n13:I[6130,[],\"\"]\n6:[\"categorySlug\",\"ml-ops\",\"d\"]\n7:[\"postOrSeriesSlug\",\"gpu-vs-cpu-performance-for-ml-inference-workflows\",\"d\"]\n14:[]\n"])</script><script>self.__next_f.push([1,"0:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/1d4d01086947be98.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"$L2\",null,{\"buildId\":\"VvaX91qL0y6klITKNgfgL\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/ml-ops/gpu-vs-cpu-performance-for-ml-inference-workflows/\",\"initialTree\":[\"\",{\"children\":[[\"categorySlug\",\"ml-ops\",\"d\"],{\"children\":[[\"postOrSeriesSlug\",\"gpu-vs-cpu-performance-for-ml-inference-workflows\",\"d\"],{\"children\":[\"__PAGE__?{\\\"categorySlug\\\":\\\"ml-ops\\\",\\\"postOrSeriesSlug\\\":\\\"gpu-vs-cpu-performance-for-ml-inference-workflows\\\"}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[[\"categorySlug\",\"ml-ops\",\"d\"],{\"children\":[[\"postOrSeriesSlug\",\"gpu-vs-cpu-performance-for-ml-inference-workflows\",\"d\"],{\"children\":[\"__PAGE__\",{},[[\"$L3\",\"$L4\"],null],null]},[\"$\",\"$L5\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"$6\",\"children\",\"$7\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}],null]},[\"$\",\"$L5\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"$6\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}],null]},[[\"$\",\"html\",null,{\"lang\":\"en\",\"suppressHydrationWarning\":true,\"children\":[\"$\",\"body\",null,{\"className\":\"__className_d65c78\",\"children\":[\"$\",\"$L9\",null,{\"children\":[[\"$\",\"$La\",null,{}],[\"$\",\"$Lb\",null,{\"maxWidth\":\"lg\",\"children\":[[\"$\",\"$L5\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[\"$\",\"$Lc\",null,{\"children\":[[\"$\",\"$Ld\",null,{\"render\":false,\"targetSiteNavigationState\":[],\"targetPageNavigationState\":[]}],[\"$\",\"$Le\",null,{\"variant\":\"h4\",\"children\":[\"$\",\"strong\",null,{\"children\":\"Not Found\"}]}],[\"$\",\"$Le\",null,{\"variant\":\"h6\",\"mb\":3,\"children\":\"Oops! It looks like the page you're looking for does not exist.\"}],[\"$\",\"$Lf\",null,{\"href\":\"/\",\"children\":[\"$\",\"$L10\",null,{\"variant\":\"contained\",\"sx\":{\"marginRight\":5,\"marginBottom\":1},\"children\":\"Take me Home\"}]}]]}],\"notFoundStyles\":[],\"styles\":null}],[\"$\",\"$L11\",null,{}]]}]]}]}]}],null],null],\"couldBeIntercepted\":false,\"initialHead\":[false,\"$L12\"],\"globalErrorComponent\":\"$13\",\"missingSlots\":\"$W14\"}]]\n"])</script><script>self.__next_f.push([1,"12:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"link\",\"2\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"16x16\"}]]\n3:null\n"])</script><script>self.__next_f.push([1,"15:I[3507,[\"98\",\"static/chunks/98-7f6363f9ac68c942.js\",\"134\",\"static/chunks/134-9729e0afcc6dfdfe.js\",\"830\",\"static/chunks/830-8a0df588e7c84864.js\",\"748\",\"static/chunks/748-1f14ee6eb3d7029a.js\",\"411\",\"static/chunks/411-e5dcfc2304d91b2f.js\",\"533\",\"static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js\"],\"\"]\n17:I[4204,[\"98\",\"static/chunks/98-7f6363f9ac68c942.js\",\"134\",\"static/chunks/134-9729e0afcc6dfdfe.js\",\"830\",\"static/chunks/830-8a0df588e7c84864.js\",\"748\",\"static/chunks/748-1f14ee6eb3d7029a.js\",\"411\",\"static/chunks/411-e5dcfc2304d91b2f.js\",\"533\",\"static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js\"],\"default\"]\n18:I[1847,[\"98\",\"static/chunks/98-7f6363f9ac68c942.js\",\"134\",\"static/chunks/134-9729e0afcc6dfdfe.js\",\"830\",\"static/chunks/830-8a0df588e7c84864.js\",\"748\",\"static/chunks/748-1f14ee6eb3d7029a.js\",\"411\",\"static/chunks/411-e5dcfc2304d91b2f.js\",\"533\",\"static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js\"],\"default\"]\n19:I[8125,[\"98\",\"static/chunks/98-7f6363f9ac68c942.js\",\"134\",\"static/chunks/134-9729e0afcc6dfdfe.js\",\"830\",\"static/chunks/830-8a0df588e7c84864.js\",\"748\",\"static/chunks/748-1f14ee6eb3d7029a.js\",\"411\",\"static/chunks/411-e5dcfc2304d91b2f.js\",\"533\",\"static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js\"],\"\"]\n1a:I[3578,[\"98\",\"static/chunks/98-7f6363f9ac68c942.js\",\"134\",\"static/chunks/134-9729e0afcc6dfdfe.js\",\"830\",\"static/chunks/830-8a0df588e7c84864.js\",\"748\",\"static/chunks/748-1f14ee6eb3d7029a.js\",\"411\",\"static/chunks/411-e5dcfc2304d91b2f.js\",\"533\",\"static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js\"],\"default\"]\n1b:I[7005,[\"98\",\"static/chunks/98-7f6363f9ac68c942.js\",\"134\",\"static/chunks/134-9729e0afcc6dfdfe.js\",\"830\",\"static/chunks/830-8a0df588e7c84864.js\",\"748\",\"static/chunks/748-1f14ee6eb3d7029a.js\",\"411\",\"static/chunks/411-e5dcfc2304d91b2f.js\",\"533\",\"static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js\"],\"\"]\n1c:I["])</script><script>self.__next_f.push([1,"6480,[\"98\",\"static/chunks/98-7f6363f9ac68c942.js\",\"134\",\"static/chunks/134-9729e0afcc6dfdfe.js\",\"830\",\"static/chunks/830-8a0df588e7c84864.js\",\"748\",\"static/chunks/748-1f14ee6eb3d7029a.js\",\"411\",\"static/chunks/411-e5dcfc2304d91b2f.js\",\"533\",\"static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js\"],\"default\"]\n1f:I[9355,[\"98\",\"static/chunks/98-7f6363f9ac68c942.js\",\"134\",\"static/chunks/134-9729e0afcc6dfdfe.js\",\"830\",\"static/chunks/830-8a0df588e7c84864.js\",\"748\",\"static/chunks/748-1f14ee6eb3d7029a.js\",\"411\",\"static/chunks/411-e5dcfc2304d91b2f.js\",\"533\",\"static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js\"],\"\"]\n20:I[8888,[\"98\",\"static/chunks/98-7f6363f9ac68c942.js\",\"134\",\"static/chunks/134-9729e0afcc6dfdfe.js\",\"830\",\"static/chunks/830-8a0df588e7c84864.js\",\"748\",\"static/chunks/748-1f14ee6eb3d7029a.js\",\"411\",\"static/chunks/411-e5dcfc2304d91b2f.js\",\"533\",\"static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js\"],\"\"]\n21:I[3037,[\"98\",\"static/chunks/98-7f6363f9ac68c942.js\",\"134\",\"static/chunks/134-9729e0afcc6dfdfe.js\",\"830\",\"static/chunks/830-8a0df588e7c84864.js\",\"748\",\"static/chunks/748-1f14ee6eb3d7029a.js\",\"411\",\"static/chunks/411-e5dcfc2304d91b2f.js\",\"533\",\"static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js\"],\"\"]\n22:I[7842,[\"98\",\"static/chunks/98-7f6363f9ac68c942.js\",\"134\",\"static/chunks/134-9729e0afcc6dfdfe.js\",\"830\",\"static/chunks/830-8a0df588e7c84864.js\",\"748\",\"static/chunks/748-1f14ee6eb3d7029a.js\",\"411\",\"static/chunks/411-e5dcfc2304d91b2f.js\",\"533\",\"static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js\"],\"\"]\n23:I[9697,[\"98\",\"static/chunks/98-7f6363f9ac68c942.js\",\"134\",\"static/chunks/134-9729e0afcc6dfdfe.js\",\"830\",\"static/chunks/830-8a0df588e7c84864.js\",\"748\",\"static/chunks/748-1f14ee6eb3d7029a.js\",\"411\",\"static/chunks/411-e5dcfc2304d91b2f.js\",\"533\",\"static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js\"],\"\"]\n24:I[4775,[\"98\",\"static/"])</script><script>self.__next_f.push([1,"chunks/98-7f6363f9ac68c942.js\",\"134\",\"static/chunks/134-9729e0afcc6dfdfe.js\",\"830\",\"static/chunks/830-8a0df588e7c84864.js\",\"748\",\"static/chunks/748-1f14ee6eb3d7029a.js\",\"411\",\"static/chunks/411-e5dcfc2304d91b2f.js\",\"533\",\"static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js\"],\"\"]\n1d:T7f5,from segmentation_models_pytorch import UnetPlusPlus\nimport torch\nimport torch.nn.functional as F\nfrom torchvision import transforms\n\n\nclass Model:\n    def __init__(self, weights_path, use_cuda=False):\n        self.using_cuda = use_cuda and torch.cuda.is_available()\n        self.device = torch.device(\"cuda\") if self.using_cuda else torch.device(\"cpu\")\n        self.dtype = torch.cuda.FloatTensor if self.using_cuda else torch.Tensor\n\n        self.model = UnetPlusPlus(\n            encoder_name=\"resnet34\",\n            encoder_depth=4,\n            encoder_weights=\"imagenet\",\n            decoder_channels=(256, 128, 64, 32),\n            in_channels=1,\n            classes=1,\n            activation=None,\n            aux_params=None\n        )\n\n        self.model = self.model.to(self.device)\n        self.model.load_state_dict(torch.load(weights_path, map_location=self.device))\n\n        self.preprocessing_transform = transforms.Compose([\n            transforms.ToTensor(),\n            transforms.Resize(size=(256, 256))\n        ])\n\n        if use_cuda and not self.using_cuda:\n            print(\"CUDA is not available to Torch, using CPU instead.\")\n\n    def preprocess(self, images):\n        transformed_images = torch.stack([self.preprocessing_transform(image) for image in images])\n        transformed_images = transformed_images.type(self.dtype)\n\n        batched_images = transformed_images.to(self.device)\n\n        return batched_images\n\n    def postprocess(self, output, output_size=(256, 256)):\n        output = output[0]\n        output = output.ge(0.5)\n        output = F.interpolate(output.unsqueeze(0).unsqueeze(0).float(), size=output_size, mode=\"nearest\")\n        output = output.bool().squeeze(0).squeeze(0)\n\n    "])</script><script>self.__next_f.push([1,"    if self.using_cuda:\n            output = output.cpu()\n\n        output = output.numpy()\n\n        return output\n\n    def forward(self, preprocessed_images):\n        output = self.model.forward(preprocessed_images)\n        output = torch.sigmoid(output)\n        output = output.detach()\n\n        return output1e:T5f9,from os import listdir\nfrom os.path import join as path_join\nfrom time import time\n\nimport cv2\nimport numpy as np\n\nfrom config import inputs_dir, outputs_dir, weights_dir\nfrom model import Model\n\n\nif __name__ == \"__main__\":\n    test_images = []\n    all_image_names = listdir(inputs_dir)\n    for i, image_name in enumerate(all_image_names):\n        image = cv2.imread(path_join(inputs_dir, image_name), cv2.IMREAD_GRAYSCALE)\n        test_images.append(image)\n\n        if (i + 1) % 500 == 0:\n            print(f\"Loaded images: {i} / {len(all_image_names)}\")\n\n        if (i + 1) % 50 == 0:\n            break\n    print(\"Images loaded.\")\n\n    model = Model(path_join(weights_dir, \"weights_001.pt\"), use_cuda=False)\n    print(\"Model loaded.\")\n\n    start_time = time()\n\n    outputs = []\n    for i, test_image in enumerate(test_images):\n        preprocessed_image = model.preprocess([test_image])\n        output = model.forward(preprocessed_image)\n        output = output.detach()\n        outputs.append(output)\n\n    end_time = time()\n    time_elapsed = end_time - start_time\n    print(\n        f\"Num images: {len(test_images)}, \"\n        f\"Batch size: {1}, \"\n        f\"Time taken: {time_elapsed} s, \"\n        f\"Time taken per image: {1000 * time_elapsed / len(test_images)} ms\"\n    )\n\n    for output in outputs:\n        boolean_array = model.postprocess(output[0], (512, 512))\n        binary_image = boolean_array.astype(np.uint8) * 255\n        file_path = path_join(outputs_dir, f\"{i}.png\")\n        cv2.imwrite(file_path, binary_image)25:T6ef,from os import listdir\nfrom os.path import join as path_join\nfrom time import time\n\nimport cv2\nimport numpy as np\n\nfrom config import inputs_dir, outputs_dir, weights_dir\nfrom model import Mode"])</script><script>self.__next_f.push([1,"l\n\n\nif __name__ == \"__main__\":\n    test_images = [cv2.imread(path_join(inputs_dir, image_name), cv2.IMREAD_GRAYSCALE) for image_name in listdir(inputs_dir)]\n    print(\"Images loaded.\")\n\n    model = Model(path_join(weights_dir, \"weights_001.pt\"), use_cuda=True)\n    print(\"Model loaded.\")\n\n    for batch_size in [1, 2, 4, 8, 16, 32]: #, 64, 128, 256]:\n        test_batches = [test_images[i:i+batch_size] for i in range(0, len(test_images), batch_size)]\n        outputs = []\n\n        start_time = time()\n        preprocessed_batches = [model.preprocess(batch) for batch in test_batches]\n\n        for i, preprocessed_batch in enumerate(preprocessed_batches):\n            output = model.forward(preprocessed_batch)\n            output = output.detach()\n            outputs.append(output)\n\n            if (i + 1) % 25 == 0:\n                print(f\"Processed: {i} / {len(preprocessed_batches)}\")\n\n        end_time = time()\n        time_elapsed = end_time - start_time\n\n        print(\n            f\"Num images: {len(test_images)}, \"\n            f\"Batch size: {batch_size}, \"\n            f\"Time taken: {time_elapsed} s, \"\n            f\"Time taken per image: {1000 * time_elapsed / len(test_images)} ms\"\n        )\n\n        for i, output in enumerate(outputs):\n            for j, single_output in enumerate(output):\n                boolean_array = model.postprocess(single_output, (512, 512))\n                binary_image = boolean_array.astype(np.uint8) * 255\n                file_path = path_join(outputs_dir, f\"{i * batch_size + j}.png\")\n                cv2.imwrite(file_path, binary_image)"])</script><script>self.__next_f.push([1,"4:[\"$\",\"$Lc\",null,{\"mb\":5,\"pb\":2,\"sx\":{\"width\":\"100%\",\"display\":\"flex\",\"flexDirection\":\"column\",\"justifyContent\":\"flex-start\",\"alignItems\":\"flex-start\"},\"children\":[[\"$\",\"$Ld\",null,{\"render\":true,\"targetSiteNavigationState\":[{\"absoluteSlug\":\"/ml-ops\",\"title\":\"ML Ops\"},{\"absoluteSlug\":\"/ml-ops/gpu-vs-cpu-performance-for-ml-inference-workflows\",\"title\":\"ML Inference Performance on GPU and CPU across different batch sizes.\"}],\"targetPageNavigationState\":[{\"title\":\"The Model\",\"absoluteSlug\":\"#the-model\"},{\"title\":\"CPU and GPU\",\"absoluteSlug\":\"#cpu-and-gpu\"},{\"title\":\"Testing Code\",\"absoluteSlug\":\"#testing-code\"},{\"title\":\"CPU Inference\",\"absoluteSlug\":\"#cpu-inference\"},{\"title\":\"GPU Inference\",\"absoluteSlug\":\"#gpu-inference\"},{\"title\":\"Batched GPU Inference\",\"absoluteSlug\":\"#batched-gpu-inference\"},{\"title\":\"Batched CPU Inference: Any Good?\",\"absoluteSlug\":\"#batched-cpu-inference:-any-good?\"},{\"title\":\"Model Dependence\",\"absoluteSlug\":\"#model-dependence\"},{\"title\":\"Conclusion\",\"absoluteSlug\":\"#conclusion\"}]}],[\"$\",\"$L15\",null,{\"container\":true,\"spacing\":2,\"mb\":0,\"children\":[[\"$\",\"$L15\",null,{\"item\":true,\"xs\":12,\"sm\":12,\"md\":4,\"sx\":{\"background\":\"linear-gradient(to right, #eeeeee, #ffffff)\",\"borderRadius\":5},\"children\":[\"$\",\"$Lc\",null,{\"sx\":{\"width\":\"100%\",\"height\":\"100%\",\"display\":\"flex\",\"flexDirection\":\"column\",\"justifyContent\":\"center\",\"alignItems\":\"flex-start\",\"paddingBottom\":2},\"children\":[[\"$\",\"$Le\",null,{\"gutterBottom\":true,\"variant\":\"h5\",\"component\":\"h1\",\"children\":\"ML Inference Performance on GPU and CPU across different batch sizes.\"}],[\"$\",\"$Le\",null,{\"gutterBottom\":true,\"variant\":\"p\",\"component\":\"p\",\"mb\":4,\"children\":\"A comparison of ML inference speed and memory consumption across various batch sizes on both GPU and CPU.\"}],[\"$\",\"$Lc\",null,{\"sx\":{\"width\":\"100%\",\"display\":\"flex\",\"flexDirection\":\"row\",\"justifyContent\":\"space-between\",\"alignItems\":\"center\",\"marginBottom\":2},\"children\":[[\"$\",\"$Le\",null,{\"gutterBottom\":true,\"variant\":\"p\",\"component\":\"p\",\"children\":\"June 09, 2024\"}],[\"$\",\"$Le\",null,{\"gutterBottom\":true,\"variant\":\"p\",\"component\":\"p\",\"children\":[\"08m\",\" Read\"]}]]}],\"$L16\",false]}]}],[\"$\",\"$L15\",null,{\"item\":true,\"xs\":12,\"sm\":12,\"md\":8,\"children\":[\"$\",\"$Lc\",null,{\"sx\":{\"flex\":1,\"display\":\"flex\",\"flexDirection\":\"column\",\"justifyContent\":\"center\",\"alignItems\":\"center\",\"marginRight\":2},\"children\":[\"$\",\"img\",null,{\"src\":\"/media/images/gpu-vs-cpu-performance-for-ml-inference-workflows-thumbnail.jpg\",\"style\":{\"width\":\"100%\",\"maxWidth\":\"75vw\",\"height\":\"auto\",\"maxHeight\":\"35vh\",\"objectFit\":\"cover\"}}]}]}]]}],[\"$\",\"$Lc\",null,{\"sx\":{\"width\":\"100%\"},\"children\":[\"$\",\"$L15\",null,{\"container\":true,\"spacing\":2,\"mt\":4,\"mb\":0,\"children\":[[\"$\",\"$L15\",null,{\"item\":true,\"xs\":12,\"sm\":12,\"md\":4,\"lg\":3,\"sx\":{\"background\":\"linear-gradient(to right, #eeeeee, #ffffff)\",\"borderRadius\":5},\"children\":[\"$\",\"$Lc\",null,{\"sx\":{\"width\":\"100%\"},\"children\":[[\"$\",\"$Lc\",null,{\"sx\":{\"width\":\"100%\",\"display\":{\"xs\":\"block\",\"md\":\"none\"},\"marginBottom\":2},\"children\":[\"$\",\"$L17\",null,{\"sx\":{\"width\":\"100%\",\"marginBottom\":2,\"boxShadow\":3,\"backgroundColor\":\"#ffffff22\"},\"disableGutters\":true,\"children\":[[\"$\",\"$L18\",null,{\"expandIcon\":[\"$\",\"$L19\",null,{}],\"children\":[\"$\",\"$Le\",null,{\"variant\":\"h6\",\"component\":\"h6\",\"sx\":{\"margin\":0,\"padding\":0},\"children\":\"Table of Contents\"}]}],[\"$\",\"$L1a\",null,{\"sx\":{\"width\":\"90%\",\"display\":\"flex\",\"flexDirection\":\"column\",\"justifyContent\":\"flex-start\",\"alignItems\":\"flex-start\",\"marginBottom\":2},\"children\":[[\"$\",\"a\",\"0\",{\"href\":\"#the-model\",\"style\":{\"textDecoration\":\"none\",\"color\":\"inherit\",\"\u0026:visited\":{\"textDecoration\":\"none\",\"color\":\"inherit\"}},\"children\":[\"$\",\"$Le\",\"0\",{\"variant\":\"p\",\"component\":\"p\",\"ml\":0,\"mb\":2.5,\"sx\":{\"\u0026:hover\":{\"color\":\"blue\"}},\"children\":\"The Model\"}]}],[\"$\",\"a\",\"1\",{\"href\":\"#cpu-and-gpu\",\"style\":{\"textDecoration\":\"none\",\"color\":\"inherit\",\"\u0026:visited\":{\"textDecoration\":\"none\",\"color\":\"inherit\"}},\"children\":[\"$\",\"$Le\",\"1\",{\"variant\":\"p\",\"component\":\"p\",\"ml\":1,\"mb\":2,\"sx\":{\"\u0026:hover\":{\"color\":\"blue\"}},\"children\":\"CPU and GPU\"}]}],[\"$\",\"a\",\"2\",{\"href\":\"#testing-code\",\"style\":{\"textDecoration\":\"none\",\"color\":\"inherit\",\"\u0026:visited\":{\"textDecoration\":\"none\",\"color\":\"inherit\"}},\"children\":[\"$\",\"$Le\",\"2\",{\"variant\":\"p\",\"component\":\"p\",\"ml\":1,\"mb\":2,\"sx\":{\"\u0026:hover\":{\"color\":\"blue\"}},\"children\":\"Testing Code\"}]}],[\"$\",\"a\",\"3\",{\"href\":\"#cpu-inference\",\"style\":{\"textDecoration\":\"none\",\"color\":\"inherit\",\"\u0026:visited\":{\"textDecoration\":\"none\",\"color\":\"inherit\"}},\"children\":[\"$\",\"$Le\",\"3\",{\"variant\":\"p\",\"component\":\"p\",\"ml\":0,\"mb\":2.5,\"sx\":{\"\u0026:hover\":{\"color\":\"blue\"}},\"children\":\"CPU Inference\"}]}],[\"$\",\"a\",\"4\",{\"href\":\"#gpu-inference\",\"style\":{\"textDecoration\":\"none\",\"color\":\"inherit\",\"\u0026:visited\":{\"textDecoration\":\"none\",\"color\":\"inherit\"}},\"children\":[\"$\",\"$Le\",\"4\",{\"variant\":\"p\",\"component\":\"p\",\"ml\":0,\"mb\":2.5,\"sx\":{\"\u0026:hover\":{\"color\":\"blue\"}},\"children\":\"GPU Inference\"}]}],[\"$\",\"a\",\"5\",{\"href\":\"#batched-gpu-inference\",\"style\":{\"textDecoration\":\"none\",\"color\":\"inherit\",\"\u0026:visited\":{\"textDecoration\":\"none\",\"color\":\"inherit\"}},\"children\":[\"$\",\"$Le\",\"5\",{\"variant\":\"p\",\"component\":\"p\",\"ml\":0,\"mb\":2.5,\"sx\":{\"\u0026:hover\":{\"color\":\"blue\"}},\"children\":\"Batched GPU Inference\"}]}],[\"$\",\"a\",\"6\",{\"href\":\"#batched-cpu-inference:-any-good?\",\"style\":{\"textDecoration\":\"none\",\"color\":\"inherit\",\"\u0026:visited\":{\"textDecoration\":\"none\",\"color\":\"inherit\"}},\"children\":[\"$\",\"$Le\",\"6\",{\"variant\":\"p\",\"component\":\"p\",\"ml\":1,\"mb\":2,\"sx\":{\"\u0026:hover\":{\"color\":\"blue\"}},\"children\":\"Batched CPU Inference: Any Good?\"}]}],[\"$\",\"a\",\"7\",{\"href\":\"#model-dependence\",\"style\":{\"textDecoration\":\"none\",\"color\":\"inherit\",\"\u0026:visited\":{\"textDecoration\":\"none\",\"color\":\"inherit\"}},\"children\":[\"$\",\"$Le\",\"7\",{\"variant\":\"p\",\"component\":\"p\",\"ml\":1,\"mb\":2,\"sx\":{\"\u0026:hover\":{\"color\":\"blue\"}},\"children\":\"Model Dependence\"}]}],[\"$\",\"a\",\"8\",{\"href\":\"#conclusion\",\"style\":{\"textDecoration\":\"none\",\"color\":\"inherit\",\"\u0026:visited\":{\"textDecoration\":\"none\",\"color\":\"inherit\"}},\"children\":[\"$\",\"$Le\",\"8\",{\"variant\":\"p\",\"component\":\"p\",\"ml\":0,\"mb\":2.5,\"sx\":{\"\u0026:hover\":{\"color\":\"blue\"}},\"children\":\"Conclusion\"}]}]]}]]}]}],[\"$\",\"$Lc\",null,{\"sx\":{\"width\":\"100%\",\"display\":{\"xs\":\"none\",\"md\":\"block\"}},\"children\":[[\"$\",\"$Le\",null,{\"variant\":\"h5\",\"component\":\"h5\",\"sx\":{\"margin\":0,\"padding\":0},\"children\":\"Table of Contents\"}],[[\"$\",\"a\",\"0\",{\"href\":\"#the-model\",\"style\":{\"textDecoration\":\"none\",\"color\":\"inherit\",\"\u0026:visited\":{\"textDecoration\":\"none\",\"color\":\"inherit\"}},\"children\":[\"$\",\"$Le\",\"0\",{\"variant\":\"p\",\"component\":\"p\",\"ml\":0,\"mb\":2.5,\"sx\":{\"\u0026:hover\":{\"color\":\"blue\"}},\"children\":\"The Model\"}]}],[\"$\",\"a\",\"1\",{\"href\":\"#cpu-and-gpu\",\"style\":{\"textDecoration\":\"none\",\"color\":\"inherit\",\"\u0026:visited\":{\"textDecoration\":\"none\",\"color\":\"inherit\"}},\"children\":[\"$\",\"$Le\",\"1\",{\"variant\":\"p\",\"component\":\"p\",\"ml\":1,\"mb\":2,\"sx\":{\"\u0026:hover\":{\"color\":\"blue\"}},\"children\":\"CPU and GPU\"}]}],[\"$\",\"a\",\"2\",{\"href\":\"#testing-code\",\"style\":{\"textDecoration\":\"none\",\"color\":\"inherit\",\"\u0026:visited\":{\"textDecoration\":\"none\",\"color\":\"inherit\"}},\"children\":[\"$\",\"$Le\",\"2\",{\"variant\":\"p\",\"component\":\"p\",\"ml\":1,\"mb\":2,\"sx\":{\"\u0026:hover\":{\"color\":\"blue\"}},\"children\":\"Testing Code\"}]}],[\"$\",\"a\",\"3\",{\"href\":\"#cpu-inference\",\"style\":{\"textDecoration\":\"none\",\"color\":\"inherit\",\"\u0026:visited\":{\"textDecoration\":\"none\",\"color\":\"inherit\"}},\"children\":[\"$\",\"$Le\",\"3\",{\"variant\":\"p\",\"component\":\"p\",\"ml\":0,\"mb\":2.5,\"sx\":{\"\u0026:hover\":{\"color\":\"blue\"}},\"children\":\"CPU Inference\"}]}],[\"$\",\"a\",\"4\",{\"href\":\"#gpu-inference\",\"style\":{\"textDecoration\":\"none\",\"color\":\"inherit\",\"\u0026:visited\":{\"textDecoration\":\"none\",\"color\":\"inherit\"}},\"children\":[\"$\",\"$Le\",\"4\",{\"variant\":\"p\",\"component\":\"p\",\"ml\":0,\"mb\":2.5,\"sx\":{\"\u0026:hover\":{\"color\":\"blue\"}},\"children\":\"GPU Inference\"}]}],[\"$\",\"a\",\"5\",{\"href\":\"#batched-gpu-inference\",\"style\":{\"textDecoration\":\"none\",\"color\":\"inherit\",\"\u0026:visited\":{\"textDecoration\":\"none\",\"color\":\"inherit\"}},\"children\":[\"$\",\"$Le\",\"5\",{\"variant\":\"p\",\"component\":\"p\",\"ml\":0,\"mb\":2.5,\"sx\":{\"\u0026:hover\":{\"color\":\"blue\"}},\"children\":\"Batched GPU Inference\"}]}],[\"$\",\"a\",\"6\",{\"href\":\"#batched-cpu-inference:-any-good?\",\"style\":{\"textDecoration\":\"none\",\"color\":\"inherit\",\"\u0026:visited\":{\"textDecoration\":\"none\",\"color\":\"inherit\"}},\"children\":[\"$\",\"$Le\",\"6\",{\"variant\":\"p\",\"component\":\"p\",\"ml\":1,\"mb\":2,\"sx\":{\"\u0026:hover\":{\"color\":\"blue\"}},\"children\":\"Batched CPU Inference: Any Good?\"}]}],[\"$\",\"a\",\"7\",{\"href\":\"#model-dependence\",\"style\":{\"textDecoration\":\"none\",\"color\":\"inherit\",\"\u0026:visited\":{\"textDecoration\":\"none\",\"color\":\"inherit\"}},\"children\":[\"$\",\"$Le\",\"7\",{\"variant\":\"p\",\"component\":\"p\",\"ml\":1,\"mb\":2,\"sx\":{\"\u0026:hover\":{\"color\":\"blue\"}},\"children\":\"Model Dependence\"}]}],[\"$\",\"a\",\"8\",{\"href\":\"#conclusion\",\"style\":{\"textDecoration\":\"none\",\"color\":\"inherit\",\"\u0026:visited\":{\"textDecoration\":\"none\",\"color\":\"inherit\"}},\"children\":[\"$\",\"$Le\",\"8\",{\"variant\":\"p\",\"component\":\"p\",\"ml\":0,\"mb\":2.5,\"sx\":{\"\u0026:hover\":{\"color\":\"blue\"}},\"children\":\"Conclusion\"}]}]]]}]]}]}],[\"$\",\"$L15\",null,{\"item\":true,\"xs\":12,\"sm\":12,\"md\":8,\"lg\":9,\"sx\":{\"background\":\"linear-gradient(to right, #ffffff, #eeeeee)\",\"borderRadius\":5},\"children\":[\"$\",\"$Lc\",null,{\"sx\":{\"flex\":1,\"marginRight\":2},\"children\":[[\"$\",\"$Le\",\"0\",{\"variant\":\"p\",\"component\":\"p\",\"sx\":{\"textAlign\":\"justify\",\"marginBottom\":2},\"children\":[\"$undefined\",\"When deploying your ML model to production, it is important to get the inference process running as fast as possible. GPUs are efficient at parallel processing. In today's article, we compare the inference speeds of running a PyTorch model on a CPU and a GPU. We also test how processing more images in parallel, as batches, on GPU affects the speed.\"]}],[\"$\",\"$Le\",\"1\",{\"id\":\"the-model\",\"variant\":\"h4\",\"component\":\"h1\",\"mb\":2,\"children\":[\"$\",\"strong\",null,{\"children\":\"The Model\"}]}],[\"$\",\"$Le\",\"2\",{\"variant\":\"p\",\"component\":\"p\",\"sx\":{\"textAlign\":\"justify\",\"marginBottom\":2},\"children\":[\"$undefined\",\"Inside the project directory, let's create a folder called \",[\"$\",\"$Lc\",\"2-text-italics\",{\"component\":\"span\",\"sx\":{\"paddingLeft\":0.5,\"paddingRight\":0.5,\"borderRadius\":1,\"backgroundColor\":\"rgb(227, 234, 242)\"},\"children\":\"src\"}],\". Inside this folder, create a new file called \",[\"$\",\"$Lc\",\"2-text-italics\",{\"component\":\"span\",\"sx\":{\"paddingLeft\":0.5,\"paddingRight\":0.5,\"borderRadius\":1,\"backgroundColor\":\"rgb(227, 234, 242)\"},\"children\":\"model.py\"}],\". Here, we'll define a very simple model based on the \",[\"$\",\"$Lc\",\"2-text-italics\",{\"component\":\"span\",\"sx\":{\"paddingLeft\":0.5,\"paddingRight\":0.5,\"borderRadius\":1,\"backgroundColor\":\"rgb(227, 234, 242)\"},\"children\":\"UNet++\"}],\" architecture. For this, we'll use the \",[\"$\",\"$L1b\",\"2-link\",{\"href\":\"https://pypi.org/project/segmentation-models-pytorch/0.0.3/\",\"rel\":\"noopener noreferrer\",\"target\":\"_blank\",\"color\":\"primary\",\"underline\":\"hover\",\"children\":\"segmentation_models_pytorch\"}],\" package. Inside the file, we create a class called \",[\"$\",\"$Lc\",\"2-text-italics\",{\"component\":\"span\",\"sx\":{\"paddingLeft\":0.5,\"paddingRight\":0.5,\"borderRadius\":1,\"backgroundColor\":\"rgb(227, 234, 242)\"},\"children\":\"Model\"}],\" that has 4 main functions:\"]}],[\"$\",\"$Le\",\"3\",{\"variant\":\"p\",\"component\":\"p\",\"sx\":{\"textAlign\":\"justify\",\"marginBottom\":2},\"children\":[\"$undefined\",\"1. \",[\"$\",\"$Lc\",\"3-text-italics\",{\"component\":\"span\",\"sx\":{\"paddingLeft\":0.5,\"paddingRight\":0.5,\"borderRadius\":1,\"backgroundColor\":\"rgb(227, 234, 242)\"},\"children\":\"__init__\"}],\": initializes the model, loads the weights, and creates the preprocessing transform.\"]}],[\"$\",\"$Le\",\"4\",{\"variant\":\"p\",\"component\":\"p\",\"sx\":{\"textAlign\":\"justify\",\"marginBottom\":2},\"children\":[\"$undefined\",\"1. \",[\"$\",\"$Lc\",\"4-text-italics\",{\"component\":\"span\",\"sx\":{\"paddingLeft\":0.5,\"paddingRight\":0.5,\"borderRadius\":1,\"backgroundColor\":\"rgb(227, 234, 242)\"},\"children\":\"preprocess\"}],\": takes a list of images and returns a batch that can be passed to the \",[\"$\",\"$Lc\",\"4-text-italics\",{\"component\":\"span\",\"sx\":{\"paddingLeft\":0.5,\"paddingRight\":0.5,\"borderRadius\":1,\"backgroundColor\":\"rgb(227, 234, 242)\"},\"children\":\"forward\"}],\" function.\"]}],[\"$\",\"$Le\",\"5\",{\"variant\":\"p\",\"component\":\"p\",\"sx\":{\"textAlign\":\"justify\",\"marginBottom\":2},\"children\":[\"$undefined\",\"1. \",[\"$\",\"$Lc\",\"5-text-italics\",{\"component\":\"span\",\"sx\":{\"paddingLeft\":0.5,\"paddingRight\":0.5,\"borderRadius\":1,\"backgroundColor\":\"rgb(227, 234, 242)\"},\"children\":\"postprocess\"}],\": takes a single model output and returns an image with an option to resize the image.\"]}],[\"$\",\"$Le\",\"6\",{\"variant\":\"p\",\"component\":\"p\",\"sx\":{\"textAlign\":\"justify\",\"marginBottom\":2},\"children\":[\"$undefined\",\"1. \",[\"$\",\"$Lc\",\"6-text-italics\",{\"component\":\"span\",\"sx\":{\"paddingLeft\":0.5,\"paddingRight\":0.5,\"borderRadius\":1,\"backgroundColor\":\"rgb(227, 234, 242)\"},\"children\":\"forward\"}],\": the function used for inference.\"]}],[\"$\",\"$Lc\",null,{\"sx\":{\"width\":\"100%\",\"marginBottom\":2},\"children\":[[\"$\",\"$L1c\",null,{\"contentToCopy\":\"$1d\"}],[\"$\",\"pre\",null,{\"style\":{\"color\":\"#111b27\",\"background\":\"#e3eaf2\",\"fontFamily\":\"Consolas, Monaco, \\\"Andale Mono\\\", \\\"Ubuntu Mono\\\", monospace\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":0,\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-python\",\"style\":{\"color\":\"#111b27\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, \\\"Andale Mono\\\", \\\"Ubuntu Mono\\\", monospace\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"code-segement0\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"from\"]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" segmentation_models_pytorch \"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"import\"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" UnetPlusPlus\\n\"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"import\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" torch\\n\"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"import\"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" torch\"]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"nn\"]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"functional \"]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"as\"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" F\\n\"]}],[\"$\",\"span\",\"code-segement16\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"from\"]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" torchvision \"]}],[\"$\",\"span\",\"code-segement19\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"import\"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" transforms\\n\"]}],\"\\n\",\"\\n\",[\"$\",\"span\",\"code-segement23\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"class\"]}],[\"$\",\"span\",\"code-segement25\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement26\",{\"className\":\"token\",\"style\":{\"color\":\"#005a8e\"},\"children\":[\"Model\"]}],[\"$\",\"span\",\"code-segement27\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement28\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement29\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement30\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"def\"]}],[\"$\",\"span\",\"code-segement31\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement32\",{\"className\":\"token\",\"style\":{\"color\":\"#7c00aa\"},\"children\":[\"__init__\"]}],[\"$\",\"span\",\"code-segement33\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement34\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"self\"]}],[\"$\",\"span\",\"code-segement35\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement36\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" weights_path\"]}],[\"$\",\"span\",\"code-segement37\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement38\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" use_cuda\"]}],[\"$\",\"span\",\"code-segement39\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement40\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"False\"]}],[\"$\",\"span\",\"code-segement41\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement42\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement43\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement44\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        self\"]}],[\"$\",\"span\",\"code-segement45\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement46\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"using_cuda \"]}],[\"$\",\"span\",\"code-segement47\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement48\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" use_cuda \"]}],[\"$\",\"span\",\"code-segement49\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"and\"]}],[\"$\",\"span\",\"code-segement50\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" torch\"]}],[\"$\",\"span\",\"code-segement51\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement52\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"cuda\"]}],[\"$\",\"span\",\"code-segement53\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement54\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"is_available\"]}],[\"$\",\"span\",\"code-segement55\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement56\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement57\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement58\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        self\"]}],[\"$\",\"span\",\"code-segement59\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement60\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"device \"]}],[\"$\",\"span\",\"code-segement61\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement62\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" torch\"]}],[\"$\",\"span\",\"code-segement63\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement64\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"device\"]}],[\"$\",\"span\",\"code-segement65\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement66\",{\"className\":\"token\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"\\\"cuda\\\"\"]}],[\"$\",\"span\",\"code-segement67\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement68\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement69\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"if\"]}],[\"$\",\"span\",\"code-segement70\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" self\"]}],[\"$\",\"span\",\"code-segement71\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement72\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"using_cuda \"]}],[\"$\",\"span\",\"code-segement73\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"else\"]}],[\"$\",\"span\",\"code-segement74\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" torch\"]}],[\"$\",\"span\",\"code-segement75\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement76\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"device\"]}],[\"$\",\"span\",\"code-segement77\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement78\",{\"className\":\"token\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"\\\"cpu\\\"\"]}],[\"$\",\"span\",\"code-segement79\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement80\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement81\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        self\"]}],[\"$\",\"span\",\"code-segement82\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement83\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"dtype \"]}],[\"$\",\"span\",\"code-segement84\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement85\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" torch\"]}],[\"$\",\"span\",\"code-segement86\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement87\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"cuda\"]}],[\"$\",\"span\",\"code-segement88\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement89\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"FloatTensor \"]}],[\"$\",\"span\",\"code-segement90\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"if\"]}],[\"$\",\"span\",\"code-segement91\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" self\"]}],[\"$\",\"span\",\"code-segement92\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement93\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"using_cuda \"]}],[\"$\",\"span\",\"code-segement94\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"else\"]}],[\"$\",\"span\",\"code-segement95\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" torch\"]}],[\"$\",\"span\",\"code-segement96\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement97\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"Tensor\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement99\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        self\"]}],[\"$\",\"span\",\"code-segement100\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement101\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"model \"]}],[\"$\",\"span\",\"code-segement102\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement103\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" UnetPlusPlus\"]}],[\"$\",\"span\",\"code-segement104\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement105\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement106\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            encoder_name\"]}],[\"$\",\"span\",\"code-segement107\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement108\",{\"className\":\"token\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"\\\"resnet34\\\"\"]}],[\"$\",\"span\",\"code-segement109\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement110\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement111\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            encoder_depth\"]}],[\"$\",\"span\",\"code-segement112\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement113\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"4\"]}],[\"$\",\"span\",\"code-segement114\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement115\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement116\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            encoder_weights\"]}],[\"$\",\"span\",\"code-segement117\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement118\",{\"className\":\"token\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"\\\"imagenet\\\"\"]}],[\"$\",\"span\",\"code-segement119\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement120\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement121\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            decoder_channels\"]}],[\"$\",\"span\",\"code-segement122\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement123\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement124\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"256\"]}],[\"$\",\"span\",\"code-segement125\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement126\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement127\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"128\"]}],[\"$\",\"span\",\"code-segement128\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement129\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement130\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"64\"]}],[\"$\",\"span\",\"code-segement131\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement132\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement133\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"32\"]}],[\"$\",\"span\",\"code-segement134\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement135\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement136\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement137\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            in_channels\"]}],[\"$\",\"span\",\"code-segement138\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement139\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"1\"]}],[\"$\",\"span\",\"code-segement140\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement141\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement142\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            classes\"]}],[\"$\",\"span\",\"code-segement143\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement144\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"1\"]}],[\"$\",\"span\",\"code-segement145\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement146\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement147\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            activation\"]}],[\"$\",\"span\",\"code-segement148\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement149\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"None\"]}],[\"$\",\"span\",\"code-segement150\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement151\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement152\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            aux_params\"]}],[\"$\",\"span\",\"code-segement153\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement154\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"None\"]}],[\"$\",\"span\",\"code-segement155\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement156\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement157\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement158\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement160\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        self\"]}],[\"$\",\"span\",\"code-segement161\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement162\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"model \"]}],[\"$\",\"span\",\"code-segement163\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement164\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" self\"]}],[\"$\",\"span\",\"code-segement165\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement166\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"model\"]}],[\"$\",\"span\",\"code-segement167\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement168\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"to\"]}],[\"$\",\"span\",\"code-segement169\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement170\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"self\"]}],[\"$\",\"span\",\"code-segement171\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement172\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"device\"]}],[\"$\",\"span\",\"code-segement173\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement174\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement175\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        self\"]}],[\"$\",\"span\",\"code-segement176\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement177\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"model\"]}],[\"$\",\"span\",\"code-segement178\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement179\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"load_state_dict\"]}],[\"$\",\"span\",\"code-segement180\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement181\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"torch\"]}],[\"$\",\"span\",\"code-segement182\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement183\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"load\"]}],[\"$\",\"span\",\"code-segement184\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement185\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"weights_path\"]}],[\"$\",\"span\",\"code-segement186\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement187\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" map_location\"]}],[\"$\",\"span\",\"code-segement188\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement189\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"self\"]}],[\"$\",\"span\",\"code-segement190\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement191\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"device\"]}],[\"$\",\"span\",\"code-segement192\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement193\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement194\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement196\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        self\"]}],[\"$\",\"span\",\"code-segement197\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement198\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"preprocessing_transform \"]}],[\"$\",\"span\",\"code-segement199\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement200\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" transforms\"]}],[\"$\",\"span\",\"code-segement201\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement202\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"Compose\"]}],[\"$\",\"span\",\"code-segement203\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement204\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement205\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement206\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            transforms\"]}],[\"$\",\"span\",\"code-segement207\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement208\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"ToTensor\"]}],[\"$\",\"span\",\"code-segement209\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement210\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement211\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement212\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement213\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            transforms\"]}],[\"$\",\"span\",\"code-segement214\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement215\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"Resize\"]}],[\"$\",\"span\",\"code-segement216\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement217\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"size\"]}],[\"$\",\"span\",\"code-segement218\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement219\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement220\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"256\"]}],[\"$\",\"span\",\"code-segement221\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement222\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement223\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"256\"]}],[\"$\",\"span\",\"code-segement224\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement225\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement226\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement227\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement228\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement229\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement230\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement232\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement233\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"if\"]}],[\"$\",\"span\",\"code-segement234\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" use_cuda \"]}],[\"$\",\"span\",\"code-segement235\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"and\"]}],[\"$\",\"span\",\"code-segement236\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement237\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"not\"]}],[\"$\",\"span\",\"code-segement238\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" self\"]}],[\"$\",\"span\",\"code-segement239\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement240\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"using_cuda\"]}],[\"$\",\"span\",\"code-segement241\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement242\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement243\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement244\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"print\"]}],[\"$\",\"span\",\"code-segement245\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement246\",{\"className\":\"token\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"\\\"CUDA is not available to Torch, using CPU instead.\\\"\"]}],[\"$\",\"span\",\"code-segement247\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement248\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement250\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement251\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"def\"]}],[\"$\",\"span\",\"code-segement252\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement253\",{\"className\":\"token\",\"style\":{\"color\":\"#7c00aa\"},\"children\":[\"preprocess\"]}],[\"$\",\"span\",\"code-segement254\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement255\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"self\"]}],[\"$\",\"span\",\"code-segement256\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement257\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" images\"]}],[\"$\",\"span\",\"code-segement258\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement259\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement260\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement261\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        transformed_images \"]}],[\"$\",\"span\",\"code-segement262\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement263\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" torch\"]}],[\"$\",\"span\",\"code-segement264\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement265\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"stack\"]}],[\"$\",\"span\",\"code-segement266\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement267\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement268\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"self\"]}],[\"$\",\"span\",\"code-segement269\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement270\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"preprocessing_transform\"]}],[\"$\",\"span\",\"code-segement271\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement272\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"image\"]}],[\"$\",\"span\",\"code-segement273\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement274\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement275\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"for\"]}],[\"$\",\"span\",\"code-segement276\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" image \"]}],[\"$\",\"span\",\"code-segement277\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"in\"]}],[\"$\",\"span\",\"code-segement278\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" images\"]}],[\"$\",\"span\",\"code-segement279\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement280\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement281\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement282\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        transformed_images \"]}],[\"$\",\"span\",\"code-segement283\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement284\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" transformed_images\"]}],[\"$\",\"span\",\"code-segement285\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement286\",{\"className\":\"token\",\"style\":{\"color\":\"#af00af\"},\"children\":[\"type\"]}],[\"$\",\"span\",\"code-segement287\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement288\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"self\"]}],[\"$\",\"span\",\"code-segement289\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement290\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"dtype\"]}],[\"$\",\"span\",\"code-segement291\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement292\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement294\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        batched_images \"]}],[\"$\",\"span\",\"code-segement295\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement296\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" transformed_images\"]}],[\"$\",\"span\",\"code-segement297\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement298\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"to\"]}],[\"$\",\"span\",\"code-segement299\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement300\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"self\"]}],[\"$\",\"span\",\"code-segement301\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement302\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"device\"]}],[\"$\",\"span\",\"code-segement303\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement304\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement306\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement307\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"return\"]}],[\"$\",\"span\",\"code-segement308\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" batched_images\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement310\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement311\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"def\"]}],[\"$\",\"span\",\"code-segement312\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement313\",{\"className\":\"token\",\"style\":{\"color\":\"#7c00aa\"},\"children\":[\"postprocess\"]}],[\"$\",\"span\",\"code-segement314\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement315\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"self\"]}],[\"$\",\"span\",\"code-segement316\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement317\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" output\"]}],[\"$\",\"span\",\"code-segement318\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement319\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" output_size\"]}],[\"$\",\"span\",\"code-segement320\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement321\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement322\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"256\"]}],[\"$\",\"span\",\"code-segement323\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement324\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement325\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"256\"]}],[\"$\",\"span\",\"code-segement326\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement327\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement328\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement329\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement330\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        output \"]}],[\"$\",\"span\",\"code-segement331\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement332\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" output\"]}],[\"$\",\"span\",\"code-segement333\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement334\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"0\"]}],[\"$\",\"span\",\"code-segement335\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement336\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement337\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        output \"]}],[\"$\",\"span\",\"code-segement338\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement339\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" output\"]}],[\"$\",\"span\",\"code-segement340\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement341\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"ge\"]}],[\"$\",\"span\",\"code-segement342\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement343\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"0.5\"]}],[\"$\",\"span\",\"code-segement344\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement345\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement346\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        output \"]}],[\"$\",\"span\",\"code-segement347\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement348\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" F\"]}],[\"$\",\"span\",\"code-segement349\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement350\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"interpolate\"]}],[\"$\",\"span\",\"code-segement351\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement352\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"output\"]}],[\"$\",\"span\",\"code-segement353\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement354\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"unsqueeze\"]}],[\"$\",\"span\",\"code-segement355\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement356\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"0\"]}],[\"$\",\"span\",\"code-segement357\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement358\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement359\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"unsqueeze\"]}],[\"$\",\"span\",\"code-segement360\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement361\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"0\"]}],[\"$\",\"span\",\"code-segement362\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement363\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement364\",{\"className\":\"token\",\"style\":{\"color\":\"#af00af\"},\"children\":[\"float\"]}],[\"$\",\"span\",\"code-segement365\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement366\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement367\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement368\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" size\"]}],[\"$\",\"span\",\"code-segement369\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement370\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"output_size\"]}],[\"$\",\"span\",\"code-segement371\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement372\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" mode\"]}],[\"$\",\"span\",\"code-segement373\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement374\",{\"className\":\"token\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"\\\"nearest\\\"\"]}],[\"$\",\"span\",\"code-segement375\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement376\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement377\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        output \"]}],[\"$\",\"span\",\"code-segement378\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement379\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" output\"]}],[\"$\",\"span\",\"code-segement380\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement381\",{\"className\":\"token\",\"style\":{\"color\":\"#af00af\"},\"children\":[\"bool\"]}],[\"$\",\"span\",\"code-segement382\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement383\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement384\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement385\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"squeeze\"]}],[\"$\",\"span\",\"code-segement386\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement387\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"0\"]}],[\"$\",\"span\",\"code-segement388\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement389\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement390\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"squeeze\"]}],[\"$\",\"span\",\"code-segement391\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement392\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"0\"]}],[\"$\",\"span\",\"code-segement393\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement394\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement396\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement397\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"if\"]}],[\"$\",\"span\",\"code-segement398\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" self\"]}],[\"$\",\"span\",\"code-segement399\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement400\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"using_cuda\"]}],[\"$\",\"span\",\"code-segement401\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement402\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement403\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            output \"]}],[\"$\",\"span\",\"code-segement404\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement405\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" output\"]}],[\"$\",\"span\",\"code-segement406\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement407\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"cpu\"]}],[\"$\",\"span\",\"code-segement408\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement409\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement410\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement412\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        output \"]}],[\"$\",\"span\",\"code-segement413\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement414\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" output\"]}],[\"$\",\"span\",\"code-segement415\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement416\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"numpy\"]}],[\"$\",\"span\",\"code-segement417\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement418\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement419\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement421\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement422\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"return\"]}],[\"$\",\"span\",\"code-segement423\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" output\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement425\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement426\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"def\"]}],[\"$\",\"span\",\"code-segement427\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement428\",{\"className\":\"token\",\"style\":{\"color\":\"#7c00aa\"},\"children\":[\"forward\"]}],[\"$\",\"span\",\"code-segement429\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement430\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"self\"]}],[\"$\",\"span\",\"code-segement431\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement432\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" preprocessed_images\"]}],[\"$\",\"span\",\"code-segement433\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement434\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement435\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement436\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        output \"]}],[\"$\",\"span\",\"code-segement437\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement438\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" self\"]}],[\"$\",\"span\",\"code-segement439\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement440\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"model\"]}],[\"$\",\"span\",\"code-segement441\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement442\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"forward\"]}],[\"$\",\"span\",\"code-segement443\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement444\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"preprocessed_images\"]}],[\"$\",\"span\",\"code-segement445\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement446\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement447\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        output \"]}],[\"$\",\"span\",\"code-segement448\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement449\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" torch\"]}],[\"$\",\"span\",\"code-segement450\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement451\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"sigmoid\"]}],[\"$\",\"span\",\"code-segement452\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement453\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"output\"]}],[\"$\",\"span\",\"code-segement454\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement455\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement456\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        output \"]}],[\"$\",\"span\",\"code-segement457\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement458\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" output\"]}],[\"$\",\"span\",\"code-segement459\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement460\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"detach\"]}],[\"$\",\"span\",\"code-segement461\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement462\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement463\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement465\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement466\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"return\"]}],[\"$\",\"span\",\"code-segement467\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" output\"]}]]]}]}]]}],[\"$\",\"$Le\",\"8\",{\"id\":\"cpu-and-gpu\",\"variant\":\"h5\",\"component\":\"h2\",\"mb\":2,\"children\":[\"$\",\"strong\",null,{\"children\":\"CPU and GPU\"}]}],[\"$\",\"$Le\",\"9\",{\"variant\":\"p\",\"component\":\"p\",\"sx\":{\"textAlign\":\"justify\",\"marginBottom\":2},\"children\":[\"$undefined\",\"In the following three lines, define \",[\"$\",\"$Lc\",\"9-text-italics\",{\"component\":\"span\",\"sx\":{\"paddingLeft\":0.5,\"paddingRight\":0.5,\"borderRadius\":1,\"backgroundColor\":\"rgb(227, 234, 242)\"},\"children\":\"self.device\"}],\" and \",[\"$\",\"$Lc\",\"9-text-italics\",{\"component\":\"span\",\"sx\":{\"paddingLeft\":0.5,\"paddingRight\":0.5,\"borderRadius\":1,\"backgroundColor\":\"rgb(227, 234, 242)\"},\"children\":\"self.dtype\"}],\" based on whether the constructor was called with the instruction to use CUDA and if CUDA is actually available to torch.\"]}],[\"$\",\"$Lc\",null,{\"sx\":{\"width\":\"100%\",\"marginBottom\":2},\"children\":[[\"$\",\"$L1c\",null,{\"contentToCopy\":\"self.using_cuda = use_cuda and torch.cuda.is_available()\\nself.device = torch.device(\\\"cuda\\\") if self.using_cuda else torch.device(\\\"cpu\\\")\\nself.dtype = torch.cuda.FloatTensor if self.using_cuda else torch.Tensor\"}],[\"$\",\"pre\",null,{\"style\":{\"color\":\"#111b27\",\"background\":\"#e3eaf2\",\"fontFamily\":\"Consolas, Monaco, \\\"Andale Mono\\\", \\\"Ubuntu Mono\\\", monospace\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":0,\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-python\",\"style\":{\"color\":\"#111b27\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, \\\"Andale Mono\\\", \\\"Ubuntu Mono\\\", monospace\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"code-segement0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"self\"]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"using_cuda \"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" use_cuda \"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"and\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" torch\"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"cuda\"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"is_available\"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"self\"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement16\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"device \"]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" torch\"]}],[\"$\",\"span\",\"code-segement19\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"device\"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement22\",{\"className\":\"token\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"\\\"cuda\\\"\"]}],[\"$\",\"span\",\"code-segement23\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement25\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"if\"]}],[\"$\",\"span\",\"code-segement26\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" self\"]}],[\"$\",\"span\",\"code-segement27\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement28\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"using_cuda \"]}],[\"$\",\"span\",\"code-segement29\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"else\"]}],[\"$\",\"span\",\"code-segement30\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" torch\"]}],[\"$\",\"span\",\"code-segement31\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement32\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"device\"]}],[\"$\",\"span\",\"code-segement33\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement34\",{\"className\":\"token\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"\\\"cpu\\\"\"]}],[\"$\",\"span\",\"code-segement35\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement36\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement37\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"self\"]}],[\"$\",\"span\",\"code-segement38\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement39\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"dtype \"]}],[\"$\",\"span\",\"code-segement40\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement41\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" torch\"]}],[\"$\",\"span\",\"code-segement42\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement43\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"cuda\"]}],[\"$\",\"span\",\"code-segement44\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement45\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"FloatTensor \"]}],[\"$\",\"span\",\"code-segement46\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"if\"]}],[\"$\",\"span\",\"code-segement47\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" self\"]}],[\"$\",\"span\",\"code-segement48\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement49\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"using_cuda \"]}],[\"$\",\"span\",\"code-segement50\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"else\"]}],[\"$\",\"span\",\"code-segement51\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" torch\"]}],[\"$\",\"span\",\"code-segement52\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement53\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"Tensor\"]}]]]}]}]]}],[\"$\",\"$Le\",\"11\",{\"variant\":\"p\",\"component\":\"p\",\"sx\":{\"textAlign\":\"justify\",\"marginBottom\":2},\"children\":[\"$undefined\",\"We load the model to the \",[\"$\",\"$Lc\",\"11-text-italics\",{\"component\":\"span\",\"sx\":{\"paddingLeft\":0.5,\"paddingRight\":0.5,\"borderRadius\":1,\"backgroundColor\":\"rgb(227, 234, 242)\"},\"children\":\"device\"}],\".\"]}],[\"$\",\"$Lc\",null,{\"sx\":{\"width\":\"100%\",\"marginBottom\":2},\"children\":[[\"$\",\"$L1c\",null,{\"contentToCopy\":\"self.model = self.model.to(self.device)\\nself.model.load_state_dict(torch.load(weights_path, map_location=self.device))\"}],[\"$\",\"pre\",null,{\"style\":{\"color\":\"#111b27\",\"background\":\"#e3eaf2\",\"fontFamily\":\"Consolas, Monaco, \\\"Andale Mono\\\", \\\"Ubuntu Mono\\\", monospace\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":0,\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-python\",\"style\":{\"color\":\"#111b27\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, \\\"Andale Mono\\\", \\\"Ubuntu Mono\\\", monospace\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"code-segement0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"self\"]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"model \"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" self\"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"model\"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"to\"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"self\"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"device\"]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"self\"]}],[\"$\",\"span\",\"code-segement16\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"model\"]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement19\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"load_state_dict\"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"torch\"]}],[\"$\",\"span\",\"code-segement22\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement23\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"load\"]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement25\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"weights_path\"]}],[\"$\",\"span\",\"code-segement26\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement27\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" map_location\"]}],[\"$\",\"span\",\"code-segement28\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement29\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"self\"]}],[\"$\",\"span\",\"code-segement30\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement31\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"device\"]}],[\"$\",\"span\",\"code-segement32\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement33\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}]]]}]}]]}],[\"$\",\"$Le\",\"13\",{\"variant\":\"p\",\"component\":\"p\",\"sx\":{\"textAlign\":\"justify\",\"marginBottom\":2},\"children\":[\"$undefined\",\"And, in the preprocessing function, we transfer our batched images to the device as well.\"]}],[\"$\",\"$Lc\",null,{\"sx\":{\"width\":\"100%\",\"marginBottom\":2},\"children\":[[\"$\",\"$L1c\",null,{\"contentToCopy\":\"batched_images = transformed_images.to(self.device)\"}],[\"$\",\"pre\",null,{\"style\":{\"color\":\"#111b27\",\"background\":\"#e3eaf2\",\"fontFamily\":\"Consolas, Monaco, \\\"Andale Mono\\\", \\\"Ubuntu Mono\\\", monospace\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":0,\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-python\",\"style\":{\"color\":\"#111b27\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, \\\"Andale Mono\\\", \\\"Ubuntu Mono\\\", monospace\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"code-segement0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"batched_images \"]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" transformed_images\"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"to\"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"self\"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"device\"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}]]]}]}]]}],[\"$\",\"$Le\",\"15\",{\"variant\":\"p\",\"component\":\"p\",\"sx\":{\"textAlign\":\"justify\",\"marginBottom\":2},\"children\":[\"$undefined\",\"In the src directory, we'll make another file \",[\"$\",\"$Lc\",\"15-text-italics\",{\"component\":\"span\",\"sx\":{\"paddingLeft\":0.5,\"paddingRight\":0.5,\"borderRadius\":1,\"backgroundColor\":\"rgb(227, 234, 242)\"},\"children\":\"config.py\"}],\" to store the directories we will be using for testing.\"]}],[\"$\",\"$Lc\",null,{\"sx\":{\"width\":\"100%\",\"marginBottom\":2},\"children\":[[\"$\",\"$L1c\",null,{\"contentToCopy\":\"from os.path import dirname, join as path_join\\n\\n\\ninputs_dir = path_join(dirname(dirname(__file__)), \\\"inputs\\\")\\nweights_dir = path_join(dirname(dirname(__file__)), \\\"weights\\\")\\noutputs_dir = path_join(dirname(dirname(__file__)), \\\"outputs\\\")\"}],[\"$\",\"pre\",null,{\"style\":{\"color\":\"#111b27\",\"background\":\"#e3eaf2\",\"fontFamily\":\"Consolas, Monaco, \\\"Andale Mono\\\", \\\"Ubuntu Mono\\\", monospace\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":0,\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-python\",\"style\":{\"color\":\"#111b27\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, \\\"Andale Mono\\\", \\\"Ubuntu Mono\\\", monospace\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"code-segement0\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"from\"]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" os\"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"path \"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"import\"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" dirname\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" join \"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"as\"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" path_join\\n\"]}],\"\\n\",\"\\n\",[\"$\",\"span\",\"code-segement12\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"inputs_dir \"]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" path_join\"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement16\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"dirname\"]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"dirname\"]}],[\"$\",\"span\",\"code-segement19\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"__file__\"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement22\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement23\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement25\",{\"className\":\"token\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"\\\"inputs\\\"\"]}],[\"$\",\"span\",\"code-segement26\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement27\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement28\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"weights_dir \"]}],[\"$\",\"span\",\"code-segement29\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement30\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" path_join\"]}],[\"$\",\"span\",\"code-segement31\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement32\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"dirname\"]}],[\"$\",\"span\",\"code-segement33\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement34\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"dirname\"]}],[\"$\",\"span\",\"code-segement35\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement36\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"__file__\"]}],[\"$\",\"span\",\"code-segement37\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement38\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement39\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement40\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement41\",{\"className\":\"token\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"\\\"weights\\\"\"]}],[\"$\",\"span\",\"code-segement42\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement43\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement44\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"outputs_dir \"]}],[\"$\",\"span\",\"code-segement45\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement46\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" path_join\"]}],[\"$\",\"span\",\"code-segement47\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement48\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"dirname\"]}],[\"$\",\"span\",\"code-segement49\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement50\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"dirname\"]}],[\"$\",\"span\",\"code-segement51\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement52\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"__file__\"]}],[\"$\",\"span\",\"code-segement53\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement54\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement55\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement56\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement57\",{\"className\":\"token\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"\\\"outputs\\\"\"]}],[\"$\",\"span\",\"code-segement58\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}]]]}]}]]}],[\"$\",\"$Le\",\"17\",{\"variant\":\"p\",\"component\":\"p\",\"sx\":{\"textAlign\":\"justify\",\"marginBottom\":2},\"children\":[\"$undefined\",\"Let us also create these three folders, here is what the project's directory structure should look like after doing so.\"]}],[\"$\",\"$Lc\",null,{\"sx\":{\"width\":\"100%\",\"marginBottom\":2},\"children\":[[\"$\",\"$L1c\",null,{\"contentToCopy\":\"inputs\\n       sample_image.png\\n\\noutputs\\n       sample_mask.png\\n\\nsrc\\n       config.py\\n       model.py\\n       test.py\\n\\nweights\\n        weights_001.pt\"}],[\"$\",\"pre\",null,{\"style\":{\"color\":\"#111b27\",\"background\":\"#e3eaf2\",\"fontFamily\":\"Consolas, Monaco, \\\"Andale Mono\\\", \\\"Ubuntu Mono\\\", monospace\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":0,\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-bash\",\"style\":{\"color\":\"#111b27\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, \\\"Andale Mono\\\", \\\"Ubuntu Mono\\\", monospace\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"code-segement0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"inputs\\n\"]}],\"       sample_image.png\\n\",\"\\n\",\"outputs\\n\",\"       sample_mask.png\\n\",\"\\n\",\"src\\n\",\"       config.py\\n\",\"       model.py\\n\",\"       test.py\\n\",\"\\n\",\"weights\\n\",\"        weights_001.pt\"]]}]}]]}],[\"$\",\"$Le\",\"19\",{\"id\":\"testing-code\",\"variant\":\"h5\",\"component\":\"h2\",\"mb\":2,\"children\":[\"$\",\"strong\",null,{\"children\":\"Testing Code\"}]}],[\"$\",\"$Le\",\"20\",{\"variant\":\"p\",\"component\":\"p\",\"sx\":{\"textAlign\":\"justify\",\"marginBottom\":2},\"children\":[\"$undefined\",\"Let's work on the \",[\"$\",\"$Lc\",\"20-text-italics\",{\"component\":\"span\",\"sx\":{\"paddingLeft\":0.5,\"paddingRight\":0.5,\"borderRadius\":1,\"backgroundColor\":\"rgb(227, 234, 242)\"},\"children\":\"src/test.py\"}],\" file. Our input images are located in the \",[\"$\",\"$Lc\",\"20-text-italics\",{\"component\":\"span\",\"sx\":{\"paddingLeft\":0.5,\"paddingRight\":0.5,\"borderRadius\":1,\"backgroundColor\":\"rgb(227, 234, 242)\"},\"children\":\"inputs\"}],\" folder and model weights are in the \",[\"$\",\"$Lc\",\"20-text-italics\",{\"component\":\"span\",\"sx\":{\"paddingLeft\":0.5,\"paddingRight\":0.5,\"borderRadius\":1,\"backgroundColor\":\"rgb(227, 234, 242)\"},\"children\":\"weights\"}],\" folder.\"]}],[\"$\",\"$Lc\",null,{\"sx\":{\"width\":\"100%\",\"marginBottom\":2},\"children\":[[\"$\",\"$L1c\",null,{\"contentToCopy\":\"from os import listdir\\nfrom os.path import join as path_join\\nfrom time import time\\n\\nimport cv2\\nimport numpy as np\\n\\nfrom config import inputs_dir, outputs_dir, weights_dir\\nfrom model import Model\\n\\n\\nif __name__ == \\\"__main__\\\":\\n    test_images = [cv2.imread(path_join(inputs_dir, image_name), cv2.IMREAD_GRAYSCALE) for image_name in listdir(inputs_dir)]\\n    print(\\\"Images loaded.\\\")\\n\\n    model = Model(path_join(weights_dir, \\\"weights_001.pt\\\"))\\n    print(\\\"Model loaded.\\\")\"}],[\"$\",\"pre\",null,{\"style\":{\"color\":\"#111b27\",\"background\":\"#e3eaf2\",\"fontFamily\":\"Consolas, Monaco, \\\"Andale Mono\\\", \\\"Ubuntu Mono\\\", monospace\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":0,\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-python\",\"style\":{\"color\":\"#111b27\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, \\\"Andale Mono\\\", \\\"Ubuntu Mono\\\", monospace\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"code-segement0\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"from\"]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" os \"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"import\"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" listdir\\n\"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"from\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" os\"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"path \"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"import\"]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" join \"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"as\"]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" path_join\\n\"]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"from\"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" time \"]}],[\"$\",\"span\",\"code-segement16\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"import\"]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" time\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement19\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"import\"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" cv2\\n\"]}],[\"$\",\"span\",\"code-segement22\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement23\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"import\"]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" numpy \"]}],[\"$\",\"span\",\"code-segement25\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"as\"]}],[\"$\",\"span\",\"code-segement26\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" np\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement28\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement29\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"from\"]}],[\"$\",\"span\",\"code-segement30\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" config \"]}],[\"$\",\"span\",\"code-segement31\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"import\"]}],[\"$\",\"span\",\"code-segement32\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" inputs_dir\"]}],[\"$\",\"span\",\"code-segement33\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement34\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" outputs_dir\"]}],[\"$\",\"span\",\"code-segement35\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement36\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" weights_dir\\n\"]}],[\"$\",\"span\",\"code-segement37\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement38\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"from\"]}],[\"$\",\"span\",\"code-segement39\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" model \"]}],[\"$\",\"span\",\"code-segement40\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"import\"]}],[\"$\",\"span\",\"code-segement41\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" Model\\n\"]}],\"\\n\",\"\\n\",[\"$\",\"span\",\"code-segement44\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement45\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"if\"]}],[\"$\",\"span\",\"code-segement46\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" __name__ \"]}],[\"$\",\"span\",\"code-segement47\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"==\"]}],[\"$\",\"span\",\"code-segement48\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement49\",{\"className\":\"token\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"\\\"__main__\\\"\"]}],[\"$\",\"span\",\"code-segement50\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement51\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement52\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    test_images \"]}],[\"$\",\"span\",\"code-segement53\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement54\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement55\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement56\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"cv2\"]}],[\"$\",\"span\",\"code-segement57\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement58\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"imread\"]}],[\"$\",\"span\",\"code-segement59\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement60\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"path_join\"]}],[\"$\",\"span\",\"code-segement61\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement62\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"inputs_dir\"]}],[\"$\",\"span\",\"code-segement63\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement64\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" image_name\"]}],[\"$\",\"span\",\"code-segement65\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement66\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement67\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" cv2\"]}],[\"$\",\"span\",\"code-segement68\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement69\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"IMREAD_GRAYSCALE\"]}],[\"$\",\"span\",\"code-segement70\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement71\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement72\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"for\"]}],[\"$\",\"span\",\"code-segement73\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" image_name \"]}],[\"$\",\"span\",\"code-segement74\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"in\"]}],[\"$\",\"span\",\"code-segement75\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" listdir\"]}],[\"$\",\"span\",\"code-segement76\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement77\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"inputs_dir\"]}],[\"$\",\"span\",\"code-segement78\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement79\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement80\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement81\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement82\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"print\"]}],[\"$\",\"span\",\"code-segement83\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement84\",{\"className\":\"token\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"\\\"Images loaded.\\\"\"]}],[\"$\",\"span\",\"code-segement85\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement86\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement88\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    model \"]}],[\"$\",\"span\",\"code-segement89\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement90\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" Model\"]}],[\"$\",\"span\",\"code-segement91\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement92\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"path_join\"]}],[\"$\",\"span\",\"code-segement93\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement94\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"weights_dir\"]}],[\"$\",\"span\",\"code-segement95\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement96\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement97\",{\"className\":\"token\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"\\\"weights_001.pt\\\"\"]}],[\"$\",\"span\",\"code-segement98\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement99\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement100\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement101\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement102\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"print\"]}],[\"$\",\"span\",\"code-segement103\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement104\",{\"className\":\"token\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"\\\"Model loaded.\\\"\"]}],[\"$\",\"span\",\"code-segement105\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}]]]}]}]]}],[\"$\",\"$Le\",\"22\",{\"variant\":\"p\",\"component\":\"p\",\"sx\":{\"textAlign\":\"justify\",\"marginBottom\":2},\"children\":[\"$undefined\",\"Next, we can iterate over each of the test images, preprocess them, run a forward pass, postprocess, and save the output.\"]}],[\"$\",\"$Lc\",null,{\"sx\":{\"width\":\"100%\",\"marginBottom\":2},\"children\":[[\"$\",\"$L1c\",null,{\"contentToCopy\":\"start_time = time()\\n\\noutputs = []\\nfor i, test_image in enumerate(test_images):\\n    preprocessed_image = model.preprocess([test_image])\\n    output = model.forward(preprocessed_image)\\n    output = output.detach()\\n    outputs.append(output)\\n\\nend_time = time()\\ntime_elapsed = end_time - start_time\\nprint(\\n    f\\\"Num images: {len(test_images)}, \\\"\\n    f\\\"Batch size: {1}, \\\"\\n    f\\\"Time taken: {time_elapsed} s, \\\"\\n    f\\\"Time taken per image: {1000 * time_elapsed / len(test_images)} ms\\\"\\n)\\n\\nfor output in outputs:\\n    boolean_array = model.postprocess(output[0], (512, 512))\\n    binary_image = boolean_array.astype(np.uint8) * 255\\n    file_path = path_join(outputs_dir, f\\\"{i}.png\\\")\\n    cv2.imwrite(file_path, binary_image)\"}],[\"$\",\"pre\",null,{\"style\":{\"color\":\"#111b27\",\"background\":\"#e3eaf2\",\"fontFamily\":\"Consolas, Monaco, \\\"Andale Mono\\\", \\\"Ubuntu Mono\\\", monospace\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":0,\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-python\",\"style\":{\"color\":\"#111b27\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, \\\"Andale Mono\\\", \\\"Ubuntu Mono\\\", monospace\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"code-segement0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"start_time \"]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" time\"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement7\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"outputs \"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"for\"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" i\"]}],[\"$\",\"span\",\"code-segement16\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" test_image \"]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"in\"]}],[\"$\",\"span\",\"code-segement19\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"token\",\"style\":{\"color\":\"#af00af\"},\"children\":[\"enumerate\"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement22\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"test_images\"]}],[\"$\",\"span\",\"code-segement23\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement25\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement26\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    preprocessed_image \"]}],[\"$\",\"span\",\"code-segement27\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement28\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" model\"]}],[\"$\",\"span\",\"code-segement29\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement30\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"preprocess\"]}],[\"$\",\"span\",\"code-segement31\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement32\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement33\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"test_image\"]}],[\"$\",\"span\",\"code-segement34\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement35\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement36\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement37\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    output \"]}],[\"$\",\"span\",\"code-segement38\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement39\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" model\"]}],[\"$\",\"span\",\"code-segement40\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement41\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"forward\"]}],[\"$\",\"span\",\"code-segement42\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement43\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"preprocessed_image\"]}],[\"$\",\"span\",\"code-segement44\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement45\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement46\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    output \"]}],[\"$\",\"span\",\"code-segement47\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement48\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" output\"]}],[\"$\",\"span\",\"code-segement49\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement50\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"detach\"]}],[\"$\",\"span\",\"code-segement51\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement52\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement53\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement54\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    outputs\"]}],[\"$\",\"span\",\"code-segement55\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement56\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"append\"]}],[\"$\",\"span\",\"code-segement57\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement58\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"output\"]}],[\"$\",\"span\",\"code-segement59\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement60\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement62\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"end_time \"]}],[\"$\",\"span\",\"code-segement63\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement64\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" time\"]}],[\"$\",\"span\",\"code-segement65\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement66\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement67\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement68\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"time_elapsed \"]}],[\"$\",\"span\",\"code-segement69\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement70\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" end_time \"]}],[\"$\",\"span\",\"code-segement71\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"-\"]}],[\"$\",\"span\",\"code-segement72\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" start_time\\n\"]}],[\"$\",\"span\",\"code-segement73\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement74\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"print\"]}],[\"$\",\"span\",\"code-segement75\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement76\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement77\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement78\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"f\\\"Num images: \"]}],[\"$\",\"span\",\"code-segement79\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement80\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#af00af\"},\"children\":[\"len\"]}],[\"$\",\"span\",\"code-segement81\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement82\",{\"className\":\"token string-interpolation interpolation\",\"style\":{},\"children\":[\"test_images\"]}],[\"$\",\"span\",\"code-segement83\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement84\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement85\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\", \\\"\"]}],[\"$\",\"span\",\"code-segement86\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement87\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement88\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"f\\\"Batch size: \"]}],[\"$\",\"span\",\"code-segement89\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement90\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"1\"]}],[\"$\",\"span\",\"code-segement91\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement92\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\", \\\"\"]}],[\"$\",\"span\",\"code-segement93\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement94\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement95\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"f\\\"Time taken: \"]}],[\"$\",\"span\",\"code-segement96\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement97\",{\"className\":\"token string-interpolation interpolation\",\"style\":{},\"children\":[\"time_elapsed\"]}],[\"$\",\"span\",\"code-segement98\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement99\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\" s, \\\"\"]}],[\"$\",\"span\",\"code-segement100\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement101\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement102\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"f\\\"Time taken per image: \"]}],[\"$\",\"span\",\"code-segement103\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement104\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"1000\"]}],[\"$\",\"span\",\"code-segement105\",{\"className\":\"token string-interpolation interpolation\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement106\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement107\",{\"className\":\"token string-interpolation interpolation\",\"style\":{},\"children\":[\" time_elapsed \"]}],[\"$\",\"span\",\"code-segement108\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"/\"]}],[\"$\",\"span\",\"code-segement109\",{\"className\":\"token string-interpolation interpolation\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement110\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#af00af\"},\"children\":[\"len\"]}],[\"$\",\"span\",\"code-segement111\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement112\",{\"className\":\"token string-interpolation interpolation\",\"style\":{},\"children\":[\"test_images\"]}],[\"$\",\"span\",\"code-segement113\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement114\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement115\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\" ms\\\"\"]}],[\"$\",\"span\",\"code-segement116\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement117\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement118\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement119\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement121\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement122\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"for\"]}],[\"$\",\"span\",\"code-segement123\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" output \"]}],[\"$\",\"span\",\"code-segement124\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"in\"]}],[\"$\",\"span\",\"code-segement125\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" outputs\"]}],[\"$\",\"span\",\"code-segement126\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement127\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement128\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    boolean_array \"]}],[\"$\",\"span\",\"code-segement129\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement130\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" model\"]}],[\"$\",\"span\",\"code-segement131\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement132\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"postprocess\"]}],[\"$\",\"span\",\"code-segement133\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement134\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"output\"]}],[\"$\",\"span\",\"code-segement135\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement136\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"0\"]}],[\"$\",\"span\",\"code-segement137\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement138\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement139\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement140\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement141\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"512\"]}],[\"$\",\"span\",\"code-segement142\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement143\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement144\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"512\"]}],[\"$\",\"span\",\"code-segement145\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement146\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement147\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement148\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    binary_image \"]}],[\"$\",\"span\",\"code-segement149\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement150\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" boolean_array\"]}],[\"$\",\"span\",\"code-segement151\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement152\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"astype\"]}],[\"$\",\"span\",\"code-segement153\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement154\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"np\"]}],[\"$\",\"span\",\"code-segement155\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement156\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"uint8\"]}],[\"$\",\"span\",\"code-segement157\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement158\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement159\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement160\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement161\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"255\"]}],[\"$\",\"span\",\"code-segement162\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement163\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    file_path \"]}],[\"$\",\"span\",\"code-segement164\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement165\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" path_join\"]}],[\"$\",\"span\",\"code-segement166\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement167\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"outputs_dir\"]}],[\"$\",\"span\",\"code-segement168\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement169\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement170\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"f\\\"\"]}],[\"$\",\"span\",\"code-segement171\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement172\",{\"className\":\"token string-interpolation interpolation\",\"style\":{},\"children\":[\"i\"]}],[\"$\",\"span\",\"code-segement173\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement174\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\".png\\\"\"]}],[\"$\",\"span\",\"code-segement175\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement176\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement177\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    cv2\"]}],[\"$\",\"span\",\"code-segement178\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement179\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"imwrite\"]}],[\"$\",\"span\",\"code-segement180\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement181\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"file_path\"]}],[\"$\",\"span\",\"code-segement182\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement183\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" binary_image\"]}],[\"$\",\"span\",\"code-segement184\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}]]]}]}]]}],[\"$\",\"$Le\",\"24\",{\"variant\":\"p\",\"component\":\"p\",\"sx\":{\"textAlign\":\"justify\",\"marginBottom\":2},\"children\":[\"$undefined\",\"Here's the entire \",[\"$\",\"$Lc\",\"24-text-italics\",{\"component\":\"span\",\"sx\":{\"paddingLeft\":0.5,\"paddingRight\":0.5,\"borderRadius\":1,\"backgroundColor\":\"rgb(227, 234, 242)\"},\"children\":\"test.py\"}],\" file:\"]}],[\"$\",\"$Lc\",null,{\"sx\":{\"width\":\"100%\",\"marginBottom\":2},\"children\":[[\"$\",\"$L1c\",null,{\"contentToCopy\":\"$1e\"}],[\"$\",\"pre\",null,{\"style\":{\"color\":\"#111b27\",\"background\":\"#e3eaf2\",\"fontFamily\":\"Consolas, Monaco, \\\"Andale Mono\\\", \\\"Ubuntu Mono\\\", monospace\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":0,\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-python\",\"style\":{\"color\":\"#111b27\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, \\\"Andale Mono\\\", \\\"Ubuntu Mono\\\", monospace\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"code-segement0\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"from\"]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" os \"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"import\"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" listdir\\n\"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"from\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" os\"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"path \"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"import\"]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" join \"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"as\"]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" path_join\\n\"]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"from\"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" time \"]}],[\"$\",\"span\",\"code-segement16\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"import\"]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" time\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement19\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"import\"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" cv2\\n\"]}],[\"$\",\"span\",\"code-segement22\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement23\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"import\"]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" numpy \"]}],[\"$\",\"span\",\"code-segement25\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"as\"]}],[\"$\",\"span\",\"code-segement26\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" np\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement28\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement29\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"from\"]}],[\"$\",\"span\",\"code-segement30\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" config \"]}],[\"$\",\"span\",\"code-segement31\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"import\"]}],[\"$\",\"span\",\"code-segement32\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" inputs_dir\"]}],[\"$\",\"span\",\"code-segement33\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement34\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" outputs_dir\"]}],[\"$\",\"span\",\"code-segement35\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement36\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" weights_dir\\n\"]}],[\"$\",\"span\",\"code-segement37\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement38\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"from\"]}],[\"$\",\"span\",\"code-segement39\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" model \"]}],[\"$\",\"span\",\"code-segement40\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"import\"]}],[\"$\",\"span\",\"code-segement41\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" Model\\n\"]}],\"\\n\",\"\\n\",[\"$\",\"span\",\"code-segement44\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement45\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"if\"]}],[\"$\",\"span\",\"code-segement46\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" __name__ \"]}],[\"$\",\"span\",\"code-segement47\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"==\"]}],[\"$\",\"span\",\"code-segement48\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement49\",{\"className\":\"token\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"\\\"__main__\\\"\"]}],[\"$\",\"span\",\"code-segement50\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement51\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement52\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    test_images \"]}],[\"$\",\"span\",\"code-segement53\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement54\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement55\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement56\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement57\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement58\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    all_image_names \"]}],[\"$\",\"span\",\"code-segement59\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement60\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" listdir\"]}],[\"$\",\"span\",\"code-segement61\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement62\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"inputs_dir\"]}],[\"$\",\"span\",\"code-segement63\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement64\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement65\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement66\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"for\"]}],[\"$\",\"span\",\"code-segement67\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" i\"]}],[\"$\",\"span\",\"code-segement68\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement69\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" image_name \"]}],[\"$\",\"span\",\"code-segement70\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"in\"]}],[\"$\",\"span\",\"code-segement71\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement72\",{\"className\":\"token\",\"style\":{\"color\":\"#af00af\"},\"children\":[\"enumerate\"]}],[\"$\",\"span\",\"code-segement73\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement74\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"all_image_names\"]}],[\"$\",\"span\",\"code-segement75\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement76\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement77\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement78\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        image \"]}],[\"$\",\"span\",\"code-segement79\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement80\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" cv2\"]}],[\"$\",\"span\",\"code-segement81\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement82\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"imread\"]}],[\"$\",\"span\",\"code-segement83\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement84\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"path_join\"]}],[\"$\",\"span\",\"code-segement85\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement86\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"inputs_dir\"]}],[\"$\",\"span\",\"code-segement87\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement88\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" image_name\"]}],[\"$\",\"span\",\"code-segement89\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement90\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement91\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" cv2\"]}],[\"$\",\"span\",\"code-segement92\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement93\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"IMREAD_GRAYSCALE\"]}],[\"$\",\"span\",\"code-segement94\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement95\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement96\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        test_images\"]}],[\"$\",\"span\",\"code-segement97\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement98\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"append\"]}],[\"$\",\"span\",\"code-segement99\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement100\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"image\"]}],[\"$\",\"span\",\"code-segement101\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement102\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement104\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement105\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"if\"]}],[\"$\",\"span\",\"code-segement106\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement107\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement108\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"i \"]}],[\"$\",\"span\",\"code-segement109\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"+\"]}],[\"$\",\"span\",\"code-segement110\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement111\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"1\"]}],[\"$\",\"span\",\"code-segement112\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement113\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement114\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"%\"]}],[\"$\",\"span\",\"code-segement115\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement116\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"500\"]}],[\"$\",\"span\",\"code-segement117\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement118\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"==\"]}],[\"$\",\"span\",\"code-segement119\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement120\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"0\"]}],[\"$\",\"span\",\"code-segement121\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement122\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement123\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement124\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"print\"]}],[\"$\",\"span\",\"code-segement125\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement126\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"f\\\"Loaded images: \"]}],[\"$\",\"span\",\"code-segement127\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement128\",{\"className\":\"token string-interpolation interpolation\",\"style\":{},\"children\":[\"i\"]}],[\"$\",\"span\",\"code-segement129\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement130\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\" / \"]}],[\"$\",\"span\",\"code-segement131\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement132\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#af00af\"},\"children\":[\"len\"]}],[\"$\",\"span\",\"code-segement133\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement134\",{\"className\":\"token string-interpolation interpolation\",\"style\":{},\"children\":[\"all_image_names\"]}],[\"$\",\"span\",\"code-segement135\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement136\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement137\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"\\\"\"]}],[\"$\",\"span\",\"code-segement138\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement139\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement141\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement142\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"if\"]}],[\"$\",\"span\",\"code-segement143\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement144\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement145\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"i \"]}],[\"$\",\"span\",\"code-segement146\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"+\"]}],[\"$\",\"span\",\"code-segement147\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement148\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"1\"]}],[\"$\",\"span\",\"code-segement149\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement150\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement151\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"%\"]}],[\"$\",\"span\",\"code-segement152\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement153\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"50\"]}],[\"$\",\"span\",\"code-segement154\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement155\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"==\"]}],[\"$\",\"span\",\"code-segement156\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement157\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"0\"]}],[\"$\",\"span\",\"code-segement158\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement159\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement160\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement161\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"break\"]}],[\"$\",\"span\",\"code-segement162\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement163\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement164\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"print\"]}],[\"$\",\"span\",\"code-segement165\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement166\",{\"className\":\"token\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"\\\"Images loaded.\\\"\"]}],[\"$\",\"span\",\"code-segement167\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement168\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement170\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    model \"]}],[\"$\",\"span\",\"code-segement171\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement172\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" Model\"]}],[\"$\",\"span\",\"code-segement173\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement174\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"path_join\"]}],[\"$\",\"span\",\"code-segement175\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement176\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"weights_dir\"]}],[\"$\",\"span\",\"code-segement177\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement178\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement179\",{\"className\":\"token\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"\\\"weights_001.pt\\\"\"]}],[\"$\",\"span\",\"code-segement180\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement181\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement182\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" use_cuda\"]}],[\"$\",\"span\",\"code-segement183\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement184\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"False\"]}],[\"$\",\"span\",\"code-segement185\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement186\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement187\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement188\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"print\"]}],[\"$\",\"span\",\"code-segement189\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement190\",{\"className\":\"token\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"\\\"Model loaded.\\\"\"]}],[\"$\",\"span\",\"code-segement191\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement192\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement194\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    start_time \"]}],[\"$\",\"span\",\"code-segement195\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement196\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" time\"]}],[\"$\",\"span\",\"code-segement197\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement198\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement199\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement201\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    outputs \"]}],[\"$\",\"span\",\"code-segement202\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement203\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement204\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement205\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement206\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement207\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement208\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"for\"]}],[\"$\",\"span\",\"code-segement209\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" i\"]}],[\"$\",\"span\",\"code-segement210\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement211\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" test_image \"]}],[\"$\",\"span\",\"code-segement212\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"in\"]}],[\"$\",\"span\",\"code-segement213\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement214\",{\"className\":\"token\",\"style\":{\"color\":\"#af00af\"},\"children\":[\"enumerate\"]}],[\"$\",\"span\",\"code-segement215\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement216\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"test_images\"]}],[\"$\",\"span\",\"code-segement217\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement218\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement219\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement220\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        preprocessed_image \"]}],[\"$\",\"span\",\"code-segement221\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement222\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" model\"]}],[\"$\",\"span\",\"code-segement223\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement224\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"preprocess\"]}],[\"$\",\"span\",\"code-segement225\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement226\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement227\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"test_image\"]}],[\"$\",\"span\",\"code-segement228\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement229\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement230\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement231\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        output \"]}],[\"$\",\"span\",\"code-segement232\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement233\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" model\"]}],[\"$\",\"span\",\"code-segement234\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement235\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"forward\"]}],[\"$\",\"span\",\"code-segement236\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement237\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"preprocessed_image\"]}],[\"$\",\"span\",\"code-segement238\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement239\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement240\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        output \"]}],[\"$\",\"span\",\"code-segement241\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement242\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" output\"]}],[\"$\",\"span\",\"code-segement243\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement244\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"detach\"]}],[\"$\",\"span\",\"code-segement245\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement246\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement247\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement248\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        outputs\"]}],[\"$\",\"span\",\"code-segement249\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement250\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"append\"]}],[\"$\",\"span\",\"code-segement251\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement252\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"output\"]}],[\"$\",\"span\",\"code-segement253\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement254\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement256\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    end_time \"]}],[\"$\",\"span\",\"code-segement257\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement258\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" time\"]}],[\"$\",\"span\",\"code-segement259\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement260\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement261\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement262\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    time_elapsed \"]}],[\"$\",\"span\",\"code-segement263\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement264\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" end_time \"]}],[\"$\",\"span\",\"code-segement265\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"-\"]}],[\"$\",\"span\",\"code-segement266\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" start_time\\n\"]}],[\"$\",\"span\",\"code-segement267\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement268\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"print\"]}],[\"$\",\"span\",\"code-segement269\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement270\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement271\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement272\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"f\\\"Num images: \"]}],[\"$\",\"span\",\"code-segement273\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement274\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#af00af\"},\"children\":[\"len\"]}],[\"$\",\"span\",\"code-segement275\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement276\",{\"className\":\"token string-interpolation interpolation\",\"style\":{},\"children\":[\"test_images\"]}],[\"$\",\"span\",\"code-segement277\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement278\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement279\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\", \\\"\"]}],[\"$\",\"span\",\"code-segement280\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement281\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement282\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"f\\\"Batch size: \"]}],[\"$\",\"span\",\"code-segement283\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement284\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"1\"]}],[\"$\",\"span\",\"code-segement285\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement286\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\", \\\"\"]}],[\"$\",\"span\",\"code-segement287\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement288\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement289\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"f\\\"Time taken: \"]}],[\"$\",\"span\",\"code-segement290\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement291\",{\"className\":\"token string-interpolation interpolation\",\"style\":{},\"children\":[\"time_elapsed\"]}],[\"$\",\"span\",\"code-segement292\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement293\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\" s, \\\"\"]}],[\"$\",\"span\",\"code-segement294\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement295\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement296\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"f\\\"Time taken per image: \"]}],[\"$\",\"span\",\"code-segement297\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement298\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"1000\"]}],[\"$\",\"span\",\"code-segement299\",{\"className\":\"token string-interpolation interpolation\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement300\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement301\",{\"className\":\"token string-interpolation interpolation\",\"style\":{},\"children\":[\" time_elapsed \"]}],[\"$\",\"span\",\"code-segement302\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"/\"]}],[\"$\",\"span\",\"code-segement303\",{\"className\":\"token string-interpolation interpolation\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement304\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#af00af\"},\"children\":[\"len\"]}],[\"$\",\"span\",\"code-segement305\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement306\",{\"className\":\"token string-interpolation interpolation\",\"style\":{},\"children\":[\"test_images\"]}],[\"$\",\"span\",\"code-segement307\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement308\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement309\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\" ms\\\"\"]}],[\"$\",\"span\",\"code-segement310\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement311\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement312\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement313\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement315\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement316\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"for\"]}],[\"$\",\"span\",\"code-segement317\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" output \"]}],[\"$\",\"span\",\"code-segement318\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"in\"]}],[\"$\",\"span\",\"code-segement319\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" outputs\"]}],[\"$\",\"span\",\"code-segement320\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement321\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement322\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        boolean_array \"]}],[\"$\",\"span\",\"code-segement323\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement324\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" model\"]}],[\"$\",\"span\",\"code-segement325\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement326\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"postprocess\"]}],[\"$\",\"span\",\"code-segement327\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement328\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"output\"]}],[\"$\",\"span\",\"code-segement329\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement330\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"0\"]}],[\"$\",\"span\",\"code-segement331\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement332\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement333\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement334\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement335\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"512\"]}],[\"$\",\"span\",\"code-segement336\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement337\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement338\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"512\"]}],[\"$\",\"span\",\"code-segement339\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement340\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement341\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement342\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        binary_image \"]}],[\"$\",\"span\",\"code-segement343\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement344\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" boolean_array\"]}],[\"$\",\"span\",\"code-segement345\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement346\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"astype\"]}],[\"$\",\"span\",\"code-segement347\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement348\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"np\"]}],[\"$\",\"span\",\"code-segement349\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement350\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"uint8\"]}],[\"$\",\"span\",\"code-segement351\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement352\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement353\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement354\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement355\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"255\"]}],[\"$\",\"span\",\"code-segement356\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement357\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        file_path \"]}],[\"$\",\"span\",\"code-segement358\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement359\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" path_join\"]}],[\"$\",\"span\",\"code-segement360\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement361\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"outputs_dir\"]}],[\"$\",\"span\",\"code-segement362\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement363\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement364\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"f\\\"\"]}],[\"$\",\"span\",\"code-segement365\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement366\",{\"className\":\"token string-interpolation interpolation\",\"style\":{},\"children\":[\"i\"]}],[\"$\",\"span\",\"code-segement367\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement368\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\".png\\\"\"]}],[\"$\",\"span\",\"code-segement369\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement370\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement371\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        cv2\"]}],[\"$\",\"span\",\"code-segement372\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement373\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"imwrite\"]}],[\"$\",\"span\",\"code-segement374\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement375\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"file_path\"]}],[\"$\",\"span\",\"code-segement376\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement377\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" binary_image\"]}],[\"$\",\"span\",\"code-segement378\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}]]]}]}]]}],[\"$\",\"$Le\",\"26\",{\"id\":\"cpu-inference\",\"variant\":\"h4\",\"component\":\"h1\",\"mb\":2,\"children\":[\"$\",\"strong\",null,{\"children\":\"CPU Inference\"}]}],[\"$\",\"$Le\",\"27\",{\"variant\":\"p\",\"component\":\"p\",\"sx\":{\"textAlign\":\"justify\",\"marginBottom\":2},\"children\":[\"$undefined\",\"Right now, in the line where we have initialized the model, we pass the \",[\"$\",\"$Lc\",\"27-text-italics\",{\"component\":\"span\",\"sx\":{\"paddingLeft\":0.5,\"paddingRight\":0.5,\"borderRadius\":1,\"backgroundColor\":\"rgb(227, 234, 242)\"},\"children\":\"use_cuda\"}],\" parameter as \",[\"$\",\"$Lc\",\"27-text-italics\",{\"component\":\"span\",\"sx\":{\"paddingLeft\":0.5,\"paddingRight\":0.5,\"borderRadius\":1,\"backgroundColor\":\"rgb(227, 234, 242)\"},\"children\":\"False\"}],\". Actually, we don't really need to do that because that is what it defaults to.\"]}],[\"$\",\"$Lc\",null,{\"sx\":{\"width\":\"100%\",\"marginBottom\":2},\"children\":[[\"$\",\"$L1c\",null,{\"contentToCopy\":\"model = Model(path_join(weights_dir, \\\"weights_001.pt\\\"), use_cuda=False)\"}],[\"$\",\"pre\",null,{\"style\":{\"color\":\"#111b27\",\"background\":\"#e3eaf2\",\"fontFamily\":\"Consolas, Monaco, \\\"Andale Mono\\\", \\\"Ubuntu Mono\\\", monospace\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":0,\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-python\",\"style\":{\"color\":\"#111b27\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, \\\"Andale Mono\\\", \\\"Ubuntu Mono\\\", monospace\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"code-segement0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"model \"]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" Model\"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"path_join\"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"weights_dir\"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"token\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"\\\"weights_001.pt\\\"\"]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" use_cuda\"]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"False\"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}]]]}]}]]}],[\"$\",\"$Le\",\"29\",{\"variant\":\"p\",\"component\":\"p\",\"sx\":{\"textAlign\":\"justify\",\"marginBottom\":2},\"children\":[\"$undefined\",\"Let's run the script.\"]}],[\"$\",\"$Le\",\"30\",{\"variant\":\"p\",\"component\":\"p\",\"sx\":{\"textAlign\":\"justify\",\"marginBottom\":2},\"children\":[\"$undefined\",\"For 5,000 images, it took around 6674.206 seconds (01h51m14s). This is around 1.3348 s per image or 0.7491 FPS.\"]}],[\"$\",\"$Lc\",\"31\",{\"sx\":{\"width\":\"100%\",\"display\":\"flex\",\"flexDirection\":\"column\",\"justifyContent\":\"center\",\"alignItems\":\"center\",\"marginBottom\":2},\"children\":[\"$\",\"$L1f\",null,{\"sx\":{\"backgroundColor\":\"rgb(227, 234, 242)\"},\"children\":[[\"$\",\"$Le\",null,{\"variant\":\"h6\",\"component\":\"h4\",\"sx\":{\"width\":\"100%\",\"textAlign\":\"center\",\"marginTop\":2},\"children\":[\"$\",\"strong\",null,{\"children\":\"Num images: 5,000 | Device: CPU\"}]}],[\"$\",\"$L20\",null,{\"children\":[[\"$\",\"$L21\",null,{\"children\":[\"$\",\"$L22\",null,{\"children\":[[\"$\",\"$L23\",\"0\",{\"sx\":{\"fontWeight\":\"bold\"},\"children\":\"Batch Size\"}],[\"$\",\"$L23\",\"1\",{\"sx\":{\"fontWeight\":\"bold\"},\"children\":\"Time Taken (s)\"}],[\"$\",\"$L23\",\"2\",{\"sx\":{\"fontWeight\":\"bold\"},\"children\":\"Time Taken per Image (s)\"}],[\"$\",\"$L23\",\"3\",{\"sx\":{\"fontWeight\":\"bold\"},\"children\":\"FPS\"}]]}]}],[\"$\",\"$L24\",null,{\"children\":[[\"$\",\"$L22\",\"0\",{\"sx\":{\"\u0026:last-child td, \u0026:last-child th\":{\"border\":0}},\"children\":[[\"$\",\"$L23\",\"0\",{\"children\":\"1\"}],[\"$\",\"$L23\",\"1\",{\"children\":\"01h51m14s\"}],[\"$\",\"$L23\",\"2\",{\"children\":\"1.3348\"}],[\"$\",\"$L23\",\"3\",{\"children\":\"0.7491\"}]]}]]}]]}]]}]}],[\"$\",\"$Le\",\"32\",{\"id\":\"gpu-inference\",\"variant\":\"h4\",\"component\":\"h1\",\"mb\":2,\"children\":[\"$\",\"strong\",null,{\"children\":\"GPU Inference\"}]}],[\"$\",\"$Le\",\"33\",{\"variant\":\"p\",\"component\":\"p\",\"sx\":{\"textAlign\":\"justify\",\"marginBottom\":2},\"children\":[\"$undefined\",\"Before we try to run our model on a GPU, we should make sure that CUDA is indeed available to torch. Open up a new Python interpreter in your environment and run the following lines:\"]}],[\"$\",\"$Lc\",null,{\"sx\":{\"width\":\"100%\",\"marginBottom\":2},\"children\":[[\"$\",\"$L1c\",null,{\"contentToCopy\":\"import torch\\n\\ntorch.cuda.is_available()\"}],[\"$\",\"pre\",null,{\"style\":{\"color\":\"#111b27\",\"background\":\"#e3eaf2\",\"fontFamily\":\"Consolas, Monaco, \\\"Andale Mono\\\", \\\"Ubuntu Mono\\\", monospace\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":0,\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-python\",\"style\":{\"color\":\"#111b27\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, \\\"Andale Mono\\\", \\\"Ubuntu Mono\\\", monospace\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"code-segement0\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"import\"]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" torch\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement3\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"torch\"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"cuda\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"is_available\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}]]]}]}]]}],[\"$\",\"$Le\",\"35\",{\"variant\":\"p\",\"component\":\"p\",\"sx\":{\"textAlign\":\"justify\",\"marginBottom\":2},\"children\":[\"$undefined\",\"You should get \",[\"$\",\"$Lc\",\"35-text-italics\",{\"component\":\"span\",\"sx\":{\"paddingLeft\":0.5,\"paddingRight\":0.5,\"borderRadius\":1,\"backgroundColor\":\"rgb(227, 234, 242)\"},\"children\":\"True\"}],\" in the output.\"]}],[\"$\",\"$Le\",\"36\",{\"variant\":\"p\",\"component\":\"p\",\"sx\":{\"textAlign\":\"justify\",\"marginBottom\":2},\"children\":[\"$undefined\",\"Let's convert our code to now run the inference on the machine's GPU. Since we have already written logic in the \",[\"$\",\"$Lc\",\"36-text-italics\",{\"component\":\"span\",\"sx\":{\"paddingLeft\":0.5,\"paddingRight\":0.5,\"borderRadius\":1,\"backgroundColor\":\"rgb(227, 234, 242)\"},\"children\":\"model.py\"}],\" to handle this, we can change our inference device by changing a single line in the \",[\"$\",\"$Lc\",\"36-text-italics\",{\"component\":\"span\",\"sx\":{\"paddingLeft\":0.5,\"paddingRight\":0.5,\"borderRadius\":1,\"backgroundColor\":\"rgb(227, 234, 242)\"},\"children\":\"test.py\"}],\" where we are initializing our model.\"]}],[\"$\",\"$Lc\",null,{\"sx\":{\"width\":\"100%\",\"marginBottom\":2},\"children\":[[\"$\",\"$L1c\",null,{\"contentToCopy\":\"model = Model(path_join(weights_dir, \\\"weights_001.pt\\\"), use_cuda=True)\"}],[\"$\",\"pre\",null,{\"style\":{\"color\":\"#111b27\",\"background\":\"#e3eaf2\",\"fontFamily\":\"Consolas, Monaco, \\\"Andale Mono\\\", \\\"Ubuntu Mono\\\", monospace\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":0,\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-python\",\"style\":{\"color\":\"#111b27\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, \\\"Andale Mono\\\", \\\"Ubuntu Mono\\\", monospace\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"code-segement0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"model \"]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" Model\"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"path_join\"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"weights_dir\"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"token\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"\\\"weights_001.pt\\\"\"]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" use_cuda\"]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"True\"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}]]]}]}]]}],[\"$\",\"$Le\",\"38\",{\"variant\":\"p\",\"component\":\"p\",\"sx\":{\"textAlign\":\"justify\",\"marginBottom\":2},\"children\":[\"$undefined\",\"Let's run this and see how much of a speed improvement we got.\"]}],[\"$\",\"$Lc\",\"39\",{\"sx\":{\"width\":\"100%\",\"display\":\"flex\",\"flexDirection\":\"column\",\"justifyContent\":\"center\",\"alignItems\":\"center\",\"marginBottom\":2},\"children\":[\"$\",\"$L1f\",null,{\"sx\":{\"backgroundColor\":\"rgb(227, 234, 242)\"},\"children\":[[\"$\",\"$Le\",null,{\"variant\":\"h6\",\"component\":\"h4\",\"sx\":{\"width\":\"100%\",\"textAlign\":\"center\",\"marginTop\":2},\"children\":[\"$\",\"strong\",null,{\"children\":\"Num images: 5,000 | Device: GPU\"}]}],[\"$\",\"$L20\",null,{\"children\":[[\"$\",\"$L21\",null,{\"children\":[\"$\",\"$L22\",null,{\"children\":[[\"$\",\"$L23\",\"0\",{\"sx\":{\"fontWeight\":\"bold\"},\"children\":\"Batch Size\"}],[\"$\",\"$L23\",\"1\",{\"sx\":{\"fontWeight\":\"bold\"},\"children\":\"Time Taken (s)\"}],[\"$\",\"$L23\",\"2\",{\"sx\":{\"fontWeight\":\"bold\"},\"children\":\"Time Taken per Image (ms)\"}],[\"$\",\"$L23\",\"3\",{\"sx\":{\"fontWeight\":\"bold\"},\"children\":\"FPS\"}]]}]}],[\"$\",\"$L24\",null,{\"children\":[[\"$\",\"$L22\",\"0\",{\"sx\":{\"\u0026:last-child td, \u0026:last-child th\":{\"border\":0}},\"children\":[[\"$\",\"$L23\",\"0\",{\"children\":\"1\"}],[\"$\",\"$L23\",\"1\",{\"children\":\"49.6585s\"}],[\"$\",\"$L23\",\"2\",{\"children\":\"9.9317\"}],[\"$\",\"$L23\",\"3\",{\"children\":\"100.6876\"}]]}]]}]]}]]}]}],[\"$\",\"$Le\",\"40\",{\"variant\":\"p\",\"component\":\"p\",\"sx\":{\"textAlign\":\"justify\",\"marginBottom\":2},\"children\":[\"$undefined\",\"Woah! That's a 134.41 times improvement. The \",[\"$\",\"$L1b\",\"40-link\",{\"href\":\"https://en.wikipedia.org/wiki/MythBusters\",\"rel\":\"noopener noreferrer\",\"target\":\"_blank\",\"color\":\"primary\",\"underline\":\"hover\",\"children\":\"MythBusters\"}],\" made a \",[\"$\",\"$L1b\",\"40-link\",{\"href\":\"https://www.youtube.com/watch?v=-P28LKWTzrI\",\"rel\":\"noopener noreferrer\",\"target\":\"_blank\",\"color\":\"primary\",\"underline\":\"hover\",\"children\":\"good illustration of this speed comparison\"}],\". GPUs mean business when it comes to crunching numbers.\"]}],[\"$\",\"$Le\",\"41\",{\"id\":\"batched-gpu-inference\",\"variant\":\"h4\",\"component\":\"h1\",\"mb\":2,\"children\":[\"$\",\"strong\",null,{\"children\":\"Batched GPU Inference\"}]}],[\"$\",\"$Le\",\"42\",{\"variant\":\"p\",\"component\":\"p\",\"sx\":{\"textAlign\":\"justify\",\"marginBottom\":2},\"children\":[\"$undefined\",\"Let's take a look at the \",[\"$\",\"$Lc\",\"42-text-italics\",{\"component\":\"span\",\"sx\":{\"paddingLeft\":0.5,\"paddingRight\":0.5,\"borderRadius\":1,\"backgroundColor\":\"rgb(227, 234, 242)\"},\"children\":\"preprocess\"}],\" function in \",[\"$\",\"$Lc\",\"42-text-italics\",{\"component\":\"span\",\"sx\":{\"paddingLeft\":0.5,\"paddingRight\":0.5,\"borderRadius\":1,\"backgroundColor\":\"rgb(227, 234, 242)\"},\"children\":\"model.py\"}],\".\"]}],[\"$\",\"$Lc\",null,{\"sx\":{\"width\":\"100%\",\"marginBottom\":2},\"children\":[[\"$\",\"$L1c\",null,{\"contentToCopy\":\"def preprocess(self, images):\\n    transformed_images = torch.stack([self.preprocessing_transform(image) for image in images])\\n    transformed_images = transformed_images.type(self.dtype)\\n\\n    batched_images = transformed_images.to(self.device)\\n\\n    return batched_images\"}],[\"$\",\"pre\",null,{\"style\":{\"color\":\"#111b27\",\"background\":\"#e3eaf2\",\"fontFamily\":\"Consolas, Monaco, \\\"Andale Mono\\\", \\\"Ubuntu Mono\\\", monospace\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":0,\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-python\",\"style\":{\"color\":\"#111b27\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, \\\"Andale Mono\\\", \\\"Ubuntu Mono\\\", monospace\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"code-segement0\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"def\"]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"token\",\"style\":{\"color\":\"#7c00aa\"},\"children\":[\"preprocess\"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"self\"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" images\"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    transformed_images \"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" torch\"]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"stack\"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement16\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"self\"]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement19\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"preprocessing_transform\"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"image\"]}],[\"$\",\"span\",\"code-segement22\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement23\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"for\"]}],[\"$\",\"span\",\"code-segement25\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" image \"]}],[\"$\",\"span\",\"code-segement26\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"in\"]}],[\"$\",\"span\",\"code-segement27\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" images\"]}],[\"$\",\"span\",\"code-segement28\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement29\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement30\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement31\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    transformed_images \"]}],[\"$\",\"span\",\"code-segement32\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement33\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" transformed_images\"]}],[\"$\",\"span\",\"code-segement34\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement35\",{\"className\":\"token\",\"style\":{\"color\":\"#af00af\"},\"children\":[\"type\"]}],[\"$\",\"span\",\"code-segement36\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement37\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"self\"]}],[\"$\",\"span\",\"code-segement38\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement39\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"dtype\"]}],[\"$\",\"span\",\"code-segement40\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement41\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement43\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    batched_images \"]}],[\"$\",\"span\",\"code-segement44\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement45\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" transformed_images\"]}],[\"$\",\"span\",\"code-segement46\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement47\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"to\"]}],[\"$\",\"span\",\"code-segement48\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement49\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"self\"]}],[\"$\",\"span\",\"code-segement50\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement51\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"device\"]}],[\"$\",\"span\",\"code-segement52\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement53\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement55\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement56\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"return\"]}],[\"$\",\"span\",\"code-segement57\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" batched_images\"]}]]]}]}]]}],[\"$\",\"$Le\",\"44\",{\"variant\":\"p\",\"component\":\"p\",\"sx\":{\"textAlign\":\"justify\",\"marginBottom\":2},\"children\":[\"$undefined\",\"Here, we are accepting a list of images, transforming them using the preprocessing transform, and then combining them into a single tensor using \",[\"$\",\"$Lc\",\"44-text-italics\",{\"component\":\"span\",\"sx\":{\"paddingLeft\":0.5,\"paddingRight\":0.5,\"borderRadius\":1,\"backgroundColor\":\"rgb(227, 234, 242)\"},\"children\":\"torch.stack\"}],\". We can call \",[\"$\",\"$Lc\",\"44-text-italics\",{\"component\":\"span\",\"sx\":{\"paddingLeft\":0.5,\"paddingRight\":0.5,\"borderRadius\":1,\"backgroundColor\":\"rgb(227, 234, 242)\"},\"children\":\"forward\"}],\" with this single tensor and the output tensor will include the result for each of the inputs i.e. the output is also a batch.\"]}],[\"$\",\"$Le\",\"45\",{\"variant\":\"p\",\"component\":\"p\",\"sx\":{\"textAlign\":\"justify\",\"marginBottom\":2},\"children\":[\"$undefined\",\"In \",[\"$\",\"$Lc\",\"45-text-italics\",{\"component\":\"span\",\"sx\":{\"paddingLeft\":0.5,\"paddingRight\":0.5,\"borderRadius\":1,\"backgroundColor\":\"rgb(227, 234, 242)\"},\"children\":\"test.py\"}],\", we'll create a variable called \",[\"$\",\"$Lc\",\"45-text-italics\",{\"component\":\"span\",\"sx\":{\"paddingLeft\":0.5,\"paddingRight\":0.5,\"borderRadius\":1,\"backgroundColor\":\"rgb(227, 234, 242)\"},\"children\":\"batch_size\"}],\" to define how many images are preprocessed and sent for inference at once. Then, we can create batches from the \",[\"$\",\"$Lc\",\"45-text-italics\",{\"component\":\"span\",\"sx\":{\"paddingLeft\":0.5,\"paddingRight\":0.5,\"borderRadius\":1,\"backgroundColor\":\"rgb(227, 234, 242)\"},\"children\":\"test_images\"}],\" list as follows:\"]}],[\"$\",\"$Lc\",null,{\"sx\":{\"width\":\"100%\",\"marginBottom\":2},\"children\":[[\"$\",\"$L1c\",null,{\"contentToCopy\":\"batch_size = 4\\ntest_batches = [test_images[i:i+batch_size] for i in range(0, len(test_images), batch_size)]\"}],[\"$\",\"pre\",null,{\"style\":{\"color\":\"#111b27\",\"background\":\"#e3eaf2\",\"fontFamily\":\"Consolas, Monaco, \\\"Andale Mono\\\", \\\"Ubuntu Mono\\\", monospace\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":0,\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-python\",\"style\":{\"color\":\"#111b27\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, \\\"Andale Mono\\\", \\\"Ubuntu Mono\\\", monospace\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"code-segement0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"batch_size \"]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"4\"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"test_batches \"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"test_images\"]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"i\"]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"i\"]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"+\"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"batch_size\"]}],[\"$\",\"span\",\"code-segement16\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"for\"]}],[\"$\",\"span\",\"code-segement19\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" i \"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"in\"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement22\",{\"className\":\"token\",\"style\":{\"color\":\"#af00af\"},\"children\":[\"range\"]}],[\"$\",\"span\",\"code-segement23\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"0\"]}],[\"$\",\"span\",\"code-segement25\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement26\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement27\",{\"className\":\"token\",\"style\":{\"color\":\"#af00af\"},\"children\":[\"len\"]}],[\"$\",\"span\",\"code-segement28\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement29\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"test_images\"]}],[\"$\",\"span\",\"code-segement30\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement31\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement32\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" batch_size\"]}],[\"$\",\"span\",\"code-segement33\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement34\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"]\"]}]]]}]}]]}],[\"$\",\"$Le\",\"47\",{\"variant\":\"p\",\"component\":\"p\",\"sx\":{\"textAlign\":\"justify\",\"marginBottom\":2},\"children\":[\"$undefined\",\"Let's iterate the batch size from 1 to 32 (at 32 my GPU ran out of memory) and print the time taken to process.\"]}],[\"$\",\"$Lc\",null,{\"sx\":{\"width\":\"100%\",\"marginBottom\":2},\"children\":[[\"$\",\"$L1c\",null,{\"contentToCopy\":\"for batch_size in [1, 2, 4, 8, 16, 32]: #, 64, 128, 256]:\\n    test_batches = [test_images[i:i+batch_size] for i in range(0, len(test_images), batch_size)]\\n    outputs = []\\n\\n    start_time = time()\\n    preprocessed_batches = [model.preprocess(batch) for batch in test_batches]\\n\\n    for i, preprocessed_batch in enumerate(preprocessed_batches):\\n        output = model.forward(preprocessed_batch)\\n        output = output.detach()\\n        outputs.append(output)\\n\\n        if (i + 1) % 25 == 0:\\n            print(f\\\"Processed: {i} / {len(preprocessed_batches)}\\\")\\n\\n    end_time = time()\\n    time_elapsed = end_time - start_time\\n\\n    print(\\n        f\\\"Num images: {len(test_images)}, \\\"\\n        f\\\"Batch size: {batch_size}, \\\"\\n        f\\\"Time taken: {time_elapsed} s, \\\"\\n        f\\\"Time taken per image: {1000 * time_elapsed / len(test_images)} ms\\\"\\n    )\"}],[\"$\",\"pre\",null,{\"style\":{\"color\":\"#111b27\",\"background\":\"#e3eaf2\",\"fontFamily\":\"Consolas, Monaco, \\\"Andale Mono\\\", \\\"Ubuntu Mono\\\", monospace\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":0,\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-python\",\"style\":{\"color\":\"#111b27\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, \\\"Andale Mono\\\", \\\"Ubuntu Mono\\\", monospace\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"code-segement0\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"for\"]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" batch_size \"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"in\"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"1\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"2\"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"4\"]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"8\"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement16\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"16\"]}],[\"$\",\"span\",\"code-segement18\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement19\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"32\"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement22\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement23\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"token\",\"style\":{\"color\":\"#3c526d\"},\"children\":[\"#, 64, 128, 256]:\"]}],[\"$\",\"span\",\"code-segement25\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement26\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    test_batches \"]}],[\"$\",\"span\",\"code-segement27\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement28\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement29\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement30\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"test_images\"]}],[\"$\",\"span\",\"code-segement31\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement32\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"i\"]}],[\"$\",\"span\",\"code-segement33\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement34\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"i\"]}],[\"$\",\"span\",\"code-segement35\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"+\"]}],[\"$\",\"span\",\"code-segement36\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"batch_size\"]}],[\"$\",\"span\",\"code-segement37\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement38\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement39\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"for\"]}],[\"$\",\"span\",\"code-segement40\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" i \"]}],[\"$\",\"span\",\"code-segement41\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"in\"]}],[\"$\",\"span\",\"code-segement42\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement43\",{\"className\":\"token\",\"style\":{\"color\":\"#af00af\"},\"children\":[\"range\"]}],[\"$\",\"span\",\"code-segement44\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement45\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"0\"]}],[\"$\",\"span\",\"code-segement46\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement47\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement48\",{\"className\":\"token\",\"style\":{\"color\":\"#af00af\"},\"children\":[\"len\"]}],[\"$\",\"span\",\"code-segement49\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement50\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"test_images\"]}],[\"$\",\"span\",\"code-segement51\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement52\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement53\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" batch_size\"]}],[\"$\",\"span\",\"code-segement54\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement55\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement56\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement57\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    outputs \"]}],[\"$\",\"span\",\"code-segement58\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement59\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement60\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement61\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement62\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement64\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    start_time \"]}],[\"$\",\"span\",\"code-segement65\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement66\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" time\"]}],[\"$\",\"span\",\"code-segement67\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement68\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement69\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement70\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    preprocessed_batches \"]}],[\"$\",\"span\",\"code-segement71\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement72\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement73\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement74\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"model\"]}],[\"$\",\"span\",\"code-segement75\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement76\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"preprocess\"]}],[\"$\",\"span\",\"code-segement77\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement78\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"batch\"]}],[\"$\",\"span\",\"code-segement79\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement80\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement81\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"for\"]}],[\"$\",\"span\",\"code-segement82\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" batch \"]}],[\"$\",\"span\",\"code-segement83\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"in\"]}],[\"$\",\"span\",\"code-segement84\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" test_batches\"]}],[\"$\",\"span\",\"code-segement85\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement86\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement88\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement89\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"for\"]}],[\"$\",\"span\",\"code-segement90\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" i\"]}],[\"$\",\"span\",\"code-segement91\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement92\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" preprocessed_batch \"]}],[\"$\",\"span\",\"code-segement93\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"in\"]}],[\"$\",\"span\",\"code-segement94\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement95\",{\"className\":\"token\",\"style\":{\"color\":\"#af00af\"},\"children\":[\"enumerate\"]}],[\"$\",\"span\",\"code-segement96\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement97\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"preprocessed_batches\"]}],[\"$\",\"span\",\"code-segement98\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement99\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement100\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement101\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        output \"]}],[\"$\",\"span\",\"code-segement102\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement103\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" model\"]}],[\"$\",\"span\",\"code-segement104\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement105\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"forward\"]}],[\"$\",\"span\",\"code-segement106\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement107\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"preprocessed_batch\"]}],[\"$\",\"span\",\"code-segement108\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement109\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement110\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        output \"]}],[\"$\",\"span\",\"code-segement111\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement112\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" output\"]}],[\"$\",\"span\",\"code-segement113\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement114\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"detach\"]}],[\"$\",\"span\",\"code-segement115\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement116\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement117\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement118\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        outputs\"]}],[\"$\",\"span\",\"code-segement119\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement120\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"append\"]}],[\"$\",\"span\",\"code-segement121\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement122\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"output\"]}],[\"$\",\"span\",\"code-segement123\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement124\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement126\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement127\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"if\"]}],[\"$\",\"span\",\"code-segement128\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement129\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement130\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"i \"]}],[\"$\",\"span\",\"code-segement131\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"+\"]}],[\"$\",\"span\",\"code-segement132\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement133\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"1\"]}],[\"$\",\"span\",\"code-segement134\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement135\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement136\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"%\"]}],[\"$\",\"span\",\"code-segement137\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement138\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"25\"]}],[\"$\",\"span\",\"code-segement139\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement140\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"==\"]}],[\"$\",\"span\",\"code-segement141\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement142\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"0\"]}],[\"$\",\"span\",\"code-segement143\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement144\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement145\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement146\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"print\"]}],[\"$\",\"span\",\"code-segement147\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement148\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"f\\\"Processed: \"]}],[\"$\",\"span\",\"code-segement149\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement150\",{\"className\":\"token string-interpolation interpolation\",\"style\":{},\"children\":[\"i\"]}],[\"$\",\"span\",\"code-segement151\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement152\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\" / \"]}],[\"$\",\"span\",\"code-segement153\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement154\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#af00af\"},\"children\":[\"len\"]}],[\"$\",\"span\",\"code-segement155\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement156\",{\"className\":\"token string-interpolation interpolation\",\"style\":{},\"children\":[\"preprocessed_batches\"]}],[\"$\",\"span\",\"code-segement157\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement158\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement159\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"\\\"\"]}],[\"$\",\"span\",\"code-segement160\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement161\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement163\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    end_time \"]}],[\"$\",\"span\",\"code-segement164\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement165\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" time\"]}],[\"$\",\"span\",\"code-segement166\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement167\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement168\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement169\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    time_elapsed \"]}],[\"$\",\"span\",\"code-segement170\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement171\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" end_time \"]}],[\"$\",\"span\",\"code-segement172\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"-\"]}],[\"$\",\"span\",\"code-segement173\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" start_time\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement175\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement176\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"print\"]}],[\"$\",\"span\",\"code-segement177\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement178\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement179\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement180\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"f\\\"Num images: \"]}],[\"$\",\"span\",\"code-segement181\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement182\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#af00af\"},\"children\":[\"len\"]}],[\"$\",\"span\",\"code-segement183\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement184\",{\"className\":\"token string-interpolation interpolation\",\"style\":{},\"children\":[\"test_images\"]}],[\"$\",\"span\",\"code-segement185\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement186\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement187\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\", \\\"\"]}],[\"$\",\"span\",\"code-segement188\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement189\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement190\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"f\\\"Batch size: \"]}],[\"$\",\"span\",\"code-segement191\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement192\",{\"className\":\"token string-interpolation interpolation\",\"style\":{},\"children\":[\"batch_size\"]}],[\"$\",\"span\",\"code-segement193\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement194\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\", \\\"\"]}],[\"$\",\"span\",\"code-segement195\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement196\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement197\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"f\\\"Time taken: \"]}],[\"$\",\"span\",\"code-segement198\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement199\",{\"className\":\"token string-interpolation interpolation\",\"style\":{},\"children\":[\"time_elapsed\"]}],[\"$\",\"span\",\"code-segement200\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement201\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\" s, \\\"\"]}],[\"$\",\"span\",\"code-segement202\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement203\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement204\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"f\\\"Time taken per image: \"]}],[\"$\",\"span\",\"code-segement205\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement206\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"1000\"]}],[\"$\",\"span\",\"code-segement207\",{\"className\":\"token string-interpolation interpolation\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement208\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement209\",{\"className\":\"token string-interpolation interpolation\",\"style\":{},\"children\":[\" time_elapsed \"]}],[\"$\",\"span\",\"code-segement210\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"/\"]}],[\"$\",\"span\",\"code-segement211\",{\"className\":\"token string-interpolation interpolation\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement212\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#af00af\"},\"children\":[\"len\"]}],[\"$\",\"span\",\"code-segement213\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement214\",{\"className\":\"token string-interpolation interpolation\",\"style\":{},\"children\":[\"test_images\"]}],[\"$\",\"span\",\"code-segement215\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement216\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement217\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\" ms\\\"\"]}],[\"$\",\"span\",\"code-segement218\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement219\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement220\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}]]]}]}]]}],[\"$\",\"$Le\",\"49\",{\"variant\":\"p\",\"component\":\"p\",\"sx\":{\"textAlign\":\"justify\",\"marginBottom\":2},\"children\":[\"$undefined\",\"Here's the entire \",[\"$\",\"$Lc\",\"49-text-italics\",{\"component\":\"span\",\"sx\":{\"paddingLeft\":0.5,\"paddingRight\":0.5,\"borderRadius\":1,\"backgroundColor\":\"rgb(227, 234, 242)\"},\"children\":\"test.py\"}],\" file:\"]}],[\"$\",\"$Lc\",null,{\"sx\":{\"width\":\"100%\",\"marginBottom\":2},\"children\":[[\"$\",\"$L1c\",null,{\"contentToCopy\":\"$25\"}],[\"$\",\"pre\",null,{\"style\":{\"color\":\"#111b27\",\"background\":\"#e3eaf2\",\"fontFamily\":\"Consolas, Monaco, \\\"Andale Mono\\\", \\\"Ubuntu Mono\\\", monospace\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":0,\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-python\",\"style\":{\"color\":\"#111b27\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, \\\"Andale Mono\\\", \\\"Ubuntu Mono\\\", monospace\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"code-segement0\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"from\"]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" os \"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"import\"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" listdir\\n\"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"from\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" os\"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"path \"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"import\"]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" join \"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"as\"]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" path_join\\n\"]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"from\"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" time \"]}],[\"$\",\"span\",\"code-segement16\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"import\"]}],[\"$\",\"span\",\"code-segement17\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" time\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement19\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement20\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"import\"]}],[\"$\",\"span\",\"code-segement21\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" cv2\\n\"]}],[\"$\",\"span\",\"code-segement22\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement23\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"import\"]}],[\"$\",\"span\",\"code-segement24\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" numpy \"]}],[\"$\",\"span\",\"code-segement25\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"as\"]}],[\"$\",\"span\",\"code-segement26\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" np\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement28\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement29\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"from\"]}],[\"$\",\"span\",\"code-segement30\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" config \"]}],[\"$\",\"span\",\"code-segement31\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"import\"]}],[\"$\",\"span\",\"code-segement32\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" inputs_dir\"]}],[\"$\",\"span\",\"code-segement33\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement34\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" outputs_dir\"]}],[\"$\",\"span\",\"code-segement35\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement36\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" weights_dir\\n\"]}],[\"$\",\"span\",\"code-segement37\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement38\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"from\"]}],[\"$\",\"span\",\"code-segement39\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" model \"]}],[\"$\",\"span\",\"code-segement40\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"import\"]}],[\"$\",\"span\",\"code-segement41\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" Model\\n\"]}],\"\\n\",\"\\n\",[\"$\",\"span\",\"code-segement44\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\"]}],[\"$\",\"span\",\"code-segement45\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"if\"]}],[\"$\",\"span\",\"code-segement46\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" __name__ \"]}],[\"$\",\"span\",\"code-segement47\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"==\"]}],[\"$\",\"span\",\"code-segement48\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement49\",{\"className\":\"token\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"\\\"__main__\\\"\"]}],[\"$\",\"span\",\"code-segement50\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement51\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement52\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    test_images \"]}],[\"$\",\"span\",\"code-segement53\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement54\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement55\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement56\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"cv2\"]}],[\"$\",\"span\",\"code-segement57\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement58\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"imread\"]}],[\"$\",\"span\",\"code-segement59\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement60\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"path_join\"]}],[\"$\",\"span\",\"code-segement61\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement62\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"inputs_dir\"]}],[\"$\",\"span\",\"code-segement63\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement64\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" image_name\"]}],[\"$\",\"span\",\"code-segement65\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement66\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement67\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" cv2\"]}],[\"$\",\"span\",\"code-segement68\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement69\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"IMREAD_GRAYSCALE\"]}],[\"$\",\"span\",\"code-segement70\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement71\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement72\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"for\"]}],[\"$\",\"span\",\"code-segement73\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" image_name \"]}],[\"$\",\"span\",\"code-segement74\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"in\"]}],[\"$\",\"span\",\"code-segement75\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" listdir\"]}],[\"$\",\"span\",\"code-segement76\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement77\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"inputs_dir\"]}],[\"$\",\"span\",\"code-segement78\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement79\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement80\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement81\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement82\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"print\"]}],[\"$\",\"span\",\"code-segement83\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement84\",{\"className\":\"token\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"\\\"Images loaded.\\\"\"]}],[\"$\",\"span\",\"code-segement85\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement86\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement88\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    model \"]}],[\"$\",\"span\",\"code-segement89\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement90\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" Model\"]}],[\"$\",\"span\",\"code-segement91\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement92\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"path_join\"]}],[\"$\",\"span\",\"code-segement93\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement94\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"weights_dir\"]}],[\"$\",\"span\",\"code-segement95\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement96\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement97\",{\"className\":\"token\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"\\\"weights_001.pt\\\"\"]}],[\"$\",\"span\",\"code-segement98\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement99\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement100\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" use_cuda\"]}],[\"$\",\"span\",\"code-segement101\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement102\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"True\"]}],[\"$\",\"span\",\"code-segement103\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement104\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement105\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement106\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"print\"]}],[\"$\",\"span\",\"code-segement107\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement108\",{\"className\":\"token\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"\\\"Model loaded.\\\"\"]}],[\"$\",\"span\",\"code-segement109\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement110\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement112\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"    \"]}],[\"$\",\"span\",\"code-segement113\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"for\"]}],[\"$\",\"span\",\"code-segement114\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" batch_size \"]}],[\"$\",\"span\",\"code-segement115\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"in\"]}],[\"$\",\"span\",\"code-segement116\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement117\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement118\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"1\"]}],[\"$\",\"span\",\"code-segement119\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement120\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement121\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"2\"]}],[\"$\",\"span\",\"code-segement122\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement123\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement124\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"4\"]}],[\"$\",\"span\",\"code-segement125\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement126\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement127\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"8\"]}],[\"$\",\"span\",\"code-segement128\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement129\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement130\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"16\"]}],[\"$\",\"span\",\"code-segement131\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement132\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement133\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"32\"]}],[\"$\",\"span\",\"code-segement134\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement135\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement136\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement137\",{\"className\":\"token\",\"style\":{\"color\":\"#3c526d\"},\"children\":[\"#, 64, 128, 256]:\"]}],[\"$\",\"span\",\"code-segement138\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement139\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        test_batches \"]}],[\"$\",\"span\",\"code-segement140\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement141\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement142\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement143\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"test_images\"]}],[\"$\",\"span\",\"code-segement144\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement145\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"i\"]}],[\"$\",\"span\",\"code-segement146\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement147\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"i\"]}],[\"$\",\"span\",\"code-segement148\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"+\"]}],[\"$\",\"span\",\"code-segement149\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"batch_size\"]}],[\"$\",\"span\",\"code-segement150\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement151\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement152\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"for\"]}],[\"$\",\"span\",\"code-segement153\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" i \"]}],[\"$\",\"span\",\"code-segement154\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"in\"]}],[\"$\",\"span\",\"code-segement155\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement156\",{\"className\":\"token\",\"style\":{\"color\":\"#af00af\"},\"children\":[\"range\"]}],[\"$\",\"span\",\"code-segement157\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement158\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"0\"]}],[\"$\",\"span\",\"code-segement159\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement160\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement161\",{\"className\":\"token\",\"style\":{\"color\":\"#af00af\"},\"children\":[\"len\"]}],[\"$\",\"span\",\"code-segement162\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement163\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"test_images\"]}],[\"$\",\"span\",\"code-segement164\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement165\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement166\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" batch_size\"]}],[\"$\",\"span\",\"code-segement167\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement168\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement169\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement170\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        outputs \"]}],[\"$\",\"span\",\"code-segement171\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement172\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement173\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement174\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement175\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement177\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        start_time \"]}],[\"$\",\"span\",\"code-segement178\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement179\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" time\"]}],[\"$\",\"span\",\"code-segement180\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement181\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement182\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement183\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        preprocessed_batches \"]}],[\"$\",\"span\",\"code-segement184\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement185\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement186\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"[\"]}],[\"$\",\"span\",\"code-segement187\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"model\"]}],[\"$\",\"span\",\"code-segement188\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement189\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"preprocess\"]}],[\"$\",\"span\",\"code-segement190\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement191\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"batch\"]}],[\"$\",\"span\",\"code-segement192\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement193\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement194\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"for\"]}],[\"$\",\"span\",\"code-segement195\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" batch \"]}],[\"$\",\"span\",\"code-segement196\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"in\"]}],[\"$\",\"span\",\"code-segement197\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" test_batches\"]}],[\"$\",\"span\",\"code-segement198\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"]\"]}],[\"$\",\"span\",\"code-segement199\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement201\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement202\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"for\"]}],[\"$\",\"span\",\"code-segement203\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" i\"]}],[\"$\",\"span\",\"code-segement204\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement205\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" preprocessed_batch \"]}],[\"$\",\"span\",\"code-segement206\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"in\"]}],[\"$\",\"span\",\"code-segement207\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement208\",{\"className\":\"token\",\"style\":{\"color\":\"#af00af\"},\"children\":[\"enumerate\"]}],[\"$\",\"span\",\"code-segement209\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement210\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"preprocessed_batches\"]}],[\"$\",\"span\",\"code-segement211\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement212\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement213\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement214\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            output \"]}],[\"$\",\"span\",\"code-segement215\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement216\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" model\"]}],[\"$\",\"span\",\"code-segement217\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement218\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"forward\"]}],[\"$\",\"span\",\"code-segement219\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement220\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"preprocessed_batch\"]}],[\"$\",\"span\",\"code-segement221\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement222\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement223\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            output \"]}],[\"$\",\"span\",\"code-segement224\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement225\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" output\"]}],[\"$\",\"span\",\"code-segement226\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement227\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"detach\"]}],[\"$\",\"span\",\"code-segement228\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement229\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement230\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement231\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            outputs\"]}],[\"$\",\"span\",\"code-segement232\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement233\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"append\"]}],[\"$\",\"span\",\"code-segement234\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement235\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"output\"]}],[\"$\",\"span\",\"code-segement236\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement237\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement239\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement240\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"if\"]}],[\"$\",\"span\",\"code-segement241\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement242\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement243\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"i \"]}],[\"$\",\"span\",\"code-segement244\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"+\"]}],[\"$\",\"span\",\"code-segement245\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement246\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"1\"]}],[\"$\",\"span\",\"code-segement247\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement248\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement249\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"%\"]}],[\"$\",\"span\",\"code-segement250\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement251\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"25\"]}],[\"$\",\"span\",\"code-segement252\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement253\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"==\"]}],[\"$\",\"span\",\"code-segement254\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement255\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"0\"]}],[\"$\",\"span\",\"code-segement256\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement257\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement258\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                \"]}],[\"$\",\"span\",\"code-segement259\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"print\"]}],[\"$\",\"span\",\"code-segement260\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement261\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"f\\\"Processed: \"]}],[\"$\",\"span\",\"code-segement262\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement263\",{\"className\":\"token string-interpolation interpolation\",\"style\":{},\"children\":[\"i\"]}],[\"$\",\"span\",\"code-segement264\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement265\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\" / \"]}],[\"$\",\"span\",\"code-segement266\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement267\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#af00af\"},\"children\":[\"len\"]}],[\"$\",\"span\",\"code-segement268\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement269\",{\"className\":\"token string-interpolation interpolation\",\"style\":{},\"children\":[\"preprocessed_batches\"]}],[\"$\",\"span\",\"code-segement270\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement271\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement272\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"\\\"\"]}],[\"$\",\"span\",\"code-segement273\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement274\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement276\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        end_time \"]}],[\"$\",\"span\",\"code-segement277\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement278\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" time\"]}],[\"$\",\"span\",\"code-segement279\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement280\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement281\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement282\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        time_elapsed \"]}],[\"$\",\"span\",\"code-segement283\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement284\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" end_time \"]}],[\"$\",\"span\",\"code-segement285\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"-\"]}],[\"$\",\"span\",\"code-segement286\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" start_time\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement288\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement289\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"print\"]}],[\"$\",\"span\",\"code-segement290\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement291\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement292\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement293\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"f\\\"Num images: \"]}],[\"$\",\"span\",\"code-segement294\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement295\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#af00af\"},\"children\":[\"len\"]}],[\"$\",\"span\",\"code-segement296\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement297\",{\"className\":\"token string-interpolation interpolation\",\"style\":{},\"children\":[\"test_images\"]}],[\"$\",\"span\",\"code-segement298\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement299\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement300\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\", \\\"\"]}],[\"$\",\"span\",\"code-segement301\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement302\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement303\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"f\\\"Batch size: \"]}],[\"$\",\"span\",\"code-segement304\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement305\",{\"className\":\"token string-interpolation interpolation\",\"style\":{},\"children\":[\"batch_size\"]}],[\"$\",\"span\",\"code-segement306\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement307\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\", \\\"\"]}],[\"$\",\"span\",\"code-segement308\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement309\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement310\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"f\\\"Time taken: \"]}],[\"$\",\"span\",\"code-segement311\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement312\",{\"className\":\"token string-interpolation interpolation\",\"style\":{},\"children\":[\"time_elapsed\"]}],[\"$\",\"span\",\"code-segement313\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement314\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\" s, \\\"\"]}],[\"$\",\"span\",\"code-segement315\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement316\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement317\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"f\\\"Time taken per image: \"]}],[\"$\",\"span\",\"code-segement318\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement319\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"1000\"]}],[\"$\",\"span\",\"code-segement320\",{\"className\":\"token string-interpolation interpolation\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement321\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement322\",{\"className\":\"token string-interpolation interpolation\",\"style\":{},\"children\":[\" time_elapsed \"]}],[\"$\",\"span\",\"code-segement323\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"/\"]}],[\"$\",\"span\",\"code-segement324\",{\"className\":\"token string-interpolation interpolation\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement325\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#af00af\"},\"children\":[\"len\"]}],[\"$\",\"span\",\"code-segement326\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement327\",{\"className\":\"token string-interpolation interpolation\",\"style\":{},\"children\":[\"test_images\"]}],[\"$\",\"span\",\"code-segement328\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement329\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement330\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\" ms\\\"\"]}],[\"$\",\"span\",\"code-segement331\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement332\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement333\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement334\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],\"\\n\",[\"$\",\"span\",\"code-segement336\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"        \"]}],[\"$\",\"span\",\"code-segement337\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"for\"]}],[\"$\",\"span\",\"code-segement338\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" i\"]}],[\"$\",\"span\",\"code-segement339\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement340\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" output \"]}],[\"$\",\"span\",\"code-segement341\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"in\"]}],[\"$\",\"span\",\"code-segement342\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement343\",{\"className\":\"token\",\"style\":{\"color\":\"#af00af\"},\"children\":[\"enumerate\"]}],[\"$\",\"span\",\"code-segement344\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement345\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"outputs\"]}],[\"$\",\"span\",\"code-segement346\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement347\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement348\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement349\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"            \"]}],[\"$\",\"span\",\"code-segement350\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"for\"]}],[\"$\",\"span\",\"code-segement351\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" j\"]}],[\"$\",\"span\",\"code-segement352\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement353\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" single_output \"]}],[\"$\",\"span\",\"code-segement354\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"in\"]}],[\"$\",\"span\",\"code-segement355\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement356\",{\"className\":\"token\",\"style\":{\"color\":\"#af00af\"},\"children\":[\"enumerate\"]}],[\"$\",\"span\",\"code-segement357\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement358\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"output\"]}],[\"$\",\"span\",\"code-segement359\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement360\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\":\"]}],[\"$\",\"span\",\"code-segement361\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement362\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                boolean_array \"]}],[\"$\",\"span\",\"code-segement363\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement364\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" model\"]}],[\"$\",\"span\",\"code-segement365\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement366\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"postprocess\"]}],[\"$\",\"span\",\"code-segement367\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement368\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"single_output\"]}],[\"$\",\"span\",\"code-segement369\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement370\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement371\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement372\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"512\"]}],[\"$\",\"span\",\"code-segement373\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement374\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement375\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"512\"]}],[\"$\",\"span\",\"code-segement376\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement377\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement378\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement379\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                binary_image \"]}],[\"$\",\"span\",\"code-segement380\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement381\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" boolean_array\"]}],[\"$\",\"span\",\"code-segement382\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement383\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"astype\"]}],[\"$\",\"span\",\"code-segement384\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement385\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"np\"]}],[\"$\",\"span\",\"code-segement386\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement387\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"uint8\"]}],[\"$\",\"span\",\"code-segement388\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement389\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement390\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement391\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement392\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"255\"]}],[\"$\",\"span\",\"code-segement393\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement394\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                file_path \"]}],[\"$\",\"span\",\"code-segement395\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement396\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" path_join\"]}],[\"$\",\"span\",\"code-segement397\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement398\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"outputs_dir\"]}],[\"$\",\"span\",\"code-segement399\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement400\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement401\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"f\\\"\"]}],[\"$\",\"span\",\"code-segement402\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"{\"]}],[\"$\",\"span\",\"code-segement403\",{\"className\":\"token string-interpolation interpolation\",\"style\":{},\"children\":[\"i \"]}],[\"$\",\"span\",\"code-segement404\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"*\"]}],[\"$\",\"span\",\"code-segement405\",{\"className\":\"token string-interpolation interpolation\",\"style\":{},\"children\":[\" batch_size \"]}],[\"$\",\"span\",\"code-segement406\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"+\"]}],[\"$\",\"span\",\"code-segement407\",{\"className\":\"token string-interpolation interpolation\",\"style\":{},\"children\":[\" j\"]}],[\"$\",\"span\",\"code-segement408\",{\"className\":\"token string-interpolation interpolation\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"}\"]}],[\"$\",\"span\",\"code-segement409\",{\"className\":\"token string-interpolation\",\"style\":{\"color\":\"#116b00\"},\"children\":[\".png\\\"\"]}],[\"$\",\"span\",\"code-segement410\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement411\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"\\n\"]}],[\"$\",\"span\",\"code-segement412\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"                cv2\"]}],[\"$\",\"span\",\"code-segement413\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\".\"]}],[\"$\",\"span\",\"code-segement414\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"imwrite\"]}],[\"$\",\"span\",\"code-segement415\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement416\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"file_path\"]}],[\"$\",\"span\",\"code-segement417\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement418\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" binary_image\"]}],[\"$\",\"span\",\"code-segement419\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}]]]}]}]]}],[\"$\",\"$Le\",\"51\",{\"variant\":\"p\",\"component\":\"p\",\"sx\":{\"textAlign\":\"justify\",\"marginBottom\":2},\"children\":[\"$undefined\",\"Run the code and you should see logs in the console saying how long it took. I've tabulated my results (for 5,000 input images):\"]}],[\"$\",\"$Lc\",\"52\",{\"sx\":{\"width\":\"100%\",\"display\":\"flex\",\"flexDirection\":\"column\",\"justifyContent\":\"center\",\"alignItems\":\"center\",\"marginBottom\":2},\"children\":[\"$\",\"$L1f\",null,{\"sx\":{\"backgroundColor\":\"rgb(227, 234, 242)\"},\"children\":[[\"$\",\"$Le\",null,{\"variant\":\"h6\",\"component\":\"h4\",\"sx\":{\"width\":\"100%\",\"textAlign\":\"center\",\"marginTop\":2},\"children\":[\"$\",\"strong\",null,{\"children\":\"Num images: 5,000 | Device: GPU\"}]}],[\"$\",\"$L20\",null,{\"children\":[[\"$\",\"$L21\",null,{\"children\":[\"$\",\"$L22\",null,{\"children\":[[\"$\",\"$L23\",\"0\",{\"sx\":{\"fontWeight\":\"bold\"},\"children\":\"Batch Size\"}],[\"$\",\"$L23\",\"1\",{\"sx\":{\"fontWeight\":\"bold\"},\"children\":\"Time Taken (s)\"}],[\"$\",\"$L23\",\"2\",{\"sx\":{\"fontWeight\":\"bold\"},\"children\":\"Time Taken per Image (ms)\"}],[\"$\",\"$L23\",\"3\",{\"sx\":{\"fontWeight\":\"bold\"},\"children\":\"FPS\"}],[\"$\",\"$L23\",\"4\",{\"sx\":{\"fontWeight\":\"bold\"},\"children\":\"CUDA Memory Consumption (GB)\"}],[\"$\",\"$L23\",\"5\",{\"sx\":{\"fontWeight\":\"bold\"},\"children\":\"Improvement over Batch Size 1\"}],[\"$\",\"$L23\",\"6\",{\"sx\":{\"fontWeight\":\"bold\"},\"children\":\"Improvement over Previous Row\"}]]}]}],[\"$\",\"$L24\",null,{\"children\":[[\"$\",\"$L22\",\"0\",{\"sx\":{\"\u0026:last-child td, \u0026:last-child th\":{\"border\":0}},\"children\":[[\"$\",\"$L23\",\"0\",{\"children\":\"1\"}],[\"$\",\"$L23\",\"1\",{\"children\":\"46.9190\"}],[\"$\",\"$L23\",\"2\",{\"children\":\"9.3838\"}],[\"$\",\"$L23\",\"3\",{\"children\":\"106.5666\"}],[\"$\",\"$L23\",\"4\",{\"children\":\"0.9051\"}],[\"$\",\"$L23\",\"5\",{\"children\":\"1x\"}],[\"$\",\"$L23\",\"6\",{\"children\":\"-\"}]]}],[\"$\",\"$L22\",\"1\",{\"sx\":{\"\u0026:last-child td, \u0026:last-child th\":{\"border\":0}},\"children\":[[\"$\",\"$L23\",\"0\",{\"children\":\"2\"}],[\"$\",\"$L23\",\"1\",{\"children\":\"40.4961\"}],[\"$\",\"$L23\",\"2\",{\"children\":\"8.0992\"}],[\"$\",\"$L23\",\"3\",{\"children\":\"123.4689\"}],[\"$\",\"$L23\",\"4\",{\"children\":\"1.1397\"}],[\"$\",\"$L23\",\"5\",{\"children\":\"1.1586x\"}],[\"$\",\"$L23\",\"6\",{\"children\":\"1.1586x\"}]]}],[\"$\",\"$L22\",\"2\",{\"sx\":{\"\u0026:last-child td, \u0026:last-child th\":{\"border\":0}},\"children\":[[\"$\",\"$L23\",\"0\",{\"children\":\"4\"}],[\"$\",\"$L23\",\"1\",{\"children\":\"39.8241\"}],[\"$\",\"$L23\",\"2\",{\"children\":\"7.9648\"}],[\"$\",\"$L23\",\"3\",{\"children\":\"125.5524\"}],[\"$\",\"$L23\",\"4\",{\"children\":\"1.5774\"}],[\"$\",\"$L23\",\"5\",{\"children\":\"1.1781x\"}],[\"$\",\"$L23\",\"6\",{\"children\":\"1.0168x\"}]]}],[\"$\",\"$L22\",\"3\",{\"sx\":{\"\u0026:last-child td, \u0026:last-child th\":{\"border\":0}},\"children\":[[\"$\",\"$L23\",\"0\",{\"children\":\"8\"}],[\"$\",\"$L23\",\"1\",{\"children\":\"39.3241\"}],[\"$\",\"$L23\",\"2\",{\"children\":\"7.8648\"}],[\"$\",\"$L23\",\"3\",{\"children\":\"127.1488\"}],[\"$\",\"$L23\",\"4\",{\"children\":\"2.6414\"}],[\"$\",\"$L23\",\"5\",{\"children\":\"1.1931x\"}],[\"$\",\"$L23\",\"6\",{\"children\":\"1.0127x\"}]]}],[\"$\",\"$L22\",\"4\",{\"sx\":{\"\u0026:last-child td, \u0026:last-child th\":{\"border\":0}},\"children\":[[\"$\",\"$L23\",\"0\",{\"children\":\"16\"}],[\"$\",\"$L23\",\"1\",{\"children\":\"39.2899\"}],[\"$\",\"$L23\",\"2\",{\"children\":\"7.8579\"}],[\"$\",\"$L23\",\"3\",{\"children\":\"127.2442\"}],[\"$\",\"$L23\",\"4\",{\"children\":\"4.4764\"}],[\"$\",\"$L23\",\"5\",{\"children\":\"1.1940x\"}],[\"$\",\"$L23\",\"6\",{\"children\":\"1.00087x\"}]]}]]}]]}]]}]}],[\"$\",\"$Le\",\"53\",{\"variant\":\"p\",\"component\":\"p\",\"sx\":{\"textAlign\":\"justify\",\"marginBottom\":2},\"children\":[\"$undefined\",\"The biggest improvement is from Batch Size 1 -\u003e 2, while the least increase in memory consumption.\"]}],[\"$\",\"$Le\",\"54\",{\"id\":\"batched-cpu-inference:-any-good?\",\"variant\":\"h5\",\"component\":\"h2\",\"mb\":2,\"children\":[\"$\",\"strong\",null,{\"children\":\"Batched CPU Inference: Any Good?\"}]}],[\"$\",\"$Le\",\"55\",{\"variant\":\"p\",\"component\":\"p\",\"sx\":{\"textAlign\":\"justify\",\"marginBottom\":2},\"children\":[\"$undefined\",\"I'll set \",[\"$\",\"$Lc\",\"55-text-italics\",{\"component\":\"span\",\"sx\":{\"paddingLeft\":0.5,\"paddingRight\":0.5,\"borderRadius\":1,\"backgroundColor\":\"rgb(227, 234, 242)\"},\"children\":\"use_cuda\"}],\" to \",[\"$\",\"$Lc\",\"55-text-italics\",{\"component\":\"span\",\"sx\":{\"paddingLeft\":0.5,\"paddingRight\":0.5,\"borderRadius\":1,\"backgroundColor\":\"rgb(227, 234, 242)\"},\"children\":\"False\"}],\" where we are loading the model and run the inference again, with the same batches.\"]}],[\"$\",\"$Lc\",null,{\"sx\":{\"width\":\"100%\",\"marginBottom\":2},\"children\":[[\"$\",\"$L1c\",null,{\"contentToCopy\":\"model = Model(path_join(weights_dir, \\\"weights_001.pt\\\"), use_cuda=True)\"}],[\"$\",\"pre\",null,{\"style\":{\"color\":\"#111b27\",\"background\":\"#e3eaf2\",\"fontFamily\":\"Consolas, Monaco, \\\"Andale Mono\\\", \\\"Ubuntu Mono\\\", monospace\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":0,\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-python\",\"style\":{\"color\":\"#111b27\",\"background\":\"none\",\"fontFamily\":\"Consolas, Monaco, \\\"Andale Mono\\\", \\\"Ubuntu Mono\\\", monospace\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"code-segement0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"model \"]}],[\"$\",\"span\",\"code-segement1\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement2\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" Model\"]}],[\"$\",\"span\",\"code-segement3\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement4\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"path_join\"]}],[\"$\",\"span\",\"code-segement5\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\"(\"]}],[\"$\",\"span\",\"code-segement6\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"weights_dir\"]}],[\"$\",\"span\",\"code-segement7\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement8\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" \"]}],[\"$\",\"span\",\"code-segement9\",{\"className\":\"token\",\"style\":{\"color\":\"#116b00\"},\"children\":[\"\\\"weights_001.pt\\\"\"]}],[\"$\",\"span\",\"code-segement10\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}],[\"$\",\"span\",\"code-segement11\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\",\"]}],[\"$\",\"span\",\"code-segement12\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\" use_cuda\"]}],[\"$\",\"span\",\"code-segement13\",{\"className\":\"token\",\"style\":{\"color\":\"#a04900\"},\"children\":[\"=\"]}],[\"$\",\"span\",\"code-segement14\",{\"className\":\"token\",\"style\":{\"color\":\"#755f00\"},\"children\":[\"True\"]}],[\"$\",\"span\",\"code-segement15\",{\"className\":\"token\",\"style\":{\"color\":\"#111b27\"},\"children\":[\")\"]}]]]}]}]]}],[\"$\",\"$Lc\",\"57\",{\"sx\":{\"width\":\"100%\",\"display\":\"flex\",\"flexDirection\":\"column\",\"justifyContent\":\"center\",\"alignItems\":\"center\",\"marginBottom\":2},\"children\":[\"$\",\"$L1f\",null,{\"sx\":{\"backgroundColor\":\"rgb(227, 234, 242)\"},\"children\":[[\"$\",\"$Le\",null,{\"variant\":\"h6\",\"component\":\"h4\",\"sx\":{\"width\":\"100%\",\"textAlign\":\"center\",\"marginTop\":2},\"children\":[\"$\",\"strong\",null,{\"children\":\"Num images: 5,000 | Device: CPU\"}]}],[\"$\",\"$L20\",null,{\"children\":[[\"$\",\"$L21\",null,{\"children\":[\"$\",\"$L22\",null,{\"children\":[[\"$\",\"$L23\",\"0\",{\"sx\":{\"fontWeight\":\"bold\"},\"children\":\"Batch Size\"}],[\"$\",\"$L23\",\"1\",{\"sx\":{\"fontWeight\":\"bold\"},\"children\":\"Time Taken\"}],[\"$\",\"$L23\",\"2\",{\"sx\":{\"fontWeight\":\"bold\"},\"children\":\"Time Taken per Image (s)\"}],[\"$\",\"$L23\",\"3\",{\"sx\":{\"fontWeight\":\"bold\"},\"children\":\"FPS\"}]]}]}],[\"$\",\"$L24\",null,{\"children\":[[\"$\",\"$L22\",\"0\",{\"sx\":{\"\u0026:last-child td, \u0026:last-child th\":{\"border\":0}},\"children\":[[\"$\",\"$L23\",\"0\",{\"children\":\"1\"}],[\"$\",\"$L23\",\"1\",{\"children\":\"01h51m14s\"}],[\"$\",\"$L23\",\"2\",{\"children\":\"1.3348\"}],[\"$\",\"$L23\",\"3\",{\"children\":\"0.7491\"}]]}],[\"$\",\"$L22\",\"1\",{\"sx\":{\"\u0026:last-child td, \u0026:last-child th\":{\"border\":0}},\"children\":[[\"$\",\"$L23\",\"0\",{\"children\":\"2\"}],[\"$\",\"$L23\",\"1\",{\"children\":\"01h47m19s\"}],[\"$\",\"$L23\",\"2\",{\"children\":\"1.2878\"}],[\"$\",\"$L23\",\"3\",{\"children\":\"0.7765\"}]]}],[\"$\",\"$L22\",\"2\",{\"sx\":{\"\u0026:last-child td, \u0026:last-child th\":{\"border\":0}},\"children\":[[\"$\",\"$L23\",\"0\",{\"children\":\"4\"}],[\"$\",\"$L23\",\"1\",{\"children\":\"01h42m44s\"}],[\"$\",\"$L23\",\"2\",{\"children\":\"1.2327\"}],[\"$\",\"$L23\",\"3\",{\"children\":\"0.8112\"}]]}],[\"$\",\"$L22\",\"3\",{\"sx\":{\"\u0026:last-child td, \u0026:last-child th\":{\"border\":0}},\"children\":[[\"$\",\"$L23\",\"0\",{\"children\":\"8\"}],[\"$\",\"$L23\",\"1\",{\"children\":\"01h40m47s\"}],[\"$\",\"$L23\",\"2\",{\"children\":\"1.2095\"}],[\"$\",\"$L23\",\"3\",{\"children\":\"0.8267\"}]]}],[\"$\",\"$L22\",\"4\",{\"sx\":{\"\u0026:last-child td, \u0026:last-child th\":{\"border\":0}},\"children\":[[\"$\",\"$L23\",\"0\",{\"children\":\"16\"}],[\"$\",\"$L23\",\"1\",{\"children\":\"01h38m59s\"}],[\"$\",\"$L23\",\"2\",{\"children\":\"1.1877\"}],[\"$\",\"$L23\",\"3\",{\"children\":\"0.8419\"}]]}]]}]]}]]}]}],[\"$\",\"$Le\",\"58\",{\"variant\":\"p\",\"component\":\"p\",\"sx\":{\"textAlign\":\"justify\",\"marginBottom\":2},\"children\":[\"$undefined\",\"In this case, there is a trend of decreasing inference time with larger batch sizes but it's no significant improvement.\"]}],[\"$\",\"$Le\",\"59\",{\"id\":\"model-dependence\",\"variant\":\"h5\",\"component\":\"h2\",\"mb\":2,\"children\":[\"$\",\"strong\",null,{\"children\":\"Model Dependence\"}]}],[\"$\",\"$Le\",\"60\",{\"variant\":\"p\",\"component\":\"p\",\"sx\":{\"textAlign\":\"justify\",\"marginBottom\":2},\"children\":[\"$undefined\",\"The improvement we get while running a model on GPU or while running batched inference depends highly on how to model has been constructed. Here are some tests that I ran on another model (these were on an RTX 4090, with much smaller images, with a model for a different task).\"]}],[\"$\",\"$Lc\",\"61\",{\"sx\":{\"width\":\"100%\",\"display\":\"flex\",\"flexDirection\":\"column\",\"justifyContent\":\"center\",\"alignItems\":\"center\",\"marginBottom\":2},\"children\":[\"$\",\"$L1f\",null,{\"sx\":{\"backgroundColor\":\"rgb(227, 234, 242)\"},\"children\":[[\"$\",\"$Le\",null,{\"variant\":\"h6\",\"component\":\"h4\",\"sx\":{\"width\":\"100%\",\"textAlign\":\"center\",\"marginTop\":2},\"children\":[\"$\",\"strong\",null,{\"children\":\"Num images: 21,846 | Device: GPU\"}]}],[\"$\",\"$L20\",null,{\"children\":[[\"$\",\"$L21\",null,{\"children\":[\"$\",\"$L22\",null,{\"children\":[[\"$\",\"$L23\",\"0\",{\"sx\":{\"fontWeight\":\"bold\"},\"children\":\"Batch Size\"}],[\"$\",\"$L23\",\"1\",{\"sx\":{\"fontWeight\":\"bold\"},\"children\":\"Time Taken (s)\"}],[\"$\",\"$L23\",\"2\",{\"sx\":{\"fontWeight\":\"bold\"},\"children\":\"Time Taken per Image (ms)\"}],[\"$\",\"$L23\",\"3\",{\"sx\":{\"fontWeight\":\"bold\"},\"children\":\"FPS\"}],[\"$\",\"$L23\",\"4\",{\"sx\":{\"fontWeight\":\"bold\"},\"children\":\"CUDA Memory Consumption (GB)\"}],[\"$\",\"$L23\",\"5\",{\"sx\":{\"fontWeight\":\"bold\"},\"children\":\"Improvement over Batch Size 1\"}],[\"$\",\"$L23\",\"6\",{\"sx\":{\"fontWeight\":\"bold\"},\"children\":\"Improvement over Previous Row\"}]]}]}],[\"$\",\"$L24\",null,{\"children\":[[\"$\",\"$L22\",\"0\",{\"sx\":{\"\u0026:last-child td, \u0026:last-child th\":{\"border\":0}},\"children\":[[\"$\",\"$L23\",\"0\",{\"children\":\"1\"}],[\"$\",\"$L23\",\"1\",{\"children\":\"219.56\"}],[\"$\",\"$L23\",\"2\",{\"children\":\"10.05\"}],[\"$\",\"$L23\",\"3\",{\"children\":\"99.50\"}],[\"$\",\"$L23\",\"4\",{\"children\":\"0.2628\"}],[\"$\",\"$L23\",\"5\",{\"children\":\"1x\"}],[\"$\",\"$L23\",\"6\",{\"children\":\"-\"}]]}],[\"$\",\"$L22\",\"1\",{\"sx\":{\"\u0026:last-child td, \u0026:last-child th\":{\"border\":0}},\"children\":[[\"$\",\"$L23\",\"0\",{\"children\":\"2\"}],[\"$\",\"$L23\",\"1\",{\"children\":\"134.41\"}],[\"$\",\"$L23\",\"2\",{\"children\":\"6.15\"}],[\"$\",\"$L23\",\"3\",{\"children\":\"162.60\"}],[\"$\",\"$L23\",\"4\",{\"children\":\"0.3487\"}],[\"$\",\"$L23\",\"5\",{\"children\":\"1.6341x\"}],[\"$\",\"$L23\",\"6\",{\"children\":\"1.6341x\"}]]}],[\"$\",\"$L22\",\"2\",{\"sx\":{\"\u0026:last-child td, \u0026:last-child th\":{\"border\":0}},\"children\":[[\"$\",\"$L23\",\"0\",{\"children\":\"4\"}],[\"$\",\"$L23\",\"1\",{\"children\":\"76.88\"}],[\"$\",\"$L23\",\"2\",{\"children\":\"3.5193\"}],[\"$\",\"$L23\",\"3\",{\"children\":\"284.14\"}],[\"$\",\"$L23\",\"4\",{\"children\":\"0.4893\"}],[\"$\",\"$L23\",\"5\",{\"children\":\"2.8556x\"}],[\"$\",\"$L23\",\"6\",{\"children\":\"1.7474x\"}]]}],[\"$\",\"$L22\",\"3\",{\"sx\":{\"\u0026:last-child td, \u0026:last-child th\":{\"border\":0}},\"children\":[[\"$\",\"$L23\",\"0\",{\"children\":\"8\"}],[\"$\",\"$L23\",\"1\",{\"children\":\"44.47\"}],[\"$\",\"$L23\",\"2\",{\"children\":\"2.0360\"}],[\"$\",\"$L23\",\"3\",{\"children\":\"491.15\"}],[\"$\",\"$L23\",\"4\",{\"children\":\"0.8018\"}],[\"$\",\"$L23\",\"5\",{\"children\":\"4.9361x\"}],[\"$\",\"$L23\",\"6\",{\"children\":\"1.6933x\"}]]}],[\"$\",\"$L22\",\"4\",{\"sx\":{\"\u0026:last-child td, \u0026:last-child th\":{\"border\":0}},\"children\":[[\"$\",\"$L23\",\"0\",{\"children\":\"16\"}],[\"$\",\"$L23\",\"1\",{\"children\":\"26.64\"}],[\"$\",\"$L23\",\"2\",{\"children\":\"1.2196\"}],[\"$\",\"$L23\",\"3\",{\"children\":\"819.94\"}],[\"$\",\"$L23\",\"4\",{\"children\":\"1.3409\"}],[\"$\",\"$L23\",\"5\",{\"children\":\"8.2406x\"}],[\"$\",\"$L23\",\"6\",{\"children\":\"1.6694x\"}]]}],[\"$\",\"$L22\",\"5\",{\"sx\":{\"\u0026:last-child td, \u0026:last-child th\":{\"border\":0}},\"children\":[[\"$\",\"$L23\",\"0\",{\"children\":\"32\"}],[\"$\",\"$L23\",\"1\",{\"children\":\"19.37\"}],[\"$\",\"$L23\",\"2\",{\"children\":\"0.8871\"}],[\"$\",\"$L23\",\"3\",{\"children\":\"1,127.26\"}],[\"$\",\"$L23\",\"4\",{\"children\":\"2.3565\"}],[\"$\",\"$L23\",\"5\",{\"children\":\"11.3292x\"}],[\"$\",\"$L23\",\"6\",{\"children\":\"1.3748x\"}]]}],[\"$\",\"$L22\",\"6\",{\"sx\":{\"\u0026:last-child td, \u0026:last-child th\":{\"border\":0}},\"children\":[[\"$\",\"$L23\",\"0\",{\"children\":\"64\"}],[\"$\",\"$L23\",\"1\",{\"children\":\"14.69\"}],[\"$\",\"$L23\",\"2\",{\"children\":\"0.6725\"}],[\"$\",\"$L23\",\"3\",{\"children\":\"1,486.98\"}],[\"$\",\"$L23\",\"4\",{\"children\":\"4.4815\"}],[\"$\",\"$L23\",\"5\",{\"children\":\"14.9445x\"}],[\"$\",\"$L23\",\"6\",{\"children\":\"1.3191x\"}]]}],[\"$\",\"$L22\",\"7\",{\"sx\":{\"\u0026:last-child td, \u0026:last-child th\":{\"border\":0}},\"children\":[[\"$\",\"$L23\",\"0\",{\"children\":\"128\"}],[\"$\",\"$L23\",\"1\",{\"children\":\"12.84\"}],[\"$\",\"$L23\",\"2\",{\"children\":\"0.5881\"}],[\"$\",\"$L23\",\"3\",{\"children\":\"1,700.39\"}],[\"$\",\"$L23\",\"4\",{\"children\":\"9.6925\"}],[\"$\",\"$L23\",\"5\",{\"children\":\"17.0893x\"}],[\"$\",\"$L23\",\"6\",{\"children\":\"1.1435x\"}]]}],[\"$\",\"$L22\",\"8\",{\"sx\":{\"\u0026:last-child td, \u0026:last-child th\":{\"border\":0}},\"children\":[[\"$\",\"$L23\",\"0\",{\"children\":\"256\"}],[\"$\",\"$L23\",\"1\",{\"children\":\"12.35\"}],[\"$\",\"$L23\",\"2\",{\"children\":\"0.5656\"}],[\"$\",\"$L23\",\"3\",{\"children\":\"1,768.03\"}],[\"$\",\"$L23\",\"4\",{\"children\":\"19.2745\"}],[\"$\",\"$L23\",\"5\",{\"children\":\"17.7691x\"}],[\"$\",\"$L23\",\"6\",{\"children\":\"1.0397x\"}]]}]]}]]}]]}]}],[\"$\",\"$Le\",\"62\",{\"variant\":\"p\",\"component\":\"p\",\"sx\":{\"textAlign\":\"justify\",\"marginBottom\":2},\"children\":[\"$undefined\",\"The improvements for this model and input are very different.\"]}],[\"$\",\"$Le\",\"63\",{\"id\":\"conclusion\",\"variant\":\"h4\",\"component\":\"h1\",\"mb\":2,\"children\":[\"$\",\"strong\",null,{\"children\":\"Conclusion\"}]}],[\"$\",\"$Le\",\"64\",{\"variant\":\"p\",\"component\":\"p\",\"sx\":{\"textAlign\":\"justify\",\"marginBottom\":2},\"children\":[\"$undefined\",\"In this Post, we have seen how GPUs are significantly faster than CPUs for ML inference tasks. We have also seen that processing multiple inputs in parallel i.e. in a batch serves to decrease the inference time. The relative decrease is considerable among smaller batch sizes but diminishes as the batch sizes get larger. The effect on performance also depends on the model architecture and its implementation.\"]}],[\"$\",\"$Le\",\"65\",{\"variant\":\"p\",\"component\":\"p\",\"sx\":{\"textAlign\":\"justify\",\"marginBottom\":2},\"children\":[\"$undefined\",\"Or maybe, you want to serve models to run on the client side, in that case, \",[\"$\",\"$L1b\",\"65-link\",{\"href\":\"/ml-ops/tensorflow-js-inference-in-react\",\"color\":\"primary\",\"underline\":\"hover\",\"children\":\"this Article\"}],\" may interest you, where we run a model on the user's web browser using TensorFlow JS.\"]}],[\"$\",\"$Le\",\"66\",{\"variant\":\"p\",\"component\":\"p\",\"sx\":{\"textAlign\":\"justify\",\"marginBottom\":2},\"children\":[\"$undefined\",\"See you next time :)\"]}]]}]}]]}]}],\"$L26\"]}]\n"])</script><script>self.__next_f.push([1,"27:I[3713,[\"98\",\"static/chunks/98-7f6363f9ac68c942.js\",\"134\",\"static/chunks/134-9729e0afcc6dfdfe.js\",\"830\",\"static/chunks/830-8a0df588e7c84864.js\",\"748\",\"static/chunks/748-1f14ee6eb3d7029a.js\",\"411\",\"static/chunks/411-e5dcfc2304d91b2f.js\",\"533\",\"static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js\"],\"default\"]\n16:[\"$\",\"$Lc\",null,{\"sx\":{\"width\":\"100%\",\"display\":\"flex\",\"flexDirection\":\"row\",\"justifyContent\":\"space-between\",\"alignItems\":\"center\"},\"children\":[[\"$\",\"$Le\",null,{\"variant\":\"p\",\"component\":\"p\",\"mr\":2,\"children\":\"By: Abhilaksh Singh Reen\"}],[\"$\",\"$L27\",null,{\"socialMediaProfiles\":[{\"network_name\":\"LinkedIn\",\"profile_url\":\"https://www.linkedin.com/in/abhilaksh-singh-837901210/\",\"profile_display_name\":\"Abhilaksh Singh Reen\"},{\"network_name\":\"Twitter\",\"profile_url\":\"https://x.com/TheVeteran06\",\"profile_display_name\":\"The Veteran 06\"},{\"network_name\":\"GitHub\",\"profile_url\":\"https://github.com/AbhilakshSinghReen\",\"profile_display_name\":\"Abhilaksh Singh Reen\"}]}]]}]\n"])</script><script>self.__next_f.push([1,"28:I[6652,[\"98\",\"static/chunks/98-7f6363f9ac68c942.js\",\"134\",\"static/chunks/134-9729e0afcc6dfdfe.js\",\"830\",\"static/chunks/830-8a0df588e7c84864.js\",\"748\",\"static/chunks/748-1f14ee6eb3d7029a.js\",\"411\",\"static/chunks/411-e5dcfc2304d91b2f.js\",\"533\",\"static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js\"],\"\"]\n29:I[6981,[\"98\",\"static/chunks/98-7f6363f9ac68c942.js\",\"134\",\"static/chunks/134-9729e0afcc6dfdfe.js\",\"830\",\"static/chunks/830-8a0df588e7c84864.js\",\"748\",\"static/chunks/748-1f14ee6eb3d7029a.js\",\"411\",\"static/chunks/411-e5dcfc2304d91b2f.js\",\"533\",\"static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js\"],\"\"]\n2a:I[2818,[\"98\",\"static/chunks/98-7f6363f9ac68c942.js\",\"134\",\"static/chunks/134-9729e0afcc6dfdfe.js\",\"830\",\"static/chunks/830-8a0df588e7c84864.js\",\"748\",\"static/chunks/748-1f14ee6eb3d7029a.js\",\"411\",\"static/chunks/411-e5dcfc2304d91b2f.js\",\"533\",\"static/chunks/app/%5BcategorySlug%5D/%5BpostOrSeriesSlug%5D/page-b4c214dd448204e1.js\"],\"\"]\n"])</script><script>self.__next_f.push([1,"26:[\"$\",\"$Lc\",null,{\"mt\":5,\"mb\":5,\"pb\":2,\"sx\":{\"width\":\"100%\",\"display\":\"flex\",\"flexDirection\":\"column\",\"justifyContent\":\"flex-start\",\"alignItems\":\"center\"},\"children\":[\"$\",\"$L15\",null,{\"container\":true,\"spacing\":2,\"mt\":4,\"mb\":4,\"children\":[[\"$\",\"$L15\",\"/ml-ops/tensorflow-js-inference-in-react\",{\"item\":true,\"xs\":12,\"sm\":6,\"md\":4,\"lg\":3,\"children\":[\"$\",\"$Lf\",null,{\"href\":\"/ml-ops/tensorflow-js-inference-in-react\",\"passHref\":true,\"style\":{\"textDecoration\":\"none\"},\"children\":[\"$\",\"$L28\",null,{\"sx\":{\"width\":\"100%\",\"height\":\"100%\",\"boxShadow\":\"1px 1px 1px 1px \\\"#eeeeee\\\"\",\"\u0026:hover\":{\"boxShadow\":\"3px 3px 3px 3px \\\"#eeeeee\\\"\",\"cursor\":\"pointer\"}},\"children\":[[\"$\",\"$L29\",null,{\"component\":\"img\",\"height\":\"150\",\"image\":\"/media/images/react-digit-recog-app-final.jpg\",\"alt\":\"TensorFlow.js Inference in React on an image drawn with Konva\",\"sx\":{\"objectFit\":\"cover\"}}],[\"$\",\"$L2a\",null,{\"children\":[[\"$\",\"$Le\",null,{\"gutterBottom\":true,\"variant\":\"h6\",\"component\":\"h2\",\"children\":[\"\",\" \",\"TensorFlow.js Inference in React on an image drawn with Konva\"]}],[\"$\",\"$Le\",null,{\"gutterBottom\":true,\"variant\":\"p\",\"component\":\"p\",\"sx\":{\"overflow\":\"hidden\",\"textOverflow\":\"ellipsis\",\"display\":\"-webkit-box\",\"WebkitLineClamp\":\"3\",\"WebkitBoxOrient\":\"vertical\"},\"children\":\"Inferencing on an ONNX model in a React App using ONNXRuntime Web.\"}],[\"$\",\"$Lc\",null,{\"sx\":{\"width\":\"100%\",\"display\":\"flex\",\"flexDirection\":\"row\",\"justifyContent\":\"flex-end\",\"alignItems\":\"center\"},\"children\":[\"$\",\"$Le\",null,{\"gutterBottom\":true,\"variant\":\"p\",\"component\":\"p\",\"children\":\"08m Read\"}]}],false]}]]}]}]}],[\"$\",\"$L15\",\"/ml-ops/onnxruntime-web-inference-in-react\",{\"item\":true,\"xs\":12,\"sm\":6,\"md\":4,\"lg\":3,\"children\":[\"$\",\"$Lf\",null,{\"href\":\"/ml-ops/onnxruntime-web-inference-in-react\",\"passHref\":true,\"style\":{\"textDecoration\":\"none\"},\"children\":[\"$\",\"$L28\",null,{\"sx\":{\"width\":\"100%\",\"height\":\"100%\",\"boxShadow\":\"1px 1px 1px 1px \\\"#eeeeee\\\"\",\"\u0026:hover\":{\"boxShadow\":\"3px 3px 3px 3px \\\"#eeeeee\\\"\",\"cursor\":\"pointer\"}},\"children\":[[\"$\",\"$L29\",null,{\"component\":\"img\",\"height\":\"150\",\"image\":\"/media/images/react-digit-recog-app-final.jpg\",\"alt\":\"ONNXRuntime Inference in a React App\",\"sx\":{\"objectFit\":\"cover\"}}],[\"$\",\"$L2a\",null,{\"children\":[[\"$\",\"$Le\",null,{\"gutterBottom\":true,\"variant\":\"h6\",\"component\":\"h2\",\"children\":[\"\",\" \",\"ONNXRuntime Inference in a React App\"]}],[\"$\",\"$Le\",null,{\"gutterBottom\":true,\"variant\":\"p\",\"component\":\"p\",\"sx\":{\"overflow\":\"hidden\",\"textOverflow\":\"ellipsis\",\"display\":\"-webkit-box\",\"WebkitLineClamp\":\"3\",\"WebkitBoxOrient\":\"vertical\"},\"children\":\"Inferencing on an ONNX model in a React App using ONNXRuntime Web.\"}],[\"$\",\"$Lc\",null,{\"sx\":{\"width\":\"100%\",\"display\":\"flex\",\"flexDirection\":\"row\",\"justifyContent\":\"flex-end\",\"alignItems\":\"center\"},\"children\":[\"$\",\"$Le\",null,{\"gutterBottom\":true,\"variant\":\"p\",\"component\":\"p\",\"children\":\"08m Read\"}]}],false]}]]}]}]}]]}]}]\n"])</script></body></html>